/*! For license information please see main.080bc246.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,n)=>{e.exports=n(202)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,n){var r,s={},c=null,u=null;for(r in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:c,ref:u,props:s,_owner:a.current}}t.Fragment=s,t.jsx=c,t.jsxs=c},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function v(){}function w(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var b=w.prototype=new v;b.constructor=w,m(b,y.prototype),b.isPureReactComponent=!0;var S=Array.isArray,k=Object.prototype.hasOwnProperty,E={current:null},x={key:!0,ref:!0,__self:!0,__source:!0};function C(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)k.call(t,i)&&!x.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:E.current}}function T(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function I(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function A(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+I(l,0):s,S(o)?(i="",null!=e&&(i=e.replace(_,"$&/")+"/"),A(o,t,i,"",function(e){return e})):null!=o&&(T(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(_,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",S(e))for(var c=0;c<e.length;c++){var u=s+I(a=e[c],c);l+=A(a,t,i,u,o)}else if(u=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof u)for(e=u.call(e),c=0;!(a=e.next()).done;)l+=A(a=a.value,t,i,u=s+I(a,c++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function N(e,t,n){if(null==e)return e;var r=[],i=0;return A(e,r,"","",function(e){return t.call(n,e,i++)}),r}function O(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var M={current:null},R={transition:null},D={ReactCurrentDispatcher:M,ReactCurrentBatchConfig:R,ReactCurrentOwner:E};function P(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:N,forEach:function(e,t,n){N(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return N(e,function(){t++}),t},toArray:function(e){return N(e,function(e){return e})||[]},only:function(e){if(!T(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=o,t.PureComponent=w,t.StrictMode=s,t.Suspense=u,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=D,t.act=P,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=E.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)k.call(t,c)&&!x.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==l?l[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=r;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=C,t.createFactory=function(e){var t=C.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=T,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:O}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=R.transition;R.transition={};try{e()}finally{R.transition=t}},t.unstable_act=P,t.useCallback=function(e,t){return M.current.useCallback(e,t)},t.useContext=function(e){return M.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return M.current.useDeferredValue(e)},t.useEffect=function(e,t){return M.current.useEffect(e,t)},t.useId=function(){return M.current.useId()},t.useImperativeHandle=function(e,t,n){return M.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return M.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return M.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return M.current.useMemo(e,t)},t.useReducer=function(e,t,n){return M.current.useReducer(e,t,n)},t.useRef=function(e){return M.current.useRef(e)},t.useState=function(e){return M.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return M.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return M.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],c=a+1,u=e[c];if(0>s(l,n))c<i&&0>s(u,l)?(e[r]=u,e[c]=n,r=c):(e[r]=l,e[a]=n,r=a);else{if(!(c<i&&0>s(u,n)))break e;e[r]=u,e[c]=n,r=c}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var c=[],u=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(u);null!==t;){if(null===t.callback)i(u);else{if(!(t.startTime<=e))break;i(u),t.sortIndex=t.expirationTime,n(c,t)}t=r(u)}}function S(e){if(g=!1,b(e),!m)if(null!==r(c))m=!0,R(k);else{var t=r(u);null!==t&&D(S,t.startTime-e)}}function k(e,n){m=!1,g&&(g=!1,v(T),T=-1),p=!0;var s=f;try{for(b(n),d=r(c);null!==d&&(!(d.expirationTime>n)||e&&!A());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(c)&&i(c),b(n)}else i(c);d=r(c)}if(null!==d)var l=!0;else{var h=r(u);null!==h&&D(S,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var E,x=!1,C=null,T=-1,_=5,I=-1;function A(){return!(t.unstable_now()-I<_)}function N(){if(null!==C){var e=t.unstable_now();I=e;var n=!0;try{n=C(!0,e)}finally{n?E():(x=!1,C=null)}}else x=!1}if("function"===typeof w)E=function(){w(N)};else if("undefined"!==typeof MessageChannel){var O=new MessageChannel,M=O.port2;O.port1.onmessage=N,E=function(){M.postMessage(null)}}else E=function(){y(N,0)};function R(e){C=e,x||(x=!0,E())}function D(e,n){T=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,R(k))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(u,e),null===r(c)&&e===r(u)&&(g?(v(T),T=-1):g=!0,D(S,s-o))):(e.sortIndex=a,n(c,e),m||p||(m=!0,R(k))),e},t.unstable_shouldYield=A,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},579:(e,t,n)=>{e.exports=n(153)},730:(e,t,n)=>{var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var u=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){g[e]=new m(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){g[e]=new m(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){g[e]=new m(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){g[e]=new m(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){g[e]=new m(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)});var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function w(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)}),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)});var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=Symbol.for("react.element"),k=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),_=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),N=Symbol.for("react.suspense_list"),O=Symbol.for("react.memo"),M=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var R=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var D=Symbol.iterator;function P(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=D&&e[D]||e["@@iterator"])?e:null}var L,F=Object.assign;function j(e){if(void 0===L)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);L=t&&t[1]||""}return"\n"+L+e}var V=!1;function z(e,t){if(!e||V)return"";V=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{V=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?j(e):""}function U(e){switch(e.tag){case 5:return j(e.type);case 16:return j("Lazy");case 13:return j("Suspense");case 19:return j("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 1:return e=z(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case E:return"Fragment";case k:return"Portal";case C:return"Profiler";case x:return"StrictMode";case A:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case T:return(e._context.displayName||"Context")+".Provider";case I:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case O:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case M:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function $(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function H(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function W(e){e._valueTracker||(e._valueTracker=function(e){var t=H(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function K(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=H(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function G(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function Q(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=q(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function X(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function Y(e,t){X(e,t);var n=q(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&G(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+q(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:q(n)}}function se(e,t){var n=q(t.value),r=q(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,ue,he=(ue=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction(function(){return ue(e,t)})}:ue);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach(function(e){pe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ye=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function Se(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var ke=null,Ee=null,xe=null;function Ce(e){if(e=wi(e)){if("function"!==typeof ke)throw Error(s(280));var t=e.stateNode;t&&(t=Si(t),ke(e.stateNode,e.type,t))}}function Te(e){Ee?xe?xe.push(e):xe=[e]:Ee=e}function _e(){if(Ee){var e=Ee,t=xe;if(xe=Ee=null,Ce(e),t)for(e=0;e<t.length;e++)Ce(t[e])}}function Ie(e,t){return e(t)}function Ae(){}var Ne=!1;function Oe(e,t,n){if(Ne)return e(t,n);Ne=!0;try{return Ie(e,t,n)}finally{Ne=!1,(null!==Ee||null!==xe)&&(Ae(),_e())}}function Me(e,t){var n=e.stateNode;if(null===n)return null;var r=Si(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var Re=!1;if(u)try{var De={};Object.defineProperty(De,"passive",{get:function(){Re=!0}}),window.addEventListener("test",De,De),window.removeEventListener("test",De,De)}catch(ue){Re=!1}function Pe(e,t,n,r,i,s,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(u){this.onError(u)}}var Le=!1,Fe=null,je=!1,Ve=null,ze={onError:function(e){Le=!0,Fe=e}};function Ue(e,t,n,r,i,s,o,a,l){Le=!1,Fe=null,Pe.apply(ze,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function $e(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Be(e)!==e)throw Error(s(188))}function He(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return qe(i),e;if(o===r)return qe(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e))?We(e):null}function We(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=We(e);if(null!==t)return t;e=e.sibling}return null}var Ke=i.unstable_scheduleCallback,Ge=i.unstable_cancelCallback,Je=i.unstable_shouldYield,Qe=i.unstable_requestPaint,Xe=i.unstable_now,Ye=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ct=64,ut=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ht(a):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~i)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function yt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function vt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var wt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var St,kt,Et,xt,Ct,Tt=!1,_t=[],It=null,At=null,Nt=null,Ot=new Map,Mt=new Map,Rt=[],Dt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Pt(e,t){switch(e){case"focusin":case"focusout":It=null;break;case"dragenter":case"dragleave":At=null;break;case"mouseover":case"mouseout":Nt=null;break;case"pointerover":case"pointerout":Ot.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mt.delete(t.pointerId)}}function Lt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=wi(t))&&kt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=vi(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=$e(n)))return e.blockedOn=t,void Ct(e.priority,function(){Et(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function jt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=wi(n))&&kt(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function Vt(e,t,n){jt(e)&&n.delete(t)}function zt(){Tt=!1,null!==It&&jt(It)&&(It=null),null!==At&&jt(At)&&(At=null),null!==Nt&&jt(Nt)&&(Nt=null),Ot.forEach(Vt),Mt.forEach(Vt)}function Ut(e,t){e.blockedOn===t&&(e.blockedOn=null,Tt||(Tt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zt)))}function Bt(e){function t(t){return Ut(t,e)}if(0<_t.length){Ut(_t[0],e);for(var n=1;n<_t.length;n++){var r=_t[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==It&&Ut(It,e),null!==At&&Ut(At,e),null!==Nt&&Ut(Nt,e),Ot.forEach(t),Mt.forEach(t),n=0;n<Rt.length;n++)(r=Rt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Rt.length&&null===(n=Rt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Rt.shift()}var $t=b.ReactCurrentBatchConfig,qt=!0;function Ht(e,t,n,r){var i=wt,s=$t.transition;$t.transition=null;try{wt=1,Kt(e,t,n,r)}finally{wt=i,$t.transition=s}}function Wt(e,t,n,r){var i=wt,s=$t.transition;$t.transition=null;try{wt=4,Kt(e,t,n,r)}finally{wt=i,$t.transition=s}}function Kt(e,t,n,r){if(qt){var i=Jt(e,t,n,r);if(null===i)qr(e,t,r,Gt,n),Pt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return It=Lt(It,e,t,n,r,i),!0;case"dragenter":return At=Lt(At,e,t,n,r,i),!0;case"mouseover":return Nt=Lt(Nt,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Ot.set(s,Lt(Ot.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Mt.set(s,Lt(Mt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Pt(e,r),4&t&&-1<Dt.indexOf(e)){for(;null!==i;){var s=wi(i);if(null!==s&&St(s),null===(s=Jt(e,t,n,r))&&qr(e,t,r,Gt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else qr(e,t,r,null,n)}}var Gt=null;function Jt(e,t,n,r){if(Gt=null,null!==(e=vi(e=Se(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=$e(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Gt=e,null}function Qt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ye()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,Yt=null,Zt=null;function en(){if(Zt)return Zt;var e,t,n=Yt,r=n.length,i="value"in Xt?Xt.value:Xt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return Zt=i.slice(e,1<t?1-t:void 0)}function tn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function nn(){return!0}function rn(){return!1}function sn(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?nn:rn,this.isPropagationStopped=rn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=nn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=nn)},persist:function(){},isPersistent:nn}),t}var on,an,ln,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},un=sn(cn),hn=F({},cn,{view:0,detail:0}),dn=sn(hn),fn=F({},hn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Cn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ln&&(ln&&"mousemove"===e.type?(on=e.screenX-ln.screenX,an=e.screenY-ln.screenY):an=on=0,ln=e),on)},movementY:function(e){return"movementY"in e?e.movementY:an}}),pn=sn(fn),mn=sn(F({},fn,{dataTransfer:0})),gn=sn(F({},hn,{relatedTarget:0})),yn=sn(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),vn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),wn=sn(vn),bn=sn(F({},cn,{data:0})),Sn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},kn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function Cn(){return xn}var Tn=F({},hn,{key:function(e){if(e.key){var t=Sn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?kn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Cn,charCode:function(e){return"keypress"===e.type?tn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),_n=sn(Tn),In=sn(F({},fn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=sn(F({},hn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Cn})),Nn=sn(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),On=F({},fn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Mn=sn(On),Rn=[9,13,27,32],Dn=u&&"CompositionEvent"in window,Pn=null;u&&"documentMode"in document&&(Pn=document.documentMode);var Ln=u&&"TextEvent"in window&&!Pn,Fn=u&&(!Dn||Pn&&8<Pn&&11>=Pn),jn=String.fromCharCode(32),Vn=!1;function zn(e,t){switch(e){case"keyup":return-1!==Rn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Un(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Bn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function Hn(e,t,n,r){Te(r),0<(t=Wr(t,"onChange")).length&&(n=new un("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Wn=null,Kn=null;function Gn(e){jr(e,0)}function Jn(e){if(K(bi(e)))return e}function Qn(e,t){if("change"===e)return t}var Xn=!1;if(u){var Yn;if(u){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}Yn=Zn}else Yn=!1;Xn=Yn&&(!document.documentMode||9<document.documentMode)}function tr(){Wn&&(Wn.detachEvent("onpropertychange",nr),Kn=Wn=null)}function nr(e){if("value"===e.propertyName&&Jn(Kn)){var t=[];Hn(t,Kn,e,Se(e)),Oe(Gn,t)}}function rr(e,t,n){"focusin"===e?(tr(),Kn=n,(Wn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Kn)}function sr(e,t){if("click"===e)return Jn(t)}function or(e,t){if("input"===e||"change"===e)return Jn(t)}var ar="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function lr(e,t){if(ar(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ar(e[i],t[i]))return!1}return!0}function cr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ur(e,t){var n,r=cr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=cr(r)}}function hr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function dr(){for(var e=window,t=G();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=G((e=t.contentWindow).document)}return t}function fr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pr(e){var t=dr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&hr(n.ownerDocument.documentElement,n)){if(null!==r&&fr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=ur(n,s);var o=ur(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mr=u&&"documentMode"in document&&11>=document.documentMode,gr=null,yr=null,vr=null,wr=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;wr||null==gr||gr!==G(r)||("selectionStart"in(r=gr)&&fr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},vr&&lr(vr,r)||(vr=r,0<(r=Wr(yr,"onSelect")).length&&(t=new un("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=gr)))}function Sr(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var kr={animationend:Sr("Animation","AnimationEnd"),animationiteration:Sr("Animation","AnimationIteration"),animationstart:Sr("Animation","AnimationStart"),transitionend:Sr("Transition","TransitionEnd")},Er={},xr={};function Cr(e){if(Er[e])return Er[e];if(!kr[e])return e;var t,n=kr[e];for(t in n)if(n.hasOwnProperty(t)&&t in xr)return Er[e]=n[t];return e}u&&(xr=document.createElement("div").style,"AnimationEvent"in window||(delete kr.animationend.animation,delete kr.animationiteration.animation,delete kr.animationstart.animation),"TransitionEvent"in window||delete kr.transitionend.transition);var Tr=Cr("animationend"),_r=Cr("animationiteration"),Ir=Cr("animationstart"),Ar=Cr("transitionend"),Nr=new Map,Or="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Mr(e,t){Nr.set(e,t),l(t,[e])}for(var Rr=0;Rr<Or.length;Rr++){var Dr=Or[Rr];Mr(Dr.toLowerCase(),"on"+(Dr[0].toUpperCase()+Dr.slice(1)))}Mr(Tr,"onAnimationEnd"),Mr(_r,"onAnimationIteration"),Mr(Ir,"onAnimationStart"),Mr("dblclick","onDoubleClick"),Mr("focusin","onFocus"),Mr("focusout","onBlur"),Mr(Ar,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Pr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Lr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Pr));function Fr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,c){if(Ue.apply(this,arguments),Le){if(!Le)throw Error(s(198));var u=Fe;Le=!1,Fe=null,je||(je=!0,Ve=u)}}(r,t,void 0,e),e.currentTarget=null}function jr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,a,c),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,c=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Fr(i,a,c),s=l}}}if(je)throw e=Ve,je=!1,Ve=null,e}function Vr(e,t){var n=t[mi];void 0===n&&(n=t[mi]=new Set);var r=e+"__bubble";n.has(r)||($r(t,e,2,!1),n.add(r))}function zr(e,t,n){var r=0;t&&(r|=4),$r(n,e,r,t)}var Ur="_reactListening"+Math.random().toString(36).slice(2);function Br(e){if(!e[Ur]){e[Ur]=!0,o.forEach(function(t){"selectionchange"!==t&&(Lr.has(t)||zr(t,!1,e),zr(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ur]||(t[Ur]=!0,zr("selectionchange",!1,t))}}function $r(e,t,n,r){switch(Qt(t)){case 1:var i=Ht;break;case 4:i=Wt;break;default:i=Kt}n=i.bind(null,t,n,e),i=void 0,!Re||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function qr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=vi(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Oe(function(){var r=s,i=Se(n),o=[];e:{var a=Nr.get(e);if(void 0!==a){var l=un,c=e;switch(e){case"keypress":if(0===tn(n))break e;case"keydown":case"keyup":l=_n;break;case"focusin":c="focus",l=gn;break;case"focusout":c="blur",l=gn;break;case"beforeblur":case"afterblur":l=gn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=pn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=mn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Tr:case _r:case Ir:l=yn;break;case Ar:l=Nn;break;case"scroll":l=dn;break;case"wheel":l=Mn;break;case"copy":case"cut":case"paste":l=wn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=In}var u=0!==(4&t),h=!u&&"scroll"===e,d=u?null!==a?a+"Capture":null:a;u=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Me(p,d))&&u.push(Hr(p,m,f)))),h)break;p=p.return}0<u.length&&(a=new l(a,c,null,n,i),o.push({event:a,listeners:u}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===be||!(c=n.relatedTarget||n.fromElement)||!vi(c)&&!c[pi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(c=(c=n.relatedTarget||n.toElement)?vi(c):null)&&(c!==(h=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(l=null,c=r),l!==c)){if(u=pn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(u=In,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:bi(l),f=null==c?a:bi(c),(a=new u(m,p+"leave",l,n,i)).target=h,a.relatedTarget=f,m=null,vi(i)===r&&((u=new u(d,p+"enter",c,n,i)).target=f,u.relatedTarget=h,m=u),h=m,l&&c)e:{for(d=c,p=0,f=u=l;f;f=Kr(f))p++;for(f=0,m=d;m;m=Kr(m))f++;for(;0<p-f;)u=Kr(u),p--;for(;0<f-p;)d=Kr(d),f--;for(;p--;){if(u===d||null!==d&&u===d.alternate)break e;u=Kr(u),d=Kr(d)}u=null}else u=null;null!==l&&Gr(o,a,l,u,!1),null!==c&&null!==h&&Gr(o,h,c,u,!0)}if("select"===(l=(a=r?bi(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Qn;else if(qn(a))if(Xn)g=or;else{g=ir;var y=rr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=sr);switch(g&&(g=g(e,r))?Hn(o,g,n,i):(y&&y(e,a,r),"focusout"===e&&(y=a._wrapperState)&&y.controlled&&"number"===a.type&&ee(a,"number",a.value)),y=r?bi(r):window,e){case"focusin":(qn(y)||"true"===y.contentEditable)&&(gr=y,yr=r,vr=null);break;case"focusout":vr=yr=gr=null;break;case"mousedown":wr=!0;break;case"contextmenu":case"mouseup":case"dragend":wr=!1,br(o,n,i);break;case"selectionchange":if(mr)break;case"keydown":case"keyup":br(o,n,i)}var v;if(Dn)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else Bn?zn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Fn&&"ko"!==n.locale&&(Bn||"onCompositionStart"!==w?"onCompositionEnd"===w&&Bn&&(v=en()):(Yt="value"in(Xt=i)?Xt.value:Xt.textContent,Bn=!0)),0<(y=Wr(r,w)).length&&(w=new bn(w,e,null,n,i),o.push({event:w,listeners:y}),v?w.data=v:null!==(v=Un(n))&&(w.data=v))),(v=Ln?function(e,t){switch(e){case"compositionend":return Un(t);case"keypress":return 32!==t.which?null:(Vn=!0,jn);case"textInput":return(e=t.data)===jn&&Vn?null:e;default:return null}}(e,n):function(e,t){if(Bn)return"compositionend"===e||!Dn&&zn(e,t)?(e=en(),Zt=Yt=Xt=null,Bn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Fn&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Wr(r,"onBeforeInput")).length&&(i=new bn("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=v))}jr(o,t)})}function Hr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Wr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Me(e,n))&&r.unshift(Hr(e,s,i)),null!=(s=Me(e,t))&&r.push(Hr(e,s,i))),e=e.return}return r}function Kr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Gr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==c&&(a=c,i?null!=(l=Me(n,s))&&o.unshift(Hr(n,l,a)):i||null!=(l=Me(n,s))&&o.push(Hr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Jr=/\r\n?/g,Qr=/\u0000|\uFFFD/g;function Xr(e){return("string"===typeof e?e:""+e).replace(Jr,"\n").replace(Qr,"")}function Yr(e,t,n){if(t=Xr(t),Xr(e)!==t&&n)throw Error(s(425))}function Zr(){}var ei=null,ti=null;function ni(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ri="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,si="function"===typeof Promise?Promise:void 0,oi="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof si?function(e){return si.resolve(null).then(e).catch(ai)}:ri;function ai(e){setTimeout(function(){throw e})}function li(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function ui(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),di="__reactFiber$"+hi,fi="__reactProps$"+hi,pi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function vi(e){var t=e[di];if(t)return t;for(var n=e.parentNode;n;){if(t=n[pi]||n[di]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=ui(e);null!==e;){if(n=e[di])return n;e=ui(e)}return t}n=(e=n).parentNode}return null}function wi(e){return!(e=e[di]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Si(e){return e[fi]||null}var ki=[],Ei=-1;function xi(e){return{current:e}}function Ci(e){0>Ei||(e.current=ki[Ei],ki[Ei]=null,Ei--)}function Ti(e,t){Ei++,ki[Ei]=e.current,e.current=t}var _i={},Ii=xi(_i),Ai=xi(!1),Ni=_i;function Oi(e,t){var n=e.type.contextTypes;if(!n)return _i;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Mi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Ri(){Ci(Ai),Ci(Ii)}function Di(e,t,n){if(Ii.current!==_i)throw Error(s(168));Ti(Ii,t),Ti(Ai,n)}function Pi(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,$(e)||"Unknown",i));return F({},n,r)}function Li(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_i,Ni=Ii.current,Ti(Ii,e),Ti(Ai,Ai.current),!0}function Fi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Pi(e,t,Ni),r.__reactInternalMemoizedMergedChildContext=e,Ci(Ai),Ci(Ii),Ti(Ii,e)):Ci(Ai),Ti(Ai,n)}var ji=null,Vi=!1,zi=!1;function Ui(e){null===ji?ji=[e]:ji.push(e)}function Bi(){if(!zi&&null!==ji){zi=!0;var e=0,t=wt;try{var n=ji;for(wt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}ji=null,Vi=!1}catch(i){throw null!==ji&&(ji=ji.slice(e+1)),Ke(Ze,Bi),i}finally{wt=t,zi=!1}}return null}var $i=[],qi=0,Hi=null,Wi=0,Ki=[],Gi=0,Ji=null,Xi=1,Yi="";function Zi(e,t){$i[qi++]=Wi,$i[qi++]=Hi,Hi=e,Wi=t}function es(e,t,n){Ki[Gi++]=Xi,Ki[Gi++]=Yi,Ki[Gi++]=Ji,Ji=e;var r=Xi;e=Yi;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Xi=1<<32-ot(t)+i|n<<i|r,Yi=s+e}else Xi=1<<s|n<<i|r,Yi=e}function ts(e){null!==e.return&&(Zi(e,1),es(e,1,0))}function ns(e){for(;e===Hi;)Hi=$i[--qi],$i[qi]=null,Wi=$i[--qi],$i[qi]=null;for(;e===Ji;)Ji=Ki[--Gi],Ki[Gi]=null,Yi=Ki[--Gi],Ki[Gi]=null,Xi=Ki[--Gi],Ki[Gi]=null}var rs=null,is=null,ss=!1,os=null;function as(e,t){var n=Rc(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function ls(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,rs=e,is=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,rs=e,is=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Ji?{id:Xi,overflow:Yi}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Rc(18,null,null,0)).stateNode=t,n.return=e,e.child=n,rs=e,is=null,!0);default:return!1}}function cs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function us(e){if(ss){var t=is;if(t){var n=t;if(!ls(e,t)){if(cs(e))throw Error(s(418));t=ci(n.nextSibling);var r=rs;t&&ls(e,t)?as(r,n):(e.flags=-4097&e.flags|2,ss=!1,rs=e)}}else{if(cs(e))throw Error(s(418));e.flags=-4097&e.flags|2,ss=!1,rs=e}}}function hs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;rs=e}function ds(e){if(e!==rs)return!1;if(!ss)return hs(e),ss=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ni(e.type,e.memoizedProps)),t&&(t=is)){if(cs(e))throw fs(),Error(s(418));for(;t;)as(e,t),t=ci(t.nextSibling)}if(hs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){is=ci(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}is=null}}else is=rs?ci(e.stateNode.nextSibling):null;return!0}function fs(){for(var e=is;e;)e=ci(e.nextSibling)}function ps(){is=rs=null,ss=!1}function ms(e){null===os?os=[e]:os.push(e)}var gs=b.ReactCurrentBatchConfig;function ys(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function vs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function ws(e){return(0,e._init)(e._payload)}function bs(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Pc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Vc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){var s=n.type;return s===E?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===M&&ws(s)===t.type)?((r=i(t,n.props)).ref=ys(e,t,n),r.return=e,r):((r=Lc(n.type,n.key,n.props,null,e.mode,r)).ref=ys(e,t,n),r.return=e,r)}function u(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Fc(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Vc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case S:return(n=Lc(t.type,t.key,t.props,null,e.mode,n)).ref=ys(e,null,t),n.return=e,n;case k:return(t=zc(t,e.mode,n)).return=e,t;case M:return d(e,(0,t._init)(t._payload),n)}if(te(t)||P(t))return(t=Fc(t,e.mode,n,null)).return=e,t;vs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case S:return n.key===i?c(e,t,n,r):null;case k:return n.key===i?u(e,t,n,r):null;case M:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||P(n))return null!==i?null:h(e,t,n,r,null);vs(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case S:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case k:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case M:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||P(r))return h(t,e=e.get(n)||null,r,i,null);vs(t,r)}return null}function m(i,s,a,l){for(var c=null,u=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=f(i,h,a[m],l);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),s=o(y,s,m),null===u?c=y:u.sibling=y,u=y,h=g}if(m===a.length)return n(i,h),ss&&Zi(i,m),c;if(null===h){for(;m<a.length;m++)null!==(h=d(i,a[m],l))&&(s=o(h,s,m),null===u?c=h:u.sibling=h,u=h);return ss&&Zi(i,m),c}for(h=r(i,h);m<a.length;m++)null!==(g=p(h,i,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===u?c=g:u.sibling=g,u=g);return e&&h.forEach(function(e){return t(i,e)}),ss&&Zi(i,m),c}function g(i,a,l,c){var u=P(l);if("function"!==typeof u)throw Error(s(150));if(null==(l=u.call(l)))throw Error(s(151));for(var h=u=null,m=a,g=a=0,y=null,v=l.next();null!==m&&!v.done;g++,v=l.next()){m.index>g?(y=m,m=null):y=m.sibling;var w=f(i,m,v.value,c);if(null===w){null===m&&(m=y);break}e&&m&&null===w.alternate&&t(i,m),a=o(w,a,g),null===h?u=w:h.sibling=w,h=w,m=y}if(v.done)return n(i,m),ss&&Zi(i,g),u;if(null===m){for(;!v.done;g++,v=l.next())null!==(v=d(i,v.value,c))&&(a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return ss&&Zi(i,g),u}for(m=r(i,m);!v.done;g++,v=l.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),a=o(v,a,g),null===h?u=v:h.sibling=v,h=v);return e&&m.forEach(function(e){return t(i,e)}),ss&&Zi(i,g),u}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===E&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case S:e:{for(var c=o.key,u=s;null!==u;){if(u.key===c){if((c=o.type)===E){if(7===u.tag){n(r,u.sibling),(s=i(u,o.props.children)).return=r,r=s;break e}}else if(u.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===M&&ws(c)===u.type){n(r,u.sibling),(s=i(u,o.props)).ref=ys(r,u,o),s.return=r,r=s;break e}n(r,u);break}t(r,u),u=u.sibling}o.type===E?((s=Fc(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Lc(o.type,o.key,o.props,null,r.mode,l)).ref=ys(r,s,o),l.return=r,r=l)}return a(r);case k:e:{for(u=o.key;null!==s;){if(s.key===u){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=zc(o,r.mode,l)).return=r,r=s}return a(r);case M:return e(r,s,(u=o._init)(o._payload),l)}if(te(o))return m(r,s,o,l);if(P(o))return g(r,s,o,l);vs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Vc(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var Ss=bs(!0),ks=bs(!1),Es=xi(null),xs=null,Cs=null,Ts=null;function _s(){Ts=Cs=xs=null}function Is(e){var t=Es.current;Ci(Es),e._currentValue=t}function As(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Os(e,t){xs=e,Ts=Cs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Sa=!0),e.firstContext=null)}function Ms(e){var t=e._currentValue;if(Ts!==e)if(e={context:e,memoizedValue:t,next:null},null===Cs){if(null===xs)throw Error(s(308));Cs=e,xs.dependencies={lanes:0,firstContext:e}}else Cs=Cs.next=e;return t}var Rs=null;function Ds(e){null===Rs?Rs=[e]:Rs.push(e)}function Ps(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ds(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ls(e,r)}function Ls(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Fs=!1;function js(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Us(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Nl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ls(e,n)}return null===(i=r.interleaved)?(t.next=t,Ds(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ls(e,n)}function Bs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}function $s(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function qs(e,t,n,r){var i=e.updateQueue;Fs=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,c=l.next;l.next=null,null===o?s=c:o.next=c,o=l;var u=e.alternate;null!==u&&((a=(u=u.updateQueue).lastBaseUpdate)!==o&&(null===a?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,u=c=l=null,a=s;;){var d=a.lane,f=a.eventTime;if((r&d)===d){null!==u&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=F({},h,d);break e;case 2:Fs=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===u?(c=u=f,l=h):u=u.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===u&&(l=h),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);jl|=o,e.lanes=o,e.memoizedState=h}}function Hs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Ws={},Ks=xi(Ws),Gs=xi(Ws),Js=xi(Ws);function Qs(e){if(e===Ws)throw Error(s(174));return e}function Xs(e,t){switch(Ti(Js,t),Ti(Gs,e),Ti(Ks,Ws),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ci(Ks),Ti(Ks,t)}function Ys(){Ci(Ks),Ci(Gs),Ci(Js)}function Zs(e){Qs(Js.current);var t=Qs(Ks.current),n=le(t,e.type);t!==n&&(Ti(Gs,e),Ti(Ks,n))}function eo(e){Gs.current===e&&(Ci(Ks),Ci(Gs))}var to=xi(0);function no(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ro=[];function io(){for(var e=0;e<ro.length;e++)ro[e]._workInProgressVersionPrimary=null;ro.length=0}var so=b.ReactCurrentDispatcher,oo=b.ReactCurrentBatchConfig,ao=0,lo=null,co=null,uo=null,ho=!1,fo=!1,po=0,mo=0;function go(){throw Error(s(321))}function yo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ar(e[n],t[n]))return!1;return!0}function vo(e,t,n,r,i,o){if(ao=o,lo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,so.current=null===e||null===e.memoizedState?ta:na,e=n(r,i),fo){o=0;do{if(fo=!1,po=0,25<=o)throw Error(s(301));o+=1,uo=co=null,t.updateQueue=null,so.current=ra,e=n(r,i)}while(fo)}if(so.current=ea,t=null!==co&&null!==co.next,ao=0,uo=co=lo=null,ho=!1,t)throw Error(s(300));return e}function wo(){var e=0!==po;return po=0,e}function bo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===uo?lo.memoizedState=uo=e:uo=uo.next=e,uo}function So(){if(null===co){var e=lo.alternate;e=null!==e?e.memoizedState:null}else e=co.next;var t=null===uo?lo.memoizedState:uo.next;if(null!==t)uo=t,co=e;else{if(null===e)throw Error(s(310));e={memoizedState:(co=e).memoizedState,baseState:co.baseState,baseQueue:co.baseQueue,queue:co.queue,next:null},null===uo?lo.memoizedState=uo=e:uo=uo.next=e}return uo}function ko(e,t){return"function"===typeof t?t(e):t}function Eo(e){var t=So(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=co,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,c=null,u=o;do{var h=u.lane;if((ao&h)===h)null!==c&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var d={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===c?(l=c=d,a=r):c=c.next=d,lo.lanes|=h,jl|=h}u=u.next}while(null!==u&&u!==o);null===c?a=r:c.next=l,ar(r,t.memoizedState)||(Sa=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,lo.lanes|=o,jl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function xo(e){var t=So(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ar(o,t.memoizedState)||(Sa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function Co(){}function To(e,t){var n=lo,r=So(),i=t(),o=!ar(r.memoizedState,i);if(o&&(r.memoizedState=i,Sa=!0),r=r.queue,jo(Ao.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==uo&&1&uo.memoizedState.tag){if(n.flags|=2048,Ro(9,Io.bind(null,n,r,i,t),void 0,null),null===Ol)throw Error(s(349));0!==(30&ao)||_o(n,t,i)}return i}function _o(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function Io(e,t,n,r){t.value=n,t.getSnapshot=r,No(t)&&Oo(e)}function Ao(e,t,n){return n(function(){No(t)&&Oo(e)})}function No(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ar(e,n)}catch(r){return!0}}function Oo(e){var t=Ls(e,1);null!==t&&ic(t,e,1,-1)}function Mo(e){var t=bo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ko,lastRenderedState:e},t.queue=e,e=e.dispatch=Qo.bind(null,lo,e),[t.memoizedState,e]}function Ro(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=lo.updateQueue)?(t={lastEffect:null,stores:null},lo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Do(){return So().memoizedState}function Po(e,t,n,r){var i=bo();lo.flags|=e,i.memoizedState=Ro(1|t,n,void 0,void 0===r?null:r)}function Lo(e,t,n,r){var i=So();r=void 0===r?null:r;var s=void 0;if(null!==co){var o=co.memoizedState;if(s=o.destroy,null!==r&&yo(r,o.deps))return void(i.memoizedState=Ro(t,n,s,r))}lo.flags|=e,i.memoizedState=Ro(1|t,n,s,r)}function Fo(e,t){return Po(8390656,8,e,t)}function jo(e,t){return Lo(2048,8,e,t)}function Vo(e,t){return Lo(4,2,e,t)}function zo(e,t){return Lo(4,4,e,t)}function Uo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Bo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Lo(4,4,Uo.bind(null,t,e),n)}function $o(){}function qo(e,t){var n=So();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&yo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ho(e,t){var n=So();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&yo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Wo(e,t,n){return 0===(21&ao)?(e.baseState&&(e.baseState=!1,Sa=!0),e.memoizedState=n):(ar(n,t)||(n=mt(),lo.lanes|=n,jl|=n,e.baseState=!0),t)}function Ko(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var r=oo.transition;oo.transition={};try{e(!1),t()}finally{wt=n,oo.transition=r}}function Go(){return So().memoizedState}function Jo(e,t,n){var r=rc(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xo(e))Yo(t,n);else if(null!==(n=Ps(e,t,n,r))){ic(n,e,r,nc()),Zo(n,t,r)}}function Qo(e,t,n){var r=rc(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xo(e))Yo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ar(a,o)){var l=t.interleaved;return null===l?(i.next=i,Ds(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(c){}null!==(n=Ps(e,t,i,r))&&(ic(n,e,r,i=nc()),Zo(n,t,r))}}function Xo(e){var t=e.alternate;return e===lo||null!==t&&t===lo}function Yo(e,t){fo=ho=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function Zo(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,vt(e,n)}}var ea={readContext:Ms,useCallback:go,useContext:go,useEffect:go,useImperativeHandle:go,useInsertionEffect:go,useLayoutEffect:go,useMemo:go,useReducer:go,useRef:go,useState:go,useDebugValue:go,useDeferredValue:go,useTransition:go,useMutableSource:go,useSyncExternalStore:go,useId:go,unstable_isNewReconciler:!1},ta={readContext:Ms,useCallback:function(e,t){return bo().memoizedState=[e,void 0===t?null:t],e},useContext:Ms,useEffect:Fo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Po(4194308,4,Uo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Po(4194308,4,e,t)},useInsertionEffect:function(e,t){return Po(4,2,e,t)},useMemo:function(e,t){var n=bo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=bo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Jo.bind(null,lo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},bo().memoizedState=e},useState:Mo,useDebugValue:$o,useDeferredValue:function(e){return bo().memoizedState=e},useTransition:function(){var e=Mo(!1),t=e[0];return e=Ko.bind(null,e[1]),bo().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=lo,i=bo();if(ss){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Ol)throw Error(s(349));0!==(30&ao)||_o(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Fo(Ao.bind(null,r,o,e),[e]),r.flags|=2048,Ro(9,Io.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=bo(),t=Ol.identifierPrefix;if(ss){var n=Yi;t=":"+t+"R"+(n=(Xi&~(1<<32-ot(Xi)-1)).toString(32)+n),0<(n=po++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=mo++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},na={readContext:Ms,useCallback:qo,useContext:Ms,useEffect:jo,useImperativeHandle:Bo,useInsertionEffect:Vo,useLayoutEffect:zo,useMemo:Ho,useReducer:Eo,useRef:Do,useState:function(){return Eo(ko)},useDebugValue:$o,useDeferredValue:function(e){return Wo(So(),co.memoizedState,e)},useTransition:function(){return[Eo(ko)[0],So().memoizedState]},useMutableSource:Co,useSyncExternalStore:To,useId:Go,unstable_isNewReconciler:!1},ra={readContext:Ms,useCallback:qo,useContext:Ms,useEffect:jo,useImperativeHandle:Bo,useInsertionEffect:Vo,useLayoutEffect:zo,useMemo:Ho,useReducer:xo,useRef:Do,useState:function(){return xo(ko)},useDebugValue:$o,useDeferredValue:function(e){var t=So();return null===co?t.memoizedState=e:Wo(t,co.memoizedState,e)},useTransition:function(){return[xo(ko)[0],So().memoizedState]},useMutableSource:Co,useSyncExternalStore:To,useId:Go,unstable_isNewReconciler:!1};function ia(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function sa(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var oa={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=nc(),i=rc(e),s=zs(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(ic(t,e,i,r),Bs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=nc(),i=rc(e),s=zs(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Us(e,s,i))&&(ic(t,e,i,r),Bs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=nc(),r=rc(e),i=zs(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Us(e,i,r))&&(ic(t,e,r,n),Bs(t,e,r))}};function aa(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!lr(n,r)||!lr(i,s))}function la(e,t,n){var r=!1,i=_i,s=t.contextType;return"object"===typeof s&&null!==s?s=Ms(s):(i=Mi(t)?Ni:Ii.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oi(e,i):_i),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=oa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function ca(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&oa.enqueueReplaceState(t,t.state,null)}function ua(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},js(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Ms(s):(s=Mi(t)?Ni:Ii.current,i.context=Oi(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(sa(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&oa.enqueueReplaceState(i,i.state,null),qs(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function ha(e,t){try{var n="",r=t;do{n+=U(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function da(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function fa(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var pa="function"===typeof WeakMap?WeakMap:Map;function ma(e,t,n){(n=zs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Wl||(Wl=!0,Kl=r),fa(0,t)},n}function ga(e,t,n){(n=zs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){fa(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){fa(0,t),"function"!==typeof r&&(null===Gl?Gl=new Set([this]):Gl.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ya(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new pa;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=_c.bind(null,e,t,n),t.then(e,e))}function va(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function wa(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zs(-1,1)).tag=2,Us(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var ba=b.ReactCurrentOwner,Sa=!1;function ka(e,t,n,r){t.child=null===e?ks(t,null,n,r):Ss(t,e.child,n,r)}function Ea(e,t,n,r,i){n=n.render;var s=t.ref;return Os(t,i),r=vo(e,t,n,r,s,i),n=wo(),null===e||Sa?(ss&&n&&ts(t),t.flags|=1,ka(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i))}function xa(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Dc(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Lc(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,Ca(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:lr)(o,r)&&e.ref===t.ref)return Wa(e,t,i)}return t.flags|=1,(e=Pc(s,r)).ref=t.ref,e.return=t,t.child=e}function Ca(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(lr(s,r)&&e.ref===t.ref){if(Sa=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Wa(e,t,i);0!==(131072&e.flags)&&(Sa=!0)}}return Ia(e,t,n,r,i)}function Ta(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ti(Pl,Dl),Dl|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ti(Pl,Dl),Dl|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ti(Pl,Dl),Dl|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ti(Pl,Dl),Dl|=r;return ka(e,t,i,n),t.child}function _a(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Ia(e,t,n,r,i){var s=Mi(n)?Ni:Ii.current;return s=Oi(t,s),Os(t,i),n=vo(e,t,n,r,s,i),r=wo(),null===e||Sa?(ss&&r&&ts(t),t.flags|=1,ka(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Wa(e,t,i))}function Aa(e,t,n,r,i){if(Mi(n)){var s=!0;Li(t)}else s=!1;if(Os(t,i),null===t.stateNode)Ha(e,t),la(t,n,r),ua(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,c=n.contextType;"object"===typeof c&&null!==c?c=Ms(c):c=Oi(t,c=Mi(n)?Ni:Ii.current);var u=n.getDerivedStateFromProps,h="function"===typeof u||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==c)&&ca(t,o,r,c),Fs=!1;var d=t.memoizedState;o.state=d,qs(t,r,o,i),l=t.memoizedState,a!==r||d!==l||Ai.current||Fs?("function"===typeof u&&(sa(t,n,u,r),l=t.memoizedState),(a=Fs||aa(t,n,a,r,d,l,c))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Vs(e,t),a=t.memoizedProps,c=t.type===t.elementType?a:ia(t.type,a),o.props=c,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ms(l):l=Oi(t,l=Mi(n)?Ni:Ii.current);var f=n.getDerivedStateFromProps;(u="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&ca(t,o,r,l),Fs=!1,d=t.memoizedState,o.state=d,qs(t,r,o,i);var p=t.memoizedState;a!==h||d!==p||Ai.current||Fs?("function"===typeof f&&(sa(t,n,f,r),p=t.memoizedState),(c=Fs||aa(t,n,c,r,d,p,l)||!1)?(u||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=c):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Na(e,t,n,r,s,i)}function Na(e,t,n,r,i,s){_a(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Fi(t,n,!1),Wa(e,t,s);r=t.stateNode,ba.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ss(t,e.child,null,s),t.child=Ss(t,null,a,s)):ka(e,t,a,s),t.memoizedState=r.state,i&&Fi(t,n,!0),t.child}function Oa(e){var t=e.stateNode;t.pendingContext?Di(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Di(0,t.context,!1),Xs(e,t.containerInfo)}function Ma(e,t,n,r,i){return ps(),ms(i),t.flags|=256,ka(e,t,n,r),t.child}var Ra,Da,Pa,La,Fa={dehydrated:null,treeContext:null,retryLane:0};function ja(e){return{baseLanes:e,cachePool:null,transitions:null}}function Va(e,t,n){var r,i=t.pendingProps,o=to.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ti(to,1&o),null===e)return us(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=jc(l,i,0,null),e=Fc(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ja(n),t.memoizedState=Fa,e):za(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ua(e,t,a,r=da(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=jc({mode:"visible",children:r.children},i,0,null),(o=Fc(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Ss(t,e.child,null,a),t.child.memoizedState=ja(a),t.memoizedState=Fa,o);if(0===(1&t.mode))return Ua(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Ua(e,t,a,r=da(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),Sa||l){if(null!==(r=Ol)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Ls(e,i),ic(r,e,i,-1))}return yc(),Ua(e,t,a,r=da(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Ac.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,is=ci(i.nextSibling),rs=t,ss=!0,os=null,null!==e&&(Ki[Gi++]=Xi,Ki[Gi++]=Yi,Ki[Gi++]=Ji,Xi=e.id,Yi=e.overflow,Ji=t),t=za(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Pc(o,c)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Pc(r,a):(a=Fc(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?ja(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Fa,i}return e=(a=e.child).sibling,i=Pc(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function za(e,t){return(t=jc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ua(e,t,n,r){return null!==r&&ms(r),Ss(t,e.child,null,n),(e=za(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Ba(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),As(e.return,t,n)}function $a(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function qa(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(ka(e,t,r.children,n),0!==(2&(r=to.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Ba(e,n,t);else if(19===e.tag)Ba(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ti(to,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===no(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),$a(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===no(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}$a(t,!0,n,null,s);break;case"together":$a(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ha(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wa(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),jl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Pc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Pc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ka(e,t){if(!ss)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Ga(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ja(e,t,n){var r=t.pendingProps;switch(ns(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ga(t),null;case 1:case 17:return Mi(t.type)&&Ri(),Ga(t),null;case 3:return r=t.stateNode,Ys(),Ci(Ai),Ci(Ii),io(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ds(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==os&&(lc(os),os=null))),Da(e,t),Ga(t),null;case 5:eo(t);var i=Qs(Js.current);if(n=t.type,null!==e&&null!=t.stateNode)Pa(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Ga(t),null}if(e=Qs(Ks.current),ds(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[di]=t,r[fi]=o,e=0!==(1&t.mode),n){case"dialog":Vr("cancel",r),Vr("close",r);break;case"iframe":case"object":case"embed":Vr("load",r);break;case"video":case"audio":for(i=0;i<Pr.length;i++)Vr(Pr[i],r);break;case"source":Vr("error",r);break;case"img":case"image":case"link":Vr("error",r),Vr("load",r);break;case"details":Vr("toggle",r);break;case"input":Q(r,o),Vr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Vr("invalid",r);break;case"textarea":ie(r,o),Vr("invalid",r)}for(var l in ve(n,o),i=null,o)if(o.hasOwnProperty(l)){var c=o[l];"children"===l?"string"===typeof c?r.textContent!==c&&(!0!==o.suppressHydrationWarning&&Yr(r.textContent,c,e),i=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(!0!==o.suppressHydrationWarning&&Yr(r.textContent,c,e),i=["children",""+c]):a.hasOwnProperty(l)&&null!=c&&"onScroll"===l&&Vr("scroll",r)}switch(n){case"input":W(r),Z(r,o,!0);break;case"textarea":W(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=Zr)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[di]=t,e[fi]=r,Ra(e,t,!1,!1),t.stateNode=e;e:{switch(l=we(n,r),n){case"dialog":Vr("cancel",e),Vr("close",e),i=r;break;case"iframe":case"object":case"embed":Vr("load",e),i=r;break;case"video":case"audio":for(i=0;i<Pr.length;i++)Vr(Pr[i],e);i=r;break;case"source":Vr("error",e),i=r;break;case"img":case"image":case"link":Vr("error",e),Vr("load",e),i=r;break;case"details":Vr("toggle",e),i=r;break;case"input":Q(e,r),i=J(e,r),Vr("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Vr("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Vr("invalid",e)}for(o in ve(n,i),c=i)if(c.hasOwnProperty(o)){var u=c[o];"style"===o?ge(e,u):"dangerouslySetInnerHTML"===o?null!=(u=u?u.__html:void 0)&&he(e,u):"children"===o?"string"===typeof u?("textarea"!==n||""!==u)&&de(e,u):"number"===typeof u&&de(e,""+u):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=u&&"onScroll"===o&&Vr("scroll",e):null!=u&&w(e,o,u,l))}switch(n){case"input":W(e),Z(e,r,!1);break;case"textarea":W(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+q(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Zr)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Ga(t),null;case 6:if(e&&null!=t.stateNode)La(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Qs(Js.current),Qs(Ks.current),ds(t)){if(r=t.stateNode,n=t.memoizedProps,r[di]=t,(o=r.nodeValue!==n)&&null!==(e=rs))switch(e.tag){case 3:Yr(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Yr(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[di]=t,t.stateNode=r}return Ga(t),null;case 13:if(Ci(to),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(ss&&null!==is&&0!==(1&t.mode)&&0===(128&t.flags))fs(),ps(),t.flags|=98560,o=!1;else if(o=ds(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[di]=t}else ps(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Ga(t),o=!1}else null!==os&&(lc(os),os=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&to.current)?0===Ll&&(Ll=3):yc())),null!==t.updateQueue&&(t.flags|=4),Ga(t),null);case 4:return Ys(),Da(e,t),null===e&&Br(t.stateNode.containerInfo),Ga(t),null;case 10:return Is(t.type._context),Ga(t),null;case 19:if(Ci(to),null===(o=t.memoizedState))return Ga(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Ka(o,!1);else{if(0!==Ll||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=no(e))){for(t.flags|=128,Ka(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ti(to,1&to.current|2),t.child}e=e.sibling}null!==o.tail&&Xe()>ql&&(t.flags|=128,r=!0,Ka(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=no(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Ka(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!ss)return Ga(t),null}else 2*Xe()-o.renderingStartTime>ql&&1073741824!==n&&(t.flags|=128,r=!0,Ka(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Xe(),t.sibling=null,n=to.current,Ti(to,r?1&n|2:1&n),t):(Ga(t),null);case 22:case 23:return fc(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Dl)&&(Ga(t),6&t.subtreeFlags&&(t.flags|=8192)):Ga(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Qa(e,t){switch(ns(t),t.tag){case 1:return Mi(t.type)&&Ri(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Ys(),Ci(Ai),Ci(Ii),io(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return eo(t),null;case 13:if(Ci(to),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));ps()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ci(to),null;case 4:return Ys(),null;case 10:return Is(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Ra=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Da=function(){},Pa=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Qs(Ks.current);var s,o=null;switch(n){case"input":i=J(e,i),r=J(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=Zr)}for(u in ve(n,r),n=null,i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&null!=i[u])if("style"===u){var l=i[u];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(a.hasOwnProperty(u)?o||(o=[]):(o=o||[]).push(u,null));for(u in r){var c=r[u];if(l=null!=i?i[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(null!=c||null!=l))if("style"===u)if(l){for(s in l)!l.hasOwnProperty(s)||c&&c.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in c)c.hasOwnProperty(s)&&l[s]!==c[s]&&(n||(n={}),n[s]=c[s])}else n||(o||(o=[]),o.push(u,n)),n=c;else"dangerouslySetInnerHTML"===u?(c=c?c.__html:void 0,l=l?l.__html:void 0,null!=c&&l!==c&&(o=o||[]).push(u,c)):"children"===u?"string"!==typeof c&&"number"!==typeof c||(o=o||[]).push(u,""+c):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(a.hasOwnProperty(u)?(null!=c&&"onScroll"===u&&Vr("scroll",e),o||l===c||(o=[])):(o=o||[]).push(u,c))}n&&(o=o||[]).push("style",n);var u=o;(t.updateQueue=u)&&(t.flags|=4)}},La=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xa=!1,Ya=!1,Za="function"===typeof WeakSet?WeakSet:Set,el=null;function tl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Tc(e,t,r)}else n.current=null}function nl(e,t,n){try{n()}catch(r){Tc(e,t,r)}}var rl=!1;function il(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&nl(t,n,s)}i=i.next}while(i!==r)}}function sl(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ol(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function al(e){var t=e.alternate;null!==t&&(e.alternate=null,al(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[di],delete t[fi],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ll(e){return 5===e.tag||3===e.tag||4===e.tag}function cl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ll(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function ul(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Zr));else if(4!==r&&null!==(e=e.child))for(ul(e,t,n),e=e.sibling;null!==e;)ul(e,t,n),e=e.sibling}function hl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(hl(e,t,n),e=e.sibling;null!==e;)hl(e,t,n),e=e.sibling}var dl=null,fl=!1;function pl(e,t,n){for(n=n.child;null!==n;)ml(e,t,n),n=n.sibling}function ml(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Ya||tl(n,t);case 6:var r=dl,i=fl;dl=null,pl(e,t,n),fl=i,null!==(dl=r)&&(fl?(e=dl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):dl.removeChild(n.stateNode));break;case 18:null!==dl&&(fl?(e=dl,n=n.stateNode,8===e.nodeType?li(e.parentNode,n):1===e.nodeType&&li(e,n),Bt(e)):li(dl,n.stateNode));break;case 4:r=dl,i=fl,dl=n.stateNode.containerInfo,fl=!0,pl(e,t,n),dl=r,fl=i;break;case 0:case 11:case 14:case 15:if(!Ya&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&nl(n,t,o),i=i.next}while(i!==r)}pl(e,t,n);break;case 1:if(!Ya&&(tl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Tc(n,t,a)}pl(e,t,n);break;case 21:pl(e,t,n);break;case 22:1&n.mode?(Ya=(r=Ya)||null!==n.memoizedState,pl(e,t,n),Ya=r):pl(e,t,n);break;default:pl(e,t,n)}}function gl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Za),t.forEach(function(t){var r=Nc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))})}}function yl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:dl=l.stateNode,fl=!1;break e;case 3:case 4:dl=l.stateNode.containerInfo,fl=!0;break e}l=l.return}if(null===dl)throw Error(s(160));ml(o,a,i),dl=null,fl=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(u){Tc(i,t,u)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)vl(t,e),t=t.sibling}function vl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yl(t,e),wl(e),4&r){try{il(3,e,e.return),sl(3,e)}catch(g){Tc(e,e.return,g)}try{il(5,e,e.return)}catch(g){Tc(e,e.return,g)}}break;case 1:yl(t,e),wl(e),512&r&&null!==n&&tl(n,n.return);break;case 5:if(yl(t,e),wl(e),512&r&&null!==n&&tl(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Tc(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===l&&"radio"===o.type&&null!=o.name&&X(i,o),we(l,a);var u=we(l,o);for(a=0;a<c.length;a+=2){var h=c[a],d=c[a+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):w(i,h,d,u)}switch(l){case"input":Y(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[fi]=o}catch(g){Tc(e,e.return,g)}}break;case 6:if(yl(t,e),wl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Tc(e,e.return,g)}}break;case 3:if(yl(t,e),wl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Tc(e,e.return,g)}break;case 4:default:yl(t,e),wl(e);break;case 13:yl(t,e),wl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||($l=Xe())),4&r&&gl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Ya=(u=Ya)||h,yl(t,e),Ya=u):yl(t,e),wl(e),8192&r){if(u=null!==e.memoizedState,(e.stateNode.isHidden=u)&&!h&&0!==(1&e.mode))for(el=e,h=e.child;null!==h;){for(d=el=h;null!==el;){switch(p=(f=el).child,f.tag){case 0:case 11:case 14:case 15:il(4,f,f.return);break;case 1:tl(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Tc(r,n,g)}}break;case 5:tl(f,f.return);break;case 22:if(null!==f.memoizedState){El(d);continue}}null!==p?(p.return=f,el=p):El(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,u?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(c=d.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,l.style.display=me("display",a))}catch(g){Tc(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=u?"":d.memoizedProps}catch(g){Tc(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:yl(t,e),wl(e),4&r&&gl(e);case 21:}}function wl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ll(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),hl(e,cl(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;ul(e,cl(e),o);break;default:throw Error(s(161))}}catch(Ns){Tc(e,e.return,Ns)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function bl(e,t,n){el=e,Sl(e,t,n)}function Sl(e,t,n){for(var r=0!==(1&e.mode);null!==el;){var i=el,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Xa;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Ya;a=Xa;var c=Ya;if(Xa=o,(Ya=l)&&!c)for(el=i;null!==el;)l=(o=el).child,22===o.tag&&null!==o.memoizedState?xl(i):null!==l?(l.return=o,el=l):xl(i);for(;null!==s;)el=s,Sl(s,t,n),s=s.sibling;el=i,Xa=a,Ya=c}kl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,el=s):kl(e)}}function kl(e){for(;null!==el;){var t=el;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ya||sl(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Ya)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:ia(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Hs(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Hs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var u=t.alternate;if(null!==u){var h=u.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Bt(d)}}}break;default:throw Error(s(163))}Ya||512&t.flags&&ol(t)}catch(f){Tc(t,t.return,f)}}if(t===e){el=null;break}if(null!==(n=t.sibling)){n.return=t.return,el=n;break}el=t.return}}function El(e){for(;null!==el;){var t=el;if(t===e){el=null;break}var n=t.sibling;if(null!==n){n.return=t.return,el=n;break}el=t.return}}function xl(e){for(;null!==el;){var t=el;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{sl(4,t)}catch(Ns){Tc(t,n,Ns)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(Ns){Tc(t,i,Ns)}}var s=t.return;try{ol(t)}catch(Ns){Tc(t,s,Ns)}break;case 5:var o=t.return;try{ol(t)}catch(Ns){Tc(t,o,Ns)}}}catch(Ns){Tc(t,t.return,Ns)}if(t===e){el=null;break}var a=t.sibling;if(null!==a){a.return=t.return,el=a;break}el=t.return}}var Cl,Tl=Math.ceil,_l=b.ReactCurrentDispatcher,Il=b.ReactCurrentOwner,Al=b.ReactCurrentBatchConfig,Nl=0,Ol=null,Ml=null,Rl=0,Dl=0,Pl=xi(0),Ll=0,Fl=null,jl=0,Vl=0,zl=0,Ul=null,Bl=null,$l=0,ql=1/0,Hl=null,Wl=!1,Kl=null,Gl=null,Jl=!1,Ql=null,Xl=0,Yl=0,Zl=null,ec=-1,tc=0;function nc(){return 0!==(6&Nl)?Xe():-1!==ec?ec:ec=Xe()}function rc(e){return 0===(1&e.mode)?1:0!==(2&Nl)&&0!==Rl?Rl&-Rl:null!==gs.transition?(0===tc&&(tc=mt()),tc):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Qt(e.type)}function ic(e,t,n,r){if(50<Yl)throw Yl=0,Zl=null,Error(s(185));yt(e,n,r),0!==(2&Nl)&&e===Ol||(e===Ol&&(0===(2&Nl)&&(Vl|=n),4===Ll&&cc(e,Rl)),sc(e,r),1===n&&0===Nl&&0===(1&t.mode)&&(ql=Xe()+500,Vi&&Bi()))}function sc(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=dt(e,e===Ol?Rl:0);if(0===r)null!==n&&Ge(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&Ge(n),1===t)0===e.tag?function(e){Vi=!0,Ui(e)}(uc.bind(null,e)):Ui(uc.bind(null,e)),oi(function(){0===(6&Nl)&&Bi()}),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Oc(n,oc.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function oc(e,t){if(ec=-1,tc=0,0!==(6&Nl))throw Error(s(327));var n=e.callbackNode;if(xc()&&e.callbackNode!==n)return null;var r=dt(e,e===Ol?Rl:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=vc(e,r);else{t=r;var i=Nl;Nl|=2;var o=gc();for(Ol===e&&Rl===t||(Hl=null,ql=Xe()+500,pc(e,t));;)try{bc();break}catch(l){mc(e,l)}_s(),_l.current=o,Nl=i,null!==Ml?t=0:(Ol=null,Rl=0,t=Ll)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=ac(e,i))),1===t)throw n=Fl,pc(e,0),cc(e,r),sc(e,Xe()),n;if(6===t)cc(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ar(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=vc(e,r))&&(0!==(o=pt(e))&&(r=o,t=ac(e,o))),1===t))throw n=Fl,pc(e,0),cc(e,r),sc(e,Xe()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Ec(e,Bl,Hl);break;case 3:if(cc(e,r),(130023424&r)===r&&10<(t=$l+500-Xe())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){nc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ri(Ec.bind(null,e,Bl,Hl),t);break}Ec(e,Bl,Hl);break;case 4:if(cc(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Xe()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Tl(r/1960))-r)){e.timeoutHandle=ri(Ec.bind(null,e,Bl,Hl),r);break}Ec(e,Bl,Hl);break;default:throw Error(s(329))}}}return sc(e,Xe()),e.callbackNode===n?oc.bind(null,e):null}function ac(e,t){var n=Ul;return e.current.memoizedState.isDehydrated&&(pc(e,t).flags|=256),2!==(e=vc(e,t))&&(t=Bl,Bl=n,null!==t&&lc(t)),e}function lc(e){null===Bl?Bl=e:Bl.push.apply(Bl,e)}function cc(e,t){for(t&=~zl,t&=~Vl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function uc(e){if(0!==(6&Nl))throw Error(s(327));xc();var t=dt(e,0);if(0===(1&t))return sc(e,Xe()),null;var n=vc(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=ac(e,r))}if(1===n)throw n=Fl,pc(e,0),cc(e,t),sc(e,Xe()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ec(e,Bl,Hl),sc(e,Xe()),null}function hc(e,t){var n=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=n)&&(ql=Xe()+500,Vi&&Bi())}}function dc(e){null!==Ql&&0===Ql.tag&&0===(6&Nl)&&xc();var t=Nl;Nl|=1;var n=Al.transition,r=wt;try{if(Al.transition=null,wt=1,e)return e()}finally{wt=r,Al.transition=n,0===(6&(Nl=t))&&Bi()}}function fc(){Dl=Pl.current,Ci(Pl)}function pc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ii(n)),null!==Ml)for(n=Ml.return;null!==n;){var r=n;switch(ns(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Ri();break;case 3:Ys(),Ci(Ai),Ci(Ii),io();break;case 5:eo(r);break;case 4:Ys();break;case 13:case 19:Ci(to);break;case 10:Is(r.type._context);break;case 22:case 23:fc()}n=n.return}if(Ol=e,Ml=e=Pc(e.current,null),Rl=Dl=t,Ll=0,Fl=null,zl=Vl=jl=0,Bl=Ul=null,null!==Rs){for(t=0;t<Rs.length;t++)if(null!==(r=(n=Rs[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Rs=null}return e}function mc(e,t){for(;;){var n=Ml;try{if(_s(),so.current=ea,ho){for(var r=lo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ho=!1}if(ao=0,uo=co=lo=null,fo=!1,po=0,Il.current=null,null===n||null===n.return){Ll=1,Fl=t,Ml=null;break}e:{var o=e,a=n.return,l=n,c=t;if(t=Rl,l.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=va(a);if(null!==p){p.flags&=-257,wa(p,a,l,0,t),1&p.mode&&ya(o,u,t),c=u;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){ya(o,u,t),yc();break e}c=Error(s(426))}else if(ss&&1&l.mode){var y=va(a);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),wa(y,a,l,0,t),ms(ha(c,l));break e}}o=c=ha(c,l),4!==Ll&&(Ll=2),null===Ul?Ul=[o]:Ul.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,$s(o,ma(0,c,t));break e;case 1:l=c;var v=o.type,w=o.stateNode;if(0===(128&o.flags)&&("function"===typeof v.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Gl||!Gl.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t,$s(o,ga(o,l,t));break e}}o=o.return}while(null!==o)}kc(n)}catch(b){t=b,Ml===n&&null!==n&&(Ml=n=n.return);continue}break}}function gc(){var e=_l.current;return _l.current=ea,null===e?ea:e}function yc(){0!==Ll&&3!==Ll&&2!==Ll||(Ll=4),null===Ol||0===(268435455&jl)&&0===(268435455&Vl)||cc(Ol,Rl)}function vc(e,t){var n=Nl;Nl|=2;var r=gc();for(Ol===e&&Rl===t||(Hl=null,pc(e,t));;)try{wc();break}catch(i){mc(e,i)}if(_s(),Nl=n,_l.current=r,null!==Ml)throw Error(s(261));return Ol=null,Rl=0,Ll}function wc(){for(;null!==Ml;)Sc(Ml)}function bc(){for(;null!==Ml&&!Je();)Sc(Ml)}function Sc(e){var t=Cl(e.alternate,e,Dl);e.memoizedProps=e.pendingProps,null===t?kc(e):Ml=t,Il.current=null}function kc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ja(n,t,Dl)))return void(Ml=n)}else{if(null!==(n=Qa(n,t)))return n.flags&=32767,void(Ml=n);if(null===e)return Ll=6,void(Ml=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ml=t);Ml=t=e}while(null!==t);0===Ll&&(Ll=5)}function Ec(e,t,n){var r=wt,i=Al.transition;try{Al.transition=null,wt=1,function(e,t,n,r){do{xc()}while(null!==Ql);if(0!==(6&Nl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Ol&&(Ml=Ol=null,Rl=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Jl||(Jl=!0,Oc(tt,function(){return xc(),null})),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Al.transition,Al.transition=null;var a=wt;wt=1;var l=Nl;Nl|=4,Il.current=null,function(e,t){if(ei=qt,fr(e=dr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(Qi){n=null;break e}var a=0,l=-1,c=-1,u=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==r&&3!==d.nodeType||(c=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++u===i&&(l=a),f===o&&++h===r&&(c=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===c?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ti={focusedElem:e,selectionRange:n},qt=!1,el=t;null!==el;)if(e=(t=el).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,el=e;else for(;null!==el;){t=el;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,w=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:ia(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(Qi){Tc(t,t.return,Qi)}if(null!==(e=t.sibling)){e.return=t.return,el=e;break}el=t.return}m=rl,rl=!1}(e,n),vl(n,e),pr(ti),qt=!!ei,ti=ei=null,e.current=n,bl(n,e,i),Qe(),Nl=l,wt=a,Al.transition=o}else e.current=n;if(Jl&&(Jl=!1,Ql=e,Xl=i),o=e.pendingLanes,0===o&&(Gl=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),sc(e,Xe()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Wl)throw Wl=!1,e=Kl,Kl=null,e;0!==(1&Xl)&&0!==e.tag&&xc(),o=e.pendingLanes,0!==(1&o)?e===Zl?Yl++:(Yl=0,Zl=e):Yl=0,Bi()}(e,t,n,r)}finally{Al.transition=i,wt=r}return null}function xc(){if(null!==Ql){var e=bt(Xl),t=Al.transition,n=wt;try{if(Al.transition=null,wt=16>e?16:e,null===Ql)var r=!1;else{if(e=Ql,Ql=null,Xl=0,0!==(6&Nl))throw Error(s(331));var i=Nl;for(Nl|=4,el=e.current;null!==el;){var o=el,a=o.child;if(0!==(16&el.flags)){var l=o.deletions;if(null!==l){for(var c=0;c<l.length;c++){var u=l[c];for(el=u;null!==el;){var h=el;switch(h.tag){case 0:case 11:case 15:il(8,h,o)}var d=h.child;if(null!==d)d.return=h,el=d;else for(;null!==el;){var f=(h=el).sibling,p=h.return;if(al(h),h===u){el=null;break}if(null!==f){f.return=p,el=f;break}el=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}el=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,el=a;else e:for(;null!==el;){if(0!==(2048&(o=el).flags))switch(o.tag){case 0:case 11:case 15:il(9,o,o.return)}var v=o.sibling;if(null!==v){v.return=o.return,el=v;break e}el=o.return}}var w=e.current;for(el=w;null!==el;){var b=(a=el).child;if(0!==(2064&a.subtreeFlags)&&null!==b)b.return=a,el=b;else e:for(a=w;null!==el;){if(0!==(2048&(l=el).flags))try{switch(l.tag){case 0:case 11:case 15:sl(9,l)}}catch(k){Tc(l,l.return,k)}if(l===a){el=null;break e}var S=l.sibling;if(null!==S){S.return=l.return,el=S;break e}el=l.return}}if(Nl=i,Bi(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(k){}r=!0}return r}finally{wt=n,Al.transition=t}}return!1}function Cc(e,t,n){e=Us(e,t=ma(0,t=ha(n,t),1),1),t=nc(),null!==e&&(yt(e,1,t),sc(e,t))}function Tc(e,t,n){if(3===e.tag)Cc(e,e,n);else for(;null!==t;){if(3===t.tag){Cc(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Gl||!Gl.has(r))){t=Us(t,e=ga(t,e=ha(n,e),1),1),e=nc(),null!==t&&(yt(t,1,e),sc(t,e));break}}t=t.return}}function _c(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=nc(),e.pingedLanes|=e.suspendedLanes&n,Ol===e&&(Rl&n)===n&&(4===Ll||3===Ll&&(130023424&Rl)===Rl&&500>Xe()-$l?pc(e,0):zl|=n),sc(e,t)}function Ic(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ut,0===(130023424&(ut<<=1))&&(ut=4194304)));var n=nc();null!==(e=Ls(e,t))&&(yt(e,t,n),sc(e,n))}function Ac(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ic(e,n)}function Nc(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Ic(e,n)}function Oc(e,t){return Ke(e,t)}function Mc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Rc(e,t,n,r){return new Mc(e,t,n,r)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Pc(e,t){var n=e.alternate;return null===n?((n=Rc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Lc(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Dc(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case E:return Fc(n.children,i,o,t);case x:a=8,i|=8;break;case C:return(e=Rc(12,n,t,2|i)).elementType=C,e.lanes=o,e;case A:return(e=Rc(13,n,t,i)).elementType=A,e.lanes=o,e;case N:return(e=Rc(19,n,t,i)).elementType=N,e.lanes=o,e;case R:return jc(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case T:a=10;break e;case _:a=9;break e;case I:a=11;break e;case O:a=14;break e;case M:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Rc(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Fc(e,t,n,r){return(e=Rc(7,e,r,t)).lanes=n,e}function jc(e,t,n,r){return(e=Rc(22,e,r,t)).elementType=R,e.lanes=n,e.stateNode={isHidden:!1},e}function Vc(e,t,n){return(e=Rc(6,e,null,t)).lanes=n,e}function zc(e,t,n){return(t=Rc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Uc(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Bc(e,t,n,r,i,s,o,a,l){return e=new Uc(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Rc(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},js(s),e}function $c(e){if(!e)return _i;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Mi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Mi(n))return Pi(e,n,t)}return t}function qc(e,t,n,r,i,s,o,a,l){return(e=Bc(n,r,!0,e,0,s,0,a,l)).context=$c(null),n=e.current,(s=zs(r=nc(),i=rc(n))).callback=void 0!==t&&null!==t?t:null,Us(n,s,i),e.current.lanes=i,yt(e,i,r),sc(e,r),e}function Hc(e,t,n,r){var i=t.current,s=nc(),o=rc(i);return n=$c(n),null===t.context?t.context=n:t.pendingContext=n,(t=zs(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Us(i,t,o))&&(ic(e,i,o,s),Bs(e,i,o)),o}function Wc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Kc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Gc(e,t){Kc(e,t),(e=e.alternate)&&Kc(e,t)}Cl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ai.current)Sa=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Sa=!1,function(e,t,n){switch(t.tag){case 3:Oa(t),ps();break;case 5:Zs(t);break;case 1:Mi(t.type)&&Li(t);break;case 4:Xs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ti(Es,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ti(to,1&to.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Va(e,t,n):(Ti(to,1&to.current),null!==(e=Wa(e,t,n))?e.sibling:null);Ti(to,1&to.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return qa(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ti(to,to.current),r)break;return null;case 22:case 23:return t.lanes=0,Ta(e,t,n)}return Wa(e,t,n)}(e,t,n);Sa=0!==(131072&e.flags)}else Sa=!1,ss&&0!==(1048576&t.flags)&&es(t,Wi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ha(e,t),e=t.pendingProps;var i=Oi(t,Ii.current);Os(t,n),i=vo(null,t,r,e,i,n);var o=wo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Mi(r)?(o=!0,Li(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,js(t),i.updater=oa,t.stateNode=i,i._reactInternals=t,ua(t,r,e,n),t=Na(null,t,r,!0,o,n)):(t.tag=0,ss&&o&&ts(t),ka(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ha(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===I)return 11;if(e===O)return 14}return 2}(r),e=ia(r,e),i){case 0:t=Ia(null,t,r,e,n);break e;case 1:t=Aa(null,t,r,e,n);break e;case 11:t=Ea(null,t,r,e,n);break e;case 14:t=xa(null,t,r,ia(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ia(e,t,r,i=t.elementType===r?i:ia(r,i),n);case 1:return r=t.type,i=t.pendingProps,Aa(e,t,r,i=t.elementType===r?i:ia(r,i),n);case 3:e:{if(Oa(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Vs(e,t),qs(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Ma(e,t,r,n,i=ha(Error(s(423)),t));break e}if(r!==i){t=Ma(e,t,r,n,i=ha(Error(s(424)),t));break e}for(is=ci(t.stateNode.containerInfo.firstChild),rs=t,ss=!0,os=null,n=ks(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(ps(),r===i){t=Wa(e,t,n);break e}ka(e,t,r,n)}t=t.child}return t;case 5:return Zs(t),null===e&&us(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,ni(r,i)?a=null:null!==o&&ni(r,o)&&(t.flags|=32),_a(e,t),ka(e,t,a,n),t.child;case 6:return null===e&&us(t),null;case 13:return Va(e,t,n);case 4:return Xs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ss(t,null,r,n):ka(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ea(e,t,r,i=t.elementType===r?i:ia(r,i),n);case 7:return ka(e,t,t.pendingProps,n),t.child;case 8:case 12:return ka(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Ti(Es,r._currentValue),r._currentValue=a,null!==o)if(ar(o.value,a)){if(o.children===i.children&&!Ai.current){t=Wa(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var c=l.firstContext;null!==c;){if(c.context===r){if(1===o.tag){(c=zs(-1,n&-n)).tag=2;var u=o.updateQueue;if(null!==u){var h=(u=u.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),As(o.return,n,t),l.lanes|=n;break}c=c.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),As(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}ka(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Os(t,n),r=r(i=Ms(i)),t.flags|=1,ka(e,t,r,n),t.child;case 14:return i=ia(r=t.type,t.pendingProps),xa(e,t,r,i=ia(r.type,i),n);case 15:return Ca(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:ia(r,i),Ha(e,t),t.tag=1,Mi(r)?(e=!0,Li(t)):e=!1,Os(t,n),la(t,r,i),ua(t,r,i,n),Na(null,t,r,!0,e,n);case 19:return qa(e,t,n);case 22:return Ta(e,t,n)}throw Error(s(156,t.tag))};var Jc="function"===typeof reportError?reportError:function(e){console.error(e)};function Qc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Zc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function eu(){}function tu(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=Wc(o);a.call(e)}}Hc(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Wc(o);s.call(e)}}var o=qc(t,r,e,0,null,!1,0,"",eu);return e._reactRootContainer=o,e[pi]=o.current,Br(8===e.nodeType?e.parentNode:e),dc(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Wc(l);a.call(e)}}var l=Bc(e,0,!1,null,0,!1,0,"",eu);return e._reactRootContainer=l,e[pi]=l.current,Br(8===e.nodeType?e.parentNode:e),dc(function(){Hc(t,l,n,r)}),l}(n,t,e,i,r);return Wc(o)}Xc.prototype.render=Qc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Hc(e,t,null,null)},Xc.prototype.unmount=Qc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Hc(null,e,null,null)}),t[pi]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=xt();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Rt.length&&0!==t&&t<Rt[n].priority;n++);Rt.splice(n,0,e),0===n&&Ft(e)}},St=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(vt(t,1|n),sc(t,Xe()),0===(6&Nl)&&(ql=Xe()+500,Bi()))}break;case 13:dc(function(){var t=Ls(e,1);if(null!==t){var n=nc();ic(t,e,1,n)}}),Gc(e,1)}},kt=function(e){if(13===e.tag){var t=Ls(e,134217728);if(null!==t)ic(t,e,134217728,nc());Gc(e,134217728)}},Et=function(e){if(13===e.tag){var t=rc(e),n=Ls(e,t);if(null!==n)ic(n,e,t,nc());Gc(e,t)}},xt=function(){return wt},Ct=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},ke=function(e,t,n){switch(t){case"input":if(Y(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Si(r);if(!i)throw Error(s(90));K(r),Y(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},Ie=hc,Ae=dc;var nu={usingClientEntryPoint:!1,Events:[wi,bi,Si,Te,_e,hc]},ru={findFiberByHostInstance:vi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},iu={bundleType:ru.bundleType,version:ru.version,rendererPackageName:ru.rendererPackageName,rendererConfig:ru.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=He(e))?null:e.stateNode},findFiberByHostInstance:ru.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var su=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!su.isDisabled&&su.supportsFiber)try{it=su.inject(iu),st=su}catch(ue){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nu,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:k,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Yc(e))throw Error(s(299));var n=!1,r="",i=Jc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Bc(e,1,!1,null,0,n,0,r,i),e[pi]=t.current,Br(8===e.nodeType?e.parentNode:e),new Qc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=He(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,n){if(!Zc(t))throw Error(s(200));return tu(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Yc(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Jc;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=qc(t,null,e,1,null!=n?n:null,i,0,o,a),e[pi]=t.current,Br(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Xc(t)},t.render=function(e,t,n){if(!Zc(t))throw Error(s(200));return tu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Zc(e))throw Error(s(40));return!!e._reactRootContainer&&(dc(function(){tu(null,null,e,!1,function(){e._reactRootContainer=null,e[pi]=null})}),!0)},t.unstable_batchedUpdates=hc,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Zc(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return tu(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,n)=>{e.exports=n(234)},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};n.r(r),n.d(r,{hasBrowserEnv:()=>LI,hasStandardBrowserEnv:()=>jI,hasStandardBrowserWebWorkerEnv:()=>VI,navigator:()=>FI,origin:()=>zI});var i=n(43),s=n(391);const o=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},a={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,c=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[c],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(o(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new l;const c=t<<2|s>>4;if(r.push(c),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class l extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const c=function(e){return function(e){const t=o(e);return a.encodeByteArray(t,!0)}(e).replace(/\./g,"")},u=function(e){try{return a.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function h(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const d=()=>{try{return h().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_FIREBASE_API_KEY:"AIzaSyANMjeNyYyHIhkKoQkrP2LABl8MpQQ0cLo",REACT_APP_FIREBASE_AUTH_DOMAIN:"typst-editor.firebaseapp.com",REACT_APP_FIREBASE_PROJECT_ID:"typst-editor",REACT_APP_FIREBASE_STORAGE_BUCKET:"typst-editor.firebasestorage.app",REACT_APP_FIREBASE_MESSAGING_SENDER_ID:"409169817373",REACT_APP_FIREBASE_APP_ID:"1:409169817373:web:3755e9b92cfb0ac96d7bf4",REACT_APP_TYPST_SERVER_URL:""}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&u(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},f=e=>d()?.emulatorHosts?.[e],p=()=>d()?.config,m=e=>d()?.[`_${e}`];class g{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function y(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function v(e){return(await fetch(e,{credentials:"include"})).ok}const w={};let b=!1;function S(e,t){if("undefined"===typeof window||"undefined"===typeof document||!y(window.location.host)||w[e]===t||w[e]||b)return;function n(e){return`__firebase__banner__${e}`}w[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(w))w[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{b=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),o=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),l=document.getElementById(a)||document.createElement("a"),c=n("preprendIcon"),u=document.getElementById(c)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(l,a);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,c),t.append(u,o,l,n),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function k(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function E(){const e=d()?.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function x(){return!E()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C(){try{return"object"===typeof indexedDB}catch(e){return!1}}class T extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,T.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,_.prototype.create)}}class _{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(I,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(r,t):"Error",s=`${this.serviceName}: ${i} (${n}).`;return new T(n,s,t)}}const I=/\{\$([^}]+)}/g;function A(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(N(n)&&N(s)){if(!A(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function N(e){return null!==e&&"object"===typeof e}function O(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function M(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function R(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class D{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=P),void 0===r.error&&(r.error=P),void 0===r.complete&&(r.complete=P);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function P(){}function L(e){return e&&e._delegate?e._delegate:e}class F{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const j="[DEFAULT]";class V{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new g;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:j})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===j?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch{}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j;return this.component?this.component.multipleInstances?e:j:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class z{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new V(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const U=[];var B;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(B||(B={}));const $={debug:B.DEBUG,verbose:B.VERBOSE,info:B.INFO,warn:B.WARN,error:B.ERROR,silent:B.SILENT},q=B.INFO,H={[B.DEBUG]:"log",[B.VERBOSE]:"log",[B.INFO]:"info",[B.WARN]:"warn",[B.ERROR]:"error"},W=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=H[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r](`[${n}]  ${e.name}:`,...s)};class K{constructor(e){this.name=e,this._logLevel=q,this._logHandler=W,this._userLogHandler=null,U.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in B))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?$[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,B.DEBUG,...t),this._logHandler(this,B.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,B.VERBOSE,...t),this._logHandler(this,B.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,B.INFO,...t),this._logHandler(this,B.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,B.WARN,...t),this._logHandler(this,B.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,B.ERROR,...t),this._logHandler(this,B.ERROR,...t)}}let G,J;const Q=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,ee=new WeakMap;let te={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return X.get(e);if("objectStoreNames"===t)return e.objectStoreNames||Y.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ie(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function ne(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(J||(J=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(se(this),n),ie(Q.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ie(e.apply(se(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(se(this),t,...r);return Y.set(s,t.sort?t.sort():[t]),ie(s)}}function re(e){return"function"===typeof e?ne(e):(e instanceof IDBTransaction&&function(e){if(X.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});X.set(e,t)}(e),t=e,(G||(G=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,te):e);var t}function ie(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(ie(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&Q.set(t,e)}).catch(()=>{}),ee.set(t,e),t}(e);if(Z.has(e))return Z.get(e);const t=re(e);return t!==e&&(Z.set(e,t),ee.set(t,e)),t}const se=e=>ee.get(e);const oe=["get","getKey","getAll","getAllKeys","count"],ae=["put","add","delete","clear"],le=new Map;function ce(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(le.get(t))return le.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=ae.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!oe.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return le.set(t,s),s}te=(e=>({...e,get:(t,n,r)=>ce(t,n)||e.get(t,n,r),has:(t,n)=>!!ce(t,n)||e.has(t,n)}))(te);class ue{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===t?.type}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const he="@firebase/app",de="0.14.3",fe=new K("@firebase/app"),pe="@firebase/app-compat",me="@firebase/analytics-compat",ge="@firebase/analytics",ye="@firebase/app-check-compat",ve="@firebase/app-check",we="@firebase/auth",be="@firebase/auth-compat",Se="@firebase/database",ke="@firebase/data-connect",Ee="@firebase/database-compat",xe="@firebase/functions",Ce="@firebase/functions-compat",Te="@firebase/installations",_e="@firebase/installations-compat",Ie="@firebase/messaging",Ae="@firebase/messaging-compat",Ne="@firebase/performance",Oe="@firebase/performance-compat",Me="@firebase/remote-config",Re="@firebase/remote-config-compat",De="@firebase/storage",Pe="@firebase/storage-compat",Le="@firebase/firestore",Fe="@firebase/ai",je="@firebase/firestore-compat",Ve="firebase",ze="[DEFAULT]",Ue={[he]:"fire-core",[pe]:"fire-core-compat",[ge]:"fire-analytics",[me]:"fire-analytics-compat",[ve]:"fire-app-check",[ye]:"fire-app-check-compat",[we]:"fire-auth",[be]:"fire-auth-compat",[Se]:"fire-rtdb",[ke]:"fire-data-connect",[Ee]:"fire-rtdb-compat",[xe]:"fire-fn",[Ce]:"fire-fn-compat",[Te]:"fire-iid",[_e]:"fire-iid-compat",[Ie]:"fire-fcm",[Ae]:"fire-fcm-compat",[Ne]:"fire-perf",[Oe]:"fire-perf-compat",[Me]:"fire-rc",[Re]:"fire-rc-compat",[De]:"fire-gcs",[Pe]:"fire-gcs-compat",[Le]:"fire-fst",[je]:"fire-fst-compat",[Fe]:"fire-vertex","fire-js":"fire-js",[Ve]:"fire-js-all"},Be=new Map,$e=new Map,qe=new Map;function He(e,t){try{e.container.addComponent(t)}catch(n){fe.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function We(e){const t=e.name;if(qe.has(t))return fe.debug(`There were multiple attempts to register component ${t}.`),!1;qe.set(t,e);for(const n of Be.values())He(n,e);for(const n of $e.values())He(n,e);return!0}function Ke(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function Ge(e){return null!==e&&void 0!==e&&void 0!==e.settings}const Je=new _("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Qe{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new F("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Je.create("app-deleted",{appName:this._name})}}const Xe="12.3.0";function Ye(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r={name:ze,automaticDataCollectionEnabled:!0,...t},i=r.name;if("string"!==typeof i||!i)throw Je.create("bad-app-name",{appName:String(i)});if(n||(n=p()),!n)throw Je.create("no-options");const s=Be.get(i);if(s){if(A(n,s.options)&&A(r,s.config))return s;throw Je.create("duplicate-app",{appName:i})}const o=new z(i);for(const l of qe.values())o.addComponent(l);const a=new Qe(n,r,o);return Be.set(i,a),a}function Ze(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ze;const t=Be.get(e);if(!t&&e===ze&&p())return Ye();if(!t)throw Je.create("no-app",{appName:e});return t}function et(e,t,n){let r=Ue[e]??e;n&&(r+=`-${n}`);const i=r.match(/\s|\//),s=t.match(/\s|\//);if(i||s){const e=[`Unable to register library "${r}" with version "${t}":`];return i&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void fe.warn(e.join(" "))}We(new F(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const tt="firebase-heartbeat-store";let nt=null;function rt(){return nt||(nt=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=ie(o);return r&&o.addEventListener("upgradeneeded",e=>{r(ie(o.result),e.oldVersion,e.newVersion,ie(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(tt)}catch(n){console.warn(n)}}}).catch(e=>{throw Je.create("idb-open",{originalErrorMessage:e.message})})),nt}async function it(e,t){try{const n=(await rt()).transaction(tt,"readwrite"),r=n.objectStore(tt);await r.put(t,st(e)),await n.done}catch(n){if(n instanceof T)fe.warn(n.message);else{const e=Je.create("idb-set",{originalErrorMessage:n?.message});fe.warn(e.message)}}}function st(e){return`${e.name}!${e.options.appId}`}class ot{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new lt(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=at();if(null==this._heartbeatsCache?.heartbeats&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){fe.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats||0===this._heartbeatsCache.heartbeats.length)return"";const e=at(),{heartbeatsToSend:t,unsentEntries:n}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),ct(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),ct(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=c(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return fe.warn(e),""}}}function at(){return(new Date).toISOString().substring(0,10)}class lt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!C()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await rt()).transaction(tt),n=await t.objectStore(tt).get(st(e));return await t.done,n}catch(t){if(t instanceof T)fe.warn(t.message);else{const e=Je.create("idb-get",{originalErrorMessage:t?.message});fe.warn(e.message)}}}(this.app);return e?.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return it(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return it(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function ct(e){return c(JSON.stringify({version:2,heartbeats:e})).length}var ut;ut="",We(new F("platform-logger",e=>new ue(e),"PRIVATE")),We(new F("heartbeat",e=>new ot(e),"PRIVATE")),et(he,de,ut),et(he,de,"esm2020"),et("fire-js","");function ht(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const dt=ht,ft=new _("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),pt=new K("@firebase/auth");function mt(e){if(pt.logLevel<=B.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];pt.error(`Auth (${Xe}): ${e}`,...n)}}function gt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw St(e,...n)}function yt(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return St(e,...n)}function vt(e,t,n){const r={...dt(),[t]:n};return new _("auth","Firebase",r).create(t,{appName:e.name})}function wt(e){return vt(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function bt(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&gt(e,"argument-error"),vt(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function St(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return ft.create(e,...n)}function kt(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw St(t,...r)}}function Et(e){const t="INTERNAL ASSERTION FAILED: "+e;throw mt(t),new Error(t)}function xt(e,t){e||Et(t)}function Ct(){return"undefined"!==typeof self&&self.location?.href||""}function Tt(){return"http:"===_t()||"https:"===_t()}function _t(){return"undefined"!==typeof self&&self.location?.protocol||null}function It(){return!("undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(Tt()||function(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}()||"connection"in navigator))||navigator.onLine}class At{constructor(e,t){this.shortDelay=e,this.longDelay=t,xt(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(k())||"object"===typeof navigator&&"ReactNative"===navigator.product}get(){return It()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Nt(e,t){xt(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Ot{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Et("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Et("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Et("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Mt={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Rt=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Dt=new At(3e4,6e4);function Pt(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function Lt(e,t,n,r){return Ft(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=O({key:e.config.apiKey,...s}).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l={method:t,headers:a,...i};return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),e.emulatorConfig&&y(e.emulatorConfig.host)&&(l.credentials="include"),Ot.fetch()(await Vt(e,e.config.apiHost,n,o),l)})}async function Ft(e,t,n){e._canInitEmulator=!1;const r={...Mt,...t};try{const t=new Ut(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Bt(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Bt(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Bt(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Bt(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw vt(e,a,o);gt(e,a)}}catch(i){if(i instanceof T)throw i;gt(e,"network-request-failed",{message:String(i)})}}async function jt(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Lt(e,t,n,r,i);return"mfaPendingCredential"in s&&gt(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function Vt(e,t,n,r){const i=`${t}${n}?${r}`,s=e,o=s.config.emulator?Nt(e.config,i):`${e.config.apiScheme}://${i}`;if(Rt.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(o).toString()}return o}function zt(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Ut{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(yt(this.auth,"network-request-failed")),Dt.get())})}}function Bt(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=yt(e,t,r);return i.customData._tokenResponse=n,i}function $t(e){return void 0!==e&&void 0!==e.enterprise}class qt{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return zt(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Ht(e,t){return Lt(e,"GET","/v2/recaptchaConfig",Pt(e,t))}async function Wt(e,t){return Lt(e,"POST","/v1/accounts:lookup",t)}function Kt(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Gt(e){return 1e3*Number(e)}function Jt(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return mt("JWT malformed, contained fewer than 3 sections"),null;try{const e=u(n);return e?JSON.parse(e):(mt("Failed to decode base64 JWT payload"),null)}catch(i){return mt("Caught error parsing JWT payload as JSON",i?.toString()),null}}function Qt(e){const t=Jt(e);return kt(t,"internal-error"),kt("undefined"!==typeof t.exp,"internal-error"),kt("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Xt(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof T&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Yt{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&this.schedule(!0))}this.schedule()}}class Zt{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Kt(this.lastLoginAt),this.creationTime=Kt(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function en(e){const t=e.auth,n=await e.getIdToken(),r=await Xt(e,Wt(t,{idToken:n}));kt(r?.users.length,t,"internal-error");const i=r.users[0];e._notifyReloadListener(i);const s=i.providerUserInfo?.length?tn(i.providerUserInfo):[],o=(a=e.providerData,l=s,[...a.filter(e=>!l.some(t=>t.providerId===e.providerId)),...l]);var a,l;const c=e.isAnonymous,u=!(e.email&&i.passwordHash)&&!o?.length,h=!!c&&u,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new Zt(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,d)}function tn(e){return e.map(e=>{let{providerId:t,...n}=e;return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}class nn{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){kt(e.idToken,"internal-error"),kt("undefined"!==typeof e.idToken,"internal-error"),kt("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Qt(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){kt(0!==e.length,"internal-error");const t=Qt(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(kt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Ft(e,{},async()=>{const n=O({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=await Vt(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:o,body:n};return e.emulatorConfig&&y(e.emulatorConfig.host)&&(a.credentials="include"),Ot.fetch()(s,a)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new nn;return n&&(kt("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(kt("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(kt("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new nn,this.toJSON())}_performRefresh(){return Et("not implemented")}}function rn(e,t){kt("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class sn{constructor(e){let{uid:t,auth:n,stsTokenManager:r,...i}=e;this.providerId="firebase",this.proactiveRefresh=new Yt(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Zt(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Xt(this,this.stsTokenManager.getToken(this.auth,e));return kt(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=L(e),r=await n.getIdToken(t),i=Jt(r);kt(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=s?.sign_in_provider;return{claims:i,token:r,authTime:Kt(Gt(i.auth_time)),issuedAtTime:Kt(Gt(i.iat)),expirationTime:Kt(Gt(i.exp)),signInProvider:o||null,signInSecondFactor:s?.sign_in_second_factor||null}}(this,e)}reload(){return async function(e){const t=L(e);await en(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(kt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new sn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){kt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await en(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ge(this.auth.app))return Promise.reject(wt(this.auth));const e=await this.getIdToken();return await Xt(this,async function(e,t){return Lt(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,i=t.phoneNumber??void 0,s=t.photoURL??void 0,o=t.tenantId??void 0,a=t._redirectEventId??void 0,l=t.createdAt??void 0,c=t.lastLoginAt??void 0,{uid:u,emailVerified:h,isAnonymous:d,providerData:f,stsTokenManager:p}=t;kt(u&&p,e,"internal-error");const m=nn.fromJSON(this.name,p);kt("string"===typeof u,e,"internal-error"),rn(n,e.name),rn(r,e.name),kt("boolean"===typeof h,e,"internal-error"),kt("boolean"===typeof d,e,"internal-error"),rn(i,e.name),rn(s,e.name),rn(o,e.name),rn(a,e.name),rn(l,e.name),rn(c,e.name);const g=new sn({uid:u,auth:e,email:r,emailVerified:h,displayName:n,isAnonymous:d,photoURL:s,phoneNumber:i,tenantId:o,stsTokenManager:m,createdAt:l,lastLoginAt:c});return f&&Array.isArray(f)&&(g.providerData=f.map(e=>({...e}))),a&&(g._redirectEventId=a),g}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new nn;r.updateFromServerResponse(t);const i=new sn({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await en(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];kt(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?tn(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!i?.length,o=new nn;o.updateFromIdToken(n);const a=new sn({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Zt(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!i?.length};return Object.assign(a,l),a}}const on=new Map;function an(e){xt(e instanceof Function,"Expected a class definition");let t=on.get(e);return t?(xt(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,on.set(e,t),t)}class ln{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ln.type="NONE";const cn=ln;function un(e,t,n){return`firebase:${e}:${t}:${n}`}class hn{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=un(this.userKey,r.apiKey,i),this.fullPersistenceKey=un("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await Wt(this.auth,{idToken:e}).catch(()=>{});return t?sn._fromGetAccountInfoResponse(this.auth,t,e):null}return sn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new hn(an(cn),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let i=r[0]||an(cn);const s=un(n,e.config.apiKey,e.name);let o=null;for(const l of t)try{const t=await l._get(s);if(t){let n;if("string"===typeof t){const r=await Wt(e,{idToken:t}).catch(()=>{});if(!r)break;n=await sn._fromGetAccountInfoResponse(e,r,t)}else n=sn._fromJSON(e,t);l!==i&&(o=n),i=l;break}}catch{}const a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch{}})),new hn(i,e,n)):new hn(i,e,n)}}function dn(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(gn(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(fn(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(vn(t))return"Blackberry";if(wn(t))return"Webos";if(pn(t))return"Safari";if((t.includes("chrome/")||mn(t))&&!t.includes("edge/"))return"Chrome";if(yn(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===n?.length)return n[1]}return"Other"}function fn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k();return/firefox\//i.test(e)}function pn(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:k()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k();return/crios\//i.test(e)}function gn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k();return/iemobile/i.test(e)}function yn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k();return/android/i.test(e)}function vn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k();return/blackberry/i.test(e)}function wn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k();return/webos/i.test(e)}function bn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Sn(){return function(){const e=k();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function kn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k();return bn(e)||yn(e)||wn(e)||vn(e)||/windows phone/i.test(e)||gn(e)}function En(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=dn(k());break;case"Worker":t=`${dn(k())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xe}/${r}`}class xn{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(i){r(i)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}class Cn{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Tn{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new In(this),this.idTokenSubscription=new In(this),this.beforeStateQueue=new xn(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=ft,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=an(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await hn.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(n){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Wt(this,{idToken:e}),n=await sn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ge(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const t=this.redirectUser?._redirectEventId,i=n?._redirectEventId,s=await this.tryRedirectSignIn(e);t&&t!==i||!s?.user||(n=s.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(i){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(i))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return kt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await en(e)}catch(t){if("auth/network-request-failed"!==t?.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ge(this.app))return Promise.reject(wt(this));const t=e?L(e):null;return t&&kt(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&kt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ge(this.app)?Promise.reject(wt(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ge(this.app)?Promise.reject(wt(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(an(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Lt(e,"GET","/v2/passwordPolicy",Pt(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Cn(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new _("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Lt(e,"POST","/v2/accounts:revokeToken",Pt(e,t))}(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&an(e)||this._popupRedirectResolver;kt(t,this,"argument-error"),this.redirectPersistenceManager=await hn.create(this,[an(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(kt(o,this,"internal-error"),o.then(()=>{s||i(this.currentUser)}),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return kt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=En(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await(this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Ge(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken());return e?.error&&function(e){if(pt.logLevel<=B.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];pt.warn(`Auth (${Xe}): ${e}`,...n)}}(`Error while retrieving App Check token: ${e.error}`),e?.token}}function _n(e){return L(e)}class In{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new D(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return kt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let An={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Nn(e){return An.loadJS(e)}function On(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Mn{constructor(){this.enterprise=new Rn}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Rn{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Dn="NO_RECAPTCHA";class Pn{constructor(e){this.type="recaptcha-enterprise",this.auth=_n(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;$t(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Dn)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new Mn).execute("siteKey",{action:"verify"})}return new Promise((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{Ht(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new qt(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})})(this.auth).then(i=>{if(!t&&$t(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=An.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Nn(t).then(()=>{n(i,e,r)}).catch(e=>{r(e)})}}).catch(e=>{r(e)})})}}async function Ln(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];const s=new Pn(e);let o;if(i)o=Dn;else try{o=await s.verify(n)}catch(l){o=await s.verify(n,!0)}const a={...t};if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Fn(e,t,n,r,i){if("EMAIL_PASSWORD_PROVIDER"===i){if(e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ln(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch(async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Ln(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)})}if("PHONE_PROVIDER"===i){if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const i=await Ln(e,t,n);return r(e,i).catch(async i=>{if("AUDIT"===e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await Ln(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)})}{const i=await Ln(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function jn(e){const t=_n(e),n=await Ht(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new qt(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Pn(t).verify()}}function Vn(e,t,n){const r=_n(e);kt(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!n?.disableWarnings,s=zn(t),{host:o,port:a}=function(e){const t=zn(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Un(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Un(t)}}}(t),l=null===a?"":`:${a}`,c={url:`${s}//${o}${l}/`},u=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator)return kt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void kt(A(c,r.config.emulator)&&A(u,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=u,r.settings.appVerificationDisabledForTesting=!0,y(o)?(v(`${s}//${o}${l}`),S("Auth",!0)):i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function zn(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Un(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Bn{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Et("not implemented")}_getIdTokenResponse(e){return Et("not implemented")}_linkToIdToken(e,t){return Et("not implemented")}_getReauthenticationResolver(e){return Et("not implemented")}}async function $n(e,t){return Lt(e,"POST","/v1/accounts:signUp",t)}async function qn(e,t){return jt(e,"POST","/v1/accounts:signInWithPassword",Pt(e,t))}class Hn extends Bn{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Hn(e,t,"password")}static _fromEmailAndCode(e,t){return new Hn(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Fn(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",qn,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return jt(e,"POST","/v1/accounts:signInWithEmailLink",Pt(e,t))}(e,{email:this._email,oobCode:this._password});default:gt(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Fn(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",$n,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return jt(e,"POST","/v1/accounts:signInWithEmailLink",Pt(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:gt(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Wn(e,t){return jt(e,"POST","/v1/accounts:signInWithIdp",Pt(e,t))}class Kn extends Bn{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Kn(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):gt("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,...i}=t;if(!n||!r)return null;const s=new Kn(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Wn(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Wn(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Wn(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=O(t)}return e}}async function Gn(e,t){return Lt(e,"POST","/v1/accounts:sendVerificationCode",Pt(e,t))}const Jn={USER_NOT_FOUND:"user-not-found"};class Qn extends Bn{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Qn({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Qn({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return jt(e,"POST","/v1/accounts:signInWithPhoneNumber",Pt(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await jt(e,"POST","/v1/accounts:signInWithPhoneNumber",Pt(e,t));if(n.temporaryProof)throw Bt(e,"account-exists-with-different-credential",n);return n}(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return async function(e,t){return jt(e,"POST","/v1/accounts:signInWithPhoneNumber",Pt(e,{...t,operation:"REAUTH"}),Jn)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Qn({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Xn{constructor(e){const t=M(R(e)),n=t.apiKey??null,r=t.oobCode??null,i=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);kt(n&&r&&i,"argument-error"),this.apiKey=n,this.operation=i,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=function(e){const t=M(R(e)).link,n=t?M(R(t)).deep_link_id:null,r=M(R(e)).deep_link_id;return(r?M(R(r)).link:null)||r||n||t||e}(e);try{return new Xn(t)}catch{return null}}}class Yn{constructor(){this.providerId=Yn.PROVIDER_ID}static credential(e,t){return Hn._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Xn.parseLink(t);return kt(n,"argument-error"),Hn._fromEmailAndCode(e,n.code,n.tenantId)}}Yn.PROVIDER_ID="password",Yn.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Yn.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Zn{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class er extends Zn{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class tr extends er{constructor(){super("facebook.com")}static credential(e){return Kn._fromParams({providerId:tr.PROVIDER_ID,signInMethod:tr.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return tr.credentialFromTaggedObject(e)}static credentialFromError(e){return tr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return tr.credential(t.oauthAccessToken)}catch{return null}}}tr.FACEBOOK_SIGN_IN_METHOD="facebook.com",tr.PROVIDER_ID="facebook.com";class nr extends er{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Kn._fromParams({providerId:nr.PROVIDER_ID,signInMethod:nr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return nr.credentialFromTaggedObject(e)}static credentialFromError(e){return nr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return nr.credential(n,r)}catch{return null}}}nr.GOOGLE_SIGN_IN_METHOD="google.com",nr.PROVIDER_ID="google.com";class rr extends er{constructor(){super("github.com")}static credential(e){return Kn._fromParams({providerId:rr.PROVIDER_ID,signInMethod:rr.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return rr.credentialFromTaggedObject(e)}static credentialFromError(e){return rr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return rr.credential(t.oauthAccessToken)}catch{return null}}}rr.GITHUB_SIGN_IN_METHOD="github.com",rr.PROVIDER_ID="github.com";class ir extends er{constructor(){super("twitter.com")}static credential(e,t){return Kn._fromParams({providerId:ir.PROVIDER_ID,signInMethod:ir.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return ir.credentialFromTaggedObject(e)}static credentialFromError(e){return ir.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return ir.credential(n,r)}catch{return null}}}async function sr(e,t){return jt(e,"POST","/v1/accounts:signUp",Pt(e,t))}ir.TWITTER_SIGN_IN_METHOD="twitter.com",ir.PROVIDER_ID="twitter.com";class or{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await sn._fromIdTokenResponse(e,n,r),s=ar(n);return new or({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=ar(n);return new or({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function ar(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class lr extends T{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,lr.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new lr(e,t,n,r)}}function cr(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw lr._fromErrorAndOperation(e,n,t,r);throw n})}async function ur(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Xt(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return or._forOperation(e,"link",r)}async function hr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(Ge(r.app))return Promise.reject(wt(r));const i="reauthenticate";try{const s=await Xt(e,cr(r,i,t,e),n);kt(s.idToken,r,"internal-error");const o=Jt(s.idToken);kt(o,r,"internal-error");const{sub:a}=o;return kt(e.uid===a,r,"user-mismatch"),or._forOperation(e,i,s)}catch(s){throw"auth/user-not-found"===s?.code&&gt(r,"user-mismatch"),s}}async function dr(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ge(e.app))return Promise.reject(wt(e));const r="signIn",i=await cr(e,r,t),s=await or._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function fr(e,t){return dr(_n(e),t)}async function pr(e){const t=_n(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}function mr(e,t){return Lt(e,"POST","/v2/accounts/mfaEnrollment:start",Pt(e,t))}new WeakMap;const gr="__sak";class yr{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(gr,"1"),this.storage.removeItem(gr),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class vr extends yr{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=kn(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);Sn()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}vr.type="LOCAL";const wr=vr;function br(e){const t=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=RegExp(`${t}=([^;]+)`);return document.cookie.match(n)?.[1]??null}function Sr(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class kr{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(navigator.cookieEnabled??!0))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=Sr(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return e?.value}return br(t)}async _remove(e){if(!this._isAvailable())return;if(!await this._get(e))return;const t=Sr(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch(()=>{})}_addListener(e,t){if(!this._isAvailable())return;const n=Sr(e);if(window.cookieStore){const e=e=>{const r=e.changed.find(e=>e.name===n);r&&t(r.value);e.deleted.find(e=>e.name===n)&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=br(n);const i=setInterval(()=>{const e=br(n);e!==r&&(t(e),r=e)},1e3);this.listenerUnsubscribes.set(t,()=>clearInterval(i))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}kr.type="COOKIE";class Er extends yr{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Er.type="SESSION";const xr=Er;class Cr{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Cr(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!s?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map(async e=>e(t.origin,i)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Tr(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Cr.receivers=[];class _r{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise((o,a)=>{const l=Tr("",20);r.port1.start();const c=setTimeout(()=>{a(new Error("unsupported_event"))},n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(c),i=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(c),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])}).finally(()=>{s&&this.removeMessageHandler(s)})}}function Ir(){return window}function Ar(){return"undefined"!==typeof Ir().WorkerGlobalScope&&"function"===typeof Ir().importScripts}const Nr="firebaseLocalStorageDb",Or="firebaseLocalStorage",Mr="fbase_key";class Rr{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Dr(e,t){return e.transaction([Or],t?"readwrite":"readonly").objectStore(Or)}function Pr(){const e=indexedDB.open(Nr,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Or,{keyPath:Mr})}catch(r){n(r)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Or)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Nr);return new Rr(e).toPromise()}(),t(await Pr()))})})}async function Lr(e,t,n){const r=Dr(e,!0).put({[Mr]:t,value:n});return new Rr(r).toPromise()}function Fr(e,t){const n=Dr(e,!0).delete(t);return new Rr(n).toPromise()}class jr{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await Pr()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ar()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Cr._getInstance(Ar()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await async function(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}(),!this.activeServiceWorker)return;this.sender=new _r(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Pr();return await Lr(e,gr,"1"),await Fr(e,gr),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Lr(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Dr(e,!1).get(t),r=await new Rr(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Fr(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Dr(e,!1).getAll();return new Rr(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}jr.type="LOCAL";const Vr=jr;function zr(e,t){return Lt(e,"POST","/v2/accounts/mfaSignIn:start",Pt(e,t))}On("rcb"),new At(3e4,6e4);const Ur="recaptcha";async function Br(e,t,n){if(!e._getRecaptchaConfig())try{await jn(e)}catch(r){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(r="string"===typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){kt("enroll"===t.type,e,"internal-error");const i={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=Fn(e,i,"mfaSmsEnrollment",async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Dn){kt(n?.type===Ur,e,"argument-error");return mr(e,await $r(e,t,n))}return mr(e,t)},"PHONE_PROVIDER");return(await s.catch(e=>Promise.reject(e))).phoneSessionInfo.sessionInfo}{kt("signin"===t.type,e,"internal-error");const i=r.multiFactorHint?.uid||r.multiFactorUid;kt(i,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=Fn(e,s,"mfaSmsSignIn",async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Dn){kt(n?.type===Ur,e,"argument-error");return zr(e,await $r(e,t,n))}return zr(e,t)},"PHONE_PROVIDER");return(await o.catch(e=>Promise.reject(e))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"},i=Fn(e,t,"sendVerificationCode",async(e,t)=>{if(t.captchaResponse===Dn){kt(n?.type===Ur,e,"argument-error");return Gn(e,await $r(e,t,n))}return Gn(e,t)},"PHONE_PROVIDER");return(await i.catch(e=>Promise.reject(e))).sessionInfo}}finally{n?._reset()}}async function $r(e,t,n){kt(n.type===Ur,e,"argument-error");const r=await n.verify();kt("string"===typeof r,e,"argument-error");const i={...t};if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class qr{constructor(e){this.providerId=qr.PROVIDER_ID,this.auth=_n(e)}verifyPhoneNumber(e,t){return Br(this.auth,e,L(t))}static credential(e,t){return Qn._fromVerification(e,t)}static credentialFromResult(e){const t=e;return qr.credentialFromTaggedObject(t)}static credentialFromError(e){return qr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Qn._fromTokenResponse(n,r):null}}function Hr(e,t){return t?an(t):(kt(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}qr.PROVIDER_ID="phone",qr.PHONE_SIGN_IN_METHOD="phone";class Wr extends Bn{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Wn(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Wn(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Wn(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Kr(e){return dr(e.auth,new Wr(e),e.bypassAuthState)}function Gr(e){const{auth:t,user:n}=e;return kt(n,t,"internal-error"),hr(n,new Wr(e),e.bypassAuthState)}async function Jr(e){const{auth:t,user:n}=e;return kt(n,t,"internal-error"),ur(n,new Wr(e),e.bypassAuthState)}class Qr{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Kr;case"linkViaPopup":case"linkViaRedirect":return Jr;case"reauthViaPopup":case"reauthViaRedirect":return Gr;default:gt(this.auth,"internal-error")}}resolve(e){xt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){xt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Xr=new At(2e3,1e4);class Yr extends Qr{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Yr.currentPopupAction&&Yr.currentPopupAction.cancel(),Yr.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return kt(e,this.auth,"internal-error"),e}async onExecution(){xt(1===this.filter.length,"Popup operations only handle one event");const e=Tr();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(yt(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(yt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Yr.currentPopupAction=null}pollUserCancellation(){const e=()=>{this.authWindow?.window?.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(yt(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Xr.get())};e()}}Yr.currentPopupAction=null;const Zr=new Map;class ei extends Qr{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Zr.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=ri(t),r=ni(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Zr.set(this.auth._key(),e)}return this.bypassAuthState||Zr.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function ti(e,t){Zr.set(e._key(),t)}function ni(e){return an(e._redirectPersistence)}function ri(e){return un("pendingRedirect",e.config.apiKey,e.name)}async function ii(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Ge(e.app))return Promise.reject(wt(e));const r=_n(e),i=Hr(r,t),s=new ei(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class si{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ai(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!ai(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(yt(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(oi(e))}saveEventToCache(e){this.cachedEventUids.add(oi(e)),this.lastProcessedEventTime=Date.now()}}function oi(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function ai(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===n?.code}const li=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ci=/^https?/;async function ui(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e){return Lt(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}(e);for(const n of t)try{if(hi(n))return}catch{}gt(e,"unauthorized-domain")}function hi(e){const t=Ct(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!ci.test(n))return!1;if(li.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const di=new At(3e4,6e4);function fi(){const e=Ir().___jsl;if(e?.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function pi(e){return new Promise((t,n)=>{function r(){fi(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{fi(),n(yt(e,"network-request-failed"))},timeout:di.get()})}if(Ir().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else{if(!Ir().gapi?.load){const t=On("iframefcb");return Ir()[t]=()=>{gapi.load?r():n(yt(e,"network-request-failed"))},Nn(`${An.gapiScript}?onload=${t}`).catch(e=>n(e))}r()}}).catch(e=>{throw mi=null,e})}let mi=null;const gi=new At(5e3,15e3),yi={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},vi=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function wi(e){const t=e.config;kt(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Nt(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:Xe},i=vi.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${O(r).slice(1)}`}async function bi(e){const t=await function(e){return mi=mi||pi(e),mi}(e),n=Ir().gapi;return kt(n,e,"internal-error"),t.open({where:document.body,url:wi(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:yi,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=yt(e,"network-request-failed"),s=Ir().setTimeout(()=>{r(i)},gi.get());function o(){Ir().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})}))}const Si={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ki{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function Ei(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l={...Si,width:r.toString(),height:i.toString(),top:s,left:o},c=k().toLowerCase();n&&(a=mn(c)?"_blank":n),fn(c)&&(t=t||"http://localhost",l.scrollbars="yes");const u=Object.entries(l).reduce((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`},"");if(function(){return bn(arguments.length>0&&void 0!==arguments[0]?arguments[0]:k())&&!!window.navigator?.standalone}(c)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new ki(null);const h=window.open(t||"",a,u);kt(h,e,"popup-blocked");try{h.focus()}catch(d){}return new ki(h)}const xi="__/auth/handler",Ci="emulator/auth/handler",Ti=encodeURIComponent("fac");async function _i(e,t,n,r,i,s){kt(e.config.authDomain,e,"auth-domain-config-required"),kt(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:Xe,eventId:i};if(t instanceof Zn){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof er){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const l=await e._getAppCheckToken(),c=l?`#${Ti}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${xi}`;return Nt(t,Ci)}(e)}?${O(a).slice(1)}${c}`}const Ii="webStorageSupport";const Ai=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=xr,this._completeRedirectFn=ii,this._overrideRedirectResult=ti}async _openPopup(e,t,n,r){xt(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");return Ei(e,await _i(e,t,n,Ct(),r),Tr())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Ir().location.href=e}(await _i(e,t,n,Ct(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(xt(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await bi(e),n=new si(e);return t.register("authEvent",t=>{kt(t?.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Ii,{type:Ii},n=>{const r=n?.[0]?.[Ii];void 0!==r&&t(!!r),gt(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ui(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return kn()||pn()||bn()}};var Ni="@firebase/auth",Oi="1.11.0";class Mi{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){kt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Ri=m("authIdTokenMaxAge")||300;let Di=null;var Pi;An={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=yt("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Pi="Browser",We(new F("auth",(e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;kt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:Pi,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:En(Pi)},c=new Tn(r,i,s,l);return function(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(an);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}(c,n),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),We(new F("auth-internal",e=>(e=>new Mi(e))(_n(e.getProvider("auth").getImmediate())),"PRIVATE").setInstantiationMode("EXPLICIT")),et(Ni,Oi,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Pi)),et(Ni,Oi,"esm2020");et("firebase","12.3.0","app");var Li,Fi,ji="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Vi={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let s,o=e.g[3];s=t+(o^n&(i^o))+r[0]+3614090360&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[1]+3905402710&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[2]+606105819&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[3]+3250441966&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[4]+4118548399&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[5]+1200080426&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[6]+2821735955&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[7]+4249261313&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[8]+1770035416&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[9]+2336552879&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[10]+4294925233&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[11]+2304563134&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[12]+1804603682&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[13]+4254626195&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[14]+2792965006&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[15]+1236535329&4294967295,s=t+(i^o&((n=i+(s<<22&4294967295|s>>>10))^i))+r[1]+4129170786&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[6]+3225465664&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[11]+643717713&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[0]+3921069994&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[5]+3593408605&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[10]+38016083&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[15]+3634488961&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[4]+3889429448&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[9]+568446438&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[14]+3275163606&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[3]+4107603335&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[8]+1163531501&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[13]+2850285829&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[2]+4243563512&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[7]+1735328473&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[12]+2368359562&4294967295,s=t+((n=i+(s<<20&4294967295|s>>>12))^i^o)+r[5]+4294588738&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[8]+2272392833&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[11]+1839030562&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[14]+4259657740&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[1]+2763975236&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[4]+1272893353&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[7]+4139469664&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[10]+3200236656&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[13]+681279174&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[0]+3936430074&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[3]+3572445317&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[6]+76029189&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[9]+3654602809&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[12]+3873151461&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[15]+530742520&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[2]+3299628645&4294967295,s=t+(i^((n=i+(s<<23&4294967295|s>>>9))|~o))+r[0]+4096336452&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[7]+1126891415&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[14]+2878612391&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[5]+4237533241&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[12]+1700485571&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[3]+2399980690&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[10]+4293915773&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[1]+2240044497&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[8]+1873313359&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[15]+4264355552&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[6]+2734768916&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[13]+1309151649&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[4]+4149444226&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[11]+3174756917&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[2]+718787259&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function r(e,t){this.h=t;const n=[];let r=!0;for(let i=e.length-1;i>=0;i--){const s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,i=this.C;let s=this.h,o=0;for(;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var i={};function s(e){return-128<=e&&e<128?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],e<0?-1:0)}):new r([0|e],e<0?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(e<0)return d(o(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),l=s(1),c=s(16777216);function u(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new r(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;r.l(e)<=0;)n=y(n),r=y(r);var i=v(n,1),s=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var c=s.add(r);c.l(e)<=0&&(i=i.add(n),s=c),r=v(r,1),n=v(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=a;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),c=(s=o(n)).j(t);h(c)||c.l(e)>0;)c=(s=o(n-=r)).j(t);u(s)&&(s=l),i=i.add(s),e=f(e,c)}return new m(i,e)}function y(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new r(n,e.h)}function v(e,t){const n=t>>5;t%=32;const i=e.g.length-n,s=[];for(let r=0;r<i;r++)s[r]=t>0?e.i(r+n)>>>t|e.i(r+n+1)<<32-t:e.i(r+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);const t=o(Math.pow(e,6));var n=this;let r="";for(;;){const i=g(n,t).g;let s=(((n=f(n,i.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(u(n=i))return s+r;for(;s.length<6;)s="0"+s;r=s+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let i=0;for(let r=0;r<=t;r++){let t=i+(65535&this.i(r))+(65535&e.i(r)),s=(t>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);i=s>>>16,t&=65535,s&=65535,n[r]=s<<16|t}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(this.l(c)<0&&e.l(c)<0)return o(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(let t=0;t<e.g.length;t++){const r=this.i(i)>>>16,s=65535&this.i(i),o=e.i(t)>>>16,a=65535&e.i(t);n[2*i+2*t]+=s*a,p(n,2*i+2*t),n[2*i+2*t+1]+=r*a,p(n,2*i+2*t+1),n[2*i+2*t+1]+=s*o,p(n,2*i+2*t+1),n[2*i+2*t+2]+=r*o,p(n,2*i+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new r(n,0)},e.B=function(e){return g(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new r(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new r(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,Fi=Vi.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=o(Math.pow(n,8));let i=a;for(let a=0;a<t.length;a+=8){var s=Math.min(8,t.length-a);const e=parseInt(t.substring(a,a+s),n);s<8?(s=o(Math.pow(n,s)),i=i.j(s).add(o(e))):(i=i.j(r),i=i.add(o(e)))}return i},Li=Vi.Integer=r}).apply("undefined"!==typeof ji?ji:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var zi,Ui,Bi,$i,qi,Hi,Wi,Ki,Gi="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ji={};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Gi&&Gi];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var i=i||{},s=this||self;function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){return(l=a).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}var h="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function d(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){s.setTimeout(()=>{throw e},0)}function m(){var e=b;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var g=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new y,e=>e.reset());class y{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let v,w=!1,b=new class{constructor(){this.h=this.g=null}add(e,t){const n=g.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},S=()=>{const e=Promise.resolve(void 0);v=()=>{e.then(k)}};function k(){for(var e;e=m();){try{e.h.call(e.g)}catch(n){p(n)}var t=g;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}w=!1}function E(){this.u=this.u,this.C=this.C}function x(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}E.prototype.u=!1,E.prototype.dispose=function(){this.u||(this.u=!0,this.N())},E.prototype[Symbol.dispose]=function(){this.dispose()},E.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},x.prototype.h=function(){this.defaultPrevented=!0};var C=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function T(e){return/^[\s\xa0]*$/.test(e)}function _(e,t){x.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}u(_,x),_.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&_.Z.h.call(this)},_.prototype.h=function(){_.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var I="closure_listenable_"+(1e6*Math.random()|0),A=0;function N(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++A,this.da=this.fa=!1}function O(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function M(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function R(e){const t={};for(const n in e)t[n]=e[n];return t}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<D.length;t++)n=D[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function L(e){this.src=e,this.g={},this.h=0}function F(e,t){const n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=s>=0)&&Array.prototype.splice.call(i,s,1),r&&(O(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function j(e,t,n,r){for(let i=0;i<e.length;++i){const s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}L.prototype.add=function(e,t,n,r,i){const s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);const o=j(e,t,r,i);return o>-1?(t=e[o],n||(t.fa=!1)):((t=new N(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var V="closure_lm_"+(1e6*Math.random()|0),z={};function U(e,t,n,r,i){if(r&&r.once)return $(e,t,n,r,i);if(Array.isArray(t)){for(let s=0;s<t.length;s++)U(e,t[s],n,r,i);return null}return n=Q(n),e&&e[I]?e.J(t,n,o(r)?!!r.capture:!!r,i):B(e,t,n,!1,r,i)}function B(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");const a=o(i)?!!i.capture:!!i;let l=G(e);if(l||(e[V]=l=new L(e)),(n=l.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=K;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)C||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(W(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function $(e,t,n,r,i){if(Array.isArray(t)){for(let s=0;s<t.length;s++)$(e,t[s],n,r,i);return null}return n=Q(n),e&&e[I]?e.K(t,n,o(r)?!!r.capture:!!r,i):B(e,t,n,!0,r,i)}function q(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)q(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=Q(n),e&&e[I]?(e=e.i,(s=String(t).toString())in e.g&&((n=j(t=e.g[s],n,r,i))>-1&&(O(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[s],e.h--)))):e&&(e=G(e))&&(t=e.g[t.toString()],e=-1,t&&(e=j(t,n,r,i)),(n=e>-1?t[e]:null)&&H(n))}function H(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[I])F(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(W(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=G(t))?(F(n,e),0==n.h&&(n.src=null,t[V]=null)):O(e)}}}function W(e){return e in z?z[e]:z[e]="on"+e}function K(e,t){if(e.da)e=!0;else{t=new _(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&H(e),e=n.call(r,t)}return e}function G(e){return(e=e[V])instanceof L?e:null}var J="__closure_events_fn_"+(1e9*Math.random()>>>0);function Q(e){return"function"===typeof e?e:(e[J]||(e[J]=function(t){return e.handleEvent(t)}),e[J])}function X(){E.call(this),this.i=new L(this),this.M=this,this.G=null}function Y(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new x(t,e);else if(t instanceof x)t.target=t.target||e;else{var i=t;P(t=new x(r,e),i)}let s,o;if(i=!0,n)for(o=n.length-1;o>=0;o--)s=t.g=n[o],i=Z(s,r,!0,t)&&i;if(s=t.g=e,i=Z(s,r,!0,t)&&i,i=Z(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)s=t.g=n[o],i=Z(s,r,!1,t)&&i}function Z(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){const o=t[s];if(o&&!o.da&&o.capture==n){const t=o.listener,n=o.ha||o.src;o.fa&&F(e.i,o),i=!1!==t.call(n,r)&&i}}return i&&!r.defaultPrevented}function ee(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=l(e.handleEvent,e)}return Number(t)>2147483647?-1:s.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,ee(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(X,E),X.prototype[I]=!0,X.prototype.removeEventListener=function(e,t,n,r){q(this,e,t,n,r)},X.prototype.N=function(){if(X.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)O(n[e]);delete e.g[t],e.h--}}this.G=null},X.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},X.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class te extends E{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:ee(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ne(e){E.call(this),this.h=e,this.g={}}u(ne,E);var re=[];function ie(e){M(e.g,function(e,t){this.g.hasOwnProperty(t)&&H(e)},e),e.g={}}ne.prototype.N=function(){ne.Z.N.call(this),ie(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var se=s.JSON.stringify,oe=s.JSON.parse,ae=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function le(){}function ce(){}var ue={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function he(){x.call(this,"d")}function de(){x.call(this,"c")}u(he,x),u(de,x);var fe={},pe=null;function me(){return pe=pe||new X}function ge(e){x.call(this,fe.Ia,e)}function ye(e){const t=me();Y(t,new ge(t))}function ve(e,t){x.call(this,fe.STAT_EVENT,e),this.stat=t}function we(e){const t=me();Y(t,new ve(t,e))}function be(e,t){x.call(this,fe.Ja,e),this.size=t}function Se(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){e()},t)}function ke(){this.g=!0}function Ee(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const s=JSON.parse(t);if(s)for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var n=s[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<r.length;e++)r[e]=""}}}return se(s)}catch(s){return t}}(e,n)+(r?" "+r:"")})}fe.Ia="serverreachability",u(ge,x),fe.STAT_EVENT="statevent",u(ve,x),fe.Ja="timingevent",u(be,x),ke.prototype.ua=function(){this.g=!1},ke.prototype.info=function(){};var xe,Ce={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Te={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function _e(){}function Ie(e){return encodeURIComponent(String(e))}function Ae(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function Ne(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ne(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Oe}function Oe(){this.i=null,this.g="",this.h=!1}u(_e,le),_e.prototype.g=function(){return new XMLHttpRequest},xe=new _e;var Me={},Re={};function De(e,t,n){e.M=1,e.A=st(et(t)),e.u=n,e.R=!0,Pe(e,null)}function Pe(e,t){e.F=Date.now(),je(e),e.B=et(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),wt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Oe,e.g=on(e.j,n?t:null,!e.u),e.P>0&&(e.O=new te(l(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i="readystatechange";Array.isArray(i)||(i&&(re[0]=i.toString()),i=re);for(let s=0;s<i.length;s++){const e=U(n,i[s],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?R(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),ye(),function(e,t,n,r,i,s){e.info(function(){if(e.g)if(s){var o="",a=s.split("&");for(let e=0;e<a.length;e++){var l=a[e].split("=");if(l.length>1){const e=l[0];l=l[1];const t=e.split("_");o=t.length>=2&&"type"==t[1]?o+(e+"=")+l+"&":o+(e+"=redacted&")}}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Le(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Fe(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Re:(n=Number(t.substring(n,r)),isNaN(n)?Me:(r+=1)+n>t.length?Re:(t=t.slice(r,r+n),e.C=r+n,t))}function je(e){e.T=Date.now()+e.H,Ve(e,e.H)}function Ve(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=Se(l(e.aa,e),t)}function ze(e){e.D&&(s.clearTimeout(e.D),e.D=null)}function Ue(e){0==e.j.I||e.K||en(e.j,e)}function Be(e){ze(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ie(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function $e(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||Ge(n.h,e)))if(!e.L&&Ge(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;Zt(n),$t(n)}Qt(n),we(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=Se(l(n.Va,n),6e3));Ke(n.h)<=1&&n.ta&&(n.ta=void 0)}else nn(n,11)}else if((e.L||n.g==e)&&Zt(n),!T(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let l=i[t];const u=l[0];if(!(u<=n.K))if(n.K=u,l=l[1],2==n.I)if("c"==l[0]){n.M=l[1],n.ba=l[2];const t=l[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const i=l[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const u=l[5];null!=u&&"number"===typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(Je(s,s.h),s.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,it(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var o=e;if((r=n).na=sn(r,r.L?r.ba:null,r.W),o.L){Qe(r.h,o);var a=o,c=r.O;c&&(a.H=c),a.D&&(ze(a),je(a)),r.g=o}else Jt(r);n.i.length>0&&Ht(n)}else"stop"!=l[0]&&"close"!=l[0]||nn(n,7);else 3==n.I&&("stop"==l[0]||"close"==l[0]?"stop"==l[0]?nn(n,7):Bt(n):"noop"!=l[0]&&n.l&&n.l.qa(l),n.A=0)}ye()}catch(u){}}Ne.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==jt(e)?t.j():this.Y(e)},Ne.prototype.Y=function(e){try{if(e==this.g)e:{const l=jt(this.g),c=this.g.ya();this.g.ca();if(!(l<3)&&(3!=l||this.g&&(this.h.h||this.g.la()||Vt(this.g)))){this.K||4!=l||7==c||ye(),ze(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Le(e))return e.g.la();const t=Vt(e.g);if(""===t)return"";let n="";const r=t.length,i=4==jt(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return Be(e),Ue(e),"";e.h.i=new s.TextDecoder}for(let s=0;s<r;s++)e.h.h=!0,n+=e.h.i.decode(t[s],{stream:!(i&&s==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.i,this.v,this.B,this.l,this.S,l,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!T(r)){var o=r;break t}}o=null}if(!(e=o)){this.o=!1,this.m=3,we(12),Be(this),Ue(this);break e}Ee(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,$e(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Fe(this,n),t==Re){4==l&&(this.m=4,we(14),e=!1),Ee(this.i,this.l,null,"[Incomplete Response]");break}if(t==Me){this.m=4,we(15),Ee(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}Ee(this.i,this.l,t,null),$e(this,t)}if(Le(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=l||0!=n.length||this.h.h||(this.m=1,we(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var a=this.j;a.g==this&&a.aa&&!a.P&&(a.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Xt(a),a.P=!0,we(11))}}else Ee(this.i,this.l,n,"[Invalid Chunked Response]"),Be(this),Ue(this)}else Ee(this.i,this.l,n,null),$e(this,n);4==l&&Be(this),this.o&&!this.K&&(4==l?en(this.j,this):(this.o=!1,je(this)))}else(function(e){const t={};e=(e.g&&jt(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(T(e[r]))continue;var n=Ae(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,we(12)):(this.m=0,we(13)),Be(this),Ue(this)}}}catch(Ns){}},Ne.prototype.cancel=function(){this.K=!0,Be(this)},Ne.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(ye(),we(17)),Be(this),this.m=2,Ue(this)):Ve(this,this.T-e)};var qe=class{constructor(e,t){this.g=e,this.map=t}};function He(e){this.l=e||10,s.PerformanceNavigationTiming?e=(e=s.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function We(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Ke(e){return e.h?1:e.g?e.g.size:0}function Ge(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Je(e,t){e.g?e.g.add(t):e.h=t}function Qe(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Xe(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return d(e.i)}He.prototype.cancel=function(){if(this.i=Xe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Ye=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ze(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof Ze?(this.l=e.l,tt(this,e.j),this.o=e.o,this.g=e.g,nt(this,e.u),this.h=e.h,rt(this,bt(e.i)),this.m=e.m):e&&(t=String(e).match(Ye))?(this.l=!1,tt(this,t[1]||"",!0),this.o=ot(t[2]||""),this.g=ot(t[3]||"",!0),nt(this,t[4]),this.h=ot(t[5]||"",!0),rt(this,t[6]||"",!0),this.m=ot(t[7]||"")):(this.l=!1,this.i=new pt(null,this.l))}function et(e){return new Ze(e)}function tt(e,t,n){e.j=n?ot(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function nt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function rt(e,t,n){t instanceof pt?(e.i=t,function(e,t){t&&!e.j&&(mt(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(gt(this,t),wt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=at(t,dt)),e.i=new pt(t,e.l))}function it(e,t,n){e.i.set(t,n)}function st(e){return it(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ot(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function at(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,lt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function lt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ze.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(at(t,ct,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(at(t,ct,!0),"@"),e.push(Ie(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(at(n,"/"==n.charAt(0)?ht:ut,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",at(n,ft)),e.join("")},Ze.prototype.resolve=function(e){const t=et(this);let n=!!e.j;n?tt(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)nt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const e=[];for(let t=0;t<i.length;){const n=i[t++];"."==n?r&&t==i.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==i.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?rt(t,bt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var ct=/[#\/\?@]/g,ut=/[#\?:]/g,ht=/[#\?]/g,dt=/[#\?@]/g,ft=/#/g;function pt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function mt(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let i,s=null;r>=0?(i=e[n].substring(0,r),s=e[n].substring(r+1)):i=e[n],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function gt(e,t){mt(e),t=St(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function yt(e,t){return mt(e),t=St(e,t),e.g.has(t)}function vt(e,t){mt(e);let n=[];if("string"===typeof t)yt(e,t)&&(n=n.concat(e.g.get(St(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function wt(e,t,n){gt(e,t),n.length>0&&(e.i=null,e.g.set(St(e,t),d(n)),e.h+=n.length)}function bt(e){const t=new pt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function St(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function kt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function Et(){this.g=new ae}function xt(e){this.i=e.Sb||null,this.h=e.ab||!1}function Ct(e,t){X.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Tt(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function _t(e){e.readyState=4,e.l=null,e.j=null,e.B=null,It(e)}function It(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function At(e){let t="";return M(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function Nt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=At(n),"string"===typeof e?null!=n&&Ie(n):it(e,t,n))}function Ot(e){X.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=pt.prototype).add=function(e,t){mt(this),this.i=null,e=St(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){mt(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return mt(this),this.i=null,yt(this,e=St(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=vt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const i=Ie(n);n=vt(this,n);for(let t=0;t<n.length;t++){let r=i;""!==n[t]&&(r+="="+Ie(n[t])),e.push(r)}}return this.i=e.join("&")},u(xt,le),xt.prototype.g=function(){return new Ct(this.i,this.h)},u(Ct,X),(e=Ct.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,It(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||s).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,_t(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,It(this)),this.g&&(this.readyState=3,It(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Tt(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?_t(this):It(this),3==this.readyState&&Tt(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,_t(this))},e.Na=function(e){this.g&&(this.response=e,_t(this))},e.ga=function(){this.g&&_t(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ct.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(Ot,X);var Mt=/^https?$/i,Rt=["POST","PUT"];function Dt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Pt(e),Ft(e)}function Pt(e){e.A||(e.A=!0,Y(e,"complete"),Y(e,"error"))}function Lt(e){if(e.h&&"undefined"!=typeof i)if(e.v&&4==jt(e))setTimeout(e.Ca.bind(e),0);else if(Y(e,"readystatechange"),4==jt(e)){e.h=!1;try{const i=e.ca();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){let t=String(e.D).match(Ye)[1]||null;!t&&s.self&&s.self.location&&(t=s.self.location.protocol.slice(0,-1)),r=!Mt.test(t?t.toLowerCase():"")}n=r}if(n)Y(e,"complete"),Y(e,"success");else{e.o=6;try{var o=jt(e)>2?e.g.statusText:""}catch(a){o=""}e.l=o+" ["+e.ca()+"]",Pt(e)}}finally{Ft(e)}}}function Ft(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||Y(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function jt(e){return e.g?e.g.readyState:0}function Vt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function zt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Ut(e){this.za=0,this.i=[],this.j=new ke,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=zt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=zt("baseRetryDelayMs",5e3,e),this.Za=zt("retryDelaySeedMs",1e4,e),this.Ta=zt("forwardChannelMaxRetries",2,e),this.va=zt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new He(e&&e.concurrentRequestLimit),this.Ba=new Et,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function Bt(e){if(qt(e),3==e.I){var t=e.V++,n=et(e.J);if(it(n,"SID",e.M),it(n,"RID",t),it(n,"TYPE","terminate"),Kt(e,n),(t=new Ne(e,e.j,t)).M=2,t.A=st(et(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.A,n=!0),n||(t.g=on(t.j,null),t.g.ea(t.A)),t.F=Date.now(),je(t)}rn(e)}function $t(e){e.g&&(Xt(e),e.g.cancel(),e.g=null)}function qt(e){$t(e),e.v&&(s.clearTimeout(e.v),e.v=null),Zt(e),e.h.cancel(),e.m&&("number"===typeof e.m&&s.clearTimeout(e.m),e.m=null)}function Ht(e){if(!We(e.h)&&!e.m){e.m=!0;var t=e.Ea;v||S(),w||(v(),w=!0),b.add(t,e),e.D=0}}function Wt(e,t){var n;n=t?t.l:e.V++;const r=et(e.J);it(r,"SID",e.M),it(r,"RID",n),it(r,"AID",e.K),Kt(e,r),e.u&&e.o&&Nt(r,e.u,e.o),n=new Ne(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=Gt(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Je(e.h,n),De(n,r,t)}function Kt(e,t){e.H&&M(e.H,function(e,n){it(t,n,e)}),e.l&&M({},function(e,n){it(t,n,e)})}function Gt(e,t,n){n=Math.min(e.i.length,n);const r=e.l?l(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let l=!0;for(let c=0;c<n;c++){var s=i[c].g;const n=i[c].map;if((s-=t)<0)t=Math.max(0,i[c].g-100),l=!1;else try{s="req"+s+"_"||0;try{var a=n instanceof Map?n:Object.entries(n);for(const[t,n]of a){let r=n;o(n)&&(r=se(n)),e.push(s+t+"="+encodeURIComponent(r))}}catch(Xi){throw e.push(s+"type="+encodeURIComponent("_badmap")),Xi}}catch(Xi){r&&r(n)}}if(l){a=e.join("&");break e}}a=void 0}return e=e.i.splice(0,n),t.G=e,a}function Jt(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;v||S(),w||(v(),w=!0),b.add(t,e),e.A=0}}function Qt(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=Se(l(e.Da,e),tn(e,e.A)),e.A++,!0)}function Xt(e){null!=e.B&&(s.clearTimeout(e.B),e.B=null)}function Yt(e){e.g=new Ne(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=et(e.na);it(t,"RID","rpc"),it(t,"SID",e.M),it(t,"AID",e.K),it(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&it(t,"TO",e.ia),it(t,"TYPE","xmlhttp"),Kt(e,t),e.u&&e.o&&Nt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=st(et(t)),n.u=null,n.R=!0,Pe(n,e)}function Zt(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function en(e,t){var n=null;if(e.g==t){Zt(e),Xt(e),e.g=null;var r=2}else{if(!Ge(e.h,t))return;n=t.G,Qe(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;Y(r=me(),new be(r,n)),Ht(e)}else Jt(e);else if(3==(i=t.m)||0==i&&t.X>0||!(1==r&&function(e,t){return!(Ke(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=Se(l(e.Ea,e,t),tn(e,e.D)),e.D++,!0))}(e,t)||2==r&&Qt(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:nn(e,5);break;case 4:nn(e,10);break;case 3:nn(e,6);break;default:nn(e,2)}}function tn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function nn(e,t){if(e.j.info("Error code "+t),2==t){var n=l(e.bb,e),r=e.Ua;const t=!r;r=new Ze(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||tt(r,"https"),st(r),t?function(e,t){const n=new ke;if(s.Image){const r=new Image;r.onload=c(kt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(kt,n,"TestLoadImage: error",!1,t,r),r.onabort=c(kt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(kt,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new ke;const n=new AbortController,r=setTimeout(()=>{n.abort(),kt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?kt(0,0,!0,t):kt(0,0,!1,t)}).catch(()=>{clearTimeout(r),kt(0,0,!1,t)})}(r.toString(),n)}else we(2);e.I=0,e.l&&e.l.pa(t),rn(e),qt(e)}function rn(e){if(e.I=0,e.ja=[],e.l){const t=Xe(e.h);0==t.length&&0==e.i.length||(f(e.ja,t),f(e.ja,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.oa()}}function sn(e,t,n){var r=n instanceof Ze?et(n):new Ze(n);if(""!=r.g)t&&(r.g=t+"."+r.g),nt(r,r.u);else{var i=s.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;const e=new Ze(null);r&&tt(e,r),t&&(e.g=t),i&&nt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&it(r,n,t),it(r,"VER",e.ka),Kt(e,r),r}function on(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new Ot(new xt({ab:n})):new Ot(e.ma)).Fa(e.L),t}function an(){}function ln(){}function cn(e,t){X.call(this),this.g=new Ut(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!T(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!T(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new dn(this)}function un(e){he.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function hn(){de.call(this),this.status=1}function dn(e){this.g=e}(e=Ot.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():xe.g(),this.g.onreadystatechange=h(l(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void Dt(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=s.FormData&&e instanceof s.FormData,!(Array.prototype.indexOf.call(Rt,t,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of n)this.g.setRequestHeader(s,a);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(o){Dt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,Y(this,"complete"),Y(this,"abort"),Ft(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Ft(this,!0)),Ot.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Lt(this):this.Xa())},e.Xa=function(){Lt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return jt(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),oe(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Ut.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){we(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=sn(this,null,this.W),Ht(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new Ne(this,this.j,e);let s=this.o;if(this.U&&(s?(s=R(s),P(s,this.U)):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Gt(this,i,t),it(n=et(this.J),"RID",e),it(n,"CVER",22),this.G&&it(n,"X-HTTP-Session-Id",this.G),Kt(this,n),s&&(this.R?t="headers="+Ie(At(s))+"&"+t:this.u&&Nt(n,this.u,s)),Je(this.h,i),this.Ra&&it(n,"TYPE","init"),this.S?(it(n,"$req",t),it(n,"SID","null"),i.U=!0,De(i,n,null)):De(i,n,t),this.I=2}}else 3==this.I&&(e?Wt(this,e):0==this.i.length||We(this.h)||Wt(this))},e.Da=function(){if(this.v=null,Yt(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=Se(l(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,we(10),$t(this),Yt(this))},e.Va=function(){null!=this.C&&(this.C=null,$t(this),Qt(this),we(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),we(2)):(this.j.info("Failed to ping google.com"),we(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=an.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},ln.prototype.g=function(e,t){return new cn(e,t)},u(cn,X),cn.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},cn.prototype.close=function(){Bt(this.g)},cn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=se(e),e=n);t.i.push(new qe(t.Ya++,e)),3==t.I&&Ht(t)},cn.prototype.N=function(){this.g.l=null,delete this.j,Bt(this.g),delete this.g,cn.Z.N.call(this)},u(un,he),u(hn,de),u(dn,an),dn.prototype.ra=function(){Y(this.g,"a")},dn.prototype.qa=function(e){Y(this.g,new un(e))},dn.prototype.pa=function(e){Y(this.g,new hn)},dn.prototype.oa=function(){Y(this.g,"b")},ln.prototype.createWebChannel=ln.prototype.g,cn.prototype.send=cn.prototype.o,cn.prototype.open=cn.prototype.m,cn.prototype.close=cn.prototype.close,Ki=Ji.createWebChannelTransport=function(){return new ln},Wi=Ji.getStatEventTarget=function(){return me()},Hi=Ji.Event=fe,qi=Ji.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ce.NO_ERROR=0,Ce.TIMEOUT=8,Ce.HTTP_ERROR=6,$i=Ji.ErrorCode=Ce,Te.COMPLETE="complete",Bi=Ji.EventType=Te,ce.EventType=ue,ue.OPEN="a",ue.CLOSE="b",ue.ERROR="c",ue.MESSAGE="d",X.prototype.listen=X.prototype.J,Ui=Ji.WebChannel=ce,Ji.FetchXmlHttpFactory=xt,Ot.prototype.listenOnce=Ot.prototype.K,Ot.prototype.getLastError=Ot.prototype.Ha,Ot.prototype.getLastErrorCode=Ot.prototype.ya,Ot.prototype.getStatus=Ot.prototype.ca,Ot.prototype.getResponseJson=Ot.prototype.La,Ot.prototype.getResponseText=Ot.prototype.la,Ot.prototype.send=Ot.prototype.ea,Ot.prototype.setWithCredentials=Ot.prototype.Fa,zi=Ji.XhrIo=Ot}).apply("undefined"!==typeof Gi?Gi:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Qi="@firebase/firestore",Xi="4.9.2";class Yi{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Yi.UNAUTHENTICATED=new Yi(null),Yi.GOOGLE_CREDENTIALS=new Yi("google-credentials-uid"),Yi.FIRST_PARTY=new Yi("first-party-uid"),Yi.MOCK_USER=new Yi("mock-user");let Zi="12.3.0";const es=new K("@firebase/firestore");function ts(){return es.logLevel}function ns(e){if(es.logLevel<=B.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(ss);es.debug(`Firestore (${Zi}): ${e}`,...i)}}function rs(e){if(es.logLevel<=B.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(ss);es.error(`Firestore (${Zi}): ${e}`,...i)}}function is(e){if(es.logLevel<=B.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(ss);es.warn(`Firestore (${Zi}): ${e}`,...i)}}function ss(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function as(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,ls(e,r,n)}function ls(e,t,n){let r=`FIRESTORE (${Zi}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw rs(r),new Error(r)}function cs(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||ls(t,i,r)}function us(e,t){return e}const hs={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ds extends T{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class fs{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ps{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ms{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Yi.UNAUTHENTICATED))}shutdown(){}}class gs{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ys{constructor(e){this.t=e,this.currentUser=Yi.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){cs(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new fs;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new fs,e.enqueueRetryable(()=>r(this.currentUser))};const s=()=>{const t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{ns("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(ns("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new fs)}},0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(ns("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(cs("string"==typeof t.accessToken,31837,{l:t}),new ps(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return cs(null===e||"string"==typeof e,2055,{h:e}),new Yi(e)}}class vs{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Yi.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ws{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new vs(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Yi.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class bs{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ss{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ge(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){cs(void 0===this.o,3512);const n=e=>{null!=e.error&&ns("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,ns("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{ns("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):ns("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new bs(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(cs("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new bs(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function ks(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class Es{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=ks(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function xs(e,t){return e<t?-1:e>t?1:0}function Cs(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),i=t.charAt(r);if(n!==i)return Is(n)===Is(i)?xs(n,i):Is(n)?1:-1}return xs(e.length,t.length)}const Ts=55296,_s=57343;function Is(e){const t=e.charCodeAt(0);return t>=Ts&&t<=_s}function As(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const Ns="__name__";class Os{constructor(e,t,n){void 0===t?t=0:t>e.length&&as(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&as(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Os.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Os?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=Os.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return xs(e.length,t.length)}static compareSegments(e,t){const n=Os.isNumericId(e),r=Os.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?Os.extractNumericId(e).compare(Os.extractNumericId(t)):Cs(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Li.fromString(e.substring(4,e.length-2))}}class Ms extends Os{construct(e,t,n){return new Ms(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new ds(hs.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(e=>e.length>0))}return new Ms(e)}static emptyPath(){return new Ms([])}}const Rs=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ds extends Os{construct(e,t,n){return new Ds(e,t,n)}static isValidIdentifier(e){return Rs.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ds.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Ns}static keyField(){return new Ds([Ns])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new ds(hs.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new ds(hs.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new ds(hs.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new ds(hs.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ds(t)}static emptyPath(){return new Ds([])}}class Ps{constructor(e){this.path=e}static fromPath(e){return new Ps(Ms.fromString(e))}static fromName(e){return new Ps(Ms.fromString(e).popFirst(5))}static empty(){return new Ps(Ms.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ms.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ms.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ps(new Ms(e.slice()))}}function Ls(e,t,n){if(!n)throw new ds(hs.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Fs(e){if(!Ps.isDocumentKey(e))throw new ds(hs.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function js(e){if(Ps.isDocumentKey(e))throw new ds(hs.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Vs(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function zs(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":as(12329,{type:typeof e})}function Us(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ds(hs.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=zs(e);throw new ds(hs.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Bs(e,t){const n={typeString:e};return t&&(n.value=t),n}function $s(e,t){if(!Vs(e))throw new ds(hs.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(void 0!==s&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new ds(hs.INVALID_ARGUMENT,n);return!0}const qs=-62135596800,Hs=1e6;class Ws{static now(){return Ws.fromMillis(Date.now())}static fromDate(e){return Ws.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Hs);return new Ws(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ds(hs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ds(hs.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<qs)throw new ds(hs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ds(hs.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Hs}_compareTo(e){return this.seconds===e.seconds?xs(this.nanoseconds,e.nanoseconds):xs(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ws._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($s(e,Ws._jsonSchema))return new Ws(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-qs;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ws._jsonSchemaVersion="firestore/timestamp/1.0",Ws._jsonSchema={type:Bs("string",Ws._jsonSchemaVersion),seconds:Bs("number"),nanoseconds:Bs("number")};class Ks{static fromTimestamp(e){return new Ks(e)}static min(){return new Ks(new Ws(0,0))}static max(){return new Ks(new Ws(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const Gs=-1;class Js{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}Js.UNKNOWN_ID=-1;function Qs(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=Ks.fromTimestamp(1e9===r?new Ws(n+1,0):new Ws(n,r));return new Ys(i,Ps.empty(),t)}function Xs(e){return new Ys(e.readTime,e.key,Gs)}class Ys{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Ys(Ks.min(),Ps.empty(),Gs)}static max(){return new Ys(Ks.max(),Ps.empty(),Gs)}}function Zs(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Ps.comparator(e.documentKey,t.documentKey),0!==n?n:xs(e.largestBatchId,t.largestBatchId))}const eo="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class to{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function no(e){if(e.code!==hs.FAILED_PRECONDITION||e.message!==eo)throw e;ns("LocalStore","Unexpectedly lost primary lease")}class ro{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&as(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ro((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ro?t:ro.resolve(t)}catch(e){return ro.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ro.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ro.reject(t)}static resolve(e){return new ro((t,n)=>{t(e)})}static reject(e){return new ro((t,n)=>{n(e)})}static waitFor(e){return new ro((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=ro.resolve(!1);for(const n of e)t=t.next(e=>e?ro.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new ro((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next(e=>{s[l]=e,++o,o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new ro((n,r)=>{const i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}function io(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function so(e){return"IndexedDbTransactionError"===e.name}class oo{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}oo.ce=-1;const ao=-1;function lo(e){return null==e}function co(e){return 0===e&&1/e==-1/0}function uo(e){return"number"==typeof e&&Number.isInteger(e)&&!co(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const ho="\x01";function fo(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=mo(t)),t=po(e.get(n),t);return mo(t)}function po(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case ho:n+="\x01\x11";break;default:n+=t}}return n}function mo(e){return e+ho+"\x01"}const go="remoteDocuments",yo="owner",vo="mutationQueues",wo="mutations";const bo="documentMutations",So="remoteDocumentsV14",ko="remoteDocumentGlobal",Eo="targets",xo="targetDocuments",Co="targetGlobal",To="collectionParents",_o="clientMetadata",Io="bundles",Ao="namedQueries",No="indexConfiguration",Oo="indexState",Mo="indexEntries",Ro="documentOverlays",Do="globals",Po=[vo,wo,bo,go,Eo,yo,Co,xo,_o,ko,To,Io,Ao],Lo=[vo,wo,bo,So,Eo,yo,Co,xo,_o,ko,To,Io,Ao,Ro],Fo=Lo,jo=[...Fo,No,Oo,Mo];function Vo(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function zo(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Uo(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class Bo{constructor(e,t){this.comparator=e,this.root=t||qo.EMPTY}insert(e,t){return new Bo(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,qo.BLACK,null,null))}remove(e){return new Bo(this.comparator,this.root.remove(e,this.comparator).copy(null,null,qo.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new $o(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new $o(this.root,e,this.comparator,!1)}getReverseIterator(){return new $o(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new $o(this.root,e,this.comparator,!0)}}class $o{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class qo{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:qo.RED,this.left=null!=r?r:qo.EMPTY,this.right=null!=i?i:qo.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new qo(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return qo.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return qo.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,qo.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,qo.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw as(43730,{key:this.key,value:this.value});if(this.right.isRed())throw as(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw as(27949);return e+(this.isRed()?0:1)}}qo.EMPTY=null,qo.RED=!0,qo.BLACK=!1,qo.EMPTY=new class{constructor(){this.size=0}get key(){throw as(57766)}get value(){throw as(16141)}get color(){throw as(16727)}get left(){throw as(29726)}get right(){throw as(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new qo(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Ho{constructor(e){this.comparator=e,this.data=new Bo(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Wo(this.data.getIterator())}getIteratorFrom(e){return new Wo(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof Ho))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new Ho(this.comparator);return t.data=e,t}}class Wo{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class Ko{constructor(e){this.fields=e,e.sort(Ds.comparator)}static empty(){return new Ko([])}unionWith(e){let t=new Ho(Ds.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Ko(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return As(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class Go extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Jo{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Go("Invalid base64 string: "+e):e}}(e);return new Jo(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Jo(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xs(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jo.EMPTY_BYTE_STRING=new Jo("");const Qo=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Xo(e){if(cs(!!e,39018),"string"==typeof e){let t=0;const n=Qo.exec(e);if(cs(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Yo(e.seconds),nanos:Yo(e.nanos)}}function Yo(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Zo(e){return"string"==typeof e?Jo.fromBase64String(e):Jo.fromUint8Array(e)}const ea="server_timestamp",ta="__type__",na="__previous_value__",ra="__local_write_time__";function ia(e){const t=(e?.mapValue?.fields||{})[ta]?.stringValue;return t===ea}function sa(e){const t=e.mapValue.fields[na];return ia(t)?sa(t):t}function oa(e){const t=Xo(e.mapValue.fields[ra].timestampValue);return new Ws(t.seconds,t.nanos)}class aa{constructor(e,t,n,r,i,s,o,a,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l,this.isUsingEmulator=c}}const la="(default)";class ca{constructor(e,t){this.projectId=e,this.database=t||la}static empty(){return new ca("","")}get isDefaultDatabase(){return this.database===la}isEqual(e){return e instanceof ca&&e.projectId===this.projectId&&e.database===this.database}}const ua="__type__",ha="__max__",da={mapValue:{fields:{__type__:{stringValue:ha}}}},fa="__vector__",pa="value";function ma(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?ia(e)?4:Ma(e)?9007199254740991:Na(e)?10:11:as(28295,{value:e})}function ga(e,t){if(e===t)return!0;const n=ma(e);if(n!==ma(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return oa(e).isEqual(oa(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Xo(e.timestampValue),r=Xo(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Zo(e.bytesValue).isEqual(Zo(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Yo(e.geoPointValue.latitude)===Yo(t.geoPointValue.latitude)&&Yo(e.geoPointValue.longitude)===Yo(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Yo(e.integerValue)===Yo(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Yo(e.doubleValue),r=Yo(t.doubleValue);return n===r?co(n)===co(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return As(e.arrayValue.values||[],t.arrayValue.values||[],ga);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Vo(n)!==Vo(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!ga(n[i],r[i])))return!1;return!0}(e,t);default:return as(52216,{left:e})}}function ya(e,t){return void 0!==(e.values||[]).find(e=>ga(e,t))}function va(e,t){if(e===t)return 0;const n=ma(e),r=ma(t);if(n!==r)return xs(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return xs(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Yo(e.integerValue||e.doubleValue),r=Yo(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return wa(e.timestampValue,t.timestampValue);case 4:return wa(oa(e),oa(t));case 5:return Cs(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Zo(e),r=Zo(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=xs(n[i],r[i]);if(0!==e)return e}return xs(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=xs(Yo(e.latitude),Yo(t.latitude));return 0!==n?n:xs(Yo(e.longitude),Yo(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ba(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=t.fields||{},i=n[pa]?.arrayValue,s=r[pa]?.arrayValue,o=xs(i?.values?.length||0,s?.values?.length||0);return 0!==o?o:ba(i,s)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===da.mapValue&&t===da.mapValue)return 0;if(e===da.mapValue)return 1;if(t===da.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=Cs(r[o],s[o]);if(0!==e)return e;const t=va(n[r[o]],i[s[o]]);if(0!==t)return t}return xs(r.length,s.length)}(e.mapValue,t.mapValue);default:throw as(23264,{he:n})}}function wa(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return xs(e,t);const n=Xo(e),r=Xo(t),i=xs(n.seconds,r.seconds);return 0!==i?i:xs(n.nanos,r.nanos)}function ba(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=va(n[i],r[i]);if(e)return e}return xs(n.length,r.length)}function Sa(e){return ka(e)}function ka(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Xo(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Zo(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Ps.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=ka(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${ka(e.fields[i])}`;return n+"}"}(e.mapValue):as(61005,{value:e})}function Ea(e){switch(ma(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=sa(e);return t?16+Ea(t):16;case 5:return 2*e.stringValue.length;case 6:return Zo(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce((e,t)=>e+Ea(t),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return zo(e.fields,(e,n)=>{t+=e.length+Ea(n)}),t}(e.mapValue);default:throw as(13486,{value:e})}}function xa(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Ca(e){return!!e&&"integerValue"in e}function Ta(e){return!!e&&"arrayValue"in e}function _a(e){return!!e&&"nullValue"in e}function Ia(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function Aa(e){return!!e&&"mapValue"in e}function Na(e){const t=(e?.mapValue?.fields||{})[ua]?.stringValue;return t===fa}function Oa(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return zo(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=Oa(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=Oa(e.arrayValue.values[n]);return t}return{...e}}function Ma(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===ha}class Ra{constructor(e){this.value=e}static empty(){return new Ra({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!Aa(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Oa(t)}setAll(e){let t=Ds.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=Oa(e):r.push(i.lastSegment())});const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());Aa(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ga(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];Aa(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){zo(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Ra(Oa(this.value))}}function Da(e){const t=[];return zo(e.fields,(e,n)=>{const r=new Ds([e]);if(Aa(n)){const e=Da(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new Ko(t)}class Pa{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Pa(e,0,Ks.min(),Ks.min(),Ks.min(),Ra.empty(),0)}static newFoundDocument(e,t,n,r){return new Pa(e,1,t,Ks.min(),n,r,0)}static newNoDocument(e,t){return new Pa(e,2,t,Ks.min(),Ks.min(),Ra.empty(),0)}static newUnknownDocument(e,t){return new Pa(e,3,t,Ks.min(),Ks.min(),Ra.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Ks.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ra.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ra.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Ks.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Pa&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Pa(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class La{constructor(e,t){this.position=e,this.inclusive=t}}function Fa(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Ps.comparator(Ps.fromName(o.referenceValue),n.key):va(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function ja(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!ga(e.position[n],t.position[n]))return!1;return!0}class Va{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function za(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Ua{}class Ba extends Ua{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Qa(e,t,n):"array-contains"===t?new el(e,n):"in"===t?new tl(e,n):"not-in"===t?new nl(e,n):"array-contains-any"===t?new rl(e,n):new Ba(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Xa(e,n):new Ya(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(va(t,this.value)):null!==t&&ma(this.value)===ma(t)&&this.matchesComparison(va(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return as(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class $a extends Ua{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new $a(e,t)}matches(e){return qa(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function qa(e){return"and"===e.op}function Ha(e){return Wa(e)&&qa(e)}function Wa(e){for(const t of e.filters)if(t instanceof $a)return!1;return!0}function Ka(e){if(e instanceof Ba)return e.field.canonicalString()+e.op.toString()+Sa(e.value);if(Ha(e))return e.filters.map(e=>Ka(e)).join(",");{const t=e.filters.map(e=>Ka(e)).join(",");return`${e.op}(${t})`}}function Ga(e,t){return e instanceof Ba?function(e,t){return t instanceof Ba&&e.op===t.op&&e.field.isEqual(t.field)&&ga(e.value,t.value)}(e,t):e instanceof $a?function(e,t){return t instanceof $a&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&Ga(n,t.filters[r]),!0)}(e,t):void as(19439)}function Ja(e){return e instanceof Ba?function(e){return`${e.field.canonicalString()} ${e.op} ${Sa(e.value)}`}(e):e instanceof $a?function(e){return e.op.toString()+" {"+e.getFilters().map(Ja).join(" ,")+"}"}(e):"Filter"}class Qa extends Ba{constructor(e,t,n){super(e,t,n),this.key=Ps.fromName(n.referenceValue)}matches(e){const t=Ps.comparator(e.key,this.key);return this.matchesComparison(t)}}class Xa extends Ba{constructor(e,t){super(e,"in",t),this.keys=Za("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class Ya extends Ba{constructor(e,t){super(e,"not-in",t),this.keys=Za("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Za(e,t){return(t.arrayValue?.values||[]).map(e=>Ps.fromName(e.referenceValue))}class el extends Ba{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ta(t)&&ya(t.arrayValue,this.value)}}class tl extends Ba{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ya(this.value.arrayValue,t)}}class nl extends Ba{constructor(e,t){super(e,"not-in",t)}matches(e){if(ya(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!ya(this.value.arrayValue,t)}}class rl extends Ba{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ta(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>ya(this.value.arrayValue,e))}}class il{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Te=null}}function sl(e){return new il(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function ol(e){const t=us(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>Ka(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>function(e){return e.field.canonicalString()+e.dir}(e)).join(","),lo(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Sa(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Sa(e)).join(",")),t.Te=e}return t.Te}function al(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!za(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!Ga(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ja(e.startAt,t.startAt)&&ja(e.endAt,t.endAt)}function ll(e){return Ps.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class cl{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function ul(e,t,n,r,i,s,o,a){return new cl(e,t,n,r,i,s,o,a)}function hl(e){return new cl(e)}function dl(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function fl(e){return null!==e.collectionGroup}function pl(e){const t=us(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const i of t.explicitOrderBy)t.Ie.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Ho(Ds.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}(t);r.forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Va(r,n))}),e.has(Ds.keyField().canonicalString())||t.Ie.push(new Va(Ds.keyField(),n))}return t.Ie}function ml(e){const t=us(e);return t.Ee||(t.Ee=gl(t,pl(e))),t.Ee}function gl(e,t){if("F"===e.limitType)return sl(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Va(e.field,t)});const n=e.endAt?new La(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new La(e.startAt.position,e.startAt.inclusive):null;return sl(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function yl(e,t){const n=e.filters.concat([t]);return new cl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function vl(e,t,n){return new cl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function wl(e,t){return al(ml(e),ml(t))&&e.limitType===t.limitType}function bl(e){return`${ol(ml(e))}|lt:${e.limitType}`}function Sl(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>Ja(e)).join(", ")}]`),lo(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Sa(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Sa(e)).join(",")),`Target(${t})`}(ml(e))}; limitType=${e.limitType})`}function kl(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Ps.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of pl(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Fa(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,pl(e),t))&&!(e.endAt&&!function(e,t,n){const r=Fa(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,pl(e),t))}(e,t)}function El(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function xl(e){return(t,n)=>{let r=!1;for(const i of pl(e)){const e=Cl(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Cl(e,t,n){const r=e.field.isKeyField()?Ps.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?va(r,i):as(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return as(19790,{direction:e.dir})}}class Tl{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){zo(this.inner,(t,n)=>{for(const[r,i]of n)e(r,i)})}isEmpty(){return Uo(this.inner)}size(){return this.innerSize}}const _l=new Bo(Ps.comparator);function Il(){return _l}const Al=new Bo(Ps.comparator);function Nl(){let e=Al;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function Ol(e){let t=Al;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Ml(){return Dl()}function Rl(){return Dl()}function Dl(){return new Tl(e=>e.toString(),(e,t)=>e.isEqual(t))}const Pl=new Bo(Ps.comparator),Ll=new Ho(Ps.comparator);function Fl(){let e=Ll;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const jl=new Ho(xs);function Vl(){return jl}function zl(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:co(t)?"-0":t}}function Ul(e){return{integerValue:""+e}}function Bl(e,t){return uo(t)?Ul(t):zl(e,t)}class $l{constructor(){this._=void 0}}function ql(e,t,n){return e instanceof Kl?function(e,t){const n={fields:{[ta]:{stringValue:ea},[ra]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&ia(t)&&(t=sa(t)),t&&(n.fields[na]=t),{mapValue:n}}(n,t):e instanceof Gl?Jl(e,t):e instanceof Ql?Xl(e,t):function(e,t){const n=Wl(e,t),r=Zl(n)+Zl(e.Ae);return Ca(n)&&Ca(e.Ae)?Ul(r):zl(e.serializer,r)}(e,t)}function Hl(e,t,n){return e instanceof Gl?Jl(e,t):e instanceof Ql?Xl(e,t):n}function Wl(e,t){return e instanceof Yl?function(e){return Ca(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Kl extends $l{}class Gl extends $l{constructor(e){super(),this.elements=e}}function Jl(e,t){const n=ec(t);for(const r of e.elements)n.some(e=>ga(e,r))||n.push(r);return{arrayValue:{values:n}}}class Ql extends $l{constructor(e){super(),this.elements=e}}function Xl(e,t){let n=ec(t);for(const r of e.elements)n=n.filter(e=>!ga(e,r));return{arrayValue:{values:n}}}class Yl extends $l{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function Zl(e){return Yo(e.integerValue||e.doubleValue)}function ec(e){return Ta(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class tc{constructor(e,t){this.field=e,this.transform=t}}class nc{constructor(e,t){this.version=e,this.transformResults=t}}class rc{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new rc}static exists(e){return new rc(void 0,e)}static updateTime(e){return new rc(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ic(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class sc{}function oc(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new gc(e.key,rc.none()):new hc(e.key,e.data,rc.none());{const n=e.data,r=Ra.empty();let i=new Ho(Ds.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new dc(e.key,r,new Ko(i.toArray()),rc.none())}}function ac(e,t,n){e instanceof hc?function(e,t,n){const r=e.value.clone(),i=pc(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof dc?function(e,t,n){if(!ic(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=pc(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(fc(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function lc(e,t,n,r){return e instanceof hc?function(e,t,n,r){if(!ic(e.precondition,t))return n;const i=e.value.clone(),s=mc(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof dc?function(e,t,n,r){if(!ic(e.precondition,t))return n;const i=mc(e.fieldTransforms,r,t),s=t.data;return s.setAll(fc(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):function(e,t,n){return ic(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function cc(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Wl(r.transform,e||null);null!=i&&(null===n&&(n=Ra.empty()),n.set(r.field,i))}return n||null}function uc(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&As(e,t,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Gl&&t instanceof Gl||e instanceof Ql&&t instanceof Ql?As(e.elements,t.elements,ga):e instanceof Yl&&t instanceof Yl?ga(e.Ae,t.Ae):e instanceof Kl&&t instanceof Kl}(e.transform,t.transform)}(e,t))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class hc extends sc{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class dc extends sc{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function fc(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function pc(e,t,n){const r=new Map;cs(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,Hl(o,a,n[i]))}return r}function mc(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,ql(e,s,t))}return r}class gc extends sc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yc extends sc{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class vc{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&ac(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=lc(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=lc(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Rl();return this.mutations.forEach(r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=oc(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(Ks.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Fl())}isEqual(e){return this.batchId===e.batchId&&As(this.mutations,e.mutations,(e,t)=>uc(e,t))&&As(this.baseMutations,e.baseMutations,(e,t)=>uc(e,t))}}class wc{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){cs(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=Pl;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new wc(e,t,n,r)}}class bc{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Sc{constructor(e,t){this.count=e,this.unchangedNames=t}}var kc,Ec;function xc(e){switch(e){case hs.OK:return as(64938);case hs.CANCELLED:case hs.UNKNOWN:case hs.DEADLINE_EXCEEDED:case hs.RESOURCE_EXHAUSTED:case hs.INTERNAL:case hs.UNAVAILABLE:case hs.UNAUTHENTICATED:return!1;case hs.INVALID_ARGUMENT:case hs.NOT_FOUND:case hs.ALREADY_EXISTS:case hs.PERMISSION_DENIED:case hs.FAILED_PRECONDITION:case hs.ABORTED:case hs.OUT_OF_RANGE:case hs.UNIMPLEMENTED:case hs.DATA_LOSS:return!0;default:return as(15467,{code:e})}}function Cc(e){if(void 0===e)return rs("GRPC error has no .code"),hs.UNKNOWN;switch(e){case kc.OK:return hs.OK;case kc.CANCELLED:return hs.CANCELLED;case kc.UNKNOWN:return hs.UNKNOWN;case kc.DEADLINE_EXCEEDED:return hs.DEADLINE_EXCEEDED;case kc.RESOURCE_EXHAUSTED:return hs.RESOURCE_EXHAUSTED;case kc.INTERNAL:return hs.INTERNAL;case kc.UNAVAILABLE:return hs.UNAVAILABLE;case kc.UNAUTHENTICATED:return hs.UNAUTHENTICATED;case kc.INVALID_ARGUMENT:return hs.INVALID_ARGUMENT;case kc.NOT_FOUND:return hs.NOT_FOUND;case kc.ALREADY_EXISTS:return hs.ALREADY_EXISTS;case kc.PERMISSION_DENIED:return hs.PERMISSION_DENIED;case kc.FAILED_PRECONDITION:return hs.FAILED_PRECONDITION;case kc.ABORTED:return hs.ABORTED;case kc.OUT_OF_RANGE:return hs.OUT_OF_RANGE;case kc.UNIMPLEMENTED:return hs.UNIMPLEMENTED;case kc.DATA_LOSS:return hs.DATA_LOSS;default:return as(39323,{code:e})}}(Ec=kc||(kc={}))[Ec.OK=0]="OK",Ec[Ec.CANCELLED=1]="CANCELLED",Ec[Ec.UNKNOWN=2]="UNKNOWN",Ec[Ec.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ec[Ec.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ec[Ec.NOT_FOUND=5]="NOT_FOUND",Ec[Ec.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ec[Ec.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ec[Ec.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ec[Ec.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ec[Ec.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ec[Ec.ABORTED=10]="ABORTED",Ec[Ec.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ec[Ec.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ec[Ec.INTERNAL=13]="INTERNAL",Ec[Ec.UNAVAILABLE=14]="UNAVAILABLE",Ec[Ec.DATA_LOSS=15]="DATA_LOSS";let Tc=null;function _c(){return new TextEncoder}const Ic=new Li([4294967295,4294967295],0);function Ac(e){const t=_c().encode(e),n=new Fi;return n.update(t),new Uint8Array(n.digest())}function Nc(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Li([n,r],0),new Li([i,s],0)]}class Oc{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Mc(`Invalid padding: ${t}`);if(n<0)throw new Mc(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Mc(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Mc(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Li.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Li.fromNumber(n)));return 1===r.compare(Ic)&&(r=new Li([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=Ac(e),[n,r]=Nc(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Oc(i,r,t);return n.forEach(e=>s.insert(e)),s}insert(e){if(0===this.ge)return;const t=Ac(e),[n,r]=Nc(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Mc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Rc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Dc.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Rc(Ks.min(),r,new Bo(xs),Il(),Fl())}}class Dc{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Dc(n,t,Fl(),Fl(),Fl())}}class Pc{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Lc{constructor(e,t){this.targetId=e,this.Ce=t}}class Fc{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Jo.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class jc{constructor(){this.ve=0,this.Fe=Uc(),this.Me=Jo.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Fl(),t=Fl(),n=Fl();return this.Fe.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:as(38017,{changeType:i})}}),new Dc(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Uc()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,cs(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class Vc{constructor(e){this.Ge=e,this.ze=new Map,this.je=Il(),this.Je=zc(),this.He=zc(),this.Ye=new Bo(xs)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:as(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(ll(i))if(0===n){const e=new Ps(i.path);this.et(t,e,Pa.newNoDocument(e,Ks.min()))}else cs(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){const n=this.ut(e),i=n?this.ct(n,e,r):1;if(0!==i){this.it(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}Tc?.lt(function(e,t,n,r,i){const s={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},o=t.unchangedNames;return o&&(s.bloomFilter={applied:0===i,hashCount:o?.hashCount??0,bitmapLength:o?.bits?.bitmap?.length??0,padding:o?.bits?.padding??0,mightContain:e=>r?.mightContain(e)??!1}),s}(r,e.Ce,this.Ge.ht(),n,i))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=Zo(n).toUint8Array()}catch(e){if(e instanceof Go)return is("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new Oc(s,r,i)}catch(e){return is(e instanceof Mc?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.ge?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const i=this.Ge.ht(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const i=this.ot(r);if(i){if(n.current&&ll(i.target)){const t=new Ps(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Pa.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=Fl();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new Rc(e,t,this.Ye,this.je,n);return this.je=Il(),this.Je=zc(),this.He=zc(),this.Ye=new Bo(xs),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new jc,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new Ho(xs),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new Ho(xs),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||ns("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new jc),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function zc(){return new Bo(Ps.comparator)}function Uc(){return new Bo(Ps.comparator)}const Bc={asc:"ASCENDING",desc:"DESCENDING"},$c={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},qc={and:"AND",or:"OR"};class Hc{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Wc(e,t){return e.useProto3Json||lo(t)?t:{value:t}}function Kc(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Gc(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Jc(e,t){return Kc(e,t.toTimestamp())}function Qc(e){return cs(!!e,49232),Ks.fromTimestamp(function(e){const t=Xo(e);return new Ws(t.seconds,t.nanos)}(e))}function Xc(e,t){return Yc(e,t).canonicalString()}function Yc(e,t){const n=function(e){return new Ms(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Zc(e){const t=Ms.fromString(e);return cs(wu(t),10190,{key:t.toString()}),t}function eu(e,t){return Xc(e.databaseId,t.path)}function tu(e,t){const n=Zc(t);if(n.get(1)!==e.databaseId.projectId)throw new ds(hs.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ds(hs.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Ps(su(n))}function nu(e,t){return Xc(e.databaseId,t)}function ru(e){const t=Zc(e);return 4===t.length?Ms.emptyPath():su(t)}function iu(e){return new Ms(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function su(e){return cs(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function ou(e,t,n){return{name:eu(e,t),fields:n.value.mapValue.fields}}function au(e,t){let n;if(t instanceof hc)n={update:ou(e,t.key,t.value)};else if(t instanceof gc)n={delete:eu(e,t.key)};else if(t instanceof dc)n={update:ou(e,t.key,t.data),updateMask:vu(t.fieldMask)};else{if(!(t instanceof yc))return as(16599,{Vt:t.type});n={verify:eu(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof Kl)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Gl)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Ql)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Yl)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw as(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Jc(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:as(27497)}(e,t.precondition)),n}function lu(e,t){return{documents:[nu(e,t.path)]}}function cu(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=nu(e,i);const s=function(e){if(0!==e.length)return yu($a.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map(e=>function(e){return{field:mu(e.field),direction:du(e.dir)}}(e))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Wc(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function uu(e){let t=ru(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){cs(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=hu(e);return t instanceof $a&&Ha(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map(e=>function(e){return new Va(gu(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,lo(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new La(n,t)}(n.startAt));let c=null;return n.endAt&&(c=function(e){const t=!e.before,n=e.values||[];return new La(n,t)}(n.endAt)),ul(t,i,o,s,a,"F",l,c)}function hu(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=gu(e.unaryFilter.field);return Ba.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=gu(e.unaryFilter.field);return Ba.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=gu(e.unaryFilter.field);return Ba.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=gu(e.unaryFilter.field);return Ba.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return as(61313);default:return as(60726)}}(e):void 0!==e.fieldFilter?function(e){return Ba.create(gu(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return as(58110);default:return as(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return $a.create(e.compositeFilter.filters.map(e=>hu(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return as(1026)}}(e.compositeFilter.op))}(e):as(30097,{filter:e})}function du(e){return Bc[e]}function fu(e){return $c[e]}function pu(e){return qc[e]}function mu(e){return{fieldPath:e.canonicalString()}}function gu(e){return Ds.fromServerFormat(e.fieldPath)}function yu(e){return e instanceof Ba?function(e){if("=="===e.op){if(Ia(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NAN"}};if(_a(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Ia(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NOT_NAN"}};if(_a(e.value))return{unaryFilter:{field:mu(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:mu(e.field),op:fu(e.op),value:e.value}}}(e):e instanceof $a?function(e){const t=e.getFilters().map(e=>yu(e));return 1===t.length?t[0]:{compositeFilter:{op:pu(e.op),filters:t}}}(e):as(54877,{filter:e})}function vu(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function wu(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class bu{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Ks.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Ks.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Jo.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new bu(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new bu(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new bu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new bu(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Su{constructor(e){this.yt=e}}function ku(e){const t=uu({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?vl(t,t.limit,"L"):t}class Eu{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(Yo(e.integerValue));else if("doubleValue"in e){const n=Yo(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),co(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Xo(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Zo(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?Ma(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):Na(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):as(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const r=pa,i=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(Yo(i)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),Ps.fromName(e).path.forEach(e=>{this.Ft(t,60),this.Ut(e,t)})}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Eu.Kt=new Eu;class xu{constructor(){this.Cn=new Cu}addToCollectionParentIndex(e,t){return this.Cn.add(t),ro.resolve()}getCollectionParents(e,t){return ro.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ro.resolve()}deleteFieldIndex(e,t){return ro.resolve()}deleteAllFieldIndexes(e){return ro.resolve()}createTargetIndexes(e,t){return ro.resolve()}getDocumentsMatchingTarget(e,t){return ro.resolve(null)}getIndexType(e,t){return ro.resolve(0)}getFieldIndexes(e,t){return ro.resolve([])}getNextCollectionGroupToUpdate(e){return ro.resolve(null)}getMinOffset(e,t){return ro.resolve(Ys.min())}getMinOffsetFromCollectionGroup(e,t){return ro.resolve(Ys.min())}updateCollectionGroup(e,t,n){return ro.resolve()}updateIndexEntries(e,t){return ro.resolve()}}class Cu{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Ho(Ms.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Ho(Ms.comparator)).toArray()}}new Uint8Array(0);const Tu={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_u=41943040;class Iu{static withCacheSize(e){return new Iu(e,Iu.DEFAULT_COLLECTION_PERCENTILE,Iu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Iu.DEFAULT_COLLECTION_PERCENTILE=10,Iu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Iu.DEFAULT=new Iu(_u,Iu.DEFAULT_COLLECTION_PERCENTILE,Iu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Iu.DISABLED=new Iu(-1,0,0);class Au{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Au(0)}static cr(){return new Au(-1)}}const Nu="LruGarbageCollector",Ou=1048576;function Mu(e,t){let[n,r]=e,[i,s]=t;const o=xs(n,i);return 0===o?xs(r,s):o}class Ru{constructor(e){this.Ir=e,this.buffer=new Ho(Mu),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Mu(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Du{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){ns(Nu,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){so(e)?ns(Nu,"Ignoring IndexedDB error during garbage collection: ",e):await no(e)}await this.Vr(3e5)})}}class Pu{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return ro.resolve(oo.ce);const n=new Ru(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(ns("LruGarbageCollector","Garbage collection skipped; disabled"),ro.resolve(Tu)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(ns("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Tu):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,s,o,a,l;const c=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(ns("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),ts()<=B.DEBUG&&ns("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-c}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-c}ms`),ro.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}function Lu(e,t){return new Pu(e,t)}class Fu{constructor(){this.changes=new Tl(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Pa.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?ro.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ju{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Vu{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&lc(n.mutation,e,Ko.empty(),Ws.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Fl()).next(()=>t))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Fl();const r=Ml();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Nl();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Ml();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Fl()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=Il();const s=Dl(),o=Dl();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof dc)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),lc(o.mutation,t,o.mutation.getFieldMask(),Ws.now())):s.set(t.key,Ko.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>o.set(e,new ju(t,s.get(e)??null))),o))}recalculateAndSaveOverlays(e,t){const n=Dl();let r=new Bo((e,t)=>e-t),i=Fl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const i of e)i.keys().forEach(e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Ko.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Fl()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,c=Rl();l.forEach(e=>{if(!i.has(e)){const r=oc(t.get(e),n.get(e));null!==r&&c.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,c))}return ro.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Ps.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):fl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):ro.resolve(Ml());let o=Gs,a=i;return s.next(t=>ro.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?ro.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,Fl())).next(e=>({batchId:o,changes:Ol(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Ps(t)).next(e=>{let t=Nl();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=Nl();return this.indexManager.getCollectionParents(e,i).next(o=>ro.forEach(o,o=>{const a=function(e,t){return new cl(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r))).next(e=>{i.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Pa.newInvalidDocument(r)))});let n=Nl();return e.forEach((e,r)=>{const s=i.get(e);void 0!==s&&lc(s.mutation,r,Ko.empty(),Ws.now()),kl(t,r)&&(n=n.insert(e,r))}),n})}}class zu{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return ro.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Qc(e.createTime)}}(t)),ro.resolve()}getNamedQuery(e,t){return ro.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:ku(e.bundledQuery),readTime:Qc(e.readTime)}}(t)),ro.resolve()}}class Uu{constructor(){this.overlays=new Bo(Ps.comparator),this.qr=new Map}getOverlay(e,t){return ro.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ml();return ro.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),ro.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),ro.resolve()}getOverlaysForCollection(e,t,n){const r=Ml(),i=t.length+1,s=new Ps(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return ro.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new Bo((e,t)=>e-t);const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Ml(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Ml(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return ro.resolve(o)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new bc(t,n));let i=this.qr.get(t);void 0===i&&(i=Fl(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}class Bu{constructor(){this.sessionToken=Jo.EMPTY_BYTE_STRING}getSessionToken(e){return ro.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ro.resolve()}}class $u{constructor(){this.Qr=new Ho(qu.$r),this.Ur=new Ho(qu.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new qu(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new qu(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new Ps(new Ms([])),n=new qu(t,e),r=new qu(t,e+1),i=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),i.push(e.key)}),i}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new Ps(new Ms([])),n=new qu(t,e),r=new qu(t,e+1);let i=Fl();return this.Ur.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){const t=new qu(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class qu{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return Ps.comparator(e.key,t.key)||xs(e.Yr,t.Yr)}static Kr(e,t){return xs(e.Yr,t.Yr)||Ps.comparator(e.key,t.key)}}class Hu{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new Ho(qu.$r)}checkEmpty(e){return ro.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new vc(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Zr=this.Zr.add(new qu(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return ro.resolve(s)}lookupMutationBatch(e,t){return ro.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return ro.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ro.resolve(0===this.mutationQueue.length?ao:this.tr-1)}getAllMutationBatches(e){return ro.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new qu(t,0),r=new qu(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);i.push(t)}),ro.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Ho(xs);return t.forEach(e=>{const t=new qu(e,0),r=new qu(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),ro.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Ps.isDocumentKey(i)||(i=i.child(""));const s=new qu(new Ps(i),0);let o=new Ho(xs);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)},s),ro.resolve(this.ti(o))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){cs(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return ro.forEach(t.mutations,r=>{const i=new qu(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new qu(t,0),r=this.Zr.firstAfterOrEqual(n);return ro.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,ro.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Wu{constructor(e){this.ri=e,this.docs=new Bo(Ps.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ro.resolve(n?n.document.mutableCopy():Pa.newInvalidDocument(t))}getEntries(e,t){let n=Il();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Pa.newInvalidDocument(e))}),ro.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Il();const s=t.path,o=new Ps(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Zs(Xs(o),n)<=0||(r.has(o.key)||kl(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return ro.resolve(i)}getAllFromCollectionGroup(e,t,n,r){as(9500)}ii(e,t){return ro.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Ku(this)}getSize(e){return ro.resolve(this.size)}}class Ku extends Fu{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),ro.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Gu{constructor(e){this.persistence=e,this.si=new Tl(e=>ol(e),al),this.lastRemoteSnapshotVersion=Ks.min(),this.highestTargetId=0,this.oi=0,this._i=new $u,this.targetCount=0,this.ai=Au.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),ro.resolve()}getLastRemoteSnapshotVersion(e){return ro.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ro.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),ro.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),ro.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Au(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,ro.resolve()}updateTargetData(e,t){return this.Pr(t),ro.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,ro.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.si.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),ro.waitFor(i).next(()=>r)}getTargetCount(e){return ro.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return ro.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),ro.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),ro.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),ro.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return ro.resolve(n)}containsKey(e,t){return ro.resolve(this._i.containsKey(t))}}class Ju{constructor(e,t){this.ui={},this.overlays={},this.ci=new oo(0),this.li=!1,this.li=!0,this.hi=new Bu,this.referenceDelegate=e(this),this.Pi=new Gu(this),this.indexManager=new xu,this.remoteDocumentCache=function(e){return new Wu(e)}(e=>this.referenceDelegate.Ti(e)),this.serializer=new Su(t),this.Ii=new zu(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Uu,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new Hu(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){ns("MemoryPersistence","Starting transaction:",e);const r=new Qu(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return ro.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Qu extends to{constructor(e){super(),this.currentSequenceNumber=e}}class Xu{constructor(e){this.persistence=e,this.Ri=new $u,this.Vi=null}static mi(e){return new Xu(e)}get fi(){if(this.Vi)return this.Vi;throw as(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),ro.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),ro.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),ro.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ro.forEach(this.fi,n=>{const r=Ps.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,Ks.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return ro.or([()=>ro.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Yu{constructor(e,t){this.persistence=e,this.pi=new Tl(e=>fo(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=Lu(this,t)}static mi(e,t){return new Yu(e,t)}Ei(){}di(e){return ro.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return ro.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?ro.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,i.removeEntry(r,Ks.min()))})).next(()=>i.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),ro.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ro.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),ro.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),ro.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ea(e.data.value)),t}br(e,t,n){return ro.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return ro.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Zu{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=Fl(),r=Fl();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new Zu(e,t.fromCache,n,r)}}class eh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class th{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=x()?8:io(k())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next(e=>{i.result=e}).next(()=>{if(!i.result)return this.ws(e,t,r,n).next(e=>{i.result=e})}).next(()=>{if(i.result)return;const n=new eh;return this.Ss(e,t,n).next(r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>i.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(ts()<=B.DEBUG&&ns("QueryEngine","SDK will not create cache indexes for query:",Sl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),ro.resolve()):(ts()<=B.DEBUG&&ns("QueryEngine","Query:",Sl(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(ts()<=B.DEBUG&&ns("QueryEngine","The SDK decides to create cache indexes for query:",Sl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ml(t))):ro.resolve())}ys(e,t){if(dl(t))return ro.resolve(null);let n=ml(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=vl(t,null,"F"),n=ml(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const i=Fl(...r);return this.ps.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const s=this.Ds(t,r);return this.Cs(t,s,i,n.readTime)?this.ys(e,vl(t,null,"F")):this.vs(e,s,t,n)}))})))}ws(e,t,n,r){return dl(t)||r.isEqual(Ks.min())?ro.resolve(null):this.ps.getDocuments(e,n).next(i=>{const s=this.Ds(t,i);return this.Cs(t,s,n,r)?ro.resolve(null):(ts()<=B.DEBUG&&ns("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Sl(t)),this.vs(e,s,t,Qs(r,Gs)).next(e=>e))})}Ds(e,t){let n=new Ho(xl(e));return t.forEach((t,r)=>{kl(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return ts()<=B.DEBUG&&ns("QueryEngine","Using full collection scan to execute query:",Sl(t)),this.ps.getDocumentsMatchingQuery(e,t,Ys.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const nh="LocalStore";class rh{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new Bo(xs),this.xs=new Tl(e=>ol(e),al),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vu(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}function ih(e,t,n,r){return new rh(e,t,n,r)}async function sh(e,t){const n=us(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const i=[],s=[];let o=Fl();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Ls:e,removedBatchIds:i,addedBatchIds:s}))})})}function oh(e){const t=us(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function ah(e,t,n){let r=Fl(),i=Fl();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=Il();return n.forEach((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(Ks.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):ns(nh,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{ks:r,qs:i}})}function lh(e,t){const n=us(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=ao),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function ch(e,t){const n=us(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(i=>i?(r=i,ro.resolve(r)):n.Pi.allocateTargetId(e).next(i=>(r=new bu(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}async function uh(e,t,n){const r=us(e),i=r.Ms.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!so(e))throw e;ns(nh,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function hh(e,t,n){const r=us(e);let i=Ks.min(),s=Fl();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=us(e),i=r.xs.get(n);return void 0!==i?ro.resolve(r.Ms.get(i)):r.Pi.getTargetData(t,n)}(r,e,ml(t)).next(t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{s=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:Ks.min(),n?s:Fl())).next(e=>(dh(r,El(t),e),{documents:e,Qs:s})))}function dh(e,t,n){let r=e.Os.get(t)||Ks.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}class fh{constructor(){this.activeTargetIds=Vl()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ph{constructor(){this.Mo=new fh,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new fh,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class mh{Oo(e){}shutdown(){}}const gh="ConnectivityMonitor";class yh{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){ns(gh,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){ns(gh,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let vh=null;function wh(){return null===vh?vh=268435456+Math.round(2147483648*Math.random()):vh++,"0x"+vh.toString(16)}const bh="RestConnection",Sh={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class kh{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===la?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){const s=wh(),o=this.zo(e,t.toUriEncodedString());ns(bh,`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(a,r,i);const{host:l}=new URL(o),c=y(l);return this.Jo(e,o,a,n,c).then(t=>(ns(bh,`Received RPC '${e}' ${s}: `,t),t),t=>{throw is(bh,`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t})}Ho(e,t,n,r,i,s){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Zi,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=Sh[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class Eh{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const xh="WebChannelConnection";class Ch extends kh{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const s=wh();return new Promise((i,o)=>{const a=new zi;a.setWithCredentials(!0),a.listenOnce(Bi.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case $i.NO_ERROR:const t=a.getResponseJson();ns(xh,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case $i.TIMEOUT:ns(xh,`RPC '${e}' ${s} timed out`),o(new ds(hs.DEADLINE_EXCEEDED,"Request time out"));break;case $i.HTTP_ERROR:const n=a.getStatus();if(ns(xh,`RPC '${e}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=e?.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(hs).indexOf(t)>=0?t:hs.UNKNOWN}(t.status);o(new ds(e,t.message))}else o(new ds(hs.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new ds(hs.UNAVAILABLE,"Connection failed."));break;default:as(9055,{l_:e,streamId:s,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{ns(xh,`RPC '${e}' ${s} completed.`)}});const l=JSON.stringify(r);ns(xh,`RPC '${e}' ${s} sending request:`,r),a.send(t,"POST",l,n,15)})}T_(e,t,n){const r=wh(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Ki(),o=Wi(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const c=i.join("");ns(xh,`Creating RPC '${e}' stream ${r}: ${c}`,a);const u=s.createWebChannel(c,a);this.I_(u);let h=!1,d=!1;const f=new Eh({Yo:t=>{d?ns(xh,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(ns(xh,`Opening RPC '${e}' stream ${r} transport.`),u.open(),h=!0),ns(xh,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Zo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return p(u,Ui.EventType.OPEN,()=>{d||(ns(xh,`RPC '${e}' stream ${r} transport opened.`),f.o_())}),p(u,Ui.EventType.CLOSE,()=>{d||(d=!0,ns(xh,`RPC '${e}' stream ${r} transport closed`),f.a_(),this.E_(u))}),p(u,Ui.EventType.ERROR,t=>{d||(d=!0,is(xh,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),f.a_(new ds(hs.UNAVAILABLE,"The operation could not be completed")))}),p(u,Ui.EventType.MESSAGE,t=>{if(!d){const n=t.data[0];cs(!!n,16349);const i=n,s=i?.error||i[0]?.error;if(s){ns(xh,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=kc[e];if(void 0!==t)return Cc(t)}(t),i=s.message;void 0===n&&(n=hs.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),d=!0,f.a_(new ds(n,i)),u.close()}else ns(xh,`RPC '${e}' stream ${r} received:`,n),f.u_(n)}}),p(o,Hi.STAT_EVENT,t=>{t.stat===qi.PROXY?ns(xh,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===qi.NOPROXY&&ns(xh,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.__()},0),f}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Th(){return"undefined"!=typeof document?document:null}function _h(e){return new Hc(e,!0)}class Ih{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&ns("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Ah="PersistentStream";class Nh{constructor(e,t,n,r,i,s,o,a){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new Ih(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===hs.RESOURCE_EXHAUSTED?(rs(t.toString()),rs("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===hs.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(e=>{let[n,r]=e;this.D_===t&&this.G_(n,r)},t=>{e(()=>{const e=new ds(hs.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return ns(Ah,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(ns(Ah,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Oh extends Nh{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:as(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(cs(void 0===t||"string"==typeof t,58123),Jo.fromBase64String(t||"")):(cs(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),Jo.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?hs.UNKNOWN:Cc(e.code);return new ds(t,e.message||"")}(o);n=new Fc(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=tu(e,r.document.name),s=Qc(r.document.updateTime),o=r.document.createTime?Qc(r.document.createTime):Ks.min(),a=new Ra({mapValue:{fields:r.document.fields}}),l=Pa.newFoundDocument(i,s,o,a),c=r.targetIds||[],u=r.removedTargetIds||[];n=new Pc(c,u,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=tu(e,r.document),s=r.readTime?Qc(r.readTime):Ks.min(),o=Pa.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Pc([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=tu(e,r.document),s=r.removedTargetIds||[];n=new Pc([],s,i,null)}else{if(!("filter"in t))return as(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Sc(r,i),o=e.targetId;n=new Lc(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Ks.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Ks.min():t.readTime?Qc(t.readTime):Ks.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=iu(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=ll(r)?{documents:lu(e,r)}:{query:cu(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Gc(e,t.resumeToken);const r=Wc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Ks.min())>0){n.readTime=Kc(e,t.snapshotVersion.toTimestamp());const r=Wc(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return as(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=iu(this.serializer),t.removeTarget=e,this.q_(t)}}class Mh extends Nh{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return cs(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,cs(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){cs(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(cs(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?Qc(e.updateTime):Qc(t);return n.isEqual(Ks.min())&&(n=Qc(t)),new nc(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=Qc(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=iu(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>au(this.serializer,e))};this.q_(t)}}class Rh{}class Dh extends Rh{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ds(hs.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(i=>{let[s,o]=i;return this.connection.Go(e,Yc(t,n),r,s,o)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===hs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ds(hs.UNKNOWN,e.toString())})}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(s=>{let[o,a]=s;return this.connection.Ho(e,Yc(t,n),r,o,a,i)}).catch(e=>{throw"FirebaseError"===e.name?(e.code===hs.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ds(hs.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Ph{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(rs(t),this.aa=!1):ns("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Lh="RemoteStore";class Fh{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{Wh(this)&&(ns(Lh,"Restarting streams for network reachability change."),await async function(e){const t=us(e);t.Ea.add(4),await Vh(t),t.Ra.set("Unknown"),t.Ea.delete(4),await jh(t)}(this))})}),this.Ra=new Ph(n,r)}}async function jh(e){if(Wh(e))for(const t of e.da)await t(!0)}async function Vh(e){for(const t of e.da)await t(!1)}function zh(e,t){const n=us(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Hh(n)?qh(n):hd(n).O_()&&Bh(n,t))}function Uh(e,t){const n=us(e),r=hd(n);n.Ia.delete(t),r.O_()&&$h(n,t),0===n.Ia.size&&(r.O_()?r.L_():Wh(n)&&n.Ra.set("Unknown"))}function Bh(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Ks.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}hd(e).Y_(t)}function $h(e,t){e.Va.Ue(t),hd(e).Z_(t)}function qh(e){e.Va=new Vc({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),hd(e).start(),e.Ra.ua()}function Hh(e){return Wh(e)&&!hd(e).x_()&&e.Ia.size>0}function Wh(e){return 0===us(e).Ea.size}function Kh(e){e.Va=void 0}async function Gh(e){e.Ra.set("Online")}async function Jh(e){e.Ia.forEach((t,n)=>{Bh(e,t)})}async function Qh(e,t){Kh(e),Hh(e)?(e.Ra.ha(t),qh(e)):e.Ra.set("Unknown")}async function Xh(e,t,n){if(e.Ra.set("Online"),t instanceof Fc&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){ns(Lh,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await Yh(e,n)}else if(t instanceof Pc?e.Va.Ze(t):t instanceof Lc?e.Va.st(t):e.Va.tt(t),!n.isEqual(Ks.min()))try{const t=await oh(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(Jo.EMPTY_BYTE_STRING,r.snapshotVersion)),$h(e,t);const i=new bu(r.target,t,n,r.sequenceNumber);Bh(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){ns(Lh,"Failed to raise snapshot:",t),await Yh(e,t)}}async function Yh(e,t,n){if(!so(t))throw t;e.Ea.add(1),await Vh(e),e.Ra.set("Offline"),n||(n=()=>oh(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{ns(Lh,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await jh(e)})}function Zh(e,t){return t().catch(n=>Yh(e,n,t))}async function ed(e){const t=us(e),n=dd(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:ao;for(;td(t);)try{const e=await lh(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,nd(t,e)}catch(e){await Yh(t,e)}rd(t)&&id(t)}function td(e){return Wh(e)&&e.Ta.length<10}function nd(e,t){e.Ta.push(t);const n=dd(e);n.O_()&&n.X_&&n.ea(t.mutations)}function rd(e){return Wh(e)&&!dd(e).x_()&&e.Ta.length>0}function id(e){dd(e).start()}async function sd(e){dd(e).ra()}async function od(e){const t=dd(e);for(const n of e.Ta)t.ea(n.mutations)}async function ad(e,t,n){const r=e.Ta.shift(),i=wc.from(r,t,n);await Zh(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await ed(e)}async function ld(e,t){t&&dd(e).X_&&await async function(e,t){if(function(e){return xc(e)&&e!==hs.ABORTED}(t.code)){const n=e.Ta.shift();dd(e).B_(),await Zh(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await ed(e)}}(e,t),rd(e)&&id(e)}async function cd(e,t){const n=us(e);n.asyncQueue.verifyOperationInProgress(),ns(Lh,"RemoteStore received new credentials");const r=Wh(n);n.Ea.add(3),await Vh(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await jh(n)}async function ud(e,t){const n=us(e);t?(n.Ea.delete(2),await jh(n)):t||(n.Ea.add(2),await Vh(n),n.Ra.set("Unknown"))}function hd(e){return e.ma||(e.ma=function(e,t,n){const r=us(e);return r.sa(),new Oh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Gh.bind(null,e),t_:Jh.bind(null,e),r_:Qh.bind(null,e),H_:Xh.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),Hh(e)?qh(e):e.Ra.set("Unknown")):(await e.ma.stop(),Kh(e))})),e.ma}function dd(e){return e.fa||(e.fa=function(e,t,n){const r=us(e);return r.sa(),new Mh(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:sd.bind(null,e),r_:ld.bind(null,e),ta:od.bind(null,e),na:ad.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await ed(e)):(await e.fa.stop(),e.Ta.length>0&&(ns(Lh,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}class fd{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new fs,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new fd(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ds(hs.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function pd(e,t){if(rs("AsyncQueue",`${t}: ${e}`),so(e))return new ds(hs.UNAVAILABLE,`${t}: ${e}`);throw e}class md{static emptySet(e){return new md(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||Ps.comparator(t.key,n.key):(e,t)=>Ps.comparator(e.key,t.key),this.keyedMap=Nl(),this.sortedSet=new Bo(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof md))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new md;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class gd{constructor(){this.ga=new Bo(Ps.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):as(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class yd{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new yd(e,t,md.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&wl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class vd{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class wd{constructor(){this.queries=bd(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=us(e),r=n.queries;n.queries=bd(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new ds(hs.ABORTED,"Firestore shutting down"))}}function bd(){return new Tl(e=>bl(e),wl)}async function Sd(e,t){const n=us(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.ba()&&t.Da()&&(r=2):(s=new vd,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=pd(e,`Initialization of query '${Sl(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.Sa.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&Cd(n)}async function kd(e,t){const n=us(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?i=t.Da()?0:1:!s.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Ed(e,t){const n=us(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(i)&&(r=!0);t.wa=i}}r&&Cd(n)}function xd(e,t,n){const r=us(e),i=r.queries.get(t);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(t)}function Cd(e){e.Ca.forEach(e=>{e.next()})}var Td,_d;(_d=Td||(Td={})).Ma="default",_d.Cache="cache";class Id{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new yd(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=yd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Td.Cache}}class Ad{constructor(e){this.key=e}}class Nd{constructor(e){this.key=e}}class Od{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Fl(),this.mutatedKeys=Fl(),this.eu=xl(e),this.tu=new md(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new gd,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const c=r.get(e),u=kl(this.query,t)?t:null,h=!!c&&this.mutatedKeys.has(c.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;c&&u?c.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.su(c,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.eu(u,a)>0||l&&this.eu(u,l)<0)&&(o=!0)):!c&&u?(n.track({type:0,doc:u}),f=!0):c&&!u&&(n.track({type:1,doc:c}),f=!0,(a||l)&&(o=!0)),f&&(u?(s=s.add(u),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:s,iu:n,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return as(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=r??!1;const o=t&&!r?this._u():[],a=0===this.Xa.size&&this.current&&!r?1:0,l=a!==this.Za;return this.Za=a,0!==s.length||l?{snapshot:new yd(this.query,e.tu,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new gd,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Fl(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Nd(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new Ad(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Fl();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return yd.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const Md="SyncEngine";class Rd{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Dd{constructor(e){this.key=e,this.hu=!1}}class Pd{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Tl(e=>bl(e),wl),this.Iu=new Map,this.Eu=new Set,this.du=new Bo(Ps.comparator),this.Au=new Map,this.Ru=new $u,this.Vu={},this.mu=new Map,this.fu=Au.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Ld(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=rf(e);let i;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await jd(r,t,n,!0),i}async function Fd(e,t){const n=rf(e);await jd(n,t,!0,!1)}async function jd(e,t,n,r){const i=await ch(e.localStore,ml(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await Vd(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&zh(e.remoteStore,i),a}async function Vd(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await hh(e.localStore,t.query,!1).then(e=>{let{documents:n}=e;return t.view.ru(n,i)}));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return Xd(e,t.targetId,a.au),a.snapshot}(e,t,n,r);const s=await hh(e.localStore,t,!0),o=new Od(t,s.Qs),a=o.ru(s.documents),l=Dc.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),c=o.applyChanges(a,e.isPrimaryClient,l);Xd(e,n,c.au);const u=new Rd(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),c.snapshot}async function zd(e,t,n){const r=us(e),i=r.Tu.get(t),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter(e=>!wl(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await uh(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),n&&Uh(r.remoteStore,i.targetId),Jd(r,i.targetId)}).catch(no)):(Jd(r,i.targetId),await uh(r.localStore,i.targetId,!0))}async function Ud(e,t){const n=us(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Uh(n.remoteStore,r.targetId))}async function Bd(e,t){const n=us(e);try{const e=await function(e,t){const n=us(e),r=t.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const s=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const o=[];t.targetChanges.forEach((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Pi.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Pi.addMatchingKeys(e,s.addedDocuments,a)));let c=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(Jo.EMPTY_BYTE_STRING,Ks.min()).withLastLimboFreeSnapshotVersion(Ks.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(l,c,s)&&o.push(n.Pi.updateTargetData(e,c))});let a=Il(),l=Fl();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(ah(e,s,t.documentUpdates).next(e=>{a=e.ks,l=e.qs})),!r.isEqual(Ks.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return ro.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Ms=i,e))}(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(cs(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?cs(r.hu,14607):e.removedDocuments.size>0&&(cs(r.hu,42227),r.hu=!1))}),await ef(n,e,t)}catch(e){await no(e)}}function $d(e,t,n){const r=us(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){const n=us(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const i of n.Sa)i.va(t)&&(r=!0)}),r&&Cd(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function qd(e,t,n){const r=us(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Au.get(t),s=i&&i.key;if(s){let e=new Bo(Ps.comparator);e=e.insert(s,Pa.newNoDocument(s,Ks.min()));const n=Fl().add(s),i=new Rc(Ks.min(),new Map,new Bo(xs),e,n);await Bd(r,i),r.du=r.du.remove(s),r.Au.delete(t),Zd(r)}else await uh(r.localStore,t,!1).then(()=>Jd(r,t,n)).catch(no)}async function Hd(e,t){const n=us(e),r=t.batch.batchId;try{const e=await function(e,t){const n=us(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=ro.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const s=n.docVersions.get(e);cs(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))}(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Fl();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);Gd(n,r,null),Kd(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ef(n,e)}catch(e){await no(e)}}async function Wd(e,t,n){const r=us(e);try{const e=await function(e,t){const n=us(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(cs(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);Gd(r,t,n),Kd(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await ef(r,e)}catch(n){await no(n)}}function Kd(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function Gd(e,t,n){const r=us(e);let i=r.Vu[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function Jd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Qd(e,t)})}function Qd(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Uh(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Zd(e))}function Xd(e,t,n){for(const r of n)r instanceof Ad?(e.Ru.addReference(r.key,t),Yd(e,r)):r instanceof Nd?(ns(Md,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Qd(e,r.key)):as(19791,{wu:r})}function Yd(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(ns(Md,"New document in limbo: "+n),e.Eu.add(r),Zd(e))}function Zd(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new Ps(Ms.fromString(t)),r=e.fu.next();e.Au.set(r,new Dd(n)),e.du=e.du.insert(n,r),zh(e.remoteStore,new bu(ml(hl(n.path)),r,"TargetPurposeLimboResolution",oo.ce))}}async function ef(e,t,n){const r=us(e),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((e,a)=>{o.push(r.pu(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){const t=e?!e.fromCache:n?.targetChanges.get(a.targetId)?.current;r.sharedClientState.updateQueryState(a.targetId,t?"current":"not-current")}if(e){i.push(e);const t=Zu.As(a.targetId,e);s.push(t)}}))}),await Promise.all(o),r.Pu.H_(i),await async function(e,t){const n=us(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>ro.forEach(t,t=>ro.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>ro.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!so(e))throw e;ns(nh,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,i)}}}(r.localStore,s))}async function tf(e,t){const n=us(e);if(!n.currentUser.isEqual(t)){ns(Md,"User change. New user:",t.toKey());const e=await sh(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach(e=>{e.forEach(e=>{e.reject(new ds(hs.CANCELLED,t))})}),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await ef(n,e.Ls)}}function nf(e,t){const n=us(e),r=n.Au.get(t);if(r&&r.hu)return Fl().add(r.key);{let e=Fl();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function rf(e){const t=us(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Bd.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=nf.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=qd.bind(null,t),t.Pu.H_=Ed.bind(null,t.eventManager),t.Pu.yu=xd.bind(null,t.eventManager),t}function sf(e){const t=us(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Hd.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Wd.bind(null,t),t}class of{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=_h(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return ih(this.persistence,new th,e.initialUser,this.serializer)}Cu(e){return new Ju(Xu.mi,this.serializer)}Du(e){return new ph}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}of.provider={build:()=>new of};class af extends of{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){cs(this.persistence.referenceDelegate instanceof Yu,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Du(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?Iu.withCacheSize(this.cacheSizeBytes):Iu.DEFAULT;return new Ju(e=>Yu.mi(e,t),this.serializer)}}class lf{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>$d(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=tf.bind(null,this.syncEngine),await ud(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new wd}createDatastore(e){const t=_h(e.databaseInfo.databaseId),n=function(e){return new Ch(e)}(e.databaseInfo);return function(e,t,n,r){return new Dh(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new Fh(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,e=>$d(this.syncEngine,e,0),yh.v()?new yh:new mh)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new Pd(e,t,n,r,i,s);return o&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){const t=us(e);ns(Lh,"RemoteStore shutting down."),t.Ea.add(5),await Vh(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}lf.provider={build:()=>new lf};class cf{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):rs("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const uf="FirestoreClient";class hf{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Yi.UNAUTHENTICATED,this.clientId=Es.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,async e=>{ns(uf,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(ns(uf,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new fs;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=pd(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function df(e,t){e.asyncQueue.verifyOperationInProgress(),ns(uf,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await sh(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function ff(e,t){e.asyncQueue.verifyOperationInProgress();const n=await pf(e);ns(uf,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>cd(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>cd(t.remoteStore,n)),e._onlineComponents=t}async function pf(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){ns(uf,"Using user provided OfflineComponentProvider");try{await df(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===hs.FAILED_PRECONDITION||e.code===hs.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;is("Error using user provided cache. Falling back to memory cache: "+n),await df(e,new of)}}else ns(uf,"Using default OfflineComponentProvider"),await df(e,new af(void 0));return e._offlineComponents}async function mf(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(ns(uf,"Using user provided OnlineComponentProvider"),await ff(e,e._uninitializedComponentsProvider._online)):(ns(uf,"Using default OnlineComponentProvider"),await ff(e,new lf))),e._onlineComponents}function gf(e){return mf(e).then(e=>e.syncEngine)}async function yf(e){const t=await mf(e),n=t.eventManager;return n.onListen=Ld.bind(null,t.syncEngine),n.onUnlisten=zd.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Fd.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=Ud.bind(null,t.syncEngine),n}function vf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new fs;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new cf({next:a=>{s.Nu(),t.enqueueAndForget(()=>kd(e,o));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new ds(hs.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new ds(hs.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new Id(hl(n.path),s,{includeMetadataChanges:!0,qa:!0});return Sd(e,o)}(await yf(e),e.asyncQueue,t,n,r)),r.promise}function wf(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new fs;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,i){const s=new cf({next:n=>{s.Nu(),t.enqueueAndForget(()=>kd(e,o)),n.fromCache&&"server"===r.source?i.reject(new ds(hs.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Id(n,s,{includeMetadataChanges:!0,qa:!0});return Sd(e,o)}(await yf(e),e.asyncQueue,t,n,r)),r.promise}function bf(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Sf=new Map,kf="firestore.googleapis.com",Ef=!0;class xf{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new ds(hs.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=kf,this.ssl=Ef}else this.host=e.host,this.ssl=e.ssl??Ef;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=_u;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<Ou)throw new ds(hs.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new ds(hs.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=bf(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new ds(hs.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new ds(hs.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new ds(hs.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Cf{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new xf({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ds(hs.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ds(hs.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new xf(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ms;switch(e.type){case"firstParty":return new ws(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ds(hs.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Sf.get(e);t&&(ns("ComponentProvider","Removing Datastore"),Sf.delete(e),t.terminate())}(this),Promise.resolve()}}function Tf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e=Us(e,Cf);const i=y(t),s=e._getSettings(),o={...s,emulatorOptions:e._getEmulatorOptions()},a=`${t}:${n}`;i&&(v(`https://${a}`),S("Firestore",!0)),s.host!==kf&&s.host!==a&&is("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const l={...s,host:a,ssl:i,emulatorOptions:r};if(!A(l,o)&&(e._setSettings(l),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Yi.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...e};return[c(JSON.stringify({alg:"none",type:"JWT"})),c(JSON.stringify(s)),""].join(".")}(r.mockUserToken,e._app?.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new ds(hs.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Yi(i)}e._authCredentials=new gs(new ps(t,n))}}class _f{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new _f(this.firestore,e,this._query)}}class If{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Af(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new If(this.firestore,e,this._key)}toJSON(){return{type:If._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if($s(t,If._jsonSchema))return new If(e,n||null,new Ps(Ms.fromString(t.referencePath)))}}If._jsonSchemaVersion="firestore/documentReference/1.0",If._jsonSchema={type:Bs("string",If._jsonSchemaVersion),referencePath:Bs("string")};class Af extends _f{constructor(e,t,n){super(e,t,hl(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new If(this.firestore,null,new Ps(e))}withConverter(e){return new Af(this.firestore,e,this._path)}}function Nf(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=L(e),Ls("collection","path",t),e instanceof Cf){const n=Ms.fromString(t,...r);return js(n),new Af(e,null,n)}{if(!(e instanceof If||e instanceof Af))throw new ds(hs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ms.fromString(t,...r));return js(n),new Af(e.firestore,null,n)}}function Of(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=L(e),1===arguments.length&&(t=Es.newId()),Ls("doc","path",t),e instanceof Cf){const n=Ms.fromString(t,...r);return Fs(n),new If(e,null,new Ps(n))}{if(!(e instanceof If||e instanceof Af))throw new ds(hs.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(Ms.fromString(t,...r));return Fs(n),new If(e.firestore,e instanceof Af?e.converter:null,new Ps(n))}}const Mf="AsyncQueue";class Rf{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new Ih(this,"async_queue_retry"),this._c=()=>{const e=Th();e&&ns(Mf,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Th();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Th();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new fs;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!so(e))throw e;ns(Mf,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,rs("INTERNAL UNHANDLED ERROR: ",Df(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=fd.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&as(47125,{Pc:Df(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function Df(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class Pf extends Cf{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Rf,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Rf(e),this._firestoreClient=void 0,await e}}}function Lf(e){if(e._terminated)throw new ds(hs.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Ff(e),e._firestoreClient}function Ff(e){const t=e._freezeSettings(),n=function(e,t,n,r){return new aa(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,bf(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||"",e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new hf(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){const t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}class jf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new jf(Jo.fromBase64String(e))}catch(e){throw new ds(hs.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new jf(Jo.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:jf._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($s(e,jf._jsonSchema))return jf.fromBase64String(e.bytes)}}jf._jsonSchemaVersion="firestore/bytes/1.0",jf._jsonSchema={type:Bs("string",jf._jsonSchemaVersion),bytes:Bs("string")};class Vf{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new ds(hs.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ds(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class zf{constructor(e){this._methodName=e}}class Uf{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ds(hs.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ds(hs.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xs(this._lat,e._lat)||xs(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Uf._jsonSchemaVersion}}static fromJSON(e){if($s(e,Uf._jsonSchema))return new Uf(e.latitude,e.longitude)}}Uf._jsonSchemaVersion="firestore/geoPoint/1.0",Uf._jsonSchema={type:Bs("string",Uf._jsonSchemaVersion),latitude:Bs("number"),longitude:Bs("number")};class Bf{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Bf._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($s(e,Bf._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new Bf(e.vectorValues);throw new ds(hs.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Bf._jsonSchemaVersion="firestore/vectorValue/1.0",Bf._jsonSchema={type:Bs("string",Bf._jsonSchemaVersion),vectorValues:Bs("object")};const $f=/^__.*__$/;class qf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new dc(e,this.data,this.fieldMask,t,this.fieldTransforms):new hc(e,this.data,t,this.fieldTransforms)}}class Hf{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new dc(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Wf(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw as(40011,{Ac:e})}}class Kf{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Kf({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return cp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(Wf(this.Ac)&&$f.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Gf{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||_h(e)}Cc(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new Kf({Ac:e,methodName:t,Dc:n,path:Ds.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Jf(e){const t=e._freezeSettings(),n=_h(e._databaseId);return new Gf(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Qf(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Cc(s.merge||s.mergeFields?2:0,t,n,i);sp("Data must be an object, but it was:",o,r);const a=rp(r,o);let l,c;if(s.merge)l=new Ko(o.fieldMask),c=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=op(t,r,n);if(!o.contains(i))throw new ds(hs.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);up(e,i)||e.push(i)}l=new Ko(e),c=o.fieldTransforms.filter(e=>l.covers(e.field))}else l=null,c=o.fieldTransforms;return new qf(new Ra(a),l,c)}class Xf extends zf{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xf}}class Yf extends zf{_toFieldTransform(e){return new tc(e.path,new Kl)}isEqual(e){return e instanceof Yf}}function Zf(e,t,n,r){const i=e.Cc(1,t,n);sp("Data must be an object, but it was:",i,r);const s=[],o=Ra.empty();zo(r,(e,r)=>{const a=lp(t,e,n);r=L(r);const l=i.yc(a);if(r instanceof Xf)s.push(a);else{const e=np(r,l);null!=e&&(s.push(a),o.set(a,e))}});const a=new Ko(s);return new Hf(o,a,i.fieldTransforms)}function ep(e,t,n,r,i,s){const o=e.Cc(1,t,n),a=[op(t,r,n)],l=[i];if(s.length%2!=0)throw new ds(hs.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(op(t,s[d])),l.push(s[d+1]);const c=[],u=Ra.empty();for(let d=a.length-1;d>=0;--d)if(!up(c,a[d])){const e=a[d];let t=l[d];t=L(t);const n=o.yc(e);if(t instanceof Xf)c.push(e);else{const r=np(t,n);null!=r&&(c.push(e),u.set(e,r))}}const h=new Ko(c);return new Hf(u,h,o.fieldTransforms)}function tp(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return np(n,e.Cc(r?4:3,t))}function np(e,t){if(ip(e=L(e)))return sp("Unsupported field value:",t,e),rp(e,t);if(e instanceof zf)return function(e,t){if(!Wf(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=np(i,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=L(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Bl(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ws.fromDate(e);return{timestampValue:Kc(t.serializer,n)}}if(e instanceof Ws){const n=new Ws(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Kc(t.serializer,n)}}if(e instanceof Uf)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof jf)return{bytesValue:Gc(t.serializer,e._byteString)};if(e instanceof If){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Xc(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Bf)return function(e,t){return{mapValue:{fields:{[ua]:{stringValue:fa},[pa]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return zl(t.serializer,e)})}}}}}}(e,t);throw t.Sc(`Unsupported field value: ${zs(e)}`)}(e,t)}function rp(e,t){const n={};return Uo(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):zo(e,(e,r)=>{const i=np(r,t.mc(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function ip(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ws||e instanceof Uf||e instanceof jf||e instanceof If||e instanceof zf||e instanceof Bf)}function sp(e,t,n){if(!ip(n)||!Vs(n)){const r=zs(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function op(e,t,n){if((t=L(t))instanceof Vf)return t._internalPath;if("string"==typeof t)return lp(e,t);throw cp("Field path arguments must be of type string or ",e,!1,void 0,n)}const ap=new RegExp("[~\\*/\\[\\]]");function lp(e,t,n){if(t.search(ap)>=0)throw cp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Vf(...t.split("."))._internalPath}catch(r){throw cp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function cp(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ds(hs.INVALID_ARGUMENT,a+e+l)}function up(e,t){return e.some(e=>e.isEqual(t))}class hp{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new If(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new dp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(fp("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class dp extends hp{data(){return super.data()}}function fp(e,t){return"string"==typeof t?lp(e,t):t instanceof Vf?t._internalPath:t._delegate._internalPath}function pp(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new ds(hs.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class mp{}class gp extends mp{}class yp extends gp{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new yp(e,t,n)}_apply(e){const t=this._parse(e);return kp(e._query,t),new _f(e.firestore,e.converter,yl(e._query,t))}_parse(e){const t=Jf(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new ds(hs.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Sp(o,s);const t=[];for(const n of o)t.push(bp(r,e,n));a={arrayValue:{values:t}}}else a=bp(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Sp(o,s),a=tp(n,t,o,"in"===s||"not-in"===s);return Ba.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class vp extends mp{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new vp(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:$a.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)kp(n,i),n=yl(n,i)}(e._query,t),new _f(e.firestore,e.converter,yl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class wp extends gp{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new wp(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new ds(hs.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ds(hs.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Va(t,n)}(e._query,this._field,this._direction);return new _f(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new cl(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function bp(e,t,n){if("string"==typeof(n=L(n))){if(""===n)throw new ds(hs.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!fl(t)&&-1!==n.indexOf("/"))throw new ds(hs.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Ms.fromString(n));if(!Ps.isDocumentKey(r))throw new ds(hs.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return xa(e,new Ps(r))}if(n instanceof If)return xa(e,n._key);throw new ds(hs.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${zs(n)}.`)}function Sp(e,t){if(!Array.isArray(e)||0===e.length)throw new ds(hs.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function kp(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new ds(hs.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new ds(hs.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Ep{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(ma(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Yo(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Zo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw as(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return zo(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){const t=e.fields?.[pa].arrayValue?.values?.map(e=>Yo(e.doubleValue));return new Bf(t)}convertGeoPoint(e){return new Uf(Yo(e.latitude),Yo(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=sa(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(oa(e));default:return null}}convertTimestamp(e){const t=Xo(e);return new Ws(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ms.fromString(e);cs(wu(n),9688,{name:e});const r=new ca(n.get(1),n.get(3)),i=new Ps(n.popFirst(5));return r.isEqual(t)||rs(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function xp(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Cp{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Tp extends hp{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new _p(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(fp("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ds(hs.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=Tp._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}Tp._jsonSchemaVersion="firestore/documentSnapshot/1.0",Tp._jsonSchema={type:Bs("string",Tp._jsonSchemaVersion),bundleSource:Bs("string","DocumentSnapshot"),bundleName:Bs("string"),bundle:Bs("string")};class _p extends Tp{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Ip{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Cp(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new _p(this._firestore,this._userDataWriter,n.key,n,new Cp(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ds(hs.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new _p(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Cp(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new _p(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Cp(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Ap(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ds(hs.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ip._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Es.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function Ap(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return as(61501,{type:e})}}Ip._jsonSchemaVersion="firestore/querySnapshot/1.0",Ip._jsonSchema={type:Bs("string",Ip._jsonSchemaVersion),bundleSource:Bs("string","QuerySnapshot"),bundleName:Bs("string"),bundle:Bs("string")};class Np extends Ep{constructor(e){super(),this.firestore=e}convertBytes(e){return new jf(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new If(this.firestore,null,t)}}function Op(e,t){return function(e,t){const n=new fs;return e.asyncQueue.enqueueAndForget(async()=>async function(e,t,n){const r=sf(e);try{const e=await function(e,t){const n=us(e),r=Ws.now(),i=t.reduce((e,t)=>e.add(t.key),Fl());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=Il(),l=Fl();return n.Ns.getEntries(e,i).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(i=>{s=i;const o=[];for(const e of t){const t=cc(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new dc(e.key,t,Da(t.value.mapValue),rc.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:Ol(s)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new Bo(xs)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await ef(r,e.changes),await ed(r.remoteStore)}catch(e){const t=pd(e,"Failed to persist write");n.reject(t)}}(await gf(e),t,n)),n.promise}(Lf(e),t)}function Mp(e,t,n){const r=n.docs.get(t._key),i=new Np(e);return new Tp(e,i,t._key,r,new Cp(n.hasPendingWrites,n.fromCache),t.converter)}function Rp(){return new Yf("serverTimestamp")}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Zi=e}(Xe),We(new F("firestore",(e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new Pf(new ys(e.getProvider("auth-internal")),new Ss(s,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ds(hs.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ca(e.options.projectId,t)}(s,r),s);return i={useFetchStreams:t,...i},o._setSettings(i),o},"PUBLIC").setMultipleInstances(!0)),et(Qi,Xi,e),et(Qi,Xi,"esm2020")}();const Dp=Ye({apiKey:"AIzaSyANMjeNyYyHIhkKoQkrP2LABl8MpQQ0cLo",authDomain:"typst-editor.firebaseapp.com",projectId:"typst-editor",storageBucket:"typst-editor.firebasestorage.app",messagingSenderId:"409169817373",appId:"1:409169817373:web:3755e9b92cfb0ac96d7bf4"}),Pp=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze();const t=Ke(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=Ke(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(A(n.getOptions(),t??{}))return e;gt(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:Ai,persistence:[Vr,wr,xr]}),r=m("authTokenSyncURL");if(r&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(i=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>Ri)return;const r=t?.token;Di!==r&&(Di=r,await fetch(i,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){L(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){L(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var i;const s=f("auth");return s&&Vn(n,`http://${s}`),n}(Dp),Lp=function(e,t){const n="object"==typeof e?e:Ze(),r="string"==typeof e?e:t||la,i=Ke(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=(e=>{const t=f(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&Tf(i,...e)}return i}(Dp);var Fp=n(579);const jp=(0,i.createContext)();function Vp(){return(0,i.useContext)(jp)}function zp(e){let{children:t}=e;const[n,r]=(0,i.useState)(null),[s,o]=(0,i.useState)(!0);(0,i.useEffect)(()=>{const e=function(e,t,n,r){return L(e).onAuthStateChanged(t,n,r)}(Pp,e=>{r(e),o(!1)});return e},[]);const a={currentUser:n,signup:function(e,t){return async function(e,t,n){if(Ge(e.app))return Promise.reject(wt(e));const r=_n(e),i=Fn(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",sr,"EMAIL_PASSWORD_PROVIDER"),s=await i.catch(t=>{throw"auth/password-does-not-meet-requirements"===t.code&&pr(e),t}),o=await or._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(o.user),o}(Pp,e,t)},login:function(e,t){return function(e,t,n){return Ge(e.app)?Promise.reject(wt(e)):fr(L(e),Yn.credential(t,n)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&pr(e),t})}(Pp,e,t)},loginWithGoogle:function(){const e=new nr;return async function(e,t,n){if(Ge(e.app))return Promise.reject(yt(e,"operation-not-supported-in-this-environment"));const r=_n(e);bt(e,t,Zn);const i=Hr(r,n);return new Yr(r,"signInViaPopup",t,i).executeNotNull()}(Pp,e)},logout:function(){return function(e){return L(e).signOut()}(Pp)}};return(0,Fp.jsx)(jp.Provider,{value:a,children:!s&&t})}function Up(e){let{onSwitchToSignup:t}=e;const[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)(""),[a,l]=(0,i.useState)(""),[c,u]=(0,i.useState)(!1),{login:h,loginWithGoogle:d}=Vp();return(0,Fp.jsx)("div",{className:"auth-container",children:(0,Fp.jsxs)("div",{className:"auth-card",children:[(0,Fp.jsx)("h2",{children:"\u767b\u5f55 Typst \u7f16\u8f91\u5668"}),a&&(0,Fp.jsx)("div",{className:"auth-error",children:a}),(0,Fp.jsxs)("form",{onSubmit:async function(e){e.preventDefault();try{l(""),u(!0),await h(n,s)}catch(t){l("\u767b\u5f55\u5931\u8d25: "+t.message)}u(!1)},children:[(0,Fp.jsxs)("div",{className:"form-group",children:[(0,Fp.jsx)("label",{children:"\u90ae\u7bb1"}),(0,Fp.jsx)("input",{type:"email",value:n,onChange:e=>r(e.target.value),required:!0,placeholder:"your@email.com"})]}),(0,Fp.jsxs)("div",{className:"form-group",children:[(0,Fp.jsx)("label",{children:"\u5bc6\u7801"}),(0,Fp.jsx)("input",{type:"password",value:s,onChange:e=>o(e.target.value),required:!0,placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]}),(0,Fp.jsx)("button",{type:"submit",disabled:c,className:"btn-primary",children:c?"\u767b\u5f55\u4e2d...":"\u767b\u5f55"})]}),(0,Fp.jsx)("div",{className:"auth-divider",children:"\u6216"}),(0,Fp.jsx)("button",{onClick:async function(){try{l(""),u(!0),await d()}catch(e){l("Google\u767b\u5f55\u5931\u8d25: "+e.message)}u(!1)},disabled:c,className:"btn-google",children:"\u4f7f\u7528 Google \u767b\u5f55"}),(0,Fp.jsxs)("div",{className:"auth-switch",children:["\u8fd8\u6ca1\u6709\u8d26\u6237\uff1f"," ",(0,Fp.jsx)("button",{onClick:t,className:"link-button",children:"\u6ce8\u518c"})]})]})})}function Bp(e){let{onSwitchToLogin:t}=e;const[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)(""),[a,l]=(0,i.useState)(""),[c,u]=(0,i.useState)(""),[h,d]=(0,i.useState)(!1),{signup:f,loginWithGoogle:p}=Vp();return(0,Fp.jsx)("div",{className:"auth-container",children:(0,Fp.jsxs)("div",{className:"auth-card",children:[(0,Fp.jsx)("h2",{children:"\u6ce8\u518c Typst \u7f16\u8f91\u5668"}),c&&(0,Fp.jsx)("div",{className:"auth-error",children:c}),(0,Fp.jsxs)("form",{onSubmit:async function(e){if(e.preventDefault(),s!==a)return u("\u5bc6\u7801\u4e0d\u5339\u914d");if(s.length<6)return u("\u5bc6\u7801\u81f3\u5c11\u9700\u89816\u4e2a\u5b57\u7b26");try{u(""),d(!0),await f(n,s)}catch(t){u("\u6ce8\u518c\u5931\u8d25: "+t.message)}d(!1)},children:[(0,Fp.jsxs)("div",{className:"form-group",children:[(0,Fp.jsx)("label",{children:"\u90ae\u7bb1"}),(0,Fp.jsx)("input",{type:"email",value:n,onChange:e=>r(e.target.value),required:!0,placeholder:"your@email.com"})]}),(0,Fp.jsxs)("div",{className:"form-group",children:[(0,Fp.jsx)("label",{children:"\u5bc6\u7801"}),(0,Fp.jsx)("input",{type:"password",value:s,onChange:e=>o(e.target.value),required:!0,placeholder:"\u81f3\u5c116\u4e2a\u5b57\u7b26"})]}),(0,Fp.jsxs)("div",{className:"form-group",children:[(0,Fp.jsx)("label",{children:"\u786e\u8ba4\u5bc6\u7801"}),(0,Fp.jsx)("input",{type:"password",value:a,onChange:e=>l(e.target.value),required:!0,placeholder:"\u518d\u6b21\u8f93\u5165\u5bc6\u7801"})]}),(0,Fp.jsx)("button",{type:"submit",disabled:h,className:"btn-primary",children:h?"\u6ce8\u518c\u4e2d...":"\u6ce8\u518c"})]}),(0,Fp.jsx)("div",{className:"auth-divider",children:"\u6216"}),(0,Fp.jsx)("button",{onClick:async function(){try{u(""),d(!0),await p()}catch(e){u("Google\u6ce8\u518c\u5931\u8d25: "+e.message)}d(!1)},disabled:h,className:"btn-google",children:"\u4f7f\u7528 Google \u6ce8\u518c"}),(0,Fp.jsxs)("div",{className:"auth-switch",children:["\u5df2\u6709\u8d26\u6237\uff1f"," ",(0,Fp.jsx)("button",{onClick:t,className:"link-button",children:"\u767b\u5f55"})]})]})})}var $p=n(950);function qp(e){this.content=e}qp.prototype={constructor:qp,find:function(e){for(var t=0;t<this.content.length;t+=2)if(this.content[t]===e)return t;return-1},get:function(e){var t=this.find(e);return-1==t?void 0:this.content[t+1]},update:function(e,t,n){var r=n&&n!=e?this.remove(n):this,i=r.find(e),s=r.content.slice();return-1==i?s.push(n||e,t):(s[i+1]=t,n&&(s[i]=n)),new qp(s)},remove:function(e){var t=this.find(e);if(-1==t)return this;var n=this.content.slice();return n.splice(t,2),new qp(n)},addToStart:function(e,t){return new qp([e,t].concat(this.remove(e).content))},addToEnd:function(e,t){var n=this.remove(e).content.slice();return n.push(e,t),new qp(n)},addBefore:function(e,t,n){var r=this.remove(t),i=r.content.slice(),s=r.find(e);return i.splice(-1==s?i.length:s,0,t,n),new qp(i)},forEach:function(e){for(var t=0;t<this.content.length;t+=2)e(this.content[t],this.content[t+1])},prepend:function(e){return(e=qp.from(e)).size?new qp(e.content.concat(this.subtract(e).content)):this},append:function(e){return(e=qp.from(e)).size?new qp(this.subtract(e).content.concat(e.content)):this},subtract:function(e){var t=this;e=qp.from(e);for(var n=0;n<e.content.length;n+=2)t=t.remove(e.content[n]);return t},toObject:function(){var e={};return this.forEach(function(t,n){e[t]=n}),e},get size(){return this.content.length>>1}},qp.from=function(e){if(e instanceof qp)return e;var t=[];if(e)for(var n in e)t.push(n,e[n]);return new qp(t)};const Hp=qp;function Wp(e,t,n){for(let r=0;;r++){if(r==e.childCount||r==t.childCount)return e.childCount==t.childCount?null:n;let i=e.child(r),s=t.child(r);if(i!=s){if(!i.sameMarkup(s))return n;if(i.isText&&i.text!=s.text){for(let e=0;i.text[e]==s.text[e];e++)n++;return n}if(i.content.size||s.content.size){let e=Wp(i.content,s.content,n+1);if(null!=e)return e}n+=i.nodeSize}else n+=i.nodeSize}}function Kp(e,t,n,r){for(let i=e.childCount,s=t.childCount;;){if(0==i||0==s)return i==s?null:{a:n,b:r};let o=e.child(--i),a=t.child(--s),l=o.nodeSize;if(o!=a){if(!o.sameMarkup(a))return{a:n,b:r};if(o.isText&&o.text!=a.text){let e=0,t=Math.min(o.text.length,a.text.length);for(;e<t&&o.text[o.text.length-e-1]==a.text[a.text.length-e-1];)e++,n--,r--;return{a:n,b:r}}if(o.content.size||a.content.size){let e=Kp(o.content,a.content,n-1,r-1);if(e)return e}n-=l,r-=l}else n-=l,r-=l}}class Gp{constructor(e,t){if(this.content=e,this.size=t||0,null==t)for(let n=0;n<e.length;n++)this.size+=e[n].nodeSize}nodesBetween(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4?arguments[4]:void 0;for(let s=0,o=0;o<t;s++){let a=this.content[s],l=o+a.nodeSize;if(l>e&&!1!==n(a,r+o,i||null,s)&&a.content.size){let i=o+1;a.nodesBetween(Math.max(0,e-i),Math.min(a.content.size,t-i),n,r+i)}o=l}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,n,r){let i="",s=!0;return this.nodesBetween(e,t,(o,a)=>{let l=o.isText?o.text.slice(Math.max(e,a)-a,t-a):o.isLeaf?r?"function"===typeof r?r(o):r:o.type.spec.leafText?o.type.spec.leafText(o):"":"";o.isBlock&&(o.isLeaf&&l||o.isTextblock)&&n&&(s?s=!1:i+=n),i+=l},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,n=e.firstChild,r=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(n)&&(r[r.length-1]=t.withText(t.text+n.text),i=1);i<e.content.length;i++)r.push(e.content[i]);return new Gp(r,this.size+e.size)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size;if(0==e&&t==this.size)return this;let n=[],r=0;if(t>e)for(let i=0,s=0;s<t;i++){let o=this.content[i],a=s+o.nodeSize;a>e&&((s<e||a>t)&&(o=o.isText?o.cut(Math.max(0,e-s),Math.min(o.text.length,t-s)):o.cut(Math.max(0,e-s-1),Math.min(o.content.size,t-s-1))),n.push(o),r+=o.nodeSize),s=a}return new Gp(n,r)}cutByIndex(e,t){return e==t?Gp.empty:0==e&&t==this.content.length?this:new Gp(this.content.slice(e,t))}replaceChild(e,t){let n=this.content[e];if(n==t)return this;let r=this.content.slice(),i=this.size+t.nodeSize-n.nodeSize;return r[e]=t,new Gp(r,i)}addToStart(e){return new Gp([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new Gp(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,n=0;t<this.content.length;t++){let r=this.content[t];e(r,n,t),n+=r.nodeSize}}findDiffStart(e){return Wp(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0)}findDiffEnd(e){return Kp(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.size,arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.size)}findIndex(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(0==e)return Qp(0,e);if(e==this.size)return Qp(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let n=0,r=0;;n++){let i=r+this.child(n).nodeSize;if(i>=e)return i==e||t>0?Qp(n+1,i):Qp(n,r);r=i}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return Gp.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new Gp(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return Gp.empty;let t,n=0;for(let r=0;r<e.length;r++){let i=e[r];n+=i.nodeSize,r&&i.isText&&e[r-1].sameMarkup(i)?(t||(t=e.slice(0,r)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new Gp(t||e,n)}static from(e){if(!e)return Gp.empty;if(e instanceof Gp)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new Gp([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}Gp.empty=new Gp([],0);const Jp={index:0,offset:0};function Qp(e,t){return Jp.index=e,Jp.offset=t,Jp}function Xp(e,t){if(e===t)return!0;if(!e||"object"!=typeof e||!t||"object"!=typeof t)return!1;let n=Array.isArray(e);if(Array.isArray(t)!=n)return!1;if(n){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!Xp(e[n],t[n]))return!1}else{for(let n in e)if(!(n in t)||!Xp(e[n],t[n]))return!1;for(let n in t)if(!(n in e))return!1}return!0}class Yp{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,n=!1;for(let r=0;r<e.length;r++){let i=e[r];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,r));else{if(i.type.excludes(this.type))return e;!n&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,r)),t.push(this),n=!0),t&&t.push(i)}}return t||(t=e.slice()),n||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&Xp(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let n=e.marks[t.type];if(!n)throw new RangeError(`There is no mark type ${t.type} in this schema`);let r=n.create(t.attrs);return n.checkAttrs(r.attrs),r}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].eq(t[n]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&0==e.length)return Yp.none;if(e instanceof Yp)return[e];let t=e.slice();return t.sort((e,t)=>e.type.rank-t.type.rank),t}}Yp.none=[];class Zp extends Error{}class em{constructor(e,t,n){this.content=e,this.openStart=t,this.openEnd=n}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let n=nm(this.content,e+this.openStart,t);return n&&new em(n,this.openStart,this.openEnd)}removeBetween(e,t){return new em(tm(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return em.empty;let n=t.openStart||0,r=t.openEnd||0;if("number"!=typeof n||"number"!=typeof r)throw new RangeError("Invalid input for Slice.fromJSON");return new em(Gp.fromJSON(e,t.content),n,r)}static maxOpen(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=0,r=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)n++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)r++;return new em(e,n,r)}}function tm(e,t,n){let{index:r,offset:i}=e.findIndex(t),s=e.maybeChild(r),{index:o,offset:a}=e.findIndex(n);if(i==t||s.isText){if(a!=n&&!e.child(o).isText)throw new RangeError("Removing non-flat range");return e.cut(0,t).append(e.cut(n))}if(r!=o)throw new RangeError("Removing non-flat range");return e.replaceChild(r,s.copy(tm(s.content,t-i-1,n-i-1)))}function nm(e,t,n,r){let{index:i,offset:s}=e.findIndex(t),o=e.maybeChild(i);if(s==t||o.isText)return r&&!r.canReplace(i,i,n)?null:e.cut(0,t).append(n).append(e.cut(t));let a=nm(o.content,t-s-1,n);return a&&e.replaceChild(i,o.copy(a))}function rm(e,t,n){if(n.openStart>e.depth)throw new Zp("Inserted content deeper than insertion position");if(e.depth-n.openStart!=t.depth-n.openEnd)throw new Zp("Inconsistent open depths");return im(e,t,n,0)}function im(e,t,n,r){let i=e.index(r),s=e.node(r);if(i==t.index(r)&&r<e.depth-n.openStart){let o=im(e,t,n,r+1);return s.copy(s.content.replaceChild(i,o))}if(n.content.size){if(n.openStart||n.openEnd||e.depth!=r||t.depth!=r){let{start:i,end:o}=function(e,t){let n=t.depth-e.openStart,r=t.node(n).copy(e.content);for(let i=n-1;i>=0;i--)r=t.node(i).copy(Gp.from(r));return{start:r.resolveNoCache(e.openStart+n),end:r.resolveNoCache(r.content.size-e.openEnd-n)}}(n,e);return cm(s,um(e,i,o,t,r))}{let r=e.parent,i=r.content;return cm(r,i.cut(0,e.parentOffset).append(n.content).append(i.cut(t.parentOffset)))}}return cm(s,hm(e,t,r))}function sm(e,t){if(!t.type.compatibleContent(e.type))throw new Zp("Cannot join "+t.type.name+" onto "+e.type.name)}function om(e,t,n){let r=e.node(n);return sm(r,t.node(n)),r}function am(e,t){let n=t.length-1;n>=0&&e.isText&&e.sameMarkup(t[n])?t[n]=e.withText(t[n].text+e.text):t.push(e)}function lm(e,t,n,r){let i=(t||e).node(n),s=0,o=t?t.index(n):i.childCount;e&&(s=e.index(n),e.depth>n?s++:e.textOffset&&(am(e.nodeAfter,r),s++));for(let a=s;a<o;a++)am(i.child(a),r);t&&t.depth==n&&t.textOffset&&am(t.nodeBefore,r)}function cm(e,t){return e.type.checkContent(t),e.copy(t)}function um(e,t,n,r,i){let s=e.depth>i&&om(e,t,i+1),o=r.depth>i&&om(n,r,i+1),a=[];return lm(null,e,i,a),s&&o&&t.index(i)==n.index(i)?(sm(s,o),am(cm(s,um(e,t,n,r,i+1)),a)):(s&&am(cm(s,hm(e,t,i+1)),a),lm(t,n,i,a),o&&am(cm(o,hm(n,r,i+1)),a)),lm(r,null,i,a),new Gp(a)}function hm(e,t,n){let r=[];if(lm(null,e,n,r),e.depth>n){am(cm(om(e,t,n+1),hm(e,t,n+1)),r)}return lm(t,null,n,r),new Gp(r)}em.empty=new em(Gp.empty,0,0);class dm{constructor(e,t,n){this.pos=e,this.path=t,this.parentOffset=n,this.depth=t.length/3-1}resolveDepth(e){return null==e?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[3*this.resolveDepth(e)]}index(e){return this.path[3*this.resolveDepth(e)+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e!=this.depth||this.textOffset?1:0)}start(e){return 0==(e=this.resolveDepth(e))?0:this.path[3*e-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]}after(e){if(!(e=this.resolveDepth(e)))throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[3*e-1]+this.path[3*e].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let n=this.pos-this.path[this.path.length-1],r=e.child(t);return n?e.child(t).cut(n):r}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):0==e?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let n=this.path[3*t],r=0==t?0:this.path[3*t-1]+1;for(let i=0;i<e;i++)r+=n.child(i).nodeSize;return r}marks(){let e=this.parent,t=this.index();if(0==e.content.size)return Yp.none;if(this.textOffset)return e.child(t).marks;let n=e.maybeChild(t-1),r=e.maybeChild(t);if(!n){let e=n;n=r,r=e}let i=n.marks;for(var s=0;s<i.length;s++)!1!==i[s].type.spec.inclusive||r&&i[s].isInSet(r.marks)||(i=i[s--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let n=t.marks,r=e.parent.maybeChild(e.index());for(var i=0;i<n.length;i++)!1!==n[i].type.spec.inclusive||r&&n[i].isInSet(r.marks)||(n=n[i--].removeFromSet(n));return n}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=arguments.length>1?arguments[1]:void 0;if(e.pos<this.pos)return e.blockRange(this);for(let n=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);n>=0;n--)if(e.pos<=this.end(n)&&(!t||t(this.node(n))))return new gm(this,e,n);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let n=[],r=0,i=t;for(let s=e;;){let{index:e,offset:t}=s.content.findIndex(i),o=i-t;if(n.push(s,e,r+t),!o)break;if(s=s.child(e),s.isText)break;i=o-1,r+=t+1}return new dm(t,n,i)}static resolveCached(e,t){let n=mm.get(e);if(n)for(let i=0;i<n.elts.length;i++){let e=n.elts[i];if(e.pos==t)return e}else mm.set(e,n=new fm);let r=n.elts[n.i]=dm.resolve(e,t);return n.i=(n.i+1)%pm,r}}class fm{constructor(){this.elts=[],this.i=0}}const pm=12,mm=new WeakMap;class gm{constructor(e,t,n){this.$from=e,this.$to=t,this.depth=n}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const ym=Object.create(null);class vm{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Yp.none;this.type=e,this.attrs=t,this.marks=r,this.content=n||Gp.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.content.nodesBetween(e,t,n,r,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,n,r){return this.content.textBetween(e,t,n,r)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,n){return this.type==e&&Xp(this.attrs,t||e.defaultAttrs||ym)&&Yp.sameSet(this.marks,n||Yp.none)}copy(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e==this.content?this:new vm(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new vm(this.type,this.attrs,this.content,e)}cut(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size;return 0==e&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.content.size,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e==t)return em.empty;let r=this.resolve(e),i=this.resolve(t),s=n?0:r.sharedDepth(t),o=r.start(s),a=r.node(s).content.cut(r.pos-o,i.pos-o);return new em(a,r.depth-s,i.depth-s)}replace(e,t,n){return rm(this.resolve(e),this.resolve(t),n)}nodeAt(e){for(let t=this;;){let{index:n,offset:r}=t.content.findIndex(e);if(t=t.maybeChild(n),!t)return null;if(r==e||t.isText)return t;e-=r+1}}childAfter(e){let{index:t,offset:n}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:n}}childBefore(e){if(0==e)return{node:null,index:0,offset:0};let{index:t,offset:n}=this.content.findIndex(e);if(n<e)return{node:this.content.child(t),index:t,offset:n};let r=this.content.child(t-1);return{node:r,index:t-1,offset:n-r.nodeSize}}resolve(e){return dm.resolveCached(this,e)}resolveNoCache(e){return dm.resolve(this,e)}rangeHasMark(e,t,n){let r=!1;return t>e&&this.nodesBetween(e,t,e=>(n.isInSet(e.marks)&&(r=!0),!r)),r}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),bm(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gp.empty,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:n.childCount,s=this.contentMatchAt(e).matchFragment(n,r,i),o=s&&s.matchFragment(this.content,t);if(!o||!o.validEnd)return!1;for(let a=r;a<i;a++)if(!this.type.allowsMarks(n.child(a).marks))return!1;return!0}canReplaceWith(e,t,n,r){if(r&&!this.type.allowsMarks(r))return!1;let i=this.contentMatchAt(e).matchType(n),s=i&&i.matchFragment(this.content,t);return!!s&&s.validEnd}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Yp.none;for(let t=0;t<this.marks.length;t++){let n=this.marks[t];n.type.checkAttrs(n.attrs),e=n.addToSet(e)}if(!Yp.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(e=>e.type.name)}`);this.content.forEach(e=>e.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(e=>e.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let n;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");n=t.marks.map(e.markFromJSON)}if("text"==t.type){if("string"!=typeof t.text)throw new RangeError("Invalid text node in JSON");return e.text(t.text,n)}let r=Gp.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,r,n);return i.type.checkAttrs(i.attrs),i}}vm.prototype.text=void 0;class wm extends vm{constructor(e,t,n,r){if(super(e,t,null,r),!n)throw new RangeError("Empty text nodes are not allowed");this.text=n}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):bm(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new wm(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new wm(this.type,this.attrs,e,this.marks)}cut(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.text.length;return 0==e&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function bm(e,t){for(let n=e.length-1;n>=0;n--)t=e[n].type.name+"("+t+")";return t}class Sm{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let n=new km(e,t);if(null==n.next)return Sm.empty;let r=Em(n);n.next&&n.err("Unexpected trailing text");let i=function(e){let t=Object.create(null);return n(Am(e,0));function n(r){let i=[];r.forEach(t=>{e[t].forEach(t=>{let n,{term:r,to:s}=t;if(r){for(let e=0;e<i.length;e++)i[e][0]==r&&(n=i[e][1]);Am(e,s).forEach(e=>{n||i.push([r,n=[]]),-1==n.indexOf(e)&&n.push(e)})}})});let s=t[r.join(",")]=new Sm(r.indexOf(e.length-1)>-1);for(let e=0;e<i.length;e++){let r=i[e][1].sort(Im);s.next.push({type:i[e][0],next:t[r.join(",")]||n(r)})}return s}}(function(e){let t=[[]];return i(s(e,0),n()),t;function n(){return t.push([])-1}function r(e,n,r){let i={term:r,to:n};return t[e].push(i),i}function i(e,t){e.forEach(e=>e.to=t)}function s(e,t){if("choice"==e.type)return e.exprs.reduce((e,n)=>e.concat(s(n,t)),[]);if("seq"!=e.type){if("star"==e.type){let o=n();return r(t,o),i(s(e.expr,o),o),[r(o)]}if("plus"==e.type){let o=n();return i(s(e.expr,t),o),i(s(e.expr,o),o),[r(o)]}if("opt"==e.type)return[r(t)].concat(s(e.expr,t));if("range"==e.type){let o=t;for(let t=0;t<e.min;t++){let t=n();i(s(e.expr,o),t),o=t}if(-1==e.max)i(s(e.expr,o),o);else for(let t=e.min;t<e.max;t++){let t=n();r(o,t),i(s(e.expr,o),t),o=t}return[r(o)]}if("name"==e.type)return[r(t,void 0,e.value)];throw new Error("Unknown expr type")}for(let r=0;;r++){let o=s(e.exprs[r],t);if(r==e.exprs.length-1)return o;i(o,t=n())}}}(r));return function(e,t){for(let n=0,r=[e];n<r.length;n++){let e=r[n],i=!e.validEnd,s=[];for(let t=0;t<e.next.length;t++){let{type:n,next:o}=e.next[t];s.push(n.name),!i||n.isText||n.hasRequiredAttrs()||(i=!1),-1==r.indexOf(o)&&r.push(o)}i&&t.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(i,n),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.childCount,r=this;for(let i=t;r&&i<n;i++)r=r.matchType(e.child(i).type);return r}get inlineContent(){return 0!=this.next.length&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!t.isText&&!t.hasRequiredAttrs())return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let n=0;n<e.next.length;n++)if(this.next[t].type==e.next[n].type)return!0;return!1}fillBefore(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[this];return function i(s,o){let a=s.matchFragment(e,n);if(a&&(!t||a.validEnd))return Gp.from(o.map(e=>e.createAndFill()));for(let e=0;e<s.next.length;e++){let{type:t,next:n}=s.next[e];if(!t.isText&&!t.hasRequiredAttrs()&&-1==r.indexOf(n)){r.push(n);let e=i(n,o.concat(t));if(e)return e}}return null}(this,[])}findWrapping(e){for(let n=0;n<this.wrapCache.length;n+=2)if(this.wrapCache[n]==e)return this.wrapCache[n+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),n=[{match:this,type:null,via:null}];for(;n.length;){let r=n.shift(),i=r.match;if(i.matchType(e)){let e=[];for(let t=r;t.type;t=t.via)e.push(t.type);return e.reverse()}for(let e=0;e<i.next.length;e++){let{type:s,next:o}=i.next[e];s.isLeaf||s.hasRequiredAttrs()||s.name in t||r.type&&!o.validEnd||(n.push({match:s.contentMatch,type:s,via:r}),t[s.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];return function t(n){e.push(n);for(let r=0;r<n.next.length;r++)-1==e.indexOf(n.next[r].next)&&t(n.next[r].next)}(this),e.map((t,n)=>{let r=n+(t.validEnd?"*":" ")+" ";for(let i=0;i<t.next.length;i++)r+=(i?", ":"")+t.next[i].type.name+"->"+e.indexOf(t.next[i].next);return r}).join("\n")}}Sm.empty=new Sm(!0);class km{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Em(e){let t=[];do{t.push(xm(e))}while(e.eat("|"));return 1==t.length?t[0]:{type:"choice",exprs:t}}function xm(e){let t=[];do{t.push(Cm(e))}while(e.next&&")"!=e.next&&"|"!=e.next);return 1==t.length?t[0]:{type:"seq",exprs:t}}function Cm(e){let t=function(e){if(e.eat("(")){let t=Em(e);return e.eat(")")||e.err("Missing closing paren"),t}if(!/\W/.test(e.next)){let t=function(e,t){let n=e.nodeTypes,r=n[t];if(r)return[r];let i=[];for(let s in n){let e=n[s];e.isInGroup(t)&&i.push(e)}0==i.length&&e.err("No node type or group '"+t+"' found");return i}(e,e.next).map(t=>(null==e.inline?e.inline=t.isInline:e.inline!=t.isInline&&e.err("Mixing inline and block content"),{type:"name",value:t}));return e.pos++,1==t.length?t[0]:{type:"choice",exprs:t}}e.err("Unexpected token '"+e.next+"'")}(e);for(;;)if(e.eat("+"))t={type:"plus",expr:t};else if(e.eat("*"))t={type:"star",expr:t};else if(e.eat("?"))t={type:"opt",expr:t};else{if(!e.eat("{"))break;t=_m(e,t)}return t}function Tm(e){/\D/.test(e.next)&&e.err("Expected number, got '"+e.next+"'");let t=Number(e.next);return e.pos++,t}function _m(e,t){let n=Tm(e),r=n;return e.eat(",")&&(r="}"!=e.next?Tm(e):-1),e.eat("}")||e.err("Unclosed braced range"),{type:"range",min:n,max:r,expr:t}}function Im(e,t){return t-e}function Am(e,t){let n=[];return function t(r){let i=e[r];if(1==i.length&&!i[0].term)return t(i[0].to);n.push(r);for(let e=0;e<i.length;e++){let{term:r,to:s}=i[e];r||-1!=n.indexOf(s)||t(s)}}(t),n.sort(Im)}function Nm(e){let t=Object.create(null);for(let n in e){let r=e[n];if(!r.hasDefault)return null;t[n]=r.default}return t}function Om(e,t){let n=Object.create(null);for(let r in e){let i=t&&t[r];if(void 0===i){let t=e[r];if(!t.hasDefault)throw new RangeError("No value supplied for attribute "+r);i=t.default}n[r]=i}return n}function Mm(e,t,n,r){for(let i in t)if(!(i in e))throw new RangeError(`Unsupported attribute ${i} for ${n} of type ${i}`);for(let i in e){let n=e[i];n.validate&&n.validate(t[i])}}function Rm(e,t){let n=Object.create(null);if(t)for(let r in t)n[r]=new Pm(e,r,t[r]);return n}class Dm{constructor(e,t,n){this.name=e,this.schema=t,this.spec=n,this.markSet=null,this.groups=n.group?n.group.split(" "):[],this.attrs=Rm(e,n.attrs),this.defaultAttrs=Nm(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(n.inline||"text"==e),this.isText="text"==e}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==Sm.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Om(this.attrs,e)}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new vm(this,this.computeAttrs(e),Gp.from(t),Yp.setFrom(n))}createChecked(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return t=Gp.from(t),this.checkContent(t),new vm(this,this.computeAttrs(e),t,Yp.setFrom(n))}createAndFill(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(e=this.computeAttrs(e),t=Gp.from(t),t.size){let e=this.contentMatch.fillBefore(t);if(!e)return null;t=e.append(t)}let r=this.contentMatch.matchFragment(t),i=r&&r.fillBefore(Gp.empty,!0);return i?new vm(this,e,t.append(i),Yp.setFrom(n)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let n=0;n<e.childCount;n++)if(!this.allowsMarks(e.child(n).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Mm(this.attrs,e,"node",this.name)}allowsMarkType(e){return null==this.markSet||this.markSet.indexOf(e)>-1}allowsMarks(e){if(null==this.markSet)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(null==this.markSet)return e;let t;for(let n=0;n<e.length;n++)this.allowsMarkType(e[n].type)?t&&t.push(e[n]):t||(t=e.slice(0,n));return t?t.length?t:Yp.none:e}static compile(e,t){let n=Object.create(null);e.forEach((e,r)=>n[e]=new Dm(e,t,r));let r=t.spec.topNode||"doc";if(!n[r])throw new RangeError("Schema is missing its top node type ('"+r+"')");if(!n.text)throw new RangeError("Every schema needs a 'text' type");for(let i in n.text.attrs)throw new RangeError("The text node type should not have attributes");return n}}class Pm{constructor(e,t,n){this.hasDefault=Object.prototype.hasOwnProperty.call(n,"default"),this.default=n.default,this.validate="string"==typeof n.validate?function(e,t,n){let r=n.split("|");return n=>{let i=null===n?"null":typeof n;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${t} on type ${e}, got ${i}`)}}(e,t,n.validate):n.validate}get isRequired(){return!this.hasDefault}}class Lm{constructor(e,t,n,r){this.name=e,this.rank=t,this.schema=n,this.spec=r,this.attrs=Rm(e,r.attrs),this.excluded=null;let i=Nm(this.attrs);this.instance=i?new Yp(this,i):null}create(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return!e&&this.instance?this.instance:new Yp(this,Om(this.attrs,e))}static compile(e,t){let n=Object.create(null),r=0;return e.forEach((e,i)=>n[e]=new Lm(e,r++,t,i)),n}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Mm(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class Fm{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let r in e)t[r]=e[r];t.nodes=Hp.from(e.nodes),t.marks=Hp.from(e.marks||{}),this.nodes=Dm.compile(this.spec.nodes,this),this.marks=Lm.compile(this.spec.marks,this);let n=Object.create(null);for(let r in this.nodes){if(r in this.marks)throw new RangeError(r+" can not be both a node and a mark");let e=this.nodes[r],t=e.spec.content||"",i=e.spec.marks;if(e.contentMatch=n[t]||(n[t]=Sm.parse(t,this.nodes)),e.inlineContent=e.contentMatch.inlineContent,e.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!e.isInline||!e.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=e}e.markSet="_"==i?null:i?jm(this,i.split(" ")):""!=i&&e.inlineContent?null:[]}for(let r in this.marks){let e=this.marks[r],t=e.spec.excludes;e.excluded=null==t?[e]:""==t?[]:jm(this,t.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if("string"==typeof e)e=this.nodeType(e);else{if(!(e instanceof Dm))throw new RangeError("Invalid node type: "+e);if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}return e.createChecked(t,n,r)}text(e,t){let n=this.nodes.text;return new wm(n,n.defaultAttrs,e,Yp.setFrom(t))}mark(e,t){return"string"==typeof e&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return vm.fromJSON(this,e)}markFromJSON(e){return Yp.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function jm(e,t){let n=[];for(let r=0;r<t.length;r++){let i=t[r],s=e.marks[i],o=s;if(s)n.push(s);else for(let t in e.marks){let r=e.marks[t];("_"==i||r.spec.group&&r.spec.group.split(" ").indexOf(i)>-1)&&n.push(o=r)}if(!o)throw new SyntaxError("Unknown mark type: '"+t[r]+"'")}return n}class Vm{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let n=this.matchedStyles=[];t.forEach(e=>{if(function(e){return null!=e.tag}(e))this.tags.push(e);else if(function(e){return null!=e.style}(e)){let t=/[^=]*/.exec(e.style)[0];n.indexOf(t)<0&&n.push(t),this.styles.push(e)}}),this.normalizeLists=!this.tags.some(t=>{if(!/^(ul|ol)\b/.test(t.tag)||!t.node)return!1;let n=e.nodes[t.node];return n.contentMatch.matchType(n)})}parse(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Hm(this,t,!1);return n.addAll(e,Yp.none,t.from,t.to),n.finish()}parseSlice(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new Hm(this,t,!0);return n.addAll(e,Yp.none,t.from,t.to),em.maxOpen(n.finish())}matchTag(e,t,n){for(let r=n?this.tags.indexOf(n)+1:0;r<this.tags.length;r++){let n=this.tags[r];if(Wm(e,n.tag)&&(void 0===n.namespace||e.namespaceURI==n.namespace)&&(!n.context||t.matchesContext(n.context))){if(n.getAttrs){let t=n.getAttrs(e);if(!1===t)continue;n.attrs=t||void 0}return n}}}matchStyle(e,t,n,r){for(let i=r?this.styles.indexOf(r)+1:0;i<this.styles.length;i++){let r=this.styles[i],s=r.style;if(!(0!=s.indexOf(e)||r.context&&!n.matchesContext(r.context)||s.length>e.length&&(61!=s.charCodeAt(e.length)||s.slice(e.length+1)!=t))){if(r.getAttrs){let e=r.getAttrs(t);if(!1===e)continue;r.attrs=e||void 0}return r}}}static schemaRules(e){let t=[];function n(e){let n=null==e.priority?50:e.priority,r=0;for(;r<t.length;r++){let e=t[r];if((null==e.priority?50:e.priority)<n)break}t.splice(r,0,e)}for(let r in e.marks){let t=e.marks[r].spec.parseDOM;t&&t.forEach(e=>{n(e=Km(e)),e.mark||e.ignore||e.clearMark||(e.mark=r)})}for(let r in e.nodes){let t=e.nodes[r].spec.parseDOM;t&&t.forEach(e=>{n(e=Km(e)),e.node||e.ignore||e.mark||(e.node=r)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new Vm(e,Vm.schemaRules(e)))}}const zm={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},Um={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Bm={ol:!0,ul:!0};function $m(e,t,n){return null!=t?(t?1:0)|("full"===t?2:0):e&&"pre"==e.whitespace?3:-5&n}class qm{constructor(e,t,n,r,i,s){this.type=e,this.attrs=t,this.marks=n,this.solid=r,this.options=s,this.content=[],this.activeMarks=Yp.none,this.match=i||(4&s?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(Gp.from(e));if(!t){let t,n=this.type.contentMatch;return(t=n.findWrapping(e.type))?(this.match=n,t):null}this.match=this.type.contentMatch.matchFragment(t)}return this.match.findWrapping(e.type)}finish(e){if(!(1&this.options)){let e,t=this.content[this.content.length-1];if(t&&t.isText&&(e=/[ \t\r\n\u000c]+$/.exec(t.text))){let n=t;t.text.length==e[0].length?this.content.pop():this.content[this.content.length-1]=n.withText(n.text.slice(0,n.text.length-e[0].length))}}let t=Gp.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(Gp.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!zm.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Hm{constructor(e,t,n){this.parser=e,this.options=t,this.isOpen=n,this.open=0,this.localPreserveWS=!1;let r,i=t.topNode,s=$m(null,t.preserveWhitespace,0)|(n?4:0);r=i?new qm(i.type,i.attrs,Yp.none,!0,t.topMatch||i.type.contentMatch,s):new qm(n?null:e.schema.topNodeType,null,Yp.none,!0,null,s),this.nodes=[r],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){3==e.nodeType?this.addTextNode(e,t):1==e.nodeType&&this.addElement(e,t)}addTextNode(e,t){let n=e.nodeValue,r=this.top,i=2&r.options?"full":this.localPreserveWS||(1&r.options)>0;if("full"===i||r.inlineContext(e)||/[^ \t\r\n\u000c]/.test(n)){if(i)n="full"!==i?n.replace(/\r?\n|\r/g," "):n.replace(/\r\n?/g,"\n");else if(n=n.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(n)&&this.open==this.nodes.length-1){let t=r.content[r.content.length-1],i=e.previousSibling;(!t||i&&"BR"==i.nodeName||t.isText&&/[ \t\r\n\u000c]$/.test(t.text))&&(n=n.slice(1))}n&&this.insertNode(this.parser.schema.text(n),t,!/\S/.test(n)),this.findInText(e)}else this.findInside(e)}addElement(e,t,n){let r=this.localPreserveWS,i=this.top;("PRE"==e.tagName||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s,o=e.nodeName.toLowerCase();Bm.hasOwnProperty(o)&&this.parser.normalizeLists&&function(e){for(let t=e.firstChild,n=null;t;t=t.nextSibling){let e=1==t.nodeType?t.nodeName.toLowerCase():null;e&&Bm.hasOwnProperty(e)&&n?(n.appendChild(t),t=n):"li"==e?n=t:e&&(n=null)}}(e);let a=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(s=this.parser.matchTag(e,this,n));e:if(a?a.ignore:Um.hasOwnProperty(o))this.findInside(e),this.ignoreFallback(e,t);else if(!a||a.skip||a.closeParent){a&&a.closeParent?this.open=Math.max(0,this.open-1):a&&a.skip.nodeType&&(e=a.skip);let n,r=this.needsBlock;if(zm.hasOwnProperty(o))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),n=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let s=a&&a.skip?t:this.readStyles(e,t);s&&this.addAll(e,s),n&&this.sync(i),this.needsBlock=r}else{let n=this.readStyles(e,t);n&&this.addElementByRule(e,a,n,!1===a.consuming?s:void 0)}this.localPreserveWS=r}leafFallback(e,t){"BR"==e.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode("\n"),t)}ignoreFallback(e,t){"BR"!=e.nodeName||this.top.type&&this.top.type.inlineContent||this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let n=e.style;if(n&&n.length)for(let r=0;r<this.parser.matchedStyles.length;r++){let e=this.parser.matchedStyles[r],i=n.getPropertyValue(e);if(i)for(let n;;){let r=this.parser.matchStyle(e,i,this,n);if(!r)break;if(r.ignore)return null;if(t=r.clearMark?t.filter(e=>!r.clearMark(e)):t.concat(this.parser.schema.marks[r.mark].create(r.attrs)),!1!==r.consuming)break;n=r}}return t}addElementByRule(e,t,n,r){let i,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),n,"BR"==e.nodeName)||this.leafFallback(e,n);else{let e=this.enter(s,t.attrs||null,n,t.preserveWhitespace);e&&(i=!0,n=e)}else{let e=this.parser.schema.marks[t.mark];n=n.concat(e.create(t.attrs))}let o=this.top;if(s&&s.isLeaf)this.findInside(e);else if(r)this.addElement(e,n,r);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(e=>this.insertNode(e,n,!1));else{let r=e;"string"==typeof t.contentElement?r=e.querySelector(t.contentElement):"function"==typeof t.contentElement?r=t.contentElement(e):t.contentElement&&(r=t.contentElement),this.findAround(e,r,!0),this.addAll(r,n),this.findAround(e,r,!1)}i&&this.sync(o)&&this.open--}addAll(e,t,n,r){let i=n||0;for(let s=n?e.childNodes[n]:e.firstChild,o=null==r?null:e.childNodes[r];s!=o;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s,t);this.findAtPoint(e,i)}findPlace(e,t,n){let r,i;for(let s=this.open,o=0;s>=0;s--){let t=this.nodes[s],a=t.findWrapping(e);if(a&&(!r||r.length>a.length+o)&&(r=a,i=t,!a.length))break;if(t.solid){if(n)break;o+=2}}if(!r)return null;this.sync(i);for(let s=0;s<r.length;s++)t=this.enterInner(r[s],null,t,!1);return t}insertNode(e,t,n){if(e.isInline&&this.needsBlock&&!this.top.type){let e=this.textblockFromContext();e&&(t=this.enterInner(e,null,t))}let r=this.findPlace(e,t,n);if(r){this.closeExtra();let t=this.top;t.match&&(t.match=t.match.matchType(e.type));let n=Yp.none;for(let i of r.concat(e.marks))(t.type?t.type.allowsMarkType(i.type):Gm(i.type,e.type))&&(n=i.addToSet(n));return t.content.push(e.mark(n)),!0}return!1}enter(e,t,n,r){let i=this.findPlace(e.create(t),n,!1);return i&&(i=this.enterInner(e,t,n,!0,r)),i}enterInner(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4?arguments[4]:void 0;this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let o=$m(e,i,s.options);4&s.options&&0==s.content.length&&(o|=4);let a=Yp.none;return n=n.filter(t=>!(s.type?s.type.allowsMarkType(t.type):Gm(t.type,e))||(a=t.addToSet(a),!1)),this.nodes.push(new qm(e,t,a,r,null,o)),this.open++,n}closeExtra(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!(!this.isOpen&&!this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=1)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let n=this.nodes[t].content;for(let t=n.length-1;t>=0;t--)e+=n[t].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let n=0;n<this.find.length;n++)this.find[n].node==e&&this.find[n].offset==t&&(this.find[n].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)null==this.find[t].pos&&1==e.nodeType&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,n){if(e!=t&&this.find)for(let r=0;r<this.find.length;r++)if(null==this.find[r].pos&&1==e.nodeType&&e.contains(this.find[r].node)){t.compareDocumentPosition(this.find[r].node)&(n?2:4)&&(this.find[r].pos=this.currentPos)}}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),n=this.options.context,r=!this.isOpen&&(!n||n.parent.type==this.nodes[0].type),i=-(n?n.depth+1:0)+(r?0:1),s=(e,o)=>{for(;e>=0;e--){let a=t[e];if(""==a){if(e==t.length-1||0==e)continue;for(;o>=i;o--)if(s(e-1,o))return!0;return!1}{let e=o>0||0==o&&r?this.nodes[o].type:n&&o>=i?n.node(o-i).type:null;if(!e||e.name!=a&&!e.isInGroup(a))return!1;o--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let n=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(n&&n.isTextblock&&n.defaultAttrs)return n}for(let t in this.parser.schema.nodes){let e=this.parser.schema.nodes[t];if(e.isTextblock&&e.defaultAttrs)return e}}}function Wm(e,t){return(e.matches||e.msMatchesSelector||e.webkitMatchesSelector||e.mozMatchesSelector).call(e,t)}function Km(e){let t={};for(let n in e)t[n]=e[n];return t}function Gm(e,t){let n=t.schema.nodes;for(let r in n){let i=n[r];if(!i.allowsMarkType(e))continue;let s=[],o=e=>{s.push(e);for(let n=0;n<e.edgeCount;n++){let{type:r,next:i}=e.edge(n);if(r==t)return!0;if(s.indexOf(i)<0&&o(i))return!0}};if(o(i.contentMatch))return!0}}class Jm{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;n||(n=Xm(t).createDocumentFragment());let r=n,i=[];return e.forEach(e=>{if(i.length||e.marks.length){let n=0,s=0;for(;n<i.length&&s<e.marks.length;){let t=e.marks[s];if(this.marks[t.type.name]){if(!t.eq(i[n][0])||!1===t.type.spec.spanning)break;n++,s++}else s++}for(;n<i.length;)r=i.pop()[1];for(;s<e.marks.length;){let n=e.marks[s++],o=this.serializeMark(n,e.isInline,t);o&&(i.push([n,r]),r.appendChild(o.dom),r=o.contentDOM||o.dom)}}r.appendChild(this.serializeNodeInner(e,t))}),n}serializeNodeInner(e,t){let{dom:n,contentDOM:r}=eg(Xm(t),this.nodes[e.type.name](e),null,e.attrs);if(r){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,r)}return n}serializeNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.serializeNodeInner(e,t);for(let r=e.marks.length-1;r>=0;r--){let i=this.serializeMark(e.marks[r],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(n),n=i.dom)}return n}serializeMark(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=this.marks[e.type.name];return r&&eg(Xm(n),r(e,t),null,e.attrs)}static renderSpec(e,t){return eg(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Jm(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Qm(e.nodes);return t.text||(t.text=e=>e.text),t}static marksFromSchema(e){return Qm(e.marks)}}function Qm(e){let t={};for(let n in e){let r=e[n].spec.toDOM;r&&(t[n]=r)}return t}function Xm(e){return e.document||window.document}const Ym=new WeakMap;function Zm(e){let t=Ym.get(e);return void 0===t&&Ym.set(e,t=function(e){let t=null;function n(e){if(e&&"object"==typeof e)if(Array.isArray(e))if("string"==typeof e[0])t||(t=[]),t.push(e);else for(let t=0;t<e.length;t++)n(e[t]);else for(let t in e)n(e[t])}return n(e),t}(e)),t}function eg(e,t,n,r){if("string"==typeof t)return{dom:e.createTextNode(t)};if(null!=t.nodeType)return{dom:t};if(t.dom&&null!=t.dom.nodeType)return t;let i,s=t[0];if("string"!=typeof s)throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=Zm(r))&&i.indexOf(t)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let o,a=s.indexOf(" ");a>0&&(n=s.slice(0,a),s=s.slice(a+1));let l=n?e.createElementNS(n,s):e.createElement(s),c=t[1],u=1;if(c&&"object"==typeof c&&null==c.nodeType&&!Array.isArray(c)){u=2;for(let e in c)if(null!=c[e]){let t=e.indexOf(" ");t>0?l.setAttributeNS(e.slice(0,t),e.slice(t+1),c[e]):l.setAttribute(e,c[e])}}for(let h=u;h<t.length;h++){let i=t[h];if(0===i){if(h<t.length-1||h>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}{let{dom:t,contentDOM:s}=eg(e,i,n,r);if(l.appendChild(t),s){if(o)throw new RangeError("Multiple content holes");o=s}}}return{dom:l,contentDOM:o}}const tg=Math.pow(2,16);function ng(e,t){return e+t*tg}function rg(e){return 65535&e}class ig{constructor(e,t,n){this.pos=e,this.delInfo=t,this.recover=n}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class sg{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.ranges=e,this.inverted=t,!e.length&&sg.empty)return sg.empty}recover(e){let t=0,n=rg(e);if(!this.inverted)for(let r=0;r<n;r++)t+=this.ranges[3*r+2]-this.ranges[3*r+1];return this.ranges[3*n]+t+function(e){return(e-(65535&e))/tg}(e)}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!0)}_map(e,t,n){let r=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let a=this.ranges[o]-(this.inverted?r:0);if(a>e)break;let l=this.ranges[o+i],c=this.ranges[o+s],u=a+l;if(e<=u){let i=a+r+((l?e==a?-1:e==u?1:t:t)<0?0:c);if(n)return i;let s=e==(t<0?a:u)?null:ng(o/3,e-a),h=e==a?2:e==u?1:4;return(t<0?e!=a:e!=u)&&(h|=8),new ig(i,h,s)}r+=c-l}return n?e+r:new ig(e+r,0,null)}touches(e,t){let n=0,r=rg(t),i=this.inverted?2:1,s=this.inverted?1:2;for(let o=0;o<this.ranges.length;o+=3){let t=this.ranges[o]-(this.inverted?n:0);if(t>e)break;let a=this.ranges[o+i];if(e<=t+a&&o==3*r)return!0;n+=this.ranges[o+s]-a}return!1}forEach(e){let t=this.inverted?2:1,n=this.inverted?1:2;for(let r=0,i=0;r<this.ranges.length;r+=3){let s=this.ranges[r],o=s-(this.inverted?i:0),a=s+(this.inverted?0:i),l=this.ranges[r+t],c=this.ranges[r+n];e(o,o+l,a,a+c),i+=c-l}}invert(){return new sg(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return 0==e?sg.empty:new sg(e<0?[0,-e,0]:[0,0,e])}}sg.empty=new sg([]);class og{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e?e.length:0;this.mirror=t,this.from=n,this.to=r,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.maps.length;return new og(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),null!=t&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,n=this._maps.length;t<e._maps.length;t++){let r=e.getMirror(t);this.appendMap(e._maps[t],null!=r&&r<t?n+r:void 0)}}getMirror(e){if(this.mirror)for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,n=this._maps.length+e._maps.length;t>=0;t--){let r=e.getMirror(t);this.appendMap(e._maps[t].invert(),null!=r&&r>t?n-r-1:void 0)}}invert(){let e=new og;return e.appendMappingInverted(this),e}map(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;if(this.mirror)return this._map(e,t,!0);for(let n=this.from;n<this.to;n++)e=this._maps[n].map(e,t);return e}mapResult(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this._map(e,t,!1)}_map(e,t,n){let r=0;for(let i=this.from;i<this.to;i++){let n=this._maps[i].mapResult(e,t);if(null!=n.recover){let t=this.getMirror(i);if(null!=t&&t>i&&t<this.to){i=t,e=this._maps[t].recover(n.recover);continue}}r|=n.delInfo,e=n.pos}return n?e:new ig(e,r,null)}}const ag=Object.create(null);class lg{getMap(){return sg.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let n=ag[t.stepType];if(!n)throw new RangeError(`No step type ${t.stepType} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in ag)throw new RangeError("Duplicate use of step JSON ID "+e);return ag[e]=t,t.prototype.jsonID=e,t}}class cg{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new cg(e,null)}static fail(e){return new cg(null,e)}static fromReplace(e,t,n,r){try{return cg.ok(e.replace(t,n,r))}catch(i){if(i instanceof Zp)return cg.fail(i.message);throw i}}}function ug(e,t,n){let r=[];for(let i=0;i<e.childCount;i++){let s=e.child(i);s.content.size&&(s=s.copy(ug(s.content,t,s))),s.isInline&&(s=t(s,n,i)),r.push(s)}return Gp.fromArray(r)}class hg extends lg{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=e.resolve(this.from),r=n.node(n.sharedDepth(this.to)),i=new em(ug(t.content,(e,t)=>e.isAtom&&t.type.allowsMarkType(this.mark.type)?e.mark(this.mark.addToSet(e.marks)):e,r),t.openStart,t.openEnd);return cg.fromReplace(e,this.from,this.to,i)}invert(){return new dg(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new hg(t.pos,n.pos,this.mark)}merge(e){return e instanceof hg&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new hg(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new hg(t.from,t.to,e.markFromJSON(t.mark))}}lg.jsonID("addMark",hg);class dg extends lg{constructor(e,t,n){super(),this.from=e,this.to=t,this.mark=n}apply(e){let t=e.slice(this.from,this.to),n=new em(ug(t.content,e=>e.mark(this.mark.removeFromSet(e.marks)),e),t.openStart,t.openEnd);return cg.fromReplace(e,this.from,this.to,n)}invert(){return new hg(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deleted&&n.deleted||t.pos>=n.pos?null:new dg(t.pos,n.pos,this.mark)}merge(e){return e instanceof dg&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new dg(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new dg(t.from,t.to,e.markFromJSON(t.mark))}}lg.jsonID("removeMark",dg);class fg extends lg{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return cg.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return cg.fromReplace(e,this.pos,this.pos+1,new em(Gp.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let e=this.mark.addToSet(t.marks);if(e.length==t.marks.length){for(let n=0;n<t.marks.length;n++)if(!t.marks[n].isInSet(e))return new fg(this.pos,t.marks[n]);return new fg(this.pos,this.mark)}}return new pg(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new fg(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new fg(t.pos,e.markFromJSON(t.mark))}}lg.jsonID("addNodeMark",fg);class pg extends lg{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return cg.fail("No node at mark step's position");let n=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return cg.fromReplace(e,this.pos,this.pos+1,new em(Gp.from(n),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return t&&this.mark.isInSet(t.marks)?new fg(this.pos,this.mark):this}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new pg(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new pg(t.pos,e.markFromJSON(t.mark))}}lg.jsonID("removeNodeMark",pg);class mg extends lg{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(),this.from=e,this.to=t,this.slice=n,this.structure=r}apply(e){return this.structure&&yg(e,this.from,this.to)?cg.fail("Structure replace would overwrite content"):cg.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new sg([this.from,this.to-this.from,this.slice.size])}invert(e){return new mg(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1);return t.deletedAcross&&n.deletedAcross?null:new mg(t.pos,Math.max(t.pos,n.pos),this.slice,this.structure)}merge(e){if(!(e instanceof mg)||e.structure||this.structure)return null;if(this.from+this.slice.size!=e.from||this.slice.openEnd||e.slice.openStart){if(e.to!=this.from||this.slice.openStart||e.slice.openEnd)return null;{let t=this.slice.size+e.slice.size==0?em.empty:new em(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new mg(e.from,this.to,t,this.structure)}}{let t=this.slice.size+e.slice.size==0?em.empty:new em(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new mg(this.from,this.to+(e.to-e.from),t,this.structure)}}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new mg(t.from,t.to,em.fromJSON(e,t.slice),!!t.structure)}}lg.jsonID("replace",mg);class gg extends lg{constructor(e,t,n,r,i,s){let o=arguments.length>6&&void 0!==arguments[6]&&arguments[6];super(),this.from=e,this.to=t,this.gapFrom=n,this.gapTo=r,this.slice=i,this.insert=s,this.structure=o}apply(e){if(this.structure&&(yg(e,this.from,this.gapFrom)||yg(e,this.gapTo,this.to)))return cg.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return cg.fail("Gap is not a flat range");let n=this.slice.insertAt(this.insert,t.content);return n?cg.fromReplace(e,this.from,this.to,n):cg.fail("Content does not fit in gap")}getMap(){return new sg([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new gg(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),n=e.mapResult(this.to,-1),r=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?n.pos:e.map(this.gapTo,1);return t.deletedAcross&&n.deletedAcross||r<t.pos||i>n.pos?null:new gg(t.pos,n.pos,r,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if("number"!=typeof t.from||"number"!=typeof t.to||"number"!=typeof t.gapFrom||"number"!=typeof t.gapTo||"number"!=typeof t.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new gg(t.from,t.to,t.gapFrom,t.gapTo,em.fromJSON(e,t.slice),t.insert,!!t.structure)}}function yg(e,t,n){let r=e.resolve(t),i=n-t,s=r.depth;for(;i>0&&s>0&&r.indexAfter(s)==r.node(s).childCount;)s--,i--;if(i>0){let e=r.node(s).maybeChild(r.indexAfter(s));for(;i>0;){if(!e||e.isLeaf)return!0;e=e.firstChild,i--}}return!1}function vg(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.contentMatch,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],s=e.doc.nodeAt(t),o=[],a=t+1;for(let l=0;l<s.childCount;l++){let t=s.child(l),c=a+t.nodeSize,u=r.matchType(t.type);if(u){r=u;for(let r=0;r<t.marks.length;r++)n.allowsMarkType(t.marks[r].type)||e.step(new dg(a,c,t.marks[r]));if(i&&t.isText&&"pre"!=n.whitespace){let e,r,i=/\r?\n|\r/g;for(;e=i.exec(t.text);)r||(r=new em(Gp.from(n.schema.text(" ",n.allowedMarks(t.marks))),0,0)),o.push(new mg(a+e.index,a+e.index+e[0].length,r))}}else o.push(new mg(a,c,em.empty));a=c}if(!r.validEnd){let t=r.fillBefore(Gp.empty,!0);e.replace(a,a,new em(t,0,0))}for(let l=o.length-1;l>=0;l--)e.step(o[l])}function wg(e,t,n){return(0==t||e.canReplace(t,e.childCount))&&(n==e.childCount||e.canReplace(0,n))}function bg(e){let t=e.parent.content.cutByIndex(e.startIndex,e.endIndex);for(let n=e.depth;;--n){let r=e.$from.node(n),i=e.$from.index(n),s=e.$to.indexAfter(n);if(n<e.depth&&r.canReplace(i,s,t))return n;if(0==n||r.type.spec.isolating||!wg(r,i,s))break}return null}function Sg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e,i=function(e,t){let{parent:n,startIndex:r,endIndex:i}=e,s=n.contentMatchAt(r).findWrapping(t);if(!s)return null;let o=s.length?s[0]:t;return n.canReplaceWith(r,i,o)?s:null}(e,t),s=i&&function(e,t){let{parent:n,startIndex:r,endIndex:i}=e,s=n.child(r),o=t.contentMatch.findWrapping(s.type);if(!o)return null;let a=(o.length?o[o.length-1]:t).contentMatch;for(let l=r;a&&l<i;l++)a=a.matchType(n.child(l).type);return a&&a.validEnd?o:null}(r,t);return s?i.map(kg).concat({type:t,attrs:n}).concat(s.map(kg)):null}function kg(e){return{type:e,attrs:null}}function Eg(e,t,n,r){t.forEach((i,s)=>{if(i.isText){let o,a=/\r?\n|\r/g;for(;o=a.exec(i.text);){let i=e.mapping.slice(r).map(n+1+s+o.index);e.replaceWith(i,i+1,t.type.schema.linebreakReplacement.create())}}})}function xg(e,t,n,r){t.forEach((i,s)=>{if(i.type==i.type.schema.linebreakReplacement){let i=e.mapping.slice(r).map(n+1+s);e.replaceWith(i,i+1,t.type.schema.text("\n"))}})}function Cg(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=e.resolve(t),s=i.depth-n,o=r&&r[r.length-1]||i.parent;if(s<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!o.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=n-2;c>s;c--,u--){let e=i.node(c),t=i.index(c);if(e.type.spec.isolating)return!1;let n=e.content.cutByIndex(t,e.childCount),s=r&&r[u+1];s&&(n=n.replaceChild(0,s.type.create(s.attrs)));let o=r&&r[u]||e;if(!e.canReplace(t+1,e.childCount)||!o.type.validContent(n))return!1}let a=i.indexAfter(s),l=r&&r[0];return i.node(s).canReplaceWith(a,a,l?l.type:i.node(s+1).type)}function Tg(e,t){let n=e.resolve(t),r=n.index();return _g(n.nodeBefore,n.nodeAfter)&&n.parent.canReplace(r,r+1)}function _g(e,t){return!(!e||!t||e.isLeaf||!function(e,t){t.content.size||e.type.compatibleContent(t.type);let n=e.contentMatchAt(e.childCount),{linebreakReplacement:r}=e.type.schema;for(let i=0;i<t.childCount;i++){let s=t.child(i),o=s.type==r?e.type.schema.nodes.text:s.type;if(n=n.matchType(o),!n)return!1;if(!e.type.allowsMarks(s.marks))return!1}return n.validEnd}(e,t))}function Ig(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=e.resolve(t);for(let i=r.depth;;i--){let e,s,o=r.index(i);if(i==r.depth?(e=r.nodeBefore,s=r.nodeAfter):n>0?(e=r.node(i+1),o++,s=r.node(i).maybeChild(o)):(e=r.node(i).maybeChild(o-1),s=r.node(i+1)),e&&!e.isTextblock&&_g(e,s)&&r.node(i).canReplace(o,o+1))return t;if(0==i)break;t=n<0?r.before(i):r.after(i)}}function Ag(e,t,n){let r=e.resolve(t);if(!n.content.size)return t;let i=n.content;for(let s=0;s<n.openStart;s++)i=i.firstChild.content;for(let s=1;s<=(0==n.openStart&&n.size?2:1);s++)for(let e=r.depth;e>=0;e--){let t=e==r.depth?0:r.pos<=(r.start(e+1)+r.end(e+1))/2?-1:1,n=r.index(e)+(t>0?1:0),o=r.node(e),a=!1;if(1==s)a=o.canReplace(n,n,i);else{let e=o.contentMatchAt(n).findWrapping(i.firstChild.type);a=e&&o.canReplaceWith(n,n,e[0])}if(a)return 0==t?r.pos:t<0?r.before(e+1):r.after(e+1)}return null}function Ng(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:em.empty;if(t==n&&!r.size)return null;let i=e.resolve(t),s=e.resolve(n);return Og(i,s,r)?new mg(t,n,r):new Mg(i,s,r).fit()}function Og(e,t,n){return!n.openStart&&!n.openEnd&&e.start()==t.start()&&e.parent.canReplace(e.index(),t.index(),n.content)}lg.jsonID("replaceAround",gg);class Mg{constructor(e,t,n){this.$from=e,this.$to=t,this.unplaced=n,this.frontier=[],this.placed=Gp.empty;for(let r=0;r<=e.depth;r++){let t=e.node(r);this.frontier.push({type:t.type,match:t.contentMatchAt(e.indexAfter(r))})}for(let r=e.depth;r>0;r--)this.placed=Gp.from(e.node(r).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let e=this.findFittable();e?this.placeNodes(e):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,n=this.$from,r=this.close(e<0?this.$to:n.doc.resolve(e));if(!r)return null;let i=this.placed,s=n.depth,o=r.depth;for(;s&&o&&1==i.childCount;)i=i.firstChild.content,s--,o--;let a=new em(i,s,o);return e>-1?new gg(n.pos,e,this.$to.pos,this.$to.end(),a,t):a.size||n.pos!=this.$to.pos?new mg(n.pos,r.pos,a):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,n=0,r=this.unplaced.openEnd;n<e;n++){let i=t.firstChild;if(t.childCount>1&&(r=0),i.type.spec.isolating&&r<=n){e=n;break}t=i.content}for(let t=1;t<=2;t++)for(let n=1==t?e:this.unplaced.openStart;n>=0;n--){let e,r=null;n?(r=Pg(this.unplaced.content,n-1).firstChild,e=r.content):e=this.unplaced.content;let i=e.firstChild;for(let s=this.depth;s>=0;s--){let e,{type:o,match:a}=this.frontier[s],l=null;if(1==t&&(i?a.matchType(i.type)||(l=a.fillBefore(Gp.from(i),!1)):r&&o.compatibleContent(r.type)))return{sliceDepth:n,frontierDepth:s,parent:r,inject:l};if(2==t&&i&&(e=a.findWrapping(i.type)))return{sliceDepth:n,frontierDepth:s,parent:r,wrap:e};if(r&&a.matchType(r.type))break}}}openMore(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=Pg(e,t);return!(!r.childCount||r.firstChild.isLeaf)&&(this.unplaced=new em(e,t+1,Math.max(n,r.size+t>=e.size-n?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:n}=this.unplaced,r=Pg(e,t);if(r.childCount<=1&&t>0){let i=e.size-t<=t+r.size;this.unplaced=new em(Rg(e,t-1,1),t-1,i?t-1:n)}else this.unplaced=new em(Rg(e,t,1),t,n)}placeNodes(e){let{sliceDepth:t,frontierDepth:n,parent:r,inject:i,wrap:s}=e;for(;this.depth>n;)this.closeFrontierNode();if(s)for(let m=0;m<s.length;m++)this.openFrontierNode(s[m]);let o=this.unplaced,a=r?r.content:o.content,l=o.openStart-t,c=0,u=[],{match:h,type:d}=this.frontier[n];if(i){for(let e=0;e<i.childCount;e++)u.push(i.child(e));h=h.matchFragment(i)}let f=a.size+t-(o.content.size-o.openEnd);for(;c<a.childCount;){let e=a.child(c),t=h.matchType(e.type);if(!t)break;c++,(c>1||0==l||e.content.size)&&(h=t,u.push(Lg(e.mark(d.allowedMarks(e.marks)),1==c?l:0,c==a.childCount?f:-1)))}let p=c==a.childCount;p||(f=-1),this.placed=Dg(this.placed,n,Gp.from(u)),this.frontier[n].match=h,p&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,g=a;m<f;m++){let e=g.lastChild;this.frontier.push({type:e.type,match:e.contentMatchAt(e.childCount)}),g=e.content}this.unplaced=p?0==t?em.empty:new em(Rg(o.content,t-1,1),t-1,f<0?o.openEnd:t-1):new em(Rg(o.content,t,c),o.openStart,o.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e,t=this.frontier[this.depth];if(!t.type.isTextblock||!Fg(this.$to,this.$to.depth,t.type,t.match,!1)||this.$to.depth==this.depth&&(e=this.findCloseLevel(this.$to))&&e.depth==this.depth)return-1;let{depth:n}=this.$to,r=this.$to.after(n);for(;n>1&&r==this.$to.end(--n);)++r;return r}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:n,type:r}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=Fg(e,t,r,n,i);if(s){for(let n=t-1;n>=0;n--){let{match:t,type:r}=this.frontier[n],i=Fg(e,n,r,t,!0);if(!i||i.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Dg(this.placed,t.depth,t.fit)),e=t.move;for(let n=t.depth+1;n<=e.depth;n++){let t=e.node(n),r=t.type.contentMatch.fillBefore(t.content,!0,e.index(n));this.openFrontierNode(t.type,t.attrs,r)}return e}openFrontierNode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2?arguments[2]:void 0,r=this.frontier[this.depth];r.match=r.match.matchType(e),this.placed=Dg(this.placed,this.depth,Gp.from(e.create(t,n))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let e=this.frontier.pop().match.fillBefore(Gp.empty,!0);e.childCount&&(this.placed=Dg(this.placed,this.frontier.length,e))}}function Rg(e,t,n){return 0==t?e.cutByIndex(n,e.childCount):e.replaceChild(0,e.firstChild.copy(Rg(e.firstChild.content,t-1,n)))}function Dg(e,t,n){return 0==t?e.append(n):e.replaceChild(e.childCount-1,e.lastChild.copy(Dg(e.lastChild.content,t-1,n)))}function Pg(e,t){for(let n=0;n<t;n++)e=e.firstChild.content;return e}function Lg(e,t,n){if(t<=0)return e;let r=e.content;return t>1&&(r=r.replaceChild(0,Lg(r.firstChild,t-1,1==r.childCount?n-1:0))),t>0&&(r=e.type.contentMatch.fillBefore(r).append(r),n<=0&&(r=r.append(e.type.contentMatch.matchFragment(r).fillBefore(Gp.empty,!0)))),e.copy(r)}function Fg(e,t,n,r,i){let s=e.node(t),o=i?e.indexAfter(t):e.index(t);if(o==s.childCount&&!n.compatibleContent(s.type))return null;let a=r.fillBefore(s.content,!0,o);return a&&!function(e,t,n){for(let r=n;r<t.childCount;r++)if(!e.allowsMarks(t.child(r).marks))return!0;return!1}(n,s.content,o)?a:null}function jg(e){return e.spec.defining||e.spec.definingForContent}function Vg(e,t,n,r,i){if(t<n){let i=e.firstChild;e=e.replaceChild(0,i.copy(Vg(i.content,t+1,n,r,i)))}if(t>r){let t=i.contentMatchAt(0),n=t.fillBefore(e).append(e);e=n.append(t.matchFragment(n).fillBefore(Gp.empty,!0))}return e}function zg(e,t){let n=[];for(let r=Math.min(e.depth,t.depth);r>=0;r--){let i=e.start(r);if(i<e.pos-(e.depth-r)||t.end(r)>t.pos+(t.depth-r)||e.node(r).type.spec.isolating||t.node(r).type.spec.isolating)break;(i==t.start(r)||r==e.depth&&r==t.depth&&e.parent.inlineContent&&t.parent.inlineContent&&r&&t.start(r-1)==i-1)&&n.push(r)}return n}class Ug extends lg{constructor(e,t,n){super(),this.pos=e,this.attr=t,this.value=n}apply(e){let t=e.nodeAt(this.pos);if(!t)return cg.fail("No node at attribute step's position");let n=Object.create(null);for(let i in t.attrs)n[i]=t.attrs[i];n[this.attr]=this.value;let r=t.type.create(n,null,t.marks);return cg.fromReplace(e,this.pos,this.pos+1,new em(Gp.from(r),0,t.isLeaf?0:1))}getMap(){return sg.empty}invert(e){return new Ug(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new Ug(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if("number"!=typeof t.pos||"string"!=typeof t.attr)throw new RangeError("Invalid input for AttrStep.fromJSON");return new Ug(t.pos,t.attr,t.value)}}lg.jsonID("attr",Ug);class Bg extends lg{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let r in e.attrs)t[r]=e.attrs[r];t[this.attr]=this.value;let n=e.type.create(t,e.content,e.marks);return cg.ok(n)}getMap(){return sg.empty}invert(e){return new Bg(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if("string"!=typeof t.attr)throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Bg(t.attr,t.value)}}lg.jsonID("docAttr",Bg);let $g=class extends Error{};$g=function e(t){let n=Error.call(this,t);return n.__proto__=e.prototype,n},($g.prototype=Object.create(Error.prototype)).constructor=$g,$g.prototype.name="TransformError";class qg{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new og}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new $g(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:em.empty,r=Ng(this.doc,e,t,n);return r&&this.step(r),this}replaceWith(e,t,n){return this.replace(e,t,new em(Gp.from(n),0,0))}delete(e,t){return this.replace(e,t,em.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,n){return function(e,t,n,r){if(!r.size)return e.deleteRange(t,n);let i=e.doc.resolve(t),s=e.doc.resolve(n);if(Og(i,s,r))return e.step(new mg(t,n,r));let o=zg(i,e.doc.resolve(n));0==o[o.length-1]&&o.pop();let a=-(i.depth+1);o.unshift(a);for(let d=i.depth,f=i.pos-1;d>0;d--,f--){let e=i.node(d).type.spec;if(e.defining||e.definingAsContext||e.isolating)break;o.indexOf(d)>-1?a=d:i.before(d)==f&&o.splice(1,0,-d)}let l=o.indexOf(a),c=[],u=r.openStart;for(let d=r.content,f=0;;f++){let e=d.firstChild;if(c.push(e),f==r.openStart)break;d=e.content}for(let d=u-1;d>=0;d--){let e=c[d],t=jg(e.type);if(t&&!e.sameMarkup(i.node(Math.abs(a)-1)))u=d;else if(t||!e.type.isTextblock)break}for(let d=r.openStart;d>=0;d--){let t=(d+u+1)%(r.openStart+1),a=c[t];if(a)for(let c=0;c<o.length;c++){let u=o[(c+l)%o.length],h=!0;u<0&&(h=!1,u=-u);let d=i.node(u-1),f=i.index(u-1);if(d.canReplaceWith(f,f,a.type,a.marks))return e.replace(i.before(u),h?s.after(u):n,new em(Vg(r.content,0,r.openStart,t),t,r.openEnd))}}let h=e.steps.length;for(let d=o.length-1;d>=0&&(e.replace(t,n,r),!(e.steps.length>h));d--){let e=o[d];e<0||(t=i.before(e),n=s.after(e))}}(this,e,t,n),this}replaceRangeWith(e,t,n){return function(e,t,n,r){if(!r.isInline&&t==n&&e.doc.resolve(t).parent.content.size){let i=function(e,t,n){let r=e.resolve(t);if(r.parent.canReplaceWith(r.index(),r.index(),n))return t;if(0==r.parentOffset)for(let i=r.depth-1;i>=0;i--){let e=r.index(i);if(r.node(i).canReplaceWith(e,e,n))return r.before(i+1);if(e>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let e=r.indexAfter(i);if(r.node(i).canReplaceWith(e,e,n))return r.after(i+1);if(e<r.node(i).childCount)return null}return null}(e.doc,t,r.type);null!=i&&(t=n=i)}e.replaceRange(t,n,new em(Gp.from(r),0,0))}(this,e,t,n),this}deleteRange(e,t){return function(e,t,n){let r=e.doc.resolve(t),i=e.doc.resolve(n),s=zg(r,i);for(let o=0;o<s.length;o++){let t=s[o],n=o==s.length-1;if(n&&0==t||r.node(t).type.contentMatch.validEnd)return e.delete(r.start(t),i.end(t));if(t>0&&(n||r.node(t-1).canReplace(r.index(t-1),i.indexAfter(t-1))))return e.delete(r.before(t),i.after(t))}for(let o=1;o<=r.depth&&o<=i.depth;o++)if(t-r.start(o)==r.depth-o&&n>r.end(o)&&i.end(o)-n!=i.depth-o&&r.start(o-1)==i.start(o-1)&&r.node(o-1).canReplace(r.index(o-1),i.index(o-1)))return e.delete(r.before(o),n);e.delete(t,n)}(this,e,t),this}lift(e,t){return function(e,t,n){let{$from:r,$to:i,depth:s}=t,o=r.before(s+1),a=i.after(s+1),l=o,c=a,u=Gp.empty,h=0;for(let p=s,m=!1;p>n;p--)m||r.index(p)>0?(m=!0,u=Gp.from(r.node(p).copy(u)),h++):l--;let d=Gp.empty,f=0;for(let p=s,m=!1;p>n;p--)m||i.after(p+1)<i.end(p)?(m=!0,d=Gp.from(i.node(p).copy(d)),f++):c++;e.step(new gg(l,c,o,a,new em(u.append(d),h,f),u.size-h,!0))}(this,e,t),this}join(e){return function(e,t,n){let r=null,{linebreakReplacement:i}=e.doc.type.schema,s=e.doc.resolve(t-n),o=s.node().type;if(i&&o.inlineContent){let e="pre"==o.whitespace,t=!!o.contentMatch.matchType(i);e&&!t?r=!1:!e&&t&&(r=!0)}let a=e.steps.length;if(!1===r){let r=e.doc.resolve(t+n);xg(e,r.node(),r.before(),a)}o.inlineContent&&vg(e,t+n-1,o,s.node().contentMatchAt(s.index()),null==r);let l=e.mapping.slice(a),c=l.map(t-n);if(e.step(new mg(c,l.map(t+n,-1),em.empty,!0)),!0===r){let t=e.doc.resolve(c);Eg(e,t.node(),t.before(),e.steps.length)}}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1),this}wrap(e,t){return function(e,t,n){let r=Gp.empty;for(let o=n.length-1;o>=0;o--){if(r.size){let e=n[o].type.contentMatch.matchFragment(r);if(!e||!e.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=Gp.from(n[o].type.create(n[o].attrs,r))}let i=t.start,s=t.end;e.step(new gg(i,s,i,s,new em(r,0,0),n.length,!0))}(this,e,t),this}setBlockType(e){return function(e,t,n,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let s=e.steps.length;e.doc.nodesBetween(t,n,(t,n)=>{let o="function"==typeof i?i(t):i;if(t.isTextblock&&!t.hasMarkup(r,o)&&function(e,t,n){let r=e.resolve(t),i=r.index();return r.parent.canReplaceWith(i,i+1,n)}(e.doc,e.mapping.slice(s).map(n),r)){let i=null;if(r.schema.linebreakReplacement){let e="pre"==r.whitespace,t=!!r.contentMatch.matchType(r.schema.linebreakReplacement);e&&!t?i=!1:!e&&t&&(i=!0)}!1===i&&xg(e,t,n,s),vg(e,e.mapping.slice(s).map(n,1),r,void 0,null===i);let a=e.mapping.slice(s),l=a.map(n,1),c=a.map(n+t.nodeSize,1);return e.step(new gg(l,c,l+1,c-1,new em(Gp.from(r.create(o,null,t.marks)),0,0),1,!0)),!0===i&&Eg(e,t,n,s),!1}})}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,arguments.length>2?arguments[2]:void 0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null),this}setNodeMarkup(e,t){return function(e,t,n,r,i){let s=e.doc.nodeAt(t);if(!s)throw new RangeError("No node at given position");n||(n=s.type);let o=n.create(r,null,i||s.marks);if(s.isLeaf)return e.replaceWith(t,t+s.nodeSize,o);if(!n.validContent(s.content))throw new RangeError("Invalid content for node type "+n.name);e.step(new gg(t,t+s.nodeSize,t+1,t+s.nodeSize-1,new em(Gp.from(o),0,0),1,!0))}(this,e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,arguments.length>3?arguments[3]:void 0),this}setNodeAttribute(e,t,n){return this.step(new Ug(e,t,n)),this}setDocAttribute(e,t){return this.step(new Bg(e,t)),this}addNodeMark(e,t){return this.step(new fg(e,t)),this}removeNodeMark(e,t){let n=this.doc.nodeAt(e);if(!n)throw new RangeError("No node at position "+e);if(t instanceof Yp)t.isInSet(n.marks)&&this.step(new pg(e,t));else{let r,i=n.marks,s=[];for(;r=t.isInSet(i);)s.push(new pg(e,r)),i=r.removeFromSet(i);for(let e=s.length-1;e>=0;e--)this.step(s[e])}return this}split(e){return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3?arguments[3]:void 0,i=e.doc.resolve(t),s=Gp.empty,o=Gp.empty;for(let a=i.depth,l=i.depth-n,c=n-1;a>l;a--,c--){s=Gp.from(i.node(a).copy(s));let e=r&&r[c];o=Gp.from(e?e.type.create(e.attrs,o):i.node(a).copy(o))}e.step(new mg(t,t,new em(s.append(o),n,n),!0))}(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,arguments.length>2?arguments[2]:void 0),this}addMark(e,t,n){return function(e,t,n,r){let i,s,o=[],a=[];e.doc.nodesBetween(t,n,(e,l,c)=>{if(!e.isInline)return;let u=e.marks;if(!r.isInSet(u)&&c.type.allowsMarkType(r.type)){let c=Math.max(l,t),h=Math.min(l+e.nodeSize,n),d=r.addToSet(u);for(let e=0;e<u.length;e++)u[e].isInSet(d)||(i&&i.to==c&&i.mark.eq(u[e])?i.to=h:o.push(i=new dg(c,h,u[e])));s&&s.to==c?s.to=h:a.push(s=new hg(c,h,r))}}),o.forEach(t=>e.step(t)),a.forEach(t=>e.step(t))}(this,e,t,n),this}removeMark(e,t,n){return function(e,t,n,r){let i=[],s=0;e.doc.nodesBetween(t,n,(e,o)=>{if(!e.isInline)return;s++;let a=null;if(r instanceof Lm){let t,n=e.marks;for(;t=r.isInSet(n);)(a||(a=[])).push(t),n=t.removeFromSet(n)}else r?r.isInSet(e.marks)&&(a=[r]):a=e.marks;if(a&&a.length){let r=Math.min(o+e.nodeSize,n);for(let e=0;e<a.length;e++){let n,l=a[e];for(let e=0;e<i.length;e++){let t=i[e];t.step==s-1&&l.eq(i[e].style)&&(n=t)}n?(n.to=r,n.step=s):i.push({style:l,from:Math.max(o,t),to:r,step:s})}}}),i.forEach(t=>e.step(new dg(t.from,t.to,t.style)))}(this,e,t,n),this}clearIncompatible(e,t,n){return vg(this,e,t,n),this}}const Hg=Object.create(null);class Wg{constructor(e,t,n){this.$anchor=e,this.$head=t,this.ranges=n||[new Kg(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:em.empty,n=t.content.lastChild,r=null;for(let o=0;o<t.openEnd;o++)r=n,n=n.lastChild;let i=e.steps.length,s=this.ranges;for(let o=0;o<s.length;o++){let{$from:a,$to:l}=s[o],c=e.mapping.slice(i);e.replaceRange(c.map(a.pos),c.map(l.pos),o?em.empty:t),0==o&&ry(e,i,(n?n.isInline:r&&r.isTextblock)?-1:1)}}replaceWith(e,t){let n=e.steps.length,r=this.ranges;for(let i=0;i<r.length;i++){let{$from:s,$to:o}=r[i],a=e.mapping.slice(n),l=a.map(s.pos),c=a.map(o.pos);i?e.deleteRange(l,c):(e.replaceRangeWith(l,c,t),ry(e,n,t.isInline?-1:1))}}static findFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=e.parent.inlineContent?new Qg(e):ny(e.node(0),e.parent,e.pos,e.index(),t,n);if(r)return r;for(let i=e.depth-1;i>=0;i--){let r=t<0?ny(e.node(0),e.node(i),e.before(i+1),e.index(i),t,n):ny(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,n);if(r)return r}return null}static near(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return this.findFrom(e,t)||this.findFrom(e,-t)||new ey(e.node(0))}static atStart(e){return ny(e,e,0,0,1)||new ey(e)}static atEnd(e){return ny(e,e,e.content.size,e.childCount,-1)||new ey(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let n=Hg[t.type];if(!n)throw new RangeError(`No selection type ${t.type} defined`);return n.fromJSON(e,t)}static jsonID(e,t){if(e in Hg)throw new RangeError("Duplicate use of selection JSON ID "+e);return Hg[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Qg.between(this.$anchor,this.$head).getBookmark()}}Wg.prototype.visible=!0;class Kg{constructor(e,t){this.$from=e,this.$to=t}}let Gg=!1;function Jg(e){Gg||e.parent.inlineContent||(Gg=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+e.parent.type.name+")"))}class Qg extends Wg{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;Jg(e),Jg(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let n=e.resolve(t.map(this.head));if(!n.parent.inlineContent)return Wg.near(n);let r=e.resolve(t.map(this.anchor));return new Qg(r.parent.inlineContent?r:n,n)}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:em.empty;if(super.replace(e,t),t==em.empty){let t=this.$from.marksAcross(this.$to);t&&e.ensureMarks(t)}}eq(e){return e instanceof Qg&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new Xg(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if("number"!=typeof t.anchor||"number"!=typeof t.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new Qg(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t,r=e.resolve(t);return new this(r,n==t?r:e.resolve(n))}static between(e,t,n){let r=e.pos-t.pos;if(n&&!r||(n=r>=0?1:-1),!t.parent.inlineContent){let e=Wg.findFrom(t,n,!0)||Wg.findFrom(t,-n,!0);if(!e)return Wg.near(t,n);t=e.$head}return e.parent.inlineContent||(0==r||(e=(Wg.findFrom(e,-n,!0)||Wg.findFrom(e,n,!0)).$anchor).pos<t.pos!=r<0)&&(e=t),new Qg(e,t)}}Wg.jsonID("text",Qg);class Xg{constructor(e,t){this.anchor=e,this.head=t}map(e){return new Xg(e.map(this.anchor),e.map(this.head))}resolve(e){return Qg.between(e.resolve(this.anchor),e.resolve(this.head))}}class Yg extends Wg{constructor(e){let t=e.nodeAfter,n=e.node(0).resolve(e.pos+t.nodeSize);super(e,n),this.node=t}map(e,t){let{deleted:n,pos:r}=t.mapResult(this.anchor),i=e.resolve(r);return n?Wg.near(i):new Yg(i)}content(){return new em(Gp.from(this.node),0,0)}eq(e){return e instanceof Yg&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Zg(this.anchor)}static fromJSON(e,t){if("number"!=typeof t.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Yg(e.resolve(t.anchor))}static create(e,t){return new Yg(e.resolve(t))}static isSelectable(e){return!e.isText&&!1!==e.type.spec.selectable}}Yg.prototype.visible=!1,Wg.jsonID("node",Yg);class Zg{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:n}=e.mapResult(this.anchor);return t?new Xg(n,n):new Zg(n)}resolve(e){let t=e.resolve(this.anchor),n=t.nodeAfter;return n&&Yg.isSelectable(n)?new Yg(t):Wg.near(t)}}class ey extends Wg{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:em.empty;if(t==em.empty){e.delete(0,e.doc.content.size);let t=Wg.atStart(e.doc);t.eq(e.selection)||e.setSelection(t)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new ey(e)}map(e){return new ey(e)}eq(e){return e instanceof ey}getBookmark(){return ty}}Wg.jsonID("all",ey);const ty={map(){return this},resolve:e=>new ey(e)};function ny(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(t.inlineContent)return Qg.create(e,n);for(let o=r-(i>0?0:1);i>0?o<t.childCount:o>=0;o+=i){let r=t.child(o);if(r.isAtom){if(!s&&Yg.isSelectable(r))return Yg.create(e,n-(i<0?r.nodeSize:0))}else{let t=ny(e,r,n+i,i<0?r.childCount:0,i,s);if(t)return t}n+=r.nodeSize*i}return null}function ry(e,t,n){let r=e.steps.length-1;if(r<t)return;let i,s=e.steps[r];(s instanceof mg||s instanceof gg)&&(e.mapping.maps[r].forEach((e,t,n,r)=>{null==i&&(i=r)}),e.setSelection(Wg.near(e.doc.resolve(i),n)))}class iy extends qg{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=-3&this.updated|1,this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=2,this}ensureMarks(e){return Yp.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(e,t){super.addStep(e,t),this.updated=-3&this.updated,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.selection;return t&&(e=e.mark(this.storedMarks||(n.empty?n.$from.marks():n.$from.marksAcross(n.$to)||Yp.none))),n.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,n){let r=this.doc.type.schema;if(null==t)return e?this.replaceSelectionWith(r.text(e),!0):this.deleteSelection();{if(null==n&&(n=t),n=null==n?t:n,!e)return this.deleteRange(t,n);let i=this.storedMarks;if(!i){let e=this.doc.resolve(t);i=n==t?e.marks():e.marksAcross(this.doc.resolve(n))}return this.replaceRangeWith(t,n,r.text(e,i)),this.selection.empty||this.setSelection(Wg.near(this.selection.$to)),this}}setMeta(e,t){return this.meta["string"==typeof e?e:e.key]=t,this}getMeta(e){return this.meta["string"==typeof e?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function sy(e,t){return t&&e?e.bind(t):e}class oy{constructor(e,t,n){this.name=e,this.init=sy(t.init,n),this.apply=sy(t.apply,n)}}const ay=[new oy("doc",{init:e=>e.doc||e.schema.topNodeType.createAndFill(),apply:e=>e.doc}),new oy("selection",{init:(e,t)=>e.selection||Wg.atStart(t.doc),apply:e=>e.selection}),new oy("storedMarks",{init:e=>e.storedMarks||null,apply:(e,t,n,r)=>r.selection.$cursor?e.storedMarks:null}),new oy("scrollToSelection",{init:()=>0,apply:(e,t)=>e.scrolledIntoView?t+1:t})];class ly{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=ay.slice(),t&&t.forEach(e=>{if(this.pluginsByKey[e.key])throw new RangeError("Adding different instances of a keyed plugin ("+e.key+")");this.plugins.push(e),this.pluginsByKey[e.key]=e,e.spec.state&&this.fields.push(new oy(e.key,e.spec.state,e))})}}class cy{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;for(let n=0;n<this.config.plugins.length;n++)if(n!=t){let t=this.config.plugins[n];if(t.spec.filterTransaction&&!t.spec.filterTransaction.call(t,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],n=this.applyInner(e),r=null;for(;;){let i=!1;for(let s=0;s<this.config.plugins.length;s++){let o=this.config.plugins[s];if(o.spec.appendTransaction){let a=r?r[s].n:0,l=r?r[s].state:this,c=a<t.length&&o.spec.appendTransaction.call(o,a?t.slice(a):t,l,n);if(c&&n.filterTransaction(c,s)){if(c.setMeta("appendedTransaction",e),!r){r=[];for(let e=0;e<this.config.plugins.length;e++)r.push(e<s?{state:n,n:t.length}:{state:this,n:0})}t.push(c),n=n.applyInner(c),i=!0}r&&(r[s]={state:n,n:t.length})}}if(!i)return{state:n,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new cy(this.config),n=this.config.fields;for(let r=0;r<n.length;r++){let i=n[r];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new iy(this)}static create(e){let t=new ly(e.doc?e.doc.type.schema:e.schema,e.plugins),n=new cy(t);for(let r=0;r<t.fields.length;r++)n[t.fields[r].name]=t.fields[r].init(e,n);return n}reconfigure(e){let t=new ly(this.schema,e.plugins),n=t.fields,r=new cy(t);for(let i=0;i<n.length;i++){let t=n[i].name;r[t]=this.hasOwnProperty(t)?this[t]:n[i].init(e,r)}return r}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(e=>e.toJSON())),e&&"object"==typeof e)for(let n in e){if("doc"==n||"selection"==n)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let r=e[n],i=r.spec.state;i&&i.toJSON&&(t[n]=i.toJSON.call(r,this[r.key]))}return t}static fromJSON(e,t,n){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let r=new ly(e.schema,e.plugins),i=new cy(r);return r.fields.forEach(r=>{if("doc"==r.name)i.doc=vm.fromJSON(e.schema,t.doc);else if("selection"==r.name)i.selection=Wg.fromJSON(i.doc,t.selection);else if("storedMarks"==r.name)t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(n)for(let s in n){let o=n[s],a=o.spec.state;if(o.key==r.name&&a&&a.fromJSON&&Object.prototype.hasOwnProperty.call(t,s))return void(i[r.name]=a.fromJSON.call(o,e,t[s],i))}i[r.name]=r.init(e,i)}}),i}}function uy(e,t,n){for(let r in e){let i=e[r];i instanceof Function?i=i.bind(t):"handleDOMEvents"==r&&(i=uy(i,t,{})),n[r]=i}return n}class hy{constructor(e){this.spec=e,this.props={},e.props&&uy(e.props,this,this.props),this.key=e.key?e.key.key:fy("plugin")}getState(e){return e[this.key]}}const dy=Object.create(null);function fy(e){return e in dy?e+"$"+ ++dy[e]:(dy[e]=0,e+"$")}class py{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"key";this.key=fy(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const my=function(e){for(var t=0;;t++)if(!(e=e.previousSibling))return t},gy=function(e){let t=e.assignedSlot||e.parentNode;return t&&11==t.nodeType?t.host:t};let yy=null;const vy=function(e,t,n){let r=yy||(yy=document.createRange());return r.setEnd(e,null==n?e.nodeValue.length:n),r.setStart(e,t||0),r},wy=function(e,t,n,r){return n&&(Sy(e,t,n,r,-1)||Sy(e,t,n,r,1))},by=/^(img|br|input|textarea|hr)$/i;function Sy(e,t,n,r,i){for(var s;;){if(e==n&&t==r)return!0;if(t==(i<0?0:ky(e))){let n=e.parentNode;if(!n||1!=n.nodeType||Ey(e)||by.test(e.nodeName)||"false"==e.contentEditable)return!1;t=my(e)+(i<0?0:1),e=n}else{if(1!=e.nodeType)return!1;{let n=e.childNodes[t+(i<0?-1:0)];if(1==n.nodeType&&"false"==n.contentEditable){if(!(null===(s=n.pmViewDesc)||void 0===s?void 0:s.ignoreForSelection))return!1;t+=i}else e=n,t=i<0?ky(e):0}}}}function ky(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Ey(e){let t;for(let n=e;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==e||t.contentDOM==e)}const xy=function(e){return e.focusNode&&wy(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)};function Cy(e,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=e,n.key=n.code=t,n}const Ty="undefined"!=typeof navigator?navigator:null,_y="undefined"!=typeof document?document:null,Iy=Ty&&Ty.userAgent||"",Ay=/Edge\/(\d+)/.exec(Iy),Ny=/MSIE \d/.exec(Iy),Oy=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Iy),My=!!(Ny||Oy||Ay),Ry=Ny?document.documentMode:Oy?+Oy[1]:Ay?+Ay[1]:0,Dy=!My&&/gecko\/(\d+)/i.test(Iy);Dy&&(/Firefox\/(\d+)/.exec(Iy)||[0,0])[1];const Py=!My&&/Chrome\/(\d+)/.exec(Iy),Ly=!!Py,Fy=Py?+Py[1]:0,jy=!My&&!!Ty&&/Apple Computer/.test(Ty.vendor),Vy=jy&&(/Mobile\/\w+/.test(Iy)||!!Ty&&Ty.maxTouchPoints>2),zy=Vy||!!Ty&&/Mac/.test(Ty.platform),Uy=!!Ty&&/Win/.test(Ty.platform),By=/Android \d/.test(Iy),$y=!!_y&&"webkitFontSmoothing"in _y.documentElement.style,qy=$y?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function Hy(e){let t=e.defaultView&&e.defaultView.visualViewport;return t?{left:0,right:t.width,top:0,bottom:t.height}:{left:0,right:e.documentElement.clientWidth,top:0,bottom:e.documentElement.clientHeight}}function Wy(e,t){return"number"==typeof e?e:e[t]}function Ky(e){let t=e.getBoundingClientRect(),n=t.width/e.offsetWidth||1,r=t.height/e.offsetHeight||1;return{left:t.left,right:t.left+e.clientWidth*n,top:t.top,bottom:t.top+e.clientHeight*r}}function Gy(e,t,n){let r=e.someProp("scrollThreshold")||0,i=e.someProp("scrollMargin")||5,s=e.dom.ownerDocument;for(let o=n||e.dom;o;){if(1!=o.nodeType){o=gy(o);continue}let e=o,n=e==s.body,a=n?Hy(s):Ky(e),l=0,c=0;if(t.top<a.top+Wy(r,"top")?c=-(a.top-t.top+Wy(i,"top")):t.bottom>a.bottom-Wy(r,"bottom")&&(c=t.bottom-t.top>a.bottom-a.top?t.top+Wy(i,"top")-a.top:t.bottom-a.bottom+Wy(i,"bottom")),t.left<a.left+Wy(r,"left")?l=-(a.left-t.left+Wy(i,"left")):t.right>a.right-Wy(r,"right")&&(l=t.right-a.right+Wy(i,"right")),l||c)if(n)s.defaultView.scrollBy(l,c);else{let n=e.scrollLeft,r=e.scrollTop;c&&(e.scrollTop+=c),l&&(e.scrollLeft+=l);let i=e.scrollLeft-n,s=e.scrollTop-r;t={left:t.left-i,top:t.top-s,right:t.right-i,bottom:t.bottom-s}}let u=n?"fixed":getComputedStyle(o).position;if(/^(fixed|sticky)$/.test(u))break;o="absolute"==u?o.offsetParent:gy(o)}}function Jy(e){let t=[],n=e.ownerDocument;for(let r=e;r&&(t.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),e!=n);r=gy(r));return t}function Qy(e,t){for(let n=0;n<e.length;n++){let{dom:r,top:i,left:s}=e[n];r.scrollTop!=i+t&&(r.scrollTop=i+t),r.scrollLeft!=s&&(r.scrollLeft=s)}}let Xy=null;function Yy(e,t){let n,r,i,s,o=2e8,a=0,l=t.top,c=t.top;for(let u=e.firstChild,h=0;u;u=u.nextSibling,h++){let e;if(1==u.nodeType)e=u.getClientRects();else{if(3!=u.nodeType)continue;e=vy(u).getClientRects()}for(let d=0;d<e.length;d++){let f=e[d];if(f.top<=l&&f.bottom>=c){l=Math.max(f.bottom,l),c=Math.min(f.top,c);let e=f.left>t.left?f.left-t.left:f.right<t.left?t.left-f.right:0;if(e<o){n=u,o=e,r=e&&3==n.nodeType?{left:f.right<t.left?f.right:f.left,top:t.top}:t,1==u.nodeType&&e&&(a=h+(t.left>=(f.left+f.right)/2?1:0));continue}}else f.top>t.top&&!i&&f.left<=t.left&&f.right>=t.left&&(i=u,s={left:Math.max(f.left,Math.min(f.right,t.left)),top:f.top});!n&&(t.left>=f.right&&t.top>=f.top||t.left>=f.left&&t.top>=f.bottom)&&(a=h+1)}}return!n&&i&&(n=i,r=s,o=0),n&&3==n.nodeType?function(e,t){let n=e.nodeValue.length,r=document.createRange();for(let i=0;i<n;i++){r.setEnd(e,i+1),r.setStart(e,i);let n=rv(r,1);if(n.top!=n.bottom&&Zy(t,n))return{node:e,offset:i+(t.left>=(n.left+n.right)/2?1:0)}}return{node:e,offset:0}}(n,r):!n||o&&1==n.nodeType?{node:e,offset:a}:Yy(n,r)}function Zy(e,t){return e.left>=t.left-1&&e.left<=t.right+1&&e.top>=t.top-1&&e.top<=t.bottom+1}function ev(e,t,n){let r=e.childNodes.length;if(r&&n.top<n.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(t.top-n.top)/(n.bottom-n.top))-2)),s=i;;){let n=e.childNodes[s];if(1==n.nodeType){let e=n.getClientRects();for(let r=0;r<e.length;r++){let i=e[r];if(Zy(t,i))return ev(n,t,i)}}if((s=(s+1)%r)==i)break}return e}function tv(e,t){let n,r=e.dom.ownerDocument,i=0,s=function(e,t,n){if(e.caretPositionFromPoint)try{let r=e.caretPositionFromPoint(t,n);if(r)return{node:r.offsetNode,offset:Math.min(ky(r.offsetNode),r.offset)}}catch(r){}if(e.caretRangeFromPoint){let r=e.caretRangeFromPoint(t,n);if(r)return{node:r.startContainer,offset:Math.min(ky(r.startContainer),r.startOffset)}}}(r,t.left,t.top);s&&({node:n,offset:i}=s);let o,a=(e.root.elementFromPoint?e.root:r).elementFromPoint(t.left,t.top);if(!a||!e.dom.contains(1!=a.nodeType?a.parentNode:a)){let n=e.dom.getBoundingClientRect();if(!Zy(t,n))return null;if(a=ev(e.dom,t,n),!a)return null}if(jy)for(let c=a;n&&c;c=gy(c))c.draggable&&(n=void 0);if(a=function(e,t){let n=e.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<e.getBoundingClientRect().left?n:e}(a,t),n){if(Dy&&1==n.nodeType&&(i=Math.min(i,n.childNodes.length),i<n.childNodes.length)){let e,r=n.childNodes[i];"IMG"==r.nodeName&&(e=r.getBoundingClientRect()).right<=t.left&&e.bottom>t.top&&i++}let r;$y&&i&&1==n.nodeType&&1==(r=n.childNodes[i-1]).nodeType&&"false"==r.contentEditable&&r.getBoundingClientRect().top>=t.top&&i--,n==e.dom&&i==n.childNodes.length-1&&1==n.lastChild.nodeType&&t.top>n.lastChild.getBoundingClientRect().bottom?o=e.state.doc.content.size:0!=i&&1==n.nodeType&&"BR"==n.childNodes[i-1].nodeName||(o=function(e,t,n,r){let i=-1;for(let s=t,o=!1;s!=e.dom;){let t,n=e.docView.nearestDesc(s,!0);if(!n)return null;if(1==n.dom.nodeType&&(n.node.isBlock&&n.parent||!n.contentDOM)&&((t=n.dom.getBoundingClientRect()).width||t.height)&&(n.node.isBlock&&n.parent&&(!o&&t.left>r.left||t.top>r.top?i=n.posBefore:(!o&&t.right<r.left||t.bottom<r.top)&&(i=n.posAfter),o=!0),!n.contentDOM&&i<0&&!n.node.isText))return(n.node.isBlock?r.top<(t.top+t.bottom)/2:r.left<(t.left+t.right)/2)?n.posBefore:n.posAfter;s=n.dom.parentNode}return i>-1?i:e.docView.posFromDOM(t,n,-1)}(e,n,i,t))}null==o&&(o=function(e,t,n){let{node:r,offset:i}=Yy(t,n),s=-1;if(1==r.nodeType&&!r.firstChild){let e=r.getBoundingClientRect();s=e.left!=e.right&&n.left>(e.left+e.right)/2?1:-1}return e.docView.posFromDOM(r,i,s)}(e,a,t));let l=e.docView.nearestDesc(a,!0);return{pos:o,inside:l?l.posAtStart-l.border:-1}}function nv(e){return e.top<e.bottom||e.left<e.right}function rv(e,t){let n=e.getClientRects();if(n.length){let e=n[t<0?0:n.length-1];if(nv(e))return e}return Array.prototype.find.call(n,nv)||e.getBoundingClientRect()}const iv=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function sv(e,t,n){let{node:r,offset:i,atom:s}=e.docView.domFromPos(t,n<0?-1:1),o=$y||Dy;if(3==r.nodeType){if(!o||!iv.test(r.nodeValue)&&(n<0?i:i!=r.nodeValue.length)){let e=i,t=i,s=n<0?1:-1;return n<0&&!i?(t++,s=-1):n>=0&&i==r.nodeValue.length?(e--,s=1):n<0?e--:t++,ov(rv(vy(r,e,t),s),s<0)}{let e=rv(vy(r,i,i),n);if(Dy&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let t=rv(vy(r,i-1,i-1),-1);if(t.top==e.top){let n=rv(vy(r,i,i+1),-1);if(n.top!=e.top)return ov(n,n.left<t.left)}}return e}}if(!e.state.doc.resolve(t-(s||0)).parent.inlineContent){if(null==s&&i&&(n<0||i==ky(r))){let e=r.childNodes[i-1];if(1==e.nodeType)return av(e.getBoundingClientRect(),!1)}if(null==s&&i<ky(r)){let e=r.childNodes[i];if(1==e.nodeType)return av(e.getBoundingClientRect(),!0)}return av(r.getBoundingClientRect(),n>=0)}if(null==s&&i&&(n<0||i==ky(r))){let e=r.childNodes[i-1],t=3==e.nodeType?vy(e,ky(e)-(o?0:1)):1!=e.nodeType||"BR"==e.nodeName&&e.nextSibling?null:e;if(t)return ov(rv(t,1),!1)}if(null==s&&i<ky(r)){let e=r.childNodes[i];for(;e.pmViewDesc&&e.pmViewDesc.ignoreForCoords;)e=e.nextSibling;let t=e?3==e.nodeType?vy(e,0,o?0:1):1==e.nodeType?e:null:null;if(t)return ov(rv(t,-1),!0)}return ov(rv(3==r.nodeType?vy(r):r,-n),n>=0)}function ov(e,t){if(0==e.width)return e;let n=t?e.left:e.right;return{top:e.top,bottom:e.bottom,left:n,right:n}}function av(e,t){if(0==e.height)return e;let n=t?e.top:e.bottom;return{top:n,bottom:n,left:e.left,right:e.right}}function lv(e,t,n){let r=e.state,i=e.root.activeElement;r!=t&&e.updateState(t),i!=e.dom&&e.focus();try{return n()}finally{r!=t&&e.updateState(r),i!=e.dom&&i&&i.focus()}}const cv=/[\u0590-\u08ac]/;let uv=null,hv=null,dv=!1;function fv(e,t,n){return uv==t&&hv==n?dv:(uv=t,hv=n,dv="up"==n||"down"==n?function(e,t,n){let r=t.selection,i="up"==n?r.$from:r.$to;return lv(e,t,()=>{let{node:t}=e.docView.domFromPos(i.pos,"up"==n?-1:1);for(;;){let n=e.docView.nearestDesc(t,!0);if(!n)break;if(n.node.isBlock){t=n.contentDOM||n.dom;break}t=n.dom.parentNode}let r=sv(e,i.pos,1);for(let e=t.firstChild;e;e=e.nextSibling){let t;if(1==e.nodeType)t=e.getClientRects();else{if(3!=e.nodeType)continue;t=vy(e,0,e.nodeValue.length).getClientRects()}for(let e=0;e<t.length;e++){let i=t[e];if(i.bottom>i.top+1&&("up"==n?r.top-i.top>2*(i.bottom-r.top):i.bottom-r.bottom>2*(r.bottom-i.top)))return!1}}return!0})}(e,t,n):function(e,t,n){let{$head:r}=t.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,s=!i,o=i==r.parent.content.size,a=e.domSelection();return a?cv.test(r.parent.textContent)&&a.modify?lv(e,t,()=>{let{focusNode:t,focusOffset:i,anchorNode:s,anchorOffset:o}=e.domSelectionRange(),l=a.caretBidiLevel;a.modify("move",n,"character");let c=r.depth?e.docView.domAfterPos(r.before()):e.dom,{focusNode:u,focusOffset:h}=e.domSelectionRange(),d=u&&!c.contains(1==u.nodeType?u:u.parentNode)||t==u&&i==h;try{a.collapse(s,o),t&&(t!=s||i!=o)&&a.extend&&a.extend(t,i)}catch(f){}return null!=l&&(a.caretBidiLevel=l),d}):"left"==n||"backward"==n?s:o:r.pos==r.start()||r.pos==r.end()}(e,t,n))}class pv{constructor(e,t,n,r){this.parent=e,this.children=t,this.dom=n,this.contentDOM=r,this.dirty=0,n.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,n){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,n=this.posAtStart;;t++){let r=this.children[t];if(r==e)return n;n+=r.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,n){if(this.contentDOM&&this.contentDOM.contains(1==e.nodeType?e:e.parentNode)){if(n<0){let n,r;if(e==this.contentDOM)n=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.previousSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.previousSibling;return n?this.posBeforeChild(r)+r.size:this.posAtStart}{let n,r;if(e==this.contentDOM)n=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;n=e.nextSibling}for(;n&&(!(r=n.pmViewDesc)||r.parent!=this);)n=n.nextSibling;return n?this.posBeforeChild(r):this.posAtEnd}}let r;if(e==this.dom&&this.contentDOM)r=t>my(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))r=2&e.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==t)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!1;break}if(t.previousSibling)break}if(null==r&&t==e.childNodes.length)for(let t=e;;t=t.parentNode){if(t==this.dom){r=!0;break}if(t.nextSibling)break}}return(null==r?n>0:r)?this.posAtEnd:this.posAtStart}nearestDesc(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(let n=!0,r=e;r;r=r.parentNode){let i,s=this.getDesc(r);if(s&&(!t||s.node)){if(!n||!(i=s.nodeDOM)||(1==i.nodeType?i.contains(1==e.nodeType?e:e.parentNode):i==e))return s;n=!1}}}getDesc(e){let t=e.pmViewDesc;for(let n=t;n;n=n.parent)if(n==this)return t}posFromDOM(e,t,n){for(let r=e;r;r=r.parentNode){let i=this.getDesc(r);if(i)return i.localPosFromDOM(e,t,n)}return-1}descAt(e){for(let t=0,n=0;t<this.children.length;t++){let r=this.children[t],i=n+r.size;if(n==e&&i!=n){for(;!r.border&&r.children.length;)for(let e=0;e<r.children.length;e++){let t=r.children[e];if(t.size){r=t;break}}return r}if(e<i)return r.descAt(e-n-r.border);n=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let n=0,r=0;for(let i=0;n<this.children.length;n++){let t=this.children[n],s=i+t.size;if(s>e||t instanceof Sv){r=e-i;break}i=s}if(r)return this.children[n].domFromPos(r-this.children[n].border,t);for(let i;n&&!(i=this.children[n-1]).size&&i instanceof mv&&i.side>=0;n--);if(t<=0){let e,r=!0;for(;e=n?this.children[n-1]:null,e&&e.dom.parentNode!=this.contentDOM;n--,r=!1);return e&&t&&r&&!e.border&&!e.domAtom?e.domFromPos(e.size,t):{node:this.contentDOM,offset:e?my(e.dom)+1:0}}{let e,r=!0;for(;e=n<this.children.length?this.children[n]:null,e&&e.dom.parentNode!=this.contentDOM;n++,r=!1);return e&&r&&!e.border&&!e.domAtom?e.domFromPos(0,t):{node:this.contentDOM,offset:e?my(e.dom):this.contentDOM.childNodes.length}}}parseRange(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(0==this.children.length)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let r=-1,i=-1;for(let s=n,o=0;;o++){let n=this.children[o],a=s+n.size;if(-1==r&&e<=a){let i=s+n.border;if(e>=i&&t<=a-n.border&&n.node&&n.contentDOM&&this.contentDOM.contains(n.contentDOM))return n.parseRange(e,t,i);e=s;for(let t=o;t>0;t--){let n=this.children[t-1];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(1)){r=my(n.dom)+1;break}e-=n.size}-1==r&&(r=0)}if(r>-1&&(a>t||o==this.children.length-1)){t=a;for(let e=o+1;e<this.children.length;e++){let n=this.children[e];if(n.size&&n.dom.parentNode==this.contentDOM&&!n.emptyChildAt(-1)){i=my(n.dom);break}t+=n.size}-1==i&&(i=this.contentDOM.childNodes.length);break}s=a}return{node:this.contentDOM,from:e,to:t,fromOffset:r,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return 0==t.size||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:n}=this.domFromPos(e,0);if(1!=t.nodeType||n==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[n]}setSelection(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=Math.min(e,t),s=Math.max(e,t);for(let f=0,p=0;f<this.children.length;f++){let o=this.children[f],a=p+o.size;if(i>p&&s<a)return o.setSelection(e-p-o.border,t-p-o.border,n,r);p=a}let o=this.domFromPos(e,e?-1:1),a=t==e?o:this.domFromPos(t,t?-1:1),l=n.root.getSelection(),c=n.domSelectionRange(),u=!1;if((Dy||jy)&&e==t){let{node:e,offset:t}=o;if(3==e.nodeType){if(u=!(!t||"\n"!=e.nodeValue[t-1]),u&&t==e.nodeValue.length)for(let n,r=e;r;r=r.parentNode){if(n=r.nextSibling){"BR"==n.nodeName&&(o=a={node:n.parentNode,offset:my(n)+1});break}let e=r.pmViewDesc;if(e&&e.node&&e.node.isBlock)break}}else{let n=e.childNodes[t-1];u=n&&("BR"==n.nodeName||"false"==n.contentEditable)}}if(Dy&&c.focusNode&&c.focusNode!=a.node&&1==c.focusNode.nodeType){let e=c.focusNode.childNodes[c.focusOffset];e&&"false"==e.contentEditable&&(r=!0)}if(!(r||u&&jy)&&wy(o.node,o.offset,c.anchorNode,c.anchorOffset)&&wy(a.node,a.offset,c.focusNode,c.focusOffset))return;let h=!1;if((l.extend||e==t)&&!u){l.collapse(o.node,o.offset);try{e!=t&&l.extend(a.node,a.offset),h=!0}catch(d){}}if(!h){if(e>t){let e=o;o=a,a=e}let n=document.createRange();n.setEnd(a.node,a.offset),n.setStart(o.node,o.offset),l.removeAllRanges(),l.addRange(n)}}ignoreMutation(e){return!this.contentDOM&&"selection"!=e.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let n=0,r=0;r<this.children.length;r++){let i=this.children[r],s=n+i.size;if(n==s?e<=s&&t>=n:e<s&&t>n){let r=n+i.border,o=s-i.border;if(e>=r&&t<=o)return this.dirty=e==n||t==s?2:1,void(e!=r||t!=o||!i.contentLost&&i.dom.parentNode==this.contentDOM?i.markDirty(e-r,t-r):i.dirty=3);i.dirty=i.dom!=i.contentDOM||i.dom.parentNode!=this.contentDOM||i.children.length?3:2}n=s}this.dirty=2}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let n=1==e?2:1;t.dirty<n&&(t.dirty=n)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class mv extends pv{constructor(e,t,n,r){let i,s=t.type.toDOM;if("function"==typeof s&&(s=s(n,()=>i?i.parent?i.parent.posBeforeChild(i):void 0:r)),!t.type.spec.raw){if(1!=s.nodeType){let e=document.createElement("span");e.appendChild(s),s=e}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return 0==this.dirty&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return!!t&&t(e)}ignoreMutation(e){return"selection"!=e.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class gv extends pv{constructor(e,t,n,r){super(e,[],t,null),this.textDOM=n,this.text=r}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return"characterData"===e.type&&e.target.nodeValue==e.oldValue}}class yv extends pv{constructor(e,t,n,r,i){super(e,[],n,r),this.mark=t,this.spec=i}static create(e,t,n,r){let i=r.nodeViews[t.type.name],s=i&&i(t,r,n);return s&&s.dom||(s=Jm.renderSpec(document,t.type.spec.toDOM(t,n),null,t.attrs)),new yv(e,t,s.dom,s.contentDOM||s.dom,s)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return 3!=this.dirty&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),0!=this.dirty){let e=this.parent;for(;!e.node;)e=e.parent;e.dirty<this.dirty&&(e.dirty=this.dirty),this.dirty=0}}slice(e,t,n){let r=yv.create(this.parent,this.mark,!0,n),i=this.children,s=this.size;t<s&&(i=Dv(i,t,s,n)),e>0&&(i=Dv(i,0,e,n));for(let o=0;o<i.length;o++)i[o].parent=r;return r.children=i,r}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class vv extends pv{constructor(e,t,n,r,i,s,o,a,l){super(e,[],i,s),this.node=t,this.outerDeco=n,this.innerDeco=r,this.nodeDOM=o}static create(e,t,n,r,i,s){let o,a=i.nodeViews[t.type.name],l=a&&a(t,i,()=>o?o.parent?o.parent.posBeforeChild(o):void 0:s,n,r),c=l&&l.dom,u=l&&l.contentDOM;if(t.isText)if(c){if(3!=c.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else c=document.createTextNode(t.text);else if(!c){let e=Jm.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs);({dom:c,contentDOM:u}=e)}u||t.isText||"BR"==c.nodeName||(c.hasAttribute("contenteditable")||(c.contentEditable="false"),t.type.spec.draggable&&(c.draggable=!0));let h=c;return c=Av(c,n,t),l?o=new kv(e,t,n,r,c,u||null,h,l,i,s+1):t.isText?new bv(e,t,n,r,c,h,i):new vv(e,t,n,r,c,u||null,h,i,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(e.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let t=this.children.length-1;t>=0;t--){let n=this.children[t];if(this.dom.contains(n.dom.parentNode)){e.contentElement=n.dom.parentNode;break}}e.contentElement||(e.getContent=()=>Gp.empty)}else e.contentElement=this.contentDOM;else e.getContent=()=>this.node.content;return e}matchesNode(e,t,n){return 0==this.dirty&&e.eq(this.node)&&Nv(t,this.outerDeco)&&n.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let n=this.node.inlineContent,r=t,i=e.composing?this.localCompositionInfo(e,t):null,s=i&&i.pos>-1?i:null,o=i&&i.pos<0,a=new Mv(this,s&&s.node,e);!function(e,t,n,r){let i=t.locals(e),s=0;if(0==i.length){for(let n=0;n<e.childCount;n++){let o=e.child(n);r(o,i,t.forChild(s,o),n),s+=o.nodeSize}return}let o=0,a=[],l=null;for(let c=0;;){let u,h,d,f;for(;o<i.length&&i[o].to==s;){let e=i[o++];e.widget&&(u?(h||(h=[u])).push(e):u=e)}if(u)if(h){h.sort(Rv);for(let e=0;e<h.length;e++)n(h[e],c,!!l)}else n(u,c,!!l);if(l)f=-1,d=l,l=null;else{if(!(c<e.childCount))break;f=c,d=e.child(c++)}for(let e=0;e<a.length;e++)a[e].to<=s&&a.splice(e--,1);for(;o<i.length&&i[o].from<=s&&i[o].to>s;)a.push(i[o++]);let p=s+d.nodeSize;if(d.isText){let e=p;o<i.length&&i[o].from<e&&(e=i[o].from);for(let t=0;t<a.length;t++)a[t].to<e&&(e=a[t].to);e<p&&(l=d.cut(e-s),d=d.cut(0,e-s),p=e,f=-1)}else for(;o<i.length&&i[o].to<p;)o++;r(d,d.isInline&&!d.isLeaf?a.filter(e=>!e.inline):a.slice(),t.forChild(s,d),f),s=p}}(this.node,this.innerDeco,(t,i,s)=>{t.spec.marks?a.syncToMarks(t.spec.marks,n,e):t.type.side>=0&&!s&&a.syncToMarks(i==this.node.childCount?Yp.none:this.node.child(i).marks,n,e),a.placeWidget(t,e,r)},(t,s,l,c)=>{let u;a.syncToMarks(t.marks,n,e),a.findNodeMatch(t,s,l,c)||o&&e.state.selection.from>r&&e.state.selection.to<r+t.nodeSize&&(u=a.findIndexWithChild(i.node))>-1&&a.updateNodeAt(t,s,l,u,e)||a.updateNextNode(t,s,l,e,c,r)||a.addNode(t,s,l,e,r),r+=t.nodeSize}),a.syncToMarks([],n,e),this.node.isTextblock&&a.addTextblockHacks(),a.destroyRest(),(a.changed||2==this.dirty)&&(s&&this.protectLocalComposition(e,s),Ev(this.contentDOM,this.children,e),Vy&&function(e){if("UL"==e.nodeName||"OL"==e.nodeName){let t=e.style.cssText;e.style.cssText=t+"; list-style: square !important",window.getComputedStyle(e).listStyle,e.style.cssText=t}}(this.dom))}localCompositionInfo(e,t){let{from:n,to:r}=e.state.selection;if(!(e.state.selection instanceof Qg)||n<t||r>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let e=i.nodeValue,s=function(e,t,n,r){for(let i=0,s=0;i<e.childCount&&s<=r;){let o=e.child(i++),a=s;if(s+=o.nodeSize,!o.isText)continue;let l=o.text;for(;i<e.childCount;){let t=e.child(i++);if(s+=t.nodeSize,!t.isText)break;l+=t.text}if(s>=n){if(s>=r&&l.slice(r-t.length-a,r-a)==t)return r-t.length;let e=a<r?l.lastIndexOf(t,r-a-1):-1;if(e>=0&&e+t.length+a>=n)return a+e;if(n==r&&l.length>=r+t.length-a&&l.slice(r-a,r-a+t.length)==t)return r}}return-1}(this.node.content,e,n-t,r-t);return s<0?null:{node:i,pos:s,text:e}}return{node:i,pos:-1,text:""}}protectLocalComposition(e,t){let{node:n,pos:r,text:i}=t;if(this.getDesc(n))return;let s=n;for(;s.parentNode!=this.contentDOM;s=s.parentNode){for(;s.previousSibling;)s.parentNode.removeChild(s.previousSibling);for(;s.nextSibling;)s.parentNode.removeChild(s.nextSibling);s.pmViewDesc&&(s.pmViewDesc=void 0)}let o=new gv(this,s,n,i);e.input.compositionNodes.push(o),this.children=Dv(this.children,r,r+i.length,e,o)}update(e,t,n,r){return!(3==this.dirty||!e.sameMarkup(this.node))&&(this.updateInner(e,t,n,r),!0)}updateInner(e,t,n,r){this.updateOuterDeco(t),this.node=e,this.innerDeco=n,this.contentDOM&&this.updateChildren(r,this.posAtStart),this.dirty=0}updateOuterDeco(e){if(Nv(e,this.outerDeco))return;let t=1!=this.nodeDOM.nodeType,n=this.dom;this.dom=_v(this.dom,this.nodeDOM,Tv(this.outerDeco,this.node,t),Tv(e,this.node,t)),this.dom!=n&&(n.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),!this.contentDOM&&this.node.type.spec.draggable||this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function wv(e,t,n,r,i){Av(r,t,e);let s=new vv(void 0,e,t,n,r,r,r,i,0);return s.contentDOM&&s.updateChildren(i,0),s}class bv extends vv{constructor(e,t,n,r,i,s,o){super(e,t,n,r,i,null,s,o,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,n,r){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!e.sameMarkup(this.node))&&(this.updateOuterDeco(t),0==this.dirty&&e.text==this.node.text||e.text==this.nodeDOM.nodeValue||(this.nodeDOM.nodeValue=e.text,r.trackWrites==this.nodeDOM&&(r.trackWrites=null)),this.node=e,this.dirty=0,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,n){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,n)}ignoreMutation(e){return"characterData"!=e.type&&"selection"!=e.type}slice(e,t,n){let r=this.node.cut(e,t),i=document.createTextNode(r.text);return new bv(this.parent,r,this.outerDeco,this.innerDeco,i,i,n)}markDirty(e,t){super.markDirty(e,t),this.dom==this.nodeDOM||0!=e&&t!=this.nodeDOM.nodeValue.length||(this.dirty=3)}get domAtom(){return!1}isText(e){return this.node.text==e}}class Sv extends pv{parseRule(){return{ignore:!0}}matchesHack(e){return 0==this.dirty&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class kv extends vv{constructor(e,t,n,r,i,s,o,a,l,c){super(e,t,n,r,i,s,o,l,c),this.spec=a}update(e,t,n,r){if(3==this.dirty)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,n);return i&&this.updateInner(e,t,n,r),i}return!(!this.contentDOM&&!e.isLeaf)&&super.update(e,t,n,r)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,n,r){this.spec.setSelection?this.spec.setSelection(e,t,n.root):super.setSelection(e,t,n,r)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return!!this.spec.stopEvent&&this.spec.stopEvent(e)}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function Ev(e,t,n){let r=e.firstChild,i=!1;for(let s=0;s<t.length;s++){let o=t[s],a=o.dom;if(a.parentNode==e){for(;a!=r;)r=Ov(r),i=!0;r=r.nextSibling}else i=!0,e.insertBefore(a,r);if(o instanceof yv){let t=r?r.previousSibling:e.lastChild;Ev(o.contentDOM,o.children,n),r=t?t.nextSibling:e.firstChild}}for(;r;)r=Ov(r),i=!0;i&&n.trackWrites==e&&(n.trackWrites=null)}const xv=function(e){e&&(this.nodeName=e)};xv.prototype=Object.create(null);const Cv=[new xv];function Tv(e,t,n){if(0==e.length)return Cv;let r=n?Cv[0]:new xv,i=[r];for(let s=0;s<e.length;s++){let o=e[s].type.attrs;if(o){o.nodeName&&i.push(r=new xv(o.nodeName));for(let e in o){let s=o[e];null!=s&&(n&&1==i.length&&i.push(r=new xv(t.isInline?"span":"div")),"class"==e?r.class=(r.class?r.class+" ":"")+s:"style"==e?r.style=(r.style?r.style+";":"")+s:"nodeName"!=e&&(r[e]=s))}}}return i}function _v(e,t,n,r){if(n==Cv&&r==Cv)return t;let i=t;for(let s=0;s<r.length;s++){let t=r[s],o=n[s];if(s){let n;o&&o.nodeName==t.nodeName&&i!=e&&(n=i.parentNode)&&n.nodeName.toLowerCase()==t.nodeName||(n=document.createElement(t.nodeName),n.pmIsDeco=!0,n.appendChild(i),o=Cv[0]),i=n}Iv(i,o||Cv[0],t)}return i}function Iv(e,t,n){for(let r in t)"class"==r||"style"==r||"nodeName"==r||r in n||e.removeAttribute(r);for(let r in n)"class"!=r&&"style"!=r&&"nodeName"!=r&&n[r]!=t[r]&&e.setAttribute(r,n[r]);if(t.class!=n.class){let r=t.class?t.class.split(" ").filter(Boolean):[],i=n.class?n.class.split(" ").filter(Boolean):[];for(let t=0;t<r.length;t++)-1==i.indexOf(r[t])&&e.classList.remove(r[t]);for(let t=0;t<i.length;t++)-1==r.indexOf(i[t])&&e.classList.add(i[t]);0==e.classList.length&&e.removeAttribute("class")}if(t.style!=n.style){if(t.style){let n,r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;n=r.exec(t.style);)e.style.removeProperty(n[1])}n.style&&(e.style.cssText+=n.style)}}function Av(e,t,n){return _v(e,e,Cv,Tv(t,n,1!=e.nodeType))}function Nv(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++)if(!e[n].type.eq(t[n].type))return!1;return!0}function Ov(e){let t=e.nextSibling;return e.parentNode.removeChild(e),t}class Mv{constructor(e,t,n){this.lock=t,this.view=n,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=function(e,t){let n=t,r=n.children.length,i=e.childCount,s=new Map,o=[];e:for(;i>0;){let a;for(;;)if(r){let e=n.children[r-1];if(!(e instanceof yv)){a=e,r--;break}n=e,r=e.children.length}else{if(n==t)break e;r=n.parent.children.indexOf(n),n=n.parent}let l=a.node;if(l){if(l!=e.child(i-1))break;--i,s.set(a,i),o.push(a)}}return{index:i,matched:s,matches:o.reverse()}}(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let n=e;n<t;n++)this.top.children[n].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,n){let r=0,i=this.stack.length>>1,s=Math.min(i,e.length);for(;r<s&&(r==i-1?this.top:this.stack[r+1<<1]).matchesMark(e[r])&&!1!==e[r].type.spec.spanning;)r++;for(;r<i;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let r=-1;for(let t=this.index;t<Math.min(this.index+3,this.top.children.length);t++){let n=this.top.children[t];if(n.matchesMark(e[i])&&!this.isLocked(n.dom)){r=t;break}}if(r>-1)r>this.index&&(this.changed=!0,this.destroyBetween(this.index,r)),this.top=this.top.children[this.index];else{let r=yv.create(this.top,e[i],t,n);this.top.children.splice(this.index,0,r),this.top=r,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,n,r){let i,s=-1;if(r>=this.preMatch.index&&(i=this.preMatch.matches[r-this.preMatch.index]).parent==this.top&&i.matchesNode(e,t,n))s=this.top.children.indexOf(i,this.index);else for(let o=this.index,a=Math.min(this.top.children.length,o+5);o<a;o++){let r=this.top.children[o];if(r.matchesNode(e,t,n)&&!this.preMatch.matched.has(r)){s=o;break}}return!(s<0)&&(this.destroyBetween(this.index,s),this.index++,!0)}updateNodeAt(e,t,n,r,i){let s=this.top.children[r];return 3==s.dirty&&s.dom==s.contentDOM&&(s.dirty=2),!!s.update(e,t,n,i)&&(this.destroyBetween(this.index,r),this.index++,!0)}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let t=e.pmViewDesc;if(t)for(let e=this.index;e<this.top.children.length;e++)if(this.top.children[e]==t)return e;return-1}e=t}}updateNextNode(e,t,n,r,i,s){for(let o=this.index;o<this.top.children.length;o++){let a=this.top.children[o];if(a instanceof vv){let l=this.preMatch.matched.get(a);if(null!=l&&l!=i)return!1;let c,u=a.dom,h=this.isLocked(u)&&!(e.isText&&a.node&&a.node.isText&&a.nodeDOM.nodeValue==e.text&&3!=a.dirty&&Nv(t,a.outerDeco));if(!h&&a.update(e,t,n,r))return this.destroyBetween(this.index,o),a.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(c=this.recreateWrapper(a,e,t,n,r,s)))return this.destroyBetween(this.index,o),this.top.children[this.index]=c,c.contentDOM&&(c.dirty=2,c.updateChildren(r,s+1),c.dirty=0),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,n,r,i,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!Nv(n,e.outerDeco)||!r.eq(e.innerDeco))return null;let o=vv.create(this.top,t,n,r,i,s);if(o.contentDOM){o.children=e.children,e.children=[];for(let e of o.children)e.parent=o}return e.destroy(),o}addNode(e,t,n,r,i){let s=vv.create(this.top,e,t,n,r,i);s.contentDOM&&s.updateChildren(r,i+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,n){let r=this.index<this.top.children.length?this.top.children[this.index]:null;if(!r||!r.matchesWidget(e)||e!=r.widget&&r.widget.type.toDOM.parentNode){let r=new mv(this.top,e,t,n);this.top.children.splice(this.index++,0,r),this.changed=!0}else this.index++}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof yv;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof bv)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((jy||Ly)&&e&&"false"==e.dom.contentEditable&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let n=document.createElement(e);"IMG"==e&&(n.className="ProseMirror-separator",n.alt=""),"BR"==e&&(n.className="ProseMirror-trailingBreak");let r=new Sv(this.top,[],n,null);t!=this.top?t.children.push(r):t.children.splice(this.index++,0,r),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||1==e.nodeType&&e.contains(this.lock.parentNode))}}function Rv(e,t){return e.type.side-t.type.side}function Dv(e,t,n,r,i){let s=[];for(let o=0,a=0;o<e.length;o++){let l=e[o],c=a,u=a+=l.size;c>=n||u<=t?s.push(l):(c<t&&s.push(l.slice(0,t-c,r)),i&&(s.push(i),i=void 0),u>n&&s.push(l.slice(n-c,l.size,r)))}return s}function Pv(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=e.domSelectionRange(),r=e.state.doc;if(!n.focusNode)return null;let i=e.docView.nearestDesc(n.focusNode),s=i&&0==i.size,o=e.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(o<0)return null;let a,l,c=r.resolve(o);if(xy(n)){for(a=o;i&&!i.node;)i=i.parent;let e=i.node;if(i&&e.isAtom&&Yg.isSelectable(e)&&i.parent&&(!e.isInline||!function(e,t,n){for(let r=0==t,i=t==ky(e);r||i;){if(e==n)return!0;let t=my(e);if(!(e=e.parentNode))return!1;r=r&&0==t,i=i&&t==ky(e)}}(n.focusNode,n.focusOffset,i.dom))){let e=i.posBefore;l=new Yg(o==e?c:r.resolve(e))}}else{if(n instanceof e.dom.ownerDocument.defaultView.Selection&&n.rangeCount>1){let t=o,i=o;for(let r=0;r<n.rangeCount;r++){let s=n.getRangeAt(r);t=Math.min(t,e.docView.posFromDOM(s.startContainer,s.startOffset,1)),i=Math.max(i,e.docView.posFromDOM(s.endContainer,s.endOffset,-1))}if(t<0)return null;[a,o]=i==e.state.selection.anchor?[i,t]:[t,i],c=r.resolve(o)}else a=e.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(a<0)return null}let u=r.resolve(a);if(!l){l=qv(e,u,c,"pointer"==t||e.state.selection.head<c.pos&&!s?1:-1)}return l}function Lv(e){return e.editable?e.hasFocus():Wv(e)&&document.activeElement&&document.activeElement.contains(e.dom)}function Fv(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e.state.selection;if(Bv(e,n),Lv(e)){if(!t&&e.input.mouseDown&&e.input.mouseDown.allowDefault&&Ly){let t=e.domSelectionRange(),n=e.domObserver.currentSelection;if(t.anchorNode&&n.anchorNode&&wy(t.anchorNode,t.anchorOffset,n.anchorNode,n.anchorOffset))return e.input.mouseDown.delayedSelectionSync=!0,void e.domObserver.setCurSelection()}if(e.domObserver.disconnectSelection(),e.cursorWrapper)!function(e){let t=e.domSelection(),n=document.createRange();if(!t)return;let r=e.cursorWrapper.dom,i="IMG"==r.nodeName;i?n.setStart(r.parentNode,my(r)+1):n.setStart(r,0);n.collapse(!0),t.removeAllRanges(),t.addRange(n),!i&&!e.state.selection.visible&&My&&Ry<=11&&(r.disabled=!0,r.disabled=!1)}(e);else{let r,i,{anchor:s,head:o}=n;!jv||n instanceof Qg||(n.$from.parent.inlineContent||(r=Vv(e,n.from)),n.empty||n.$from.parent.inlineContent||(i=Vv(e,n.to))),e.docView.setSelection(s,o,e,t),jv&&(r&&Uv(r),i&&Uv(i)),n.visible?e.dom.classList.remove("ProseMirror-hideselection"):(e.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function(e){let t=e.dom.ownerDocument;t.removeEventListener("selectionchange",e.input.hideSelectionGuard);let n=e.domSelectionRange(),r=n.anchorNode,i=n.anchorOffset;t.addEventListener("selectionchange",e.input.hideSelectionGuard=()=>{n.anchorNode==r&&n.anchorOffset==i||(t.removeEventListener("selectionchange",e.input.hideSelectionGuard),setTimeout(()=>{Lv(e)&&!e.state.selection.visible||e.dom.classList.remove("ProseMirror-hideselection")},20))})}(e))}e.domObserver.setCurSelection(),e.domObserver.connectSelection()}}const jv=jy||Ly&&Fy<63;function Vv(e,t){let{node:n,offset:r}=e.docView.domFromPos(t,0),i=r<n.childNodes.length?n.childNodes[r]:null,s=r?n.childNodes[r-1]:null;if(jy&&i&&"false"==i.contentEditable)return zv(i);if((!i||"false"==i.contentEditable)&&(!s||"false"==s.contentEditable)){if(i)return zv(i);if(s)return zv(s)}}function zv(e){return e.contentEditable="true",jy&&e.draggable&&(e.draggable=!1,e.wasDraggable=!0),e}function Uv(e){e.contentEditable="false",e.wasDraggable&&(e.draggable=!0,e.wasDraggable=null)}function Bv(e,t){if(t instanceof Yg){let n=e.docView.descAt(t.from);n!=e.lastSelectedViewDesc&&($v(e),n&&n.selectNode(),e.lastSelectedViewDesc=n)}else $v(e)}function $v(e){e.lastSelectedViewDesc&&(e.lastSelectedViewDesc.parent&&e.lastSelectedViewDesc.deselectNode(),e.lastSelectedViewDesc=void 0)}function qv(e,t,n,r){return e.someProp("createSelectionBetween",r=>r(e,t,n))||Qg.between(t,n,r)}function Hv(e){return!(e.editable&&!e.hasFocus())&&Wv(e)}function Wv(e){let t=e.domSelectionRange();if(!t.anchorNode)return!1;try{return e.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(e.editable||e.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function Kv(e,t){let{$anchor:n,$head:r}=e.selection,i=t>0?n.max(r):n.min(r),s=i.parent.inlineContent?i.depth?e.doc.resolve(t>0?i.after():i.before()):null:i;return s&&Wg.findFrom(s,t)}function Gv(e,t){return e.dispatch(e.state.tr.setSelection(t).scrollIntoView()),!0}function Jv(e,t,n){let r=e.state.selection;if(!(r instanceof Qg)){if(r instanceof Yg&&r.node.isInline)return Gv(e,new Qg(t>0?r.$to:r.$from));{let n=Kv(e.state,t);return!!n&&Gv(e,n)}}if(n.indexOf("s")>-1){let{$head:n}=r,i=n.textOffset?null:t<0?n.nodeBefore:n.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let s=e.state.doc.resolve(n.pos+i.nodeSize*(t<0?-1:1));return Gv(e,new Qg(r.$anchor,s))}if(!r.empty)return!1;if(e.endOfTextblock(t>0?"forward":"backward")){let n=Kv(e.state,t);return!!(n&&n instanceof Yg)&&Gv(e,n)}if(!(zy&&n.indexOf("m")>-1)){let n,i=r.$head,s=i.textOffset?null:t<0?i.nodeBefore:i.nodeAfter;if(!s||s.isText)return!1;let o=t<0?i.pos-s.nodeSize:i.pos;return!!(s.isAtom||(n=e.docView.descAt(o))&&!n.contentDOM)&&(Yg.isSelectable(s)?Gv(e,new Yg(t<0?e.state.doc.resolve(i.pos-s.nodeSize):i)):!!$y&&Gv(e,new Qg(e.state.doc.resolve(t<0?o:o+s.nodeSize))))}}function Qv(e){return 3==e.nodeType?e.nodeValue.length:e.childNodes.length}function Xv(e,t){let n=e.pmViewDesc;return n&&0==n.size&&(t<0||e.nextSibling||"BR"!=e.nodeName)}function Yv(e,t){return t<0?function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let i,s,o=!1;Dy&&1==n.nodeType&&r<Qv(n)&&Xv(n.childNodes[r],-1)&&(o=!0);for(;;)if(r>0){if(1!=n.nodeType)break;{let e=n.childNodes[r-1];if(Xv(e,-1))i=n,s=--r;else{if(3!=e.nodeType)break;n=e,r=n.nodeValue.length}}}else{if(Zv(n))break;{let t=n.previousSibling;for(;t&&Xv(t,-1);)i=n.parentNode,s=my(t),t=t.previousSibling;if(t)n=t,r=Qv(n);else{if(n=n.parentNode,n==e.dom)break;r=0}}}o?ew(e,n,r):i&&ew(e,i,s)}(e):function(e){let t=e.domSelectionRange(),n=t.focusNode,r=t.focusOffset;if(!n)return;let i,s,o=Qv(n);for(;;)if(r<o){if(1!=n.nodeType)break;if(!Xv(n.childNodes[r],1))break;i=n,s=++r}else{if(Zv(n))break;{let t=n.nextSibling;for(;t&&Xv(t,1);)i=t.parentNode,s=my(t)+1,t=t.nextSibling;if(t)n=t,r=0,o=Qv(n);else{if(n=n.parentNode,n==e.dom)break;r=o=0}}}i&&ew(e,i,s)}(e)}function Zv(e){let t=e.pmViewDesc;return t&&t.node&&t.node.isBlock}function ew(e,t,n){if(3!=t.nodeType){let e,r;(r=function(e,t){for(;e&&t==e.childNodes.length&&!Ey(e);)t=my(e)+1,e=e.parentNode;for(;e&&t<e.childNodes.length;){let n=e.childNodes[t];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;e=n,t=0}}(t,n))?(t=r,n=0):(e=function(e,t){for(;e&&!t&&!Ey(e);)t=my(e),e=e.parentNode;for(;e&&t;){let n=e.childNodes[t-1];if(3==n.nodeType)return n;if(1==n.nodeType&&"false"==n.contentEditable)break;t=(e=n).childNodes.length}}(t,n))&&(t=e,n=e.nodeValue.length)}let r=e.domSelection();if(!r)return;if(xy(r)){let e=document.createRange();e.setEnd(t,n),e.setStart(t,n),r.removeAllRanges(),r.addRange(e)}else r.extend&&r.extend(t,n);e.domObserver.setCurSelection();let{state:i}=e;setTimeout(()=>{e.state==i&&Fv(e)},50)}function tw(e,t){let n=e.state.doc.resolve(t);if(!Ly&&!Uy&&n.parent.inlineContent){let r=e.coordsAtPos(t);if(t>n.start()){let n=e.coordsAtPos(t-1),i=(n.top+n.bottom)/2;if(i>r.top&&i<r.bottom&&Math.abs(n.left-r.left)>1)return n.left<r.left?"ltr":"rtl"}if(t<n.end()){let n=e.coordsAtPos(t+1),i=(n.top+n.bottom)/2;if(i>r.top&&i<r.bottom&&Math.abs(n.left-r.left)>1)return n.left>r.left?"ltr":"rtl"}}return"rtl"==getComputedStyle(e.dom).direction?"rtl":"ltr"}function nw(e,t,n){let r=e.state.selection;if(r instanceof Qg&&!r.empty||n.indexOf("s")>-1)return!1;if(zy&&n.indexOf("m")>-1)return!1;let{$from:i,$to:s}=r;if(!i.parent.inlineContent||e.endOfTextblock(t<0?"up":"down")){let n=Kv(e.state,t);if(n&&n instanceof Yg)return Gv(e,n)}if(!i.parent.inlineContent){let n=t<0?i:s,o=r instanceof ey?Wg.near(n,t):Wg.findFrom(n,t);return!!o&&Gv(e,o)}return!1}function rw(e,t){if(!(e.state.selection instanceof Qg))return!0;let{$head:n,$anchor:r,empty:i}=e.state.selection;if(!n.sameParent(r))return!0;if(!i)return!1;if(e.endOfTextblock(t>0?"forward":"backward"))return!0;let s=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(s&&!s.isText){let r=e.state.tr;return t<0?r.delete(n.pos-s.nodeSize,n.pos):r.delete(n.pos,n.pos+s.nodeSize),e.dispatch(r),!0}return!1}function iw(e,t,n){e.domObserver.stop(),t.contentEditable=n,e.domObserver.start()}function sw(e,t){let n=t.keyCode,r=function(e){let t="";return e.ctrlKey&&(t+="c"),e.metaKey&&(t+="m"),e.altKey&&(t+="a"),e.shiftKey&&(t+="s"),t}(t);if(8==n||zy&&72==n&&"c"==r)return rw(e,-1)||Yv(e,-1);if(46==n&&!t.shiftKey||zy&&68==n&&"c"==r)return rw(e,1)||Yv(e,1);if(13==n||27==n)return!0;if(37==n||zy&&66==n&&"c"==r){let t=37==n?"ltr"==tw(e,e.state.selection.from)?-1:1:-1;return Jv(e,t,r)||Yv(e,t)}if(39==n||zy&&70==n&&"c"==r){let t=39==n?"ltr"==tw(e,e.state.selection.from)?1:-1:1;return Jv(e,t,r)||Yv(e,t)}return 38==n||zy&&80==n&&"c"==r?nw(e,-1,r)||Yv(e,-1):40==n||zy&&78==n&&"c"==r?function(e){if(!jy||e.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=e.domSelectionRange();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let n=t.firstChild;iw(e,n,"true"),setTimeout(()=>iw(e,n,"false"),20)}return!1}(e)||nw(e,1,r)||Yv(e,1):r==(zy?"m":"c")&&(66==n||73==n||89==n||90==n)}function ow(e,t){e.someProp("transformCopied",n=>{t=n(t,e)});let n=[],{content:r,openStart:i,openEnd:s}=t;for(;i>1&&s>1&&1==r.childCount&&1==r.firstChild.childCount;){i--,s--;let e=r.firstChild;n.push(e.type.name,e.attrs!=e.type.defaultAttrs?e.attrs:null),r=e.content}let o=e.someProp("clipboardSerializer")||Jm.fromSchema(e.state.schema),a=gw(),l=a.createElement("div");l.appendChild(o.serializeFragment(r,{document:a}));let c,u=l.firstChild,h=0;for(;u&&1==u.nodeType&&(c=pw[u.nodeName.toLowerCase()]);){for(let e=c.length-1;e>=0;e--){let t=a.createElement(c[e]);for(;l.firstChild;)t.appendChild(l.firstChild);l.appendChild(t),h++}u=l.firstChild}return u&&1==u.nodeType&&u.setAttribute("data-pm-slice",`${i} ${s}${h?` -${h}`:""} ${JSON.stringify(n)}`),{dom:l,text:e.someProp("clipboardTextSerializer",n=>n(t,e))||t.content.textBetween(0,t.content.size,"\n\n"),slice:t}}function aw(e,t,n,r,i){let s,o,a=i.parent.type.spec.code;if(!n&&!t)return null;let l=t&&(r||a||!n);if(l){if(e.someProp("transformPastedText",n=>{t=n(t,a||r,e)}),a)return t?new em(Gp.from(e.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):em.empty;let n=e.someProp("clipboardTextParser",n=>n(t,i,r,e));if(n)o=n;else{let n=i.marks(),{schema:r}=e.state,o=Jm.fromSchema(r);s=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(e=>{let t=s.appendChild(document.createElement("p"));e&&t.appendChild(o.serializeNode(r.text(e,n)))})}}else e.someProp("transformPastedHTML",t=>{n=t(n,e)}),s=function(e){let t=/^(\s*<meta [^>]*>)*/.exec(e);t&&(e=e.slice(t[0].length));let n,r=gw().createElement("div"),i=/<([a-z][^>\s]+)/i.exec(e);(n=i&&pw[i[1].toLowerCase()])&&(e=n.map(e=>"<"+e+">").join("")+e+n.map(e=>"</"+e+">").reverse().join(""));if(r.innerHTML=function(e){let t=window.trustedTypes;if(!t)return e;yw||(yw=t.defaultPolicy||t.createPolicy("ProseMirrorClipboard",{createHTML:e=>e}));return yw.createHTML(e)}(e),n)for(let s=0;s<n.length;s++)r=r.querySelector(n[s])||r;return r}(n),$y&&function(e){let t=e.querySelectorAll(Ly?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let r=t[n];1==r.childNodes.length&&"\xa0"==r.textContent&&r.parentNode&&r.parentNode.replaceChild(e.ownerDocument.createTextNode(" "),r)}}(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let h=+u[3];h>0;h--){let e=s.firstChild;for(;e&&1!=e.nodeType;)e=e.nextSibling;if(!e)break;s=e}if(!o){let t=e.someProp("clipboardParser")||e.someProp("domParser")||Vm.fromSchema(e.state.schema);o=t.parseSlice(s,{preserveWhitespace:!(!l&&!u),context:i,ruleFromNode:e=>"BR"!=e.nodeName||e.nextSibling||!e.parentNode||lw.test(e.parentNode.nodeName)?null:{ignore:!0}})}if(u)o=function(e,t){if(!e.size)return e;let n,r=e.content.firstChild.type.schema;try{n=JSON.parse(t)}catch(a){return e}let{content:i,openStart:s,openEnd:o}=e;for(let l=n.length-2;l>=0;l-=2){let e=r.nodes[n[l]];if(!e||e.hasRequiredAttrs())break;i=Gp.from(e.create(n[l+1],i)),s++,o++}return new em(i,s,o)}(fw(o,+u[1],+u[2]),u[4]);else if(o=em.maxOpen(function(e,t){if(e.childCount<2)return e;for(let n=t.depth;n>=0;n--){let r,i=t.node(n).contentMatchAt(t.index(n)),s=[];if(e.forEach(e=>{if(!s)return;let t,n=i.findWrapping(e.type);if(!n)return s=null;if(t=s.length&&r.length&&uw(n,r,e,s[s.length-1],0))s[s.length-1]=t;else{s.length&&(s[s.length-1]=hw(s[s.length-1],r.length));let t=cw(e,n);s.push(t),i=i.matchType(t.type),r=n}}),s)return Gp.from(s)}return e}(o.content,i),!0),o.openStart||o.openEnd){let e=0,t=0;for(let n=o.content.firstChild;e<o.openStart&&!n.type.spec.isolating;e++,n=n.firstChild);for(let n=o.content.lastChild;t<o.openEnd&&!n.type.spec.isolating;t++,n=n.lastChild);o=fw(o,e,t)}return e.someProp("transformPasted",t=>{o=t(o,e)}),o}const lw=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function cw(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(let r=t.length-1;r>=n;r--)e=t[r].create(null,Gp.from(e));return e}function uw(e,t,n,r,i){if(i<e.length&&i<t.length&&e[i]==t[i]){let s=uw(e,t,n,r.lastChild,i+1);if(s)return r.copy(r.content.replaceChild(r.childCount-1,s));if(r.contentMatchAt(r.childCount).matchType(i==e.length-1?n.type:e[i+1]))return r.copy(r.content.append(Gp.from(cw(n,e,i+1))))}}function hw(e,t){if(0==t)return e;let n=e.content.replaceChild(e.childCount-1,hw(e.lastChild,t-1)),r=e.contentMatchAt(e.childCount).fillBefore(Gp.empty,!0);return e.copy(n.append(r))}function dw(e,t,n,r,i,s){let o=t<0?e.firstChild:e.lastChild,a=o.content;return e.childCount>1&&(s=0),i<r-1&&(a=dw(a,t,n,r,i+1,s)),i>=n&&(a=t<0?o.contentMatchAt(0).fillBefore(a,s<=i).append(a):a.append(o.contentMatchAt(o.childCount).fillBefore(Gp.empty,!0))),e.replaceChild(t<0?0:e.childCount-1,o.copy(a))}function fw(e,t,n){return t<e.openStart&&(e=new em(dw(e.content,-1,t,e.openStart,0,e.openEnd),t,e.openEnd)),n<e.openEnd&&(e=new em(dw(e.content,1,n,e.openEnd,0,0),e.openStart,n)),e}const pw={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let mw=null;function gw(){return mw||(mw=document.implementation.createHTMLDocument("title"))}let yw=null;const vw={},ww={},bw={touchstart:!0,touchmove:!0};class Sw{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function kw(e,t){e.input.lastSelectionOrigin=t,e.input.lastSelectionTime=Date.now()}function Ew(e){e.someProp("handleDOMEvents",t=>{for(let n in t)e.input.eventHandlers[n]||e.dom.addEventListener(n,e.input.eventHandlers[n]=t=>xw(e,t))})}function xw(e,t){return e.someProp("handleDOMEvents",n=>{let r=n[t.type];return!!r&&(r(e,t)||t.defaultPrevented)})}function Cw(e,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=e.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function Tw(e){return{left:e.clientX,top:e.clientY}}function _w(e,t,n,r,i){if(-1==r)return!1;let s=e.state.doc.resolve(r);for(let o=s.depth+1;o>0;o--)if(e.someProp(t,t=>o>s.depth?t(e,n,s.nodeAfter,s.before(o),i,!0):t(e,n,s.node(o),s.before(o),i,!1)))return!0;return!1}function Iw(e,t,n){if(e.focused||e.focus(),e.state.selection.eq(t))return;let r=e.state.tr.setSelection(t);"pointer"==n&&r.setMeta("pointer",!0),e.dispatch(r)}function Aw(e,t,n,r,i){return _w(e,"handleClickOn",t,n,r)||e.someProp("handleClick",n=>n(e,t,r))||(i?function(e,t){if(-1==t)return!1;let n,r,i=e.state.selection;i instanceof Yg&&(n=i.node);let s=e.state.doc.resolve(t);for(let o=s.depth+1;o>0;o--){let e=o>s.depth?s.nodeAfter:s.node(o);if(Yg.isSelectable(e)){r=n&&i.$from.depth>0&&o>=i.$from.depth&&s.before(i.$from.depth+1)==i.$from.pos?s.before(i.$from.depth):s.before(o);break}}return null!=r&&(Iw(e,Yg.create(e.state.doc,r),"pointer"),!0)}(e,n):function(e,t){if(-1==t)return!1;let n=e.state.doc.resolve(t),r=n.nodeAfter;return!!(r&&r.isAtom&&Yg.isSelectable(r))&&(Iw(e,new Yg(n),"pointer"),!0)}(e,n))}function Nw(e,t,n,r){return _w(e,"handleDoubleClickOn",t,n,r)||e.someProp("handleDoubleClick",n=>n(e,t,r))}function Ow(e,t,n,r){return _w(e,"handleTripleClickOn",t,n,r)||e.someProp("handleTripleClick",n=>n(e,t,r))||function(e,t,n){if(0!=n.button)return!1;let r=e.state.doc;if(-1==t)return!!r.inlineContent&&(Iw(e,Qg.create(r,0,r.content.size),"pointer"),!0);let i=r.resolve(t);for(let s=i.depth+1;s>0;s--){let t=s>i.depth?i.nodeAfter:i.node(s),n=i.before(s);if(t.inlineContent)Iw(e,Qg.create(r,n+1,n+1+t.content.size),"pointer");else{if(!Yg.isSelectable(t))continue;Iw(e,Yg.create(r,n),"pointer")}return!0}}(e,n,r)}function Mw(e){return zw(e)}ww.keydown=(e,t)=>{let n=t;if(e.input.shiftKey=16==n.keyCode||n.shiftKey,!Pw(e,n)&&(e.input.lastKeyCode=n.keyCode,e.input.lastKeyCodeTime=Date.now(),!By||!Ly||13!=n.keyCode))if(229!=n.keyCode&&e.domObserver.forceFlush(),!Vy||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)e.someProp("handleKeyDown",t=>t(e,n))||sw(e,n)?n.preventDefault():kw(e,"key");else{let t=Date.now();e.input.lastIOSEnter=t,e.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{e.input.lastIOSEnter==t&&(e.someProp("handleKeyDown",t=>t(e,Cy(13,"Enter"))),e.input.lastIOSEnter=0)},200)}},ww.keyup=(e,t)=>{16==t.keyCode&&(e.input.shiftKey=!1)},ww.keypress=(e,t)=>{let n=t;if(Pw(e,n)||!n.charCode||n.ctrlKey&&!n.altKey||zy&&n.metaKey)return;if(e.someProp("handleKeyPress",t=>t(e,n)))return void n.preventDefault();let r=e.state.selection;if(!(r instanceof Qg)||!r.$from.sameParent(r.$to)){let t=String.fromCharCode(n.charCode),i=()=>e.state.tr.insertText(t).scrollIntoView();/[\r\n]/.test(t)||e.someProp("handleTextInput",n=>n(e,r.$from.pos,r.$to.pos,t,i))||e.dispatch(i()),n.preventDefault()}};const Rw=zy?"metaKey":"ctrlKey";vw.mousedown=(e,t)=>{let n=t;e.input.shiftKey=n.shiftKey;let r=Mw(e),i=Date.now(),s="singleClick";i-e.input.lastClick.time<500&&function(e,t){let n=t.x-e.clientX,r=t.y-e.clientY;return n*n+r*r<100}(n,e.input.lastClick)&&!n[Rw]&&e.input.lastClick.button==n.button&&("singleClick"==e.input.lastClick.type?s="doubleClick":"doubleClick"==e.input.lastClick.type&&(s="tripleClick")),e.input.lastClick={time:i,x:n.clientX,y:n.clientY,type:s,button:n.button};let o=e.posAtCoords(Tw(n));o&&("singleClick"==s?(e.input.mouseDown&&e.input.mouseDown.done(),e.input.mouseDown=new Dw(e,o,n,!!r)):("doubleClick"==s?Nw:Ow)(e,o.pos,o.inside,n)?n.preventDefault():kw(e,"pointer"))};class Dw{constructor(e,t,n,r){let i,s;if(this.view=e,this.pos=t,this.event=n,this.flushed=r,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!n[Rw],this.allowDefault=n.shiftKey,t.inside>-1)i=e.state.doc.nodeAt(t.inside),s=t.inside;else{let n=e.state.doc.resolve(t.pos);i=n.parent,s=n.depth?n.before():0}const o=r?null:n.target,a=o?e.docView.nearestDesc(o,!0):null;this.target=a&&1==a.dom.nodeType?a.dom:null;let{selection:l}=e.state;(0==n.button&&i.type.spec.draggable&&!1!==i.type.spec.selectable||l instanceof Yg&&l.from<=s&&l.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!Dy||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),kw(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Fv(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(Tw(e))),this.updateAllowDefault(e),this.allowDefault||!t?kw(this.view,"pointer"):Aw(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():0==e.button&&(this.flushed||jy&&this.mightDrag&&!this.mightDrag.node.isAtom||Ly&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(Iw(this.view,Wg.near(this.view.state.doc.resolve(t.pos)),"pointer"),e.preventDefault()):kw(this.view,"pointer")}move(e){this.updateAllowDefault(e),kw(this.view,"pointer"),0==e.buttons&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}function Pw(e,t){return!!e.composing||!!(jy&&Math.abs(t.timeStamp-e.input.compositionEndedAt)<500)&&(e.input.compositionEndedAt=-2e8,!0)}vw.touchstart=e=>{e.input.lastTouch=Date.now(),Mw(e),kw(e,"pointer")},vw.touchmove=e=>{e.input.lastTouch=Date.now(),kw(e,"pointer")},vw.contextmenu=e=>Mw(e);const Lw=By?5e3:-1;function Fw(e,t){clearTimeout(e.input.composingTimeout),t>-1&&(e.input.composingTimeout=setTimeout(()=>zw(e),t))}function jw(e){for(e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=function(){let e=document.createEvent("Event");return e.initEvent("event",!0,!0),e.timeStamp}());e.input.compositionNodes.length>0;)e.input.compositionNodes.pop().markParentsDirty()}function Vw(e){let t=e.domSelectionRange();if(!t.focusNode)return null;let n=function(e,t){for(;;){if(3==e.nodeType&&t)return e;if(1==e.nodeType&&t>0){if("false"==e.contentEditable)return null;t=ky(e=e.childNodes[t-1])}else{if(!e.parentNode||Ey(e))return null;t=my(e),e=e.parentNode}}}(t.focusNode,t.focusOffset),r=function(e,t){for(;;){if(3==e.nodeType&&t<e.nodeValue.length)return e;if(1==e.nodeType&&t<e.childNodes.length){if("false"==e.contentEditable)return null;e=e.childNodes[t],t=0}else{if(!e.parentNode||Ey(e))return null;t=my(e)+1,e=e.parentNode}}}(t.focusNode,t.focusOffset);if(n&&r&&n!=r){let t=r.pmViewDesc,i=e.domObserver.lastChangedTextNode;if(n==i||r==i)return i;if(!t||!t.isText(r.nodeValue))return r;if(e.input.compositionNode==r){let e=n.pmViewDesc;if(e&&e.isText(n.nodeValue))return r}}return n||r}function zw(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(By&&e.domObserver.flushingSoon>=0)){if(e.domObserver.forceFlush(),jw(e),t||e.docView&&e.docView.dirty){let n=Pv(e),r=e.state.selection;return n&&!n.eq(r)?e.dispatch(e.state.tr.setSelection(n)):!e.markCursor&&!t||r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?e.updateState(e.state):e.dispatch(e.state.tr.deleteSelection()),!0}return!1}}ww.compositionstart=ww.compositionupdate=e=>{if(!e.composing){e.domObserver.flush();let{state:t}=e,n=t.selection.$to;if(t.selection instanceof Qg&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(e=>!1===e.type.spec.inclusive)))e.markCursor=e.state.storedMarks||n.marks(),zw(e,!0),e.markCursor=null;else if(zw(e,!t.selection.empty),Dy&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let t=e.domSelectionRange();for(let n=t.focusNode,r=t.focusOffset;n&&1==n.nodeType&&0!=r;){let t=r<0?n.lastChild:n.childNodes[r-1];if(!t)break;if(3==t.nodeType){let n=e.domSelection();n&&n.collapse(t,t.nodeValue.length);break}n=t,r=-1}}e.input.composing=!0}Fw(e,Lw)},ww.compositionend=(e,t)=>{e.composing&&(e.input.composing=!1,e.input.compositionEndedAt=t.timeStamp,e.input.compositionPendingChanges=e.domObserver.pendingRecords().length?e.input.compositionID:0,e.input.compositionNode=null,e.input.compositionPendingChanges&&Promise.resolve().then(()=>e.domObserver.flush()),e.input.compositionID++,Fw(e,20))};const Uw=My&&Ry<15||Vy&&qy<604;function Bw(e,t,n,r,i){let s=aw(e,t,n,r,e.state.selection.$from);if(e.someProp("handlePaste",t=>t(e,i,s||em.empty)))return!0;if(!s)return!1;let o=function(e){return 0==e.openStart&&0==e.openEnd&&1==e.content.childCount?e.content.firstChild:null}(s),a=o?e.state.tr.replaceSelectionWith(o,r):e.state.tr.replaceSelection(s);return e.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function $w(e){let t=e.getData("text/plain")||e.getData("Text");if(t)return t;let n=e.getData("text/uri-list");return n?n.replace(/\r?\n/g," "):""}vw.copy=ww.cut=(e,t)=>{let n=t,r=e.state.selection,i="cut"==n.type;if(r.empty)return;let s=Uw?null:n.clipboardData,o=r.content(),{dom:a,text:l}=ow(e,o);s?(n.preventDefault(),s.clearData(),s.setData("text/html",a.innerHTML),s.setData("text/plain",l)):function(e,t){if(!e.dom.parentNode)return;let n=e.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(t),e.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),e.focus()},50)}(e,a),i&&e.dispatch(e.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},ww.paste=(e,t)=>{let n=t;if(e.composing&&!By)return;let r=Uw?null:n.clipboardData,i=e.input.shiftKey&&45!=e.input.lastKeyCode;r&&Bw(e,$w(r),r.getData("text/html"),i,n)?n.preventDefault():function(e,t){if(!e.dom.parentNode)return;let n=e.input.shiftKey||e.state.selection.$from.parent.type.spec.code,r=e.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=e.input.shiftKey&&45!=e.input.lastKeyCode;setTimeout(()=>{e.focus(),r.parentNode&&r.parentNode.removeChild(r),n?Bw(e,r.value,null,i,t):Bw(e,r.textContent,r.innerHTML,i,t)},50)}(e,n)};class qw{constructor(e,t,n){this.slice=e,this.move=t,this.node=n}}const Hw=zy?"altKey":"ctrlKey";function Ww(e,t){let n=e.someProp("dragCopies",e=>!e(t));return null!=n?n:!t[Hw]}vw.dragstart=(e,t)=>{let n=t,r=e.input.mouseDown;if(r&&r.done(),!n.dataTransfer)return;let i,s=e.state.selection,o=s.empty?null:e.posAtCoords(Tw(n));if(o&&o.pos>=s.from&&o.pos<=(s instanceof Yg?s.to-1:s.to));else if(r&&r.mightDrag)i=Yg.create(e.state.doc,r.mightDrag.pos);else if(n.target&&1==n.target.nodeType){let t=e.docView.nearestDesc(n.target,!0);t&&t.node.type.spec.draggable&&t!=e.docView&&(i=Yg.create(e.state.doc,t.posBefore))}let a=(i||e.state.selection).content(),{dom:l,text:c,slice:u}=ow(e,a);(!n.dataTransfer.files.length||!Ly||Fy>120)&&n.dataTransfer.clearData(),n.dataTransfer.setData(Uw?"Text":"text/html",l.innerHTML),n.dataTransfer.effectAllowed="copyMove",Uw||n.dataTransfer.setData("text/plain",c),e.dragging=new qw(u,Ww(e,n),i)},vw.dragend=e=>{let t=e.dragging;window.setTimeout(()=>{e.dragging==t&&(e.dragging=null)},50)},ww.dragover=ww.dragenter=(e,t)=>t.preventDefault(),ww.drop=(e,t)=>{let n=t,r=e.dragging;if(e.dragging=null,!n.dataTransfer)return;let i=e.posAtCoords(Tw(n));if(!i)return;let s=e.state.doc.resolve(i.pos),o=r&&r.slice;o?e.someProp("transformPasted",t=>{o=t(o,e)}):o=aw(e,$w(n.dataTransfer),Uw?null:n.dataTransfer.getData("text/html"),!1,s);let a=!(!r||!Ww(e,n));if(e.someProp("handleDrop",t=>t(e,n,o||em.empty,a)))return void n.preventDefault();if(!o)return;n.preventDefault();let l=o?Ag(e.state.doc,s.pos,o):s.pos;null==l&&(l=s.pos);let c=e.state.tr;if(a){let{node:e}=r;e?e.replace(c):c.deleteSelection()}let u=c.mapping.map(l),h=0==o.openStart&&0==o.openEnd&&1==o.content.childCount,d=c.doc;if(h?c.replaceRangeWith(u,u,o.content.firstChild):c.replaceRange(u,u,o),c.doc.eq(d))return;let f=c.doc.resolve(u);if(h&&Yg.isSelectable(o.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(o.content.firstChild))c.setSelection(new Yg(f));else{let t=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((e,n,r,i)=>t=i),c.setSelection(qv(e,f,c.doc.resolve(t)))}e.focus(),e.dispatch(c.setMeta("uiEvent","drop"))},vw.focus=e=>{e.input.lastFocus=Date.now(),e.focused||(e.domObserver.stop(),e.dom.classList.add("ProseMirror-focused"),e.domObserver.start(),e.focused=!0,setTimeout(()=>{e.docView&&e.hasFocus()&&!e.domObserver.currentSelection.eq(e.domSelectionRange())&&Fv(e)},20))},vw.blur=(e,t)=>{let n=t;e.focused&&(e.domObserver.stop(),e.dom.classList.remove("ProseMirror-focused"),e.domObserver.start(),n.relatedTarget&&e.dom.contains(n.relatedTarget)&&e.domObserver.currentSelection.clear(),e.focused=!1)},vw.beforeinput=(e,t)=>{if(Ly&&By&&"deleteContentBackward"==t.inputType){e.domObserver.flushSoon();let{domChangeCount:t}=e.input;setTimeout(()=>{if(e.input.domChangeCount!=t)return;if(e.dom.blur(),e.focus(),e.someProp("handleKeyDown",t=>t(e,Cy(8,"Backspace"))))return;let{$cursor:n}=e.state.selection;n&&n.pos>0&&e.dispatch(e.state.tr.delete(n.pos-1,n.pos).scrollIntoView())},50)}};for(let os in ww)vw[os]=ww[os];function Kw(e,t){if(e==t)return!0;for(let n in e)if(e[n]!==t[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}class Gw{constructor(e,t){this.toDOM=e,this.spec=t||Zw,this.side=this.spec.side||0}map(e,t,n,r){let{pos:i,deleted:s}=e.mapResult(t.from+r,this.side<0?-1:1);return s?null:new Xw(i-n,i-n,this)}valid(){return!0}eq(e){return this==e||e instanceof Gw&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Kw(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Jw{constructor(e,t){this.attrs=e,this.spec=t||Zw}map(e,t,n,r){let i=e.map(t.from+r,this.spec.inclusiveStart?-1:1)-n,s=e.map(t.to+r,this.spec.inclusiveEnd?1:-1)-n;return i>=s?null:new Xw(i,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Jw&&Kw(this.attrs,e.attrs)&&Kw(this.spec,e.spec)}static is(e){return e.type instanceof Jw}destroy(){}}class Qw{constructor(e,t){this.attrs=e,this.spec=t||Zw}map(e,t,n,r){let i=e.mapResult(t.from+r,1);if(i.deleted)return null;let s=e.mapResult(t.to+r,-1);return s.deleted||s.pos<=i.pos?null:new Xw(i.pos-n,s.pos-n,this)}valid(e,t){let n,{index:r,offset:i}=e.content.findIndex(t.from);return i==t.from&&!(n=e.child(r)).isText&&i+n.nodeSize==t.to}eq(e){return this==e||e instanceof Qw&&Kw(this.attrs,e.attrs)&&Kw(this.spec,e.spec)}destroy(){}}class Xw{constructor(e,t,n){this.from=e,this.to=t,this.type=n}copy(e,t){return new Xw(e,t,this.type)}eq(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,n){return this.type.map(e,this,t,n)}static widget(e,t,n){return new Xw(e,e,new Gw(t,n))}static inline(e,t,n,r){return new Xw(e,t,new Jw(n,r))}static node(e,t,n,r){return new Xw(e,t,new Qw(n,r))}get spec(){return this.type.spec}get inline(){return this.type instanceof Jw}get widget(){return this.type instanceof Gw}}const Yw=[],Zw={};class eb{constructor(e,t){this.local=e.length?e:Yw,this.children=t.length?t:Yw}static create(e,t){return t.length?ob(t,e,0,Zw):tb}find(e,t,n){let r=[];return this.findInner(null==e?0:e,null==t?1e9:t,r,0,n),r}findInner(e,t,n,r,i){for(let s=0;s<this.local.length;s++){let o=this.local[s];o.from<=t&&o.to>=e&&(!i||i(o.spec))&&n.push(o.copy(o.from+r,o.to+r))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let o=this.children[s]+1;this.children[s+2].findInner(e-o,t-o,n,r+o,i)}}map(e,t,n){return this==tb||0==e.maps.length?this:this.mapInner(e,t,0,0,n||Zw)}mapInner(e,t,n,r,i){let s;for(let o=0;o<this.local.length;o++){let a=this.local[o].map(e,n,r);a&&a.type.valid(t,a)?(s||(s=[])).push(a):i.onRemove&&i.onRemove(this.local[o].spec)}return this.children.length?function(e,t,n,r,i,s,o){let a=e.slice();for(let c=0,u=s;c<n.maps.length;c++){let e=0;n.maps[c].forEach((t,n,r,i)=>{let s=i-r-(n-t);for(let o=0;o<a.length;o+=3){let r=a[o+1];if(r<0||t>r+u-e)continue;let i=a[o]+u-e;n>=i?a[o+1]=t<=i?-2:-1:t>=u&&s&&(a[o]+=s,a[o+1]+=s)}e+=s}),u=n.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(-2==a[c+1]){l=!0,a[c+1]=-1;continue}let t=n.map(e[c]+s),u=t-i;if(u<0||u>=r.content.size){l=!0;continue}let h=n.map(e[c+1]+s,-1)-i,{index:d,offset:f}=r.content.findIndex(u),p=r.maybeChild(d);if(p&&f==u&&f+p.nodeSize==h){let r=a[c+2].mapInner(n,p,t+1,e[c]+s+1,o);r!=tb?(a[c]=u,a[c+1]=h,a[c+2]=r):(a[c+1]=-2,l=!0)}else l=!0}if(l){let l=function(e,t,n,r,i,s,o){function a(e,t){for(let s=0;s<e.local.length;s++){let a=e.local[s].map(r,i,t);a?n.push(a):o.onRemove&&o.onRemove(e.local[s].spec)}for(let n=0;n<e.children.length;n+=3)a(e.children[n+2],e.children[n]+t+1)}for(let l=0;l<e.length;l+=3)-1==e[l+1]&&a(e[l+2],t[l]+s+1);return n}(a,e,t,n,i,s,o),c=ob(l,r,0,o);t=c.local;for(let e=0;e<a.length;e+=3)a[e+1]<0&&(a.splice(e,3),e-=3);for(let e=0,t=0;e<c.children.length;e+=3){let n=c.children[e];for(;t<a.length&&a[t]<n;)t+=3;a.splice(t,0,c.children[e],c.children[e+1],c.children[e+2])}}return new eb(t.sort(ab),a)}(this.children,s||[],e,t,n,r,i):s?new eb(s.sort(ab),Yw):tb}add(e,t){return t.length?this==tb?eb.create(e,t):this.addInner(e,t,0):this}addInner(e,t,n){let r,i=0;e.forEach((e,s)=>{let o,a=s+n;if(o=ib(t,e,a)){for(r||(r=this.children.slice());i<r.length&&r[i]<s;)i+=3;r[i]==s?r[i+2]=r[i+2].addInner(e,o,a+1):r.splice(i,0,s,s+e.nodeSize,ob(o,e,a+1,Zw)),i+=3}});let s=rb(i?sb(t):t,-n);for(let o=0;o<s.length;o++)s[o].type.valid(e,s[o])||s.splice(o--,1);return new eb(s.length?this.local.concat(s).sort(ab):this.local,r||this.children)}remove(e){return 0==e.length||this==tb?this:this.removeInner(e,0)}removeInner(e,t){let n=this.children,r=this.local;for(let i=0;i<n.length;i+=3){let r,s=n[i]+t,o=n[i+1]+t;for(let t,n=0;n<e.length;n++)(t=e[n])&&t.from>s&&t.to<o&&(e[n]=null,(r||(r=[])).push(t));if(!r)continue;n==this.children&&(n=this.children.slice());let a=n[i+2].removeInner(r,s+1);a!=tb?n[i+2]=a:(n.splice(i,3),i-=3)}if(r.length)for(let i,s=0;s<e.length;s++)if(i=e[s])for(let e=0;e<r.length;e++)r[e].eq(i,t)&&(r==this.local&&(r=this.local.slice()),r.splice(e--,1));return n==this.children&&r==this.local?this:r.length||n.length?new eb(r,n):tb}forChild(e,t){if(this==tb)return this;if(t.isLeaf)return eb.empty;let n,r;for(let o=0;o<this.children.length;o+=3)if(this.children[o]>=e){this.children[o]==e&&(n=this.children[o+2]);break}let i=e+1,s=i+t.content.size;for(let o=0;o<this.local.length;o++){let e=this.local[o];if(e.from<s&&e.to>i&&e.type instanceof Jw){let t=Math.max(i,e.from)-i,n=Math.min(s,e.to)-i;t<n&&(r||(r=[])).push(e.copy(t,n))}}if(r){let e=new eb(r.sort(ab),Yw);return n?new nb([e,n]):e}return n||tb}eq(e){if(this==e)return!0;if(!(e instanceof eb)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return lb(this.localsInner(e))}localsInner(e){if(this==tb)return Yw;if(e.inlineContent||!this.local.some(Jw.is))return this.local;let t=[];for(let n=0;n<this.local.length;n++)this.local[n].type instanceof Jw||t.push(this.local[n]);return t}forEachSet(e){e(this)}}eb.empty=new eb([],[]),eb.removeOverlap=lb;const tb=eb.empty;class nb{constructor(e){this.members=e}map(e,t){const n=this.members.map(n=>n.map(e,t,Zw));return nb.from(n)}forChild(e,t){if(t.isLeaf)return eb.empty;let n=[];for(let r=0;r<this.members.length;r++){let i=this.members[r].forChild(e,t);i!=tb&&(i instanceof nb?n=n.concat(i.members):n.push(i))}return nb.from(n)}eq(e){if(!(e instanceof nb)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,n=!0;for(let r=0;r<this.members.length;r++){let i=this.members[r].localsInner(e);if(i.length)if(t){n&&(t=t.slice(),n=!1);for(let e=0;e<i.length;e++)t.push(i[e])}else t=i}return t?lb(n?t:t.sort(ab)):Yw}static from(e){switch(e.length){case 0:return tb;case 1:return e[0];default:return new nb(e.every(e=>e instanceof eb)?e:e.reduce((e,t)=>e.concat(t instanceof eb?t:t.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function rb(e,t){if(!t||!e.length)return e;let n=[];for(let r=0;r<e.length;r++){let i=e[r];n.push(new Xw(i.from+t,i.to+t,i.type))}return n}function ib(e,t,n){if(t.isLeaf)return null;let r=n+t.nodeSize,i=null;for(let s,o=0;o<e.length;o++)(s=e[o])&&s.from>n&&s.to<r&&((i||(i=[])).push(s),e[o]=null);return i}function sb(e){let t=[];for(let n=0;n<e.length;n++)null!=e[n]&&t.push(e[n]);return t}function ob(e,t,n,r){let i=[],s=!1;t.forEach((t,o)=>{let a=ib(e,t,o+n);if(a){s=!0;let e=ob(a,t,n+o+1,r);e!=tb&&i.push(o,o+t.nodeSize,e)}});let o=rb(s?sb(e):e,-n).sort(ab);for(let a=0;a<o.length;a++)o[a].type.valid(t,o[a])||(r.onRemove&&r.onRemove(o[a].spec),o.splice(a--,1));return o.length||i.length?new eb(o,i):tb}function ab(e,t){return e.from-t.from||e.to-t.to}function lb(e){let t=e;for(let n=0;n<t.length-1;n++){let r=t[n];if(r.from!=r.to)for(let i=n+1;i<t.length;i++){let s=t[i];if(s.from!=r.from){s.from<r.to&&(t==e&&(t=e.slice()),t[n]=r.copy(r.from,s.from),cb(t,i,r.copy(s.from,r.to)));break}s.to!=r.to&&(t==e&&(t=e.slice()),t[i]=s.copy(s.from,r.to),cb(t,i+1,s.copy(r.to,s.to)))}}return t}function cb(e,t,n){for(;t<e.length&&ab(n,e[t])>0;)t++;e.splice(t,0,n)}function ub(e){let t=[];return e.someProp("decorations",n=>{let r=n(e.state);r&&r!=tb&&t.push(r)}),e.cursorWrapper&&t.push(eb.create(e.state.doc,[e.cursorWrapper.deco])),nb.from(t)}const hb={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},db=My&&Ry<=11;class fb{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class pb{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new fb,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(e=>{for(let t=0;t<e.length;t++)this.queue.push(e[t]);My&&Ry<=11&&e.some(e=>"childList"==e.type&&e.removedNodes.length||"characterData"==e.type&&e.oldValue.length>e.target.nodeValue.length)?this.flushSoon():this.flush()}),db&&(this.onCharData=e=>{this.queue.push({target:e.target,type:"characterData",oldValue:e.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,hb)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Hv(this.view)){if(this.suppressingSelectionUpdates)return Fv(this.view);if(My&&Ry<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&wy(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t,n=new Set;for(let i=e.focusNode;i;i=gy(i))n.add(i);for(let i=e.anchorNode;i;i=gy(i))if(n.has(i)){t=i;break}let r=t&&this.view.docView.nearestDesc(t);return r&&r.ignoreMutation({type:"selection",target:3==t.nodeType?t.parentNode:t})?(this.setCurSelection(),!0):void 0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let n=e.domSelectionRange(),r=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Hv(e)&&!this.ignoreSelectionChange(n),i=-1,s=-1,o=!1,a=[];if(e.editable)for(let c=0;c<t.length;c++){let e=this.registerMutation(t[c],a);e&&(i=i<0?e.from:Math.min(e.from,i),s=s<0?e.to:Math.max(e.to,s),e.typeOver&&(o=!0))}if(Dy&&a.length){let t=a.filter(e=>"BR"==e.nodeName);if(2==t.length){let[e,n]=t;e.parentNode&&e.parentNode.parentNode==n.parentNode?n.remove():e.remove()}else{let{focusNode:n}=this.currentSelection;for(let r of t){let t=r.parentNode;!t||"LI"!=t.nodeName||n&&vb(e,n)==t||r.remove()}}}let l=null;i<0&&r&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&xy(n)&&(l=Pv(e))&&l.eq(Wg.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Fv(e),this.currentSelection.set(n),e.scrollToSelection()):(i>-1||r)&&(i>-1&&(e.docView.markDirty(i,s),function(e){if(mb.has(e))return;if(mb.set(e,null),-1!==["normal","nowrap","pre-line"].indexOf(getComputedStyle(e.dom).whiteSpace)){if(e.requiresGeckoHackNode=Dy,gb)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),gb=!0}}(e)),this.handleDOMChange(i,s,o,a),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(n)||Fv(e),this.currentSelection.set(n))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let n=this.view.docView.nearestDesc(e.target);if("attributes"==e.type&&(n==this.view.docView||"contenteditable"==e.attributeName||"style"==e.attributeName&&!e.oldValue&&!e.target.getAttribute("style")))return null;if(!n||n.ignoreMutation(e))return null;if("childList"==e.type){for(let n=0;n<e.addedNodes.length;n++){let r=e.addedNodes[n];t.push(r),3==r.nodeType&&(this.lastChangedTextNode=r)}if(n.contentDOM&&n.contentDOM!=n.dom&&!n.contentDOM.contains(e.target))return{from:n.posBefore,to:n.posAfter};let r=e.previousSibling,i=e.nextSibling;if(My&&Ry<=11&&e.addedNodes.length)for(let t=0;t<e.addedNodes.length;t++){let{previousSibling:n,nextSibling:s}=e.addedNodes[t];(!n||Array.prototype.indexOf.call(e.addedNodes,n)<0)&&(r=n),(!s||Array.prototype.indexOf.call(e.addedNodes,s)<0)&&(i=s)}let s=r&&r.parentNode==e.target?my(r)+1:0,o=n.localPosFromDOM(e.target,s,-1),a=i&&i.parentNode==e.target?my(i):e.target.childNodes.length;return{from:o,to:n.localPosFromDOM(e.target,a,1)}}return"attributes"==e.type?{from:n.posAtStart-n.border,to:n.posAtEnd+n.border}:(this.lastChangedTextNode=e.target,{from:n.posAtStart,to:n.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let mb=new WeakMap,gb=!1;function yb(e,t){let n=t.startContainer,r=t.startOffset,i=t.endContainer,s=t.endOffset,o=e.domAtPos(e.state.selection.anchor);return wy(o.node,o.offset,i,s)&&([n,r,i,s]=[i,s,n,r]),{anchorNode:n,anchorOffset:r,focusNode:i,focusOffset:s}}function vb(e,t){for(let n=t.parentNode;n&&n!=e.dom;n=n.parentNode){let t=e.docView.nearestDesc(n,!0);if(t&&t.node.isBlock)return n}return null}function wb(e){let t=e.pmViewDesc;if(t)return t.parseRule();if("BR"==e.nodeName&&e.parentNode){if(jy&&/^(ul|ol)$/i.test(e.parentNode.nodeName)){let e=document.createElement("div");return e.appendChild(document.createElement("li")),{skip:e}}if(e.parentNode.lastChild==e||jy&&/^(tr|table)$/i.test(e.parentNode.nodeName))return{ignore:!0}}else if("IMG"==e.nodeName&&e.getAttribute("mark-placeholder"))return{ignore:!0};return null}const bb=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function Sb(e,t,n,r,i){let s=e.input.compositionPendingChanges||(e.composing?e.input.compositionID:0);if(e.input.compositionPendingChanges=0,t<0){let t=e.input.lastSelectionTime>Date.now()-50?e.input.lastSelectionOrigin:null,n=Pv(e,t);if(n&&!e.state.selection.eq(n)){if(Ly&&By&&13===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime&&e.someProp("handleKeyDown",t=>t(e,Cy(13,"Enter"))))return;let r=e.state.tr.setSelection(n);"pointer"==t?r.setMeta("pointer",!0):"key"==t&&r.scrollIntoView(),s&&r.setMeta("composition",s),e.dispatch(r)}return}let o=e.state.doc.resolve(t),a=o.sharedDepth(n);t=o.before(a+1),n=e.state.doc.resolve(n).after(a+1);let l,c,u=e.state.selection,h=function(e,t,n){let r,{node:i,fromOffset:s,toOffset:o,from:a,to:l}=e.docView.parseRange(t,n),c=e.domSelectionRange(),u=c.anchorNode;if(u&&e.dom.contains(1==u.nodeType?u:u.parentNode)&&(r=[{node:u,offset:c.anchorOffset}],xy(c)||r.push({node:c.focusNode,offset:c.focusOffset})),Ly&&8===e.input.lastKeyCode)for(let g=o;g>s;g--){let e=i.childNodes[g-1],t=e.pmViewDesc;if("BR"==e.nodeName&&!t){o=g;break}if(!t||t.size)break}let h=e.state.doc,d=e.someProp("domParser")||Vm.fromSchema(e.state.schema),f=h.resolve(a),p=null,m=d.parse(i,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:s,to:o,preserveWhitespace:"pre"!=f.parent.type.whitespace||"full",findPositions:r,ruleFromNode:wb,context:f});if(r&&null!=r[0].pos){let e=r[0].pos,t=r[1]&&r[1].pos;null==t&&(t=e),p={anchor:e+a,head:t+a}}return{doc:m,sel:p,from:a,to:l}}(e,t,n),d=e.state.doc,f=d.slice(h.from,h.to);8===e.input.lastKeyCode&&Date.now()-100<e.input.lastKeyCodeTime?(l=e.state.selection.to,c="end"):(l=e.state.selection.from,c="start"),e.input.lastKeyCode=null;let p=function(e,t,n,r,i){let s=e.findDiffStart(t,n);if(null==s)return null;let{a:o,b:a}=e.findDiffEnd(t,n+e.size,n+t.size);if("end"==i){r-=o+Math.max(0,s-Math.min(o,a))-s}if(o<s&&e.size<t.size){let e=r<=s&&r>=o?s-r:0;s-=e,s&&s<t.size&&xb(t.textBetween(s-1,s+1))&&(s+=e?1:-1),a=s+(a-o),o=s}else if(a<s){let t=r<=s&&r>=a?s-r:0;s-=t,s&&s<e.size&&xb(e.textBetween(s-1,s+1))&&(s+=t?1:-1),o=s+(o-a),a=s}return{start:s,endA:o,endB:a}}(f.content,h.doc.content,h.from,l,c);if(p&&e.input.domChangeCount++,(Vy&&e.input.lastIOSEnter>Date.now()-225||By)&&i.some(e=>1==e.nodeType&&!bb.test(e.nodeName))&&(!p||p.endA>=p.endB)&&e.someProp("handleKeyDown",t=>t(e,Cy(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(!p){if(!(r&&u instanceof Qg&&!u.empty&&u.$head.sameParent(u.$anchor))||e.composing||h.sel&&h.sel.anchor!=h.sel.head){if(h.sel){let t=kb(e,e.state.doc,h.sel);if(t&&!t.eq(e.state.selection)){let n=e.state.tr.setSelection(t);s&&n.setMeta("composition",s),e.dispatch(n)}}return}p={start:u.from,endA:u.to,endB:u.to}}e.state.selection.from<e.state.selection.to&&p.start==p.endB&&e.state.selection instanceof Qg&&(p.start>e.state.selection.from&&p.start<=e.state.selection.from+2&&e.state.selection.from>=h.from?p.start=e.state.selection.from:p.endA<e.state.selection.to&&p.endA>=e.state.selection.to-2&&e.state.selection.to<=h.to&&(p.endB+=e.state.selection.to-p.endA,p.endA=e.state.selection.to)),My&&Ry<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>h.from&&" \xa0"==h.doc.textBetween(p.start-h.from-1,p.start-h.from+1)&&(p.start--,p.endA--,p.endB--);let m,g=h.doc.resolveNoCache(p.start-h.from),y=h.doc.resolveNoCache(p.endB-h.from),v=d.resolve(p.start),w=g.sameParent(y)&&g.parent.inlineContent&&v.end()>=p.endA;if((Vy&&e.input.lastIOSEnter>Date.now()-225&&(!w||i.some(e=>"DIV"==e.nodeName||"P"==e.nodeName))||!w&&g.pos<h.doc.content.size&&(!g.sameParent(y)||!g.parent.inlineContent)&&!/\S/.test(h.doc.textBetween(g.pos,y.pos,"",""))&&(m=Wg.findFrom(h.doc.resolve(g.pos+1),1,!0))&&m.head>g.pos)&&e.someProp("handleKeyDown",t=>t(e,Cy(13,"Enter"))))return void(e.input.lastIOSEnter=0);if(e.state.selection.anchor>p.start&&function(e,t,n,r,i){if(n-t<=i.pos-r.pos||Eb(r,!0,!1)<i.pos)return!1;let s=e.resolve(t);if(!r.parent.isTextblock){let e=s.nodeAfter;return null!=e&&n==t+e.nodeSize}if(s.parentOffset<s.parent.content.size||!s.parent.isTextblock)return!1;let o=e.resolve(Eb(s,!0,!0));return!(!o.parent.isTextblock||o.pos>n||Eb(o,!0,!1)<n)&&r.parent.content.cut(r.parentOffset).eq(o.parent.content)}(d,p.start,p.endA,g,y)&&e.someProp("handleKeyDown",t=>t(e,Cy(8,"Backspace"))))return void(By&&Ly&&e.domObserver.suppressSelectionUpdates());Ly&&p.endB==p.start&&(e.input.lastChromeDelete=Date.now()),By&&!w&&g.start()!=y.start()&&0==y.parentOffset&&g.depth==y.depth&&h.sel&&h.sel.anchor==h.sel.head&&h.sel.head==p.endA&&(p.endB-=2,y=h.doc.resolveNoCache(p.endB-h.from),setTimeout(()=>{e.someProp("handleKeyDown",function(t){return t(e,Cy(13,"Enter"))})},20));let b,S=p.start,k=p.endA,E=t=>{let n=t||e.state.tr.replace(S,k,h.doc.slice(p.start-h.from,p.endB-h.from));if(h.sel){let t=kb(e,n.doc,h.sel);t&&!(Ly&&e.composing&&t.empty&&(p.start!=p.endB||e.input.lastChromeDelete<Date.now()-100)&&(t.head==S||t.head==n.mapping.map(k)-1)||My&&t.empty&&t.head==S)&&n.setSelection(t)}return s&&n.setMeta("composition",s),n.scrollIntoView()};if(w){if(g.pos==y.pos){My&&Ry<=11&&0==g.parentOffset&&(e.domObserver.suppressSelectionUpdates(),setTimeout(()=>Fv(e),20));let t=E(e.state.tr.delete(S,k)),n=d.resolve(p.start).marksAcross(d.resolve(p.endA));n&&t.ensureMarks(n),e.dispatch(t)}else if(p.endA==p.endB&&(b=function(e,t){let n,r,i,s=e.firstChild.marks,o=t.firstChild.marks,a=s,l=o;for(let u=0;u<o.length;u++)a=o[u].removeFromSet(a);for(let u=0;u<s.length;u++)l=s[u].removeFromSet(l);if(1==a.length&&0==l.length)r=a[0],n="add",i=e=>e.mark(r.addToSet(e.marks));else{if(0!=a.length||1!=l.length)return null;r=l[0],n="remove",i=e=>e.mark(r.removeFromSet(e.marks))}let c=[];for(let u=0;u<t.childCount;u++)c.push(i(t.child(u)));if(Gp.from(c).eq(e))return{mark:r,type:n}}(g.parent.content.cut(g.parentOffset,y.parentOffset),v.parent.content.cut(v.parentOffset,p.endA-v.start())))){let t=E(e.state.tr);"add"==b.type?t.addMark(S,k,b.mark):t.removeMark(S,k,b.mark),e.dispatch(t)}else if(g.parent.child(g.index()).isText&&g.index()==y.index()-(y.textOffset?0:1)){let t=g.parent.textBetween(g.parentOffset,y.parentOffset),n=()=>E(e.state.tr.insertText(t,S,k));e.someProp("handleTextInput",r=>r(e,S,k,t,n))||e.dispatch(n())}}else e.dispatch(E())}function kb(e,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:qv(e,t.resolve(n.anchor),t.resolve(n.head))}function Eb(e,t,n){let r=e.depth,i=t?e.end():e.pos;for(;r>0&&(t||e.indexAfter(r)==e.node(r).childCount);)r--,i++,t=!1;if(n){let t=e.node(r).maybeChild(e.indexAfter(r));for(;t&&!t.isLeaf;)t=t.firstChild,i++}return i}function xb(e){if(2!=e.length)return!1;let t=e.charCodeAt(0),n=e.charCodeAt(1);return t>=56320&&t<=57343&&n>=55296&&n<=56319}class Cb{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Sw,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(Nb),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):"function"==typeof e?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=Ib(this),_b(this),this.nodeViews=Ab(this),this.docView=wv(this.state.doc,Tb(this),ub(this),this.dom,this),this.domObserver=new pb(this,(e,t,n,r)=>Sb(this,e,t,n,r)),this.domObserver.start(),function(e){for(let t in vw){let n=vw[t];e.dom.addEventListener(t,e.input.eventHandlers[t]=t=>{!Cw(e,t)||xw(e,t)||!e.editable&&t.type in ww||n(e,t)},bw[t]?{passive:!0}:void 0)}jy&&e.dom.addEventListener("input",()=>null),Ew(e)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&Ew(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(Nb),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let n in this._props)t[n]=this._props[n];t.state=this.state;for(let n in e)t[n]=e[n];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var n;let r=this.state,i=!1,s=!1;e.storedMarks&&this.composing&&(jw(this),s=!0),this.state=e;let o=r.plugins!=e.plugins||this._props.plugins!=t.plugins;if(o||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let e=Ab(this);(function(e,t){let n=0,r=0;for(let i in e){if(e[i]!=t[i])return!0;n++}for(let i in t)r++;return n!=r})(e,this.nodeViews)&&(this.nodeViews=e,i=!0)}(o||t.handleDOMEvents!=this._props.handleDOMEvents)&&Ew(this),this.editable=Ib(this),_b(this);let a=ub(this),l=Tb(this),c=r.plugins==e.plugins||r.doc.eq(e.doc)?e.scrollToSelection>r.scrollToSelection?"to selection":"preserve":"reset",u=i||!this.docView.matchesNode(e.doc,l,a);!u&&e.selection.eq(r.selection)||(s=!0);let h="preserve"==c&&s&&null==this.dom.style.overflowAnchor&&function(e){let t,n,r=e.dom.getBoundingClientRect(),i=Math.max(0,r.top);for(let s=(r.left+r.right)/2,o=i+1;o<Math.min(innerHeight,r.bottom);o+=5){let r=e.root.elementFromPoint(s,o);if(!r||r==e.dom||!e.dom.contains(r))continue;let a=r.getBoundingClientRect();if(a.top>=i-20){t=r,n=a.top;break}}return{refDOM:t,refTop:n,stack:Jy(e.dom)}}(this);if(s){this.domObserver.stop();let t=u&&(My||Ly)&&!this.composing&&!r.selection.empty&&!e.selection.empty&&function(e,t){let n=Math.min(e.$anchor.sharedDepth(e.head),t.$anchor.sharedDepth(t.head));return e.$anchor.start(n)!=t.$anchor.start(n)}(r.selection,e.selection);if(u){let n=Ly?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=Vw(this)),!i&&this.docView.update(e.doc,l,a,this)||(this.docView.updateOuterDeco(l),this.docView.destroy(),this.docView=wv(e.doc,l,a,this.dom,this)),n&&!this.trackWrites&&(t=!0)}t||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&function(e){let t=e.docView.domFromPos(e.state.selection.anchor,0),n=e.domSelectionRange();return wy(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?Fv(this,t):(Bv(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(r),(null===(n=this.dragging)||void 0===n?void 0:n.node)&&!r.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,r),"reset"==c?this.dom.scrollTop=0:"to selection"==c?this.scrollToSelection():h&&function(e){let{refDOM:t,refTop:n,stack:r}=e,i=t?t.getBoundingClientRect().top:0;Qy(r,0==i?0:i-n)}(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(e&&this.dom.contains(1==e.nodeType?e:e.parentNode))if(this.someProp("handleScrollToSelection",e=>e(this)));else if(this.state.selection instanceof Yg){let t=this.docView.domAfterPos(this.state.selection.from);1==t.nodeType&&Gy(this,t.getBoundingClientRect(),e)}else Gy(this,this.coordsAtPos(this.state.selection.head,1),e);else;}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(e&&e.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let t=0;t<this.pluginViews.length;t++){let n=this.pluginViews[t];n.update&&n.update(this,e)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let e=0;e<this.directPlugins.length;e++){let t=this.directPlugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}for(let e=0;e<this.state.plugins.length;e++){let t=this.state.plugins[e];t.spec.view&&this.pluginViews.push(t.spec.view(this))}}}updateDraggedNode(e,t){let n=e.node,r=-1;if(this.state.doc.nodeAt(n.from)==n.node)r=n.from;else{let e=n.from+(this.state.doc.content.size-t.doc.content.size);(e>0&&this.state.doc.nodeAt(e))==n.node&&(r=e)}this.dragging=new qw(e.slice,e.move,r<0?void 0:Yg.create(this.state.doc,r))}someProp(e,t){let n,r=this._props&&this._props[e];if(null!=r&&(n=t?t(r):r))return n;for(let s=0;s<this.directPlugins.length;s++){let r=this.directPlugins[s].props[e];if(null!=r&&(n=t?t(r):r))return n}let i=this.state.plugins;if(i)for(let s=0;s<i.length;s++){let r=i[s].props[e];if(null!=r&&(n=t?t(r):r))return n}}hasFocus(){if(My){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if("false"==e.contentEditable)return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function(e){if(e.setActive)return e.setActive();if(Xy)return e.focus(Xy);let t=Jy(e);e.focus(null==Xy?{get preventScroll(){return Xy={preventScroll:!0},!0}}:void 0),Xy||(Xy=!1,Qy(t,0))}(this.dom),Fv(this),this.domObserver.start()}get root(){let e=this._root;if(null==e)for(let t=this.dom.parentNode;t;t=t.parentNode)if(9==t.nodeType||11==t.nodeType&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t;return e||document}updateRoot(){this._root=null}posAtCoords(e){return tv(this,e)}coordsAtPos(e){return sv(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:1)}domAtPos(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1,r=this.docView.posFromDOM(e,t,n);if(null==r)throw new RangeError("DOM position not inside the editor");return r}endOfTextblock(e,t){return fv(this,t||this.state,e)}pasteHTML(e,t){return Bw(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Bw(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return ow(this,e)}destroy(){this.docView&&(!function(e){e.domObserver.stop();for(let t in e.input.eventHandlers)e.dom.removeEventListener(t,e.input.eventHandlers[t]);clearTimeout(e.input.composingTimeout),clearTimeout(e.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ub(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,yy=null)}get isDestroyed(){return null==this.docView}dispatchEvent(e){return function(e,t){xw(e,t)||!vw[t.type]||!e.editable&&t.type in ww||vw[t.type](e,t)}(this,e)}domSelectionRange(){let e=this.domSelection();return e?jy&&11===this.root.nodeType&&function(e){let t=e.activeElement;for(;t&&t.shadowRoot;)t=t.shadowRoot.activeElement;return t}(this.dom.ownerDocument)==this.dom&&function(e,t){if(t.getComposedRanges){let n=t.getComposedRanges(e.root)[0];if(n)return yb(e,n)}let n;function r(e){e.preventDefault(),e.stopImmediatePropagation(),n=e.getTargetRanges()[0]}return e.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),e.dom.removeEventListener("beforeinput",r,!0),n?yb(e,n):null}(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function Tb(e){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(e.editable),e.someProp("attributes",n=>{if("function"==typeof n&&(n=n(e.state)),n)for(let e in n)"class"==e?t.class+=" "+n[e]:"style"==e?t.style=(t.style?t.style+";":"")+n[e]:t[e]||"contenteditable"==e||"nodeName"==e||(t[e]=String(n[e]))}),t.translate||(t.translate="no"),[Xw.node(0,e.state.doc.content.size,t)]}function _b(e){if(e.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),e.cursorWrapper={dom:t,deco:Xw.widget(e.state.selection.from,t,{raw:!0,marks:e.markCursor})}}else e.cursorWrapper=null}function Ib(e){return!e.someProp("editable",t=>!1===t(e.state))}function Ab(e){let t=Object.create(null);function n(e){for(let n in e)Object.prototype.hasOwnProperty.call(t,n)||(t[n]=e[n])}return e.someProp("nodeViews",n),e.someProp("markViews",n),t}function Nb(e){if(e.spec.state||e.spec.filterTransaction||e.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}Cb.prototype.dispatch=function(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))};for(var Ob={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Mb={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},Rb="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Db="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Pb=0;Pb<10;Pb++)Ob[48+Pb]=Ob[96+Pb]=String(Pb);for(Pb=1;Pb<=24;Pb++)Ob[Pb+111]="F"+Pb;for(Pb=65;Pb<=90;Pb++)Ob[Pb]=String.fromCharCode(Pb+32),Mb[Pb]=String.fromCharCode(Pb);for(var Lb in Ob)Mb.hasOwnProperty(Lb)||(Mb[Lb]=Ob[Lb]);const Fb="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),jb="undefined"!=typeof navigator&&/Win/.test(navigator.platform);function Vb(e){let t,n,r,i,s=e.split(/-(?!$)/),o=s[s.length-1];"Space"==o&&(o=" ");for(let a=0;a<s.length-1;a++){let e=s[a];if(/^(cmd|meta|m)$/i.test(e))i=!0;else if(/^a(lt)?$/i.test(e))t=!0;else if(/^(c|ctrl|control)$/i.test(e))n=!0;else if(/^s(hift)?$/i.test(e))r=!0;else{if(!/^mod$/i.test(e))throw new Error("Unrecognized modifier name: "+e);Fb?i=!0:n=!0}}return t&&(o="Alt-"+o),n&&(o="Ctrl-"+o),i&&(o="Meta-"+o),r&&(o="Shift-"+o),o}function zb(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return t.altKey&&(e="Alt-"+e),t.ctrlKey&&(e="Ctrl-"+e),t.metaKey&&(e="Meta-"+e),n&&t.shiftKey&&(e="Shift-"+e),e}function Ub(e){let t=function(e){let t=Object.create(null);for(let n in e)t[Vb(n)]=e[n];return t}(e);return function(e,n){let r,i=function(e){var t=!(Rb&&e.metaKey&&e.shiftKey&&!e.ctrlKey&&!e.altKey||Db&&e.shiftKey&&e.key&&1==e.key.length||"Unidentified"==e.key)&&e.key||(e.shiftKey?Mb:Ob)[e.keyCode]||e.key||"Unidentified";return"Esc"==t&&(t="Escape"),"Del"==t&&(t="Delete"),"Left"==t&&(t="ArrowLeft"),"Up"==t&&(t="ArrowUp"),"Right"==t&&(t="ArrowRight"),"Down"==t&&(t="ArrowDown"),t}(n),s=t[zb(i,n)];if(s&&s(e.state,e.dispatch,e))return!0;if(1==i.length&&" "!=i){if(n.shiftKey){let r=t[zb(i,n,!1)];if(r&&r(e.state,e.dispatch,e))return!0}if((n.altKey||n.metaKey||n.ctrlKey)&&!(jb&&n.ctrlKey&&n.altKey)&&(r=Ob[n.keyCode])&&r!=i){let i=t[zb(r,n)];if(i&&i(e.state,e.dispatch,e))return!0}}return!1}}const Bb=(e,t)=>!e.selection.empty&&(t&&t(e.tr.deleteSelection().scrollIntoView()),!0);function $b(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("backward",e):n.parentOffset>0)?null:n}const qb=(e,t,n)=>{let r=$b(e,n);if(!r)return!1;let i=Gb(r);if(!i){let n=r.blockRange(),i=n&&bg(n);return null!=i&&(t&&t(e.tr.lift(n,i).scrollIntoView()),!0)}let s=i.nodeBefore;if(oS(e,i,t,-1))return!0;if(0==r.parent.content.size&&(Wb(s,"end")||Yg.isSelectable(s)))for(let o=r.depth;;o--){let n=Ng(e.doc,r.before(o),r.after(o),em.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(Wb(s,"end")?Wg.findFrom(r.doc.resolve(r.mapping.map(i.pos,-1)),-1):Yg.create(r.doc,i.pos-s.nodeSize)),t(r.scrollIntoView())}return!0}if(1==o||r.node(o-1).childCount>1)break}return!(!s.isAtom||i.depth!=r.depth-1)&&(t&&t(e.tr.delete(i.pos-s.nodeSize,i.pos).scrollIntoView()),!0)};function Hb(e,t,n){let r=t.nodeBefore,i=t.pos-1;for(;!r.isTextblock;i--){if(r.type.spec.isolating)return!1;let e=r.lastChild;if(!e)return!1;r=e}let s=t.nodeAfter,o=t.pos+1;for(;!s.isTextblock;o++){if(s.type.spec.isolating)return!1;let e=s.firstChild;if(!e)return!1;s=e}let a=Ng(e.doc,i,o,em.empty);if(!a||a.from!=i||a instanceof mg&&a.slice.size>=o-i)return!1;if(n){let t=e.tr.step(a);t.setSelection(Qg.create(t.doc,i)),n(t.scrollIntoView())}return!0}function Wb(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(let r=e;r;r="start"==t?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(n&&1!=r.childCount)return!1}return!1}const Kb=(e,t,n)=>{let{$head:r,empty:i}=e.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("backward",e):r.parentOffset>0)return!1;s=Gb(r)}let o=s&&s.nodeBefore;return!(!o||!Yg.isSelectable(o))&&(t&&t(e.tr.setSelection(Yg.create(e.doc,s.pos-o.nodeSize)).scrollIntoView()),!0)};function Gb(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function Jb(e,t){let{$cursor:n}=e.selection;return!n||(t?!t.endOfTextblock("forward",e):n.parentOffset<n.parent.content.size)?null:n}const Qb=(e,t,n)=>{let r=Jb(e,n);if(!r)return!1;let i=Yb(r);if(!i)return!1;let s=i.nodeAfter;if(oS(e,i,t,1))return!0;if(0==r.parent.content.size&&(Wb(s,"start")||Yg.isSelectable(s))){let n=Ng(e.doc,r.before(),r.after(),em.empty);if(n&&n.slice.size<n.to-n.from){if(t){let r=e.tr.step(n);r.setSelection(Wb(s,"start")?Wg.findFrom(r.doc.resolve(r.mapping.map(i.pos)),1):Yg.create(r.doc,r.mapping.map(i.pos))),t(r.scrollIntoView())}return!0}}return!(!s.isAtom||i.depth!=r.depth-1)&&(t&&t(e.tr.delete(i.pos,i.pos+s.nodeSize).scrollIntoView()),!0)},Xb=(e,t,n)=>{let{$head:r,empty:i}=e.selection,s=r;if(!i)return!1;if(r.parent.isTextblock){if(n?!n.endOfTextblock("forward",e):r.parentOffset<r.parent.content.size)return!1;s=Yb(r)}let o=s&&s.nodeAfter;return!(!o||!Yg.isSelectable(o))&&(t&&t(e.tr.setSelection(Yg.create(e.doc,s.pos)).scrollIntoView()),!0)};function Yb(e){if(!e.parent.type.spec.isolating)for(let t=e.depth-1;t>=0;t--){let n=e.node(t);if(e.index(t)+1<n.childCount)return e.doc.resolve(e.after(t+1));if(n.type.spec.isolating)break}return null}const Zb=(e,t)=>{let{$head:n,$anchor:r}=e.selection;return!(!n.parent.type.spec.code||!n.sameParent(r))&&(t&&t(e.tr.insertText("\n").scrollIntoView()),!0)};function eS(e){for(let t=0;t<e.edgeCount;t++){let{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const tS=(e,t)=>{let{$head:n,$anchor:r}=e.selection;if(!n.parent.type.spec.code||!n.sameParent(r))return!1;let i=n.node(-1),s=n.indexAfter(-1),o=eS(i.contentMatchAt(s));if(!o||!i.canReplaceWith(s,s,o))return!1;if(t){let r=n.after(),i=e.tr.replaceWith(r,r,o.createAndFill());i.setSelection(Wg.near(i.doc.resolve(r),1)),t(i.scrollIntoView())}return!0},nS=(e,t)=>{let n=e.selection,{$from:r,$to:i}=n;if(n instanceof ey||r.parent.inlineContent||i.parent.inlineContent)return!1;let s=eS(i.parent.contentMatchAt(i.indexAfter()));if(!s||!s.isTextblock)return!1;if(t){let n=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,o=e.tr.insert(n,s.createAndFill());o.setSelection(Qg.create(o.doc,n+1)),t(o.scrollIntoView())}return!0},rS=(e,t)=>{let{$cursor:n}=e.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let r=n.before();if(Cg(e.doc,r))return t&&t(e.tr.split(r).scrollIntoView()),!0}let r=n.blockRange(),i=r&&bg(r);return null!=i&&(t&&t(e.tr.lift(r,i).scrollIntoView()),!0)};const iS=(e,t)=>{let{$from:n,$to:r}=e.selection;if(e.selection instanceof Yg&&e.selection.node.isBlock)return!(!n.parentOffset||!Cg(e.doc,n.pos))&&(t&&t(e.tr.split(n.pos).scrollIntoView()),!0);if(!n.depth)return!1;let i,s,o=[],a=!1,l=!1;for(let d=n.depth;;d--){if(n.node(d).isBlock){a=n.end(d)==n.pos+(n.depth-d),l=n.start(d)==n.pos-(n.depth-d),s=eS(n.node(d-1).contentMatchAt(n.indexAfter(d-1)));let e=sS&&sS(r.parent,a,n);o.unshift(e||(a&&s?{type:s}:null)),i=d;break}if(1==d)return!1;o.unshift(null)}let c=e.tr;(e.selection instanceof Qg||e.selection instanceof ey)&&c.deleteSelection();let u=c.mapping.map(n.pos),h=Cg(c.doc,u,o.length,o);if(h||(o[0]=s?{type:s}:null,h=Cg(c.doc,u,o.length,o)),!h)return!1;if(c.split(u,o.length,o),!a&&l&&n.node(i).type!=s){let e=c.mapping.map(n.before(i)),t=c.doc.resolve(e);s&&n.node(i-1).canReplaceWith(t.index(),t.index()+1,s)&&c.setNodeMarkup(c.mapping.map(n.before(i)),s)}return t&&t(c.scrollIntoView()),!0};var sS;function oS(e,t,n,r){let i,s,o=t.nodeBefore,a=t.nodeAfter,l=o.type.spec.isolating||a.type.spec.isolating;if(!l&&function(e,t,n){let r=t.nodeBefore,i=t.nodeAfter,s=t.index();return!!(r&&i&&r.type.compatibleContent(i.type))&&(!r.content.size&&t.parent.canReplace(s-1,s)?(n&&n(e.tr.delete(t.pos-r.nodeSize,t.pos).scrollIntoView()),!0):!(!t.parent.canReplace(s,s+1)||!i.isTextblock&&!Tg(e.doc,t.pos))&&(n&&n(e.tr.join(t.pos).scrollIntoView()),!0))}(e,t,n))return!0;let c=!l&&t.parent.canReplace(t.index(),t.index()+1);if(c&&(i=(s=o.contentMatchAt(o.childCount)).findWrapping(a.type))&&s.matchType(i[0]||a.type).validEnd){if(n){let r=t.pos+a.nodeSize,s=Gp.empty;for(let e=i.length-1;e>=0;e--)s=Gp.from(i[e].create(null,s));s=Gp.from(o.copy(s));let l=e.tr.step(new gg(t.pos-1,r,t.pos,r,new em(s,1,0),i.length,!0)),c=l.doc.resolve(r+2*i.length);c.nodeAfter&&c.nodeAfter.type==o.type&&Tg(l.doc,c.pos)&&l.join(c.pos),n(l.scrollIntoView())}return!0}let u=a.type.spec.isolating||r>0&&l?null:Wg.findFrom(t,1),h=u&&u.$from.blockRange(u.$to),d=h&&bg(h);if(null!=d&&d>=t.depth)return n&&n(e.tr.lift(h,d).scrollIntoView()),!0;if(c&&Wb(a,"start",!0)&&Wb(o,"end")){let r=o,i=[];for(;i.push(r),!r.isTextblock;)r=r.lastChild;let s=a,l=1;for(;!s.isTextblock;s=s.firstChild)l++;if(r.canReplace(r.childCount,r.childCount,s.content)){if(n){let r=Gp.empty;for(let e=i.length-1;e>=0;e--)r=Gp.from(i[e].copy(r));n(e.tr.step(new gg(t.pos-i.length,t.pos+a.nodeSize,t.pos+l,t.pos+a.nodeSize-l,new em(r,i.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function aS(e){return function(t,n){let r=t.selection,i=e<0?r.$from:r.$to,s=i.depth;for(;i.node(s).isInline;){if(!s)return!1;s--}return!!i.node(s).isTextblock&&(n&&n(t.tr.setSelection(Qg.create(t.doc,e<0?i.start(s):i.end(s)))),!0)}}const lS=aS(-1),cS=aS(1);function uS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,r){let i=!1;for(let s=0;s<n.selection.ranges.length&&!i;s++){let{$from:{pos:r},$to:{pos:o}}=n.selection.ranges[s];n.doc.nodesBetween(r,o,(r,s)=>{if(i)return!1;if(r.isTextblock&&!r.hasMarkup(e,t))if(r.type==e)i=!0;else{let t=n.doc.resolve(s),r=t.index();i=t.parent.canReplaceWith(r,r+1,e)}})}if(!i)return!1;if(r){let i=n.tr;for(let r=0;r<n.selection.ranges.length;r++){let{$from:{pos:s},$to:{pos:o}}=n.selection.ranges[r];i.setBlockType(s,o,e,t)}r(i.scrollIntoView())}return!0}}function hS(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e,n,r){for(let i=0;i<t.length;i++)if(t[i](e,n,r))return!0;return!1}}let dS=hS(Bb,qb,Kb),fS=hS(Bb,Qb,Xb);const pS={Enter:hS(Zb,nS,rS,iS),"Mod-Enter":tS,Backspace:dS,"Mod-Backspace":dS,"Shift-Backspace":dS,Delete:fS,"Mod-Delete":fS,"Mod-a":(e,t)=>(t&&t(e.tr.setSelection(new ey(e.doc))),!0)},mS={"Ctrl-h":pS.Backspace,"Alt-Backspace":pS["Mod-Backspace"],"Ctrl-d":pS.Delete,"Ctrl-Alt-Backspace":pS["Mod-Delete"],"Alt-Delete":pS["Mod-Delete"],"Alt-d":pS["Mod-Delete"],"Ctrl-a":lS,"Ctrl-e":cS};for(let os in pS)mS[os]=pS[os];"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!("undefined"==typeof os||!os.platform)&&os.platform();function gS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s);if(!o)return!1;let a=r?n.tr:null;return!!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=!1,s=t,o=t.$from.doc;if(t.depth>=2&&t.$from.node(t.depth-1).type.compatibleContent(n)&&0==t.startIndex){if(0==t.$from.index(t.depth-1))return!1;let e=o.resolve(t.start-2);s=new gm(e,e,t.depth),t.endIndex<t.parent.childCount&&(t=new gm(t.$from,o.resolve(t.$to.end(t.depth)),t.depth)),i=!0}let a=Sg(s,n,r,t);if(!a)return!1;e&&function(e,t,n,r,i){let s=Gp.empty;for(let u=n.length-1;u>=0;u--)s=Gp.from(n[u].type.create(n[u].attrs,s));e.step(new gg(t.start-(r?2:0),t.end,t.start,t.end,new em(s,0,0),n.length,!0));let o=0;for(let u=0;u<n.length;u++)n[u].type==i&&(o=u+1);let a=n.length-o,l=t.start+n.length-(r?2:0),c=t.parent;for(let u=t.startIndex,h=t.endIndex,d=!0;u<h;u++,d=!1)!d&&Cg(e.doc,l,a)&&(e.split(l,a),l+=2*a),l+=c.child(u).nodeSize}(e,t,a,i,n);return!0}(a,o,e,t)&&(r&&r(a.scrollIntoView()),!0)}}function yS(e){return function(t,n){let{$from:r,$to:i}=t.selection,s=r.blockRange(i,t=>t.childCount>0&&t.firstChild.type==e);return!!s&&(!n||(r.node(s.depth-1).type==e?function(e,t,n,r){let i=e.tr,s=r.end,o=r.$to.end(r.depth);s<o&&(i.step(new gg(s-1,o,s,o,new em(Gp.from(n.create(null,r.parent.copy())),1,0),1,!0)),r=new gm(i.doc.resolve(r.$from.pos),i.doc.resolve(o),r.depth));const a=bg(r);if(null==a)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(s,-1)-1);Tg(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos);return t(i.scrollIntoView()),!0}(t,n,e,s):function(e,t,n){let r=e.tr,i=n.parent;for(let f=n.end,p=n.endIndex-1,m=n.startIndex;p>m;p--)f-=i.child(p).nodeSize,r.delete(f-1,f+1);let s=r.doc.resolve(n.start),o=s.nodeAfter;if(r.mapping.map(n.end)!=n.start+s.nodeAfter.nodeSize)return!1;let a=0==n.startIndex,l=n.endIndex==i.childCount,c=s.node(-1),u=s.index(-1);if(!c.canReplace(u+(a?0:1),u+1,o.content.append(l?Gp.empty:Gp.from(i))))return!1;let h=s.pos,d=h+o.nodeSize;return r.step(new gg(h-(a?1:0),d+(l?1:0),h+1,d-1,new em((a?Gp.empty:Gp.from(i.copy(Gp.empty))).append(l?Gp.empty:Gp.from(i.copy(Gp.empty))),a?0:1,l?0:1),a?0:1)),t(r.scrollIntoView()),!0}(t,n,s)))}}function vS(e){const{state:t,transaction:n}=e;let{selection:r}=n,{doc:i}=n,{storedMarks:s}=n;return{...t,apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return s},get selection(){return r},get doc(){return i},get tr(){return r=n.selection,i=n.doc,s=n.storedMarks,n}}}class wS{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){var e=this;const{rawCommands:t,editor:n,state:r}=this,{view:i}=n,{tr:s}=r,o=this.buildProps(s);return Object.fromEntries(Object.entries(t).map(t=>{let[n,r]=t;return[n,function(){const t=r(...arguments)(o);return s.getMeta("preventDispatch")||e.hasCustomState||i.dispatch(s),t}]}))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:r,editor:i,state:s}=this,{view:o}=i,a=[],l=!!e,c=e||s.tr,u={...Object.fromEntries(Object.entries(r).map(e=>{let[r,i]=e;return[r,function(){const e=t.buildProps(c,n),r=i(...arguments)(e);return a.push(r),u}]})),run:()=>(l||!n||c.getMeta("preventDispatch")||this.hasCustomState||o.dispatch(c),a.every(e=>!0===e))};return u}createCan(e){const{rawCommands:t,state:n}=this,r=!1,i=e||n.tr,s=this.buildProps(i,r),o=Object.fromEntries(Object.entries(t).map(e=>{let[t,n]=e;return[t,function(){return n(...arguments)({...s,dispatch:void 0})}]}));return{...o,chain:()=>this.createChain(i,r)}}buildProps(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];const{rawCommands:n,editor:r,state:i}=this,{view:s}=r,o={tr:e,editor:r,view:s,state:vS({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(n).map(e=>{let[t,n]=e;return[t,function(){return n(...arguments)(o)}]}))}};return o}}class bS{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=this.callbacks[e];return i&&i.forEach(e=>e.apply(this,n)),this}off(e,t){const n=this.callbacks[e];return n&&(t?this.callbacks[e]=n.filter(e=>e!==t):delete this.callbacks[e]),this}once(e,t){var n=this;const r=function(){n.off(e,r);for(var i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];t.apply(n,s)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function SS(e,t,n){if(void 0===e.config[t]&&e.parent)return SS(e.parent,t,n);if("function"===typeof e.config[t]){return e.config[t].bind({...n,parent:e.parent?SS(e.parent,t,n):null})}return e.config[t]}function kS(e){return{baseExtensions:e.filter(e=>"extension"===e.type),nodeExtensions:e.filter(e=>"node"===e.type),markExtensions:e.filter(e=>"mark"===e.type)}}function ES(e){const t=[],{nodeExtensions:n,markExtensions:r}=kS(e),i=[...n,...r],s={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return e.forEach(e=>{const n=SS(e,"addGlobalAttributes",{name:e.name,options:e.options,storage:e.storage,extensions:i});if(!n)return;n().forEach(e=>{e.types.forEach(n=>{Object.entries(e.attributes).forEach(e=>{let[r,i]=e;t.push({type:n,name:r,attribute:{...s,...i}})})})})}),i.forEach(e=>{const n={name:e.name,options:e.options,storage:e.storage},r=SS(e,"addAttributes",n);if(!r)return;const i=r();Object.entries(i).forEach(n=>{let[r,i]=n;const o={...s,...i};"function"===typeof(null===o||void 0===o?void 0:o.default)&&(o.default=o.default()),(null===o||void 0===o?void 0:o.isRequired)&&void 0===(null===o||void 0===o?void 0:o.default)&&delete o.default,t.push({type:e.name,name:r,attribute:o})})}),t}function xS(e,t){if("string"===typeof e){if(!t.nodes[e])throw Error(`There is no node type named '${e}'. Maybe you forgot to add the extension?`);return t.nodes[e]}return e}function CS(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(e=>!!e).reduce((e,t)=>{const n={...e};return Object.entries(t).forEach(e=>{let[t,r]=e;if(n[t])if("class"===t){const e=r?String(r).split(" "):[],i=n[t]?n[t].split(" "):[],s=e.filter(e=>!i.includes(e));n[t]=[...i,...s].join(" ")}else if("style"===t){const e=r?r.split(";").map(e=>e.trim()).filter(Boolean):[],i=n[t]?n[t].split(";").map(e=>e.trim()).filter(Boolean):[],s=new Map;i.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());s.set(t,n)}),e.forEach(e=>{const[t,n]=e.split(":").map(e=>e.trim());s.set(t,n)}),n[t]=Array.from(s.entries()).map(e=>{let[t,n]=e;return`${t}: ${n}`}).join("; ")}else n[t]=r;else n[t]=r}),n},{})}function TS(e,t){return t.filter(t=>t.type===e.type.name).filter(e=>e.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(e.attrs)||{}:{[t.name]:e.attrs[t.name]}).reduce((e,t)=>CS(e,t),{})}function _S(e){return"function"===typeof e}function IS(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(_S(e)){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return t?e.bind(t)(...r):e(...r)}return e}function AS(e,t){return"style"in e?e:{...e,getAttrs:n=>{const r=e.getAttrs?e.getAttrs(n):e.attrs;if(!1===r)return!1;const i=t.reduce((e,t)=>{const r=t.attribute.parseHTML?t.attribute.parseHTML(n):function(e){return"string"!==typeof e?e:e.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(e):"true"===e||"false"!==e&&e}(n.getAttribute(t.name));return null===r||void 0===r?e:{...e,[t.name]:r}},{});return{...r,...i}}}}function NS(e){return Object.fromEntries(Object.entries(e).filter(e=>{let[t,n]=e;return("attrs"!==t||!function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return 0===Object.keys(e).length&&e.constructor===Object}(n))&&(null!==n&&void 0!==n)}))}function OS(e,t){var n;const r=ES(e),{nodeExtensions:i,markExtensions:s}=kS(e),o=null===(n=i.find(e=>SS(e,"topNode")))||void 0===n?void 0:n.name,a=Object.fromEntries(i.map(n=>{const i=r.filter(e=>e.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:t},o=NS({...e.reduce((e,t)=>{const r=SS(t,"extendNodeSchema",s);return{...e,...r?r(n):{}}},{}),content:IS(SS(n,"content",s)),marks:IS(SS(n,"marks",s)),group:IS(SS(n,"group",s)),inline:IS(SS(n,"inline",s)),atom:IS(SS(n,"atom",s)),selectable:IS(SS(n,"selectable",s)),draggable:IS(SS(n,"draggable",s)),code:IS(SS(n,"code",s)),whitespace:IS(SS(n,"whitespace",s)),linebreakReplacement:IS(SS(n,"linebreakReplacement",s)),defining:IS(SS(n,"defining",s)),isolating:IS(SS(n,"isolating",s)),attrs:Object.fromEntries(i.map(e=>{var t;return[e.name,{default:null===(t=null===e||void 0===e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=IS(SS(n,"parseHTML",s));a&&(o.parseDOM=a.map(e=>AS(e,i)));const l=SS(n,"renderHTML",s);l&&(o.toDOM=e=>l({node:e,HTMLAttributes:TS(e,i)}));const c=SS(n,"renderText",s);return c&&(o.toText=c),[n.name,o]})),l=Object.fromEntries(s.map(n=>{const i=r.filter(e=>e.type===n.name),s={name:n.name,options:n.options,storage:n.storage,editor:t},o=NS({...e.reduce((e,t)=>{const r=SS(t,"extendMarkSchema",s);return{...e,...r?r(n):{}}},{}),inclusive:IS(SS(n,"inclusive",s)),excludes:IS(SS(n,"excludes",s)),group:IS(SS(n,"group",s)),spanning:IS(SS(n,"spanning",s)),code:IS(SS(n,"code",s)),attrs:Object.fromEntries(i.map(e=>{var t;return[e.name,{default:null===(t=null===e||void 0===e?void 0:e.attribute)||void 0===t?void 0:t.default}]}))}),a=IS(SS(n,"parseHTML",s));a&&(o.parseDOM=a.map(e=>AS(e,i)));const l=SS(n,"renderHTML",s);return l&&(o.toDOM=e=>l({mark:e,HTMLAttributes:TS(e,i)})),[n.name,o]}));return new Fm({topNode:o,nodes:a,marks:l})}function MS(e,t){return t.nodes[e]||t.marks[e]||null}function RS(e,t){return Array.isArray(t)?t.some(t=>("string"===typeof t?t:t.name)===e.name):t}function DS(e,t){const n=Jm.fromSchema(t).serializeFragment(e),r=document.implementation.createHTMLDocument().createElement("div");return r.appendChild(n),r.innerHTML}function PS(e){return"[object RegExp]"===Object.prototype.toString.call(e)}class LS{constructor(e){this.find=e.find,this.handler=e.handler}}function FS(e){var t;const{editor:n,from:r,to:i,text:s,rules:o,plugin:a}=e,{view:l}=n;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||(null===(t=c.nodeBefore||c.nodeAfter)||void 0===t?void 0:t.marks.find(e=>e.type.spec.code)))return!1;let u=!1;const h=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,n="";const r=e.parentOffset;return e.parent.nodesBetween(Math.max(0,r-t),r,(e,t,i,s)=>{var o,a;const l=(null===(a=(o=e.type.spec).toText)||void 0===a?void 0:a.call(o,{node:e,pos:t,parent:i,index:s}))||e.textContent||"%leaf%";n+=e.isAtom&&!e.isText?l:l.slice(0,Math.max(0,r-t))}),n}(c)+s;return o.forEach(e=>{if(u)return;const t=((e,t)=>{if(PS(t))return t.exec(e);const n=t(e);if(!n)return null;const r=[n.text];return r.index=n.index,r.input=e,r.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(n.replaceWith)),r})(h,e.find);if(!t)return;const o=l.state.tr,c=vS({state:l.state,transaction:o}),d={from:r-(t[0].length-s.length),to:i},{commands:f,chain:p,can:m}=new wS({editor:n,state:c});null!==e.handler({state:c,range:d,match:t,commands:f,chain:p,can:m})&&o.steps.length&&(o.setMeta(a,{transform:o,from:r,to:i,text:s}),l.dispatch(o),u=!0)}),u}function jS(e){const{editor:t,rules:n}=e,r=new hy({state:{init:()=>null,apply(e,i,s){const o=e.getMeta(r);if(o)return o;const a=e.getMeta("applyInputRules");return!!a&&setTimeout(()=>{let{text:e}=a;"string"===typeof e||(e=DS(Gp.from(e),s.schema));const{from:i}=a,o=i+e.length;FS({editor:t,from:i,to:o,text:e,rules:n,plugin:r})}),e.selectionSet||e.docChanged?null:i}},props:{handleTextInput:(e,i,s,o)=>FS({editor:t,from:i,to:s,text:o,rules:n,plugin:r}),handleDOMEvents:{compositionend:e=>(setTimeout(()=>{const{$cursor:i}=e.state.selection;i&&FS({editor:t,from:i.pos,to:i.pos,text:"",rules:n,plugin:r})}),!1)},handleKeyDown(e,i){if("Enter"!==i.key)return!1;const{$cursor:s}=e.state.selection;return!!s&&FS({editor:t,from:s.pos,to:s.pos,text:"\n",rules:n,plugin:r})}},isInputRules:!0});return r}function VS(e){return"Object"===function(e){return Object.prototype.toString.call(e).slice(8,-1)}(e)&&(e.constructor===Object&&Object.getPrototypeOf(e)===Object.prototype)}function zS(e,t){const n={...e};return VS(e)&&VS(t)&&Object.keys(t).forEach(r=>{VS(t[r])&&VS(e[r])?n[r]=zS(e[r],t[r]):n[r]=t[r]}),n}class US{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=IS(SS(this,"addOptions",{name:this.name}))),this.storage=IS(SS(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(){return new US(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend({...this.config,addOptions:()=>zS(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new US(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=IS(SS(t,"addOptions",{name:t.name})),t.storage=IS(SS(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit(e){let{editor:t,mark:n}=e;const{tr:r}=t.state,i=t.state.selection.$from;if(i.pos===i.end()){const e=i.marks();if(!!!e.find(e=>(null===e||void 0===e?void 0:e.type.name)===n.name))return!1;const s=e.find(e=>(null===e||void 0===e?void 0:e.type.name)===n.name);return s&&r.removeStoredMark(s),r.insertText(" ",i.pos),t.view.dispatch(r),!0}return!1}}class BS{constructor(e){this.find=e.find,this.handler=e.handler}}function $S(e){const{editor:t,state:n,from:r,to:i,rule:s,pasteEvent:o,dropEvent:a}=e,{commands:l,chain:c,can:u}=new wS({editor:t,state:n}),h=[];n.doc.nodesBetween(r,i,(e,t)=>{if(!e.isTextblock||e.type.spec.code)return;const d=Math.max(r,t),f=Math.min(i,t+e.content.size);((e,t,n)=>{if(PS(t))return[...e.matchAll(t)];const r=t(e,n);return r?r.map(t=>{const n=[t.text];return n.index=t.index,n.input=e,n.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),n.push(t.replaceWith)),n}):[]})(e.textBetween(d-t,f-t,void 0,"\ufffc"),s.find,o).forEach(e=>{if(void 0===e.index)return;const t=d+e.index+1,r=t+e[0].length,i={from:n.tr.mapping.map(t),to:n.tr.mapping.map(r)},f=s.handler({state:n,range:i,match:e,commands:l,chain:c,can:u,pasteEvent:o,dropEvent:a});h.push(f)})});return h.every(e=>null!==e)}let qS=null;function HS(e){const{editor:t,rules:n}=e;let r,i=null,s=!1,o=!1,a="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null;try{r="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch{r=null}const l=e=>{let{state:n,from:i,to:s,rule:o,pasteEvt:l}=e;const c=n.tr,u=vS({state:n,transaction:c});if($S({editor:t,state:u,from:Math.max(i-1,0),to:s.b-1,rule:o,pasteEvent:l,dropEvent:r})&&c.steps.length){try{r="undefined"!==typeof DragEvent?new DragEvent("drop"):null}catch{r=null}return a="undefined"!==typeof ClipboardEvent?new ClipboardEvent("paste"):null,c}};return n.map(e=>new hy({view(e){const n=n=>{var r;i=(null===(r=e.dom.parentElement)||void 0===r?void 0:r.contains(n.target))?e.dom.parentElement:null,i&&(qS=t)},r=()=>{qS&&(qS=null)};return window.addEventListener("dragstart",n),window.addEventListener("dragend",r),{destroy(){window.removeEventListener("dragstart",n),window.removeEventListener("dragend",r)}}},props:{handleDOMEvents:{drop:(e,t)=>{if(o=i===e.dom.parentElement,r=t,!o){const e=qS;(null===e||void 0===e?void 0:e.isEditable)&&setTimeout(()=>{const t=e.state.selection;t&&e.commands.deleteRange({from:t.from,to:t.to})},10)}return!1},paste:(e,t)=>{var n;const r=null===(n=t.clipboardData)||void 0===n?void 0:n.getData("text/html");return a=t,s=!!(null===r||void 0===r?void 0:r.includes("data-pm-slice")),!1}}},appendTransaction:(t,n,r)=>{const i=t[0],c="paste"===i.getMeta("uiEvent")&&!s,u="drop"===i.getMeta("uiEvent")&&!o,h=i.getMeta("applyPasteRules"),d=!!h;if(!c&&!u&&!d)return;if(d){let{text:t}=h;"string"===typeof t||(t=DS(Gp.from(t),r.schema));const{from:n}=h,i=n+t.length,s=(e=>{var t;const n=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return null===(t=n.clipboardData)||void 0===t||t.setData("text/html",e),n})(t);return l({rule:e,state:r,from:n,to:{b:i},pasteEvt:s})}const f=n.doc.content.findDiffStart(r.doc.content),p=n.doc.content.findDiffEnd(r.doc.content);return"number"===typeof f&&p&&f!==p.b?l({rule:e,state:r,from:f,to:p,pasteEvt:a}):void 0}}))}class WS{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=WS.resolve(e),this.schema=OS(this.extensions,t),this.setupExtensions()}static resolve(e){const t=WS.sort(WS.flatten(e)),n=function(e){const t=e.filter((t,n)=>e.indexOf(t)!==n);return Array.from(new Set(t))}(t.map(e=>e.name));return n.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${n.map(e=>`'${e}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(e=>{const t=SS(e,"addExtensions",{name:e.name,options:e.options,storage:e.storage});return t?[e,...this.flatten(t())]:e}).flat(10)}static sort(e){return e.sort((e,t)=>{const n=SS(e,"priority")||100,r=SS(t,"priority")||100;return n>r?-1:n<r?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const n=SS(t,"addCommands",{name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:MS(t.name,this.schema)});return n?{...e,...n()}:e},{})}get plugins(){const{editor:e}=this,t=WS.sort([...this.extensions].reverse()),n=[],r=[],i=t.map(t=>{const i={name:t.name,options:t.options,storage:t.storage,editor:e,type:MS(t.name,this.schema)},s=[],o=SS(t,"addKeyboardShortcuts",i);let a={};if("mark"===t.type&&SS(t,"exitable",i)&&(a.ArrowRight=()=>US.handleExit({editor:e,mark:t})),o){const t=Object.fromEntries(Object.entries(o()).map(t=>{let[n,r]=t;return[n,()=>r({editor:e})]}));a={...a,...t}}const l=new hy({props:{handleKeyDown:Ub(a)}});s.push(l);const c=SS(t,"addInputRules",i);RS(t,e.options.enableInputRules)&&c&&n.push(...c());const u=SS(t,"addPasteRules",i);RS(t,e.options.enablePasteRules)&&u&&r.push(...u());const h=SS(t,"addProseMirrorPlugins",i);if(h){const e=h();s.push(...e)}return s}).flat();return[jS({editor:e,rules:n}),...HS({editor:e,rules:r}),...i]}get attributes(){return ES(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=kS(this.extensions);return Object.fromEntries(t.filter(e=>!!SS(e,"addNodeView")).map(t=>{const n=this.attributes.filter(e=>e.type===t.name),r={name:t.name,options:t.options,storage:t.storage,editor:e,type:xS(t.name,this.schema)},i=SS(t,"addNodeView",r);if(!i)return[];return[t.name,(r,s,o,a,l)=>{const c=TS(r,n);return i()({node:r,view:s,getPos:o,decorations:a,innerDecorations:l,editor:e,extension:t,HTMLAttributes:c})}]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const n={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:MS(e.name,this.schema)};if("mark"===e.type){(null===(t=IS(SS(e,"keepOnSplit",n)))||void 0===t||t)&&this.splittableMarks.push(e.name)}const r=SS(e,"onBeforeCreate",n),i=SS(e,"onCreate",n),s=SS(e,"onUpdate",n),o=SS(e,"onSelectionUpdate",n),a=SS(e,"onTransaction",n),l=SS(e,"onFocus",n),c=SS(e,"onBlur",n),u=SS(e,"onDestroy",n);r&&this.editor.on("beforeCreate",r),i&&this.editor.on("create",i),s&&this.editor.on("update",s),o&&this.editor.on("selectionUpdate",o),a&&this.editor.on("transaction",a),l&&this.editor.on("focus",l),c&&this.editor.on("blur",c),u&&this.editor.on("destroy",u)})}}class KS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=IS(SS(this,"addOptions",{name:this.name}))),this.storage=IS(SS(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(){return new KS(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend({...this.config,addOptions:()=>zS(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new KS({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=IS(SS(t,"addOptions",{name:t.name})),t.storage=IS(SS(t,"addStorage",{name:t.name,options:t.options})),t}}function GS(e,t,n){const{from:r,to:i}=t,{blockSeparator:s="\n\n",textSerializers:o={}}=n||{};let a="";return e.nodesBetween(r,i,(e,n,l,c)=>{var u;e.isBlock&&n>r&&(a+=s);const h=null===o||void 0===o?void 0:o[e.type.name];if(h)return l&&(a+=h({node:e,pos:n,parent:l,index:c,range:t})),!1;e.isText&&(a+=null===(u=null===e||void 0===e?void 0:e.text)||void 0===u?void 0:u.slice(Math.max(r,n)-n,i-n))}),a}function JS(e){return Object.fromEntries(Object.entries(e.nodes).filter(e=>{let[,t]=e;return t.spec.toText}).map(e=>{let[t,n]=e;return[t,n.spec.toText]}))}const QS=KS.create({name:"clipboardTextSerializer",addOptions:()=>({blockSeparator:void 0}),addProseMirrorPlugins(){return[new hy({key:new py("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:e}=this,{state:t,schema:n}=e,{doc:r,selection:i}=t,{ranges:s}=i,o=Math.min(...s.map(e=>e.$from.pos)),a=Math.max(...s.map(e=>e.$to.pos)),l=JS(n);return GS(r,{from:o,to:a},{...void 0!==this.options.blockSeparator?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}});function XS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{strict:!0};const r=Object.keys(t);return!r.length||r.every(r=>n.strict?t[r]===e[r]:PS(t[r])?t[r].test(e[r]):t[r]===e[r])}function YS(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return e.find(e=>e.type===t&&XS(Object.fromEntries(Object.keys(n).map(t=>[t,e.attrs[t]])),n))}function ZS(e,t){return!!YS(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{})}function ek(e,t,n){var r;if(!e||!t)return;let i=e.parent.childAfter(e.parentOffset);if(i.node&&i.node.marks.some(e=>e.type===t)||(i=e.parent.childBefore(e.parentOffset)),!i.node||!i.node.marks.some(e=>e.type===t))return;n=n||(null===(r=i.node.marks[0])||void 0===r?void 0:r.attrs);if(!YS([...i.node.marks],t,n))return;let s=i.index,o=e.start()+i.offset,a=s+1,l=o+i.node.nodeSize;for(;s>0&&ZS([...e.parent.child(s-1).marks],t,n);)s-=1,o-=e.parent.child(s).nodeSize;for(;a<e.parent.childCount&&ZS([...e.parent.child(a).marks],t,n);)l+=e.parent.child(a).nodeSize,a+=1;return{from:o,to:l}}function tk(e,t){if("string"===typeof e){if(!t.marks[e])throw Error(`There is no mark type named '${e}'. Maybe you forgot to add the extension?`);return t.marks[e]}return e}function nk(e){return e instanceof Qg}function rk(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Math.min(Math.max(e,t),n)}function ik(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!t)return null;const n=Wg.atStart(e),r=Wg.atEnd(e);if("start"===t||!0===t)return n;if("end"===t)return r;const i=n.from,s=r.to;return"all"===t?Qg.create(e,rk(0,i,s),rk(e.content.size,i,s)):Qg.create(e,rk(t,i,s),rk(t,i,s))}function sk(){return"Android"===navigator.platform||/android/i.test(navigator.userAgent)}function ok(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const ak=e=>{const t=e.childNodes;for(let n=t.length-1;n>=0;n-=1){const r=t[n];3===r.nodeType&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?e.removeChild(r):1===r.nodeType&&ak(r)}return e};function lk(e){const t=`<body>${e}</body>`,n=(new window.DOMParser).parseFromString(t,"text/html").body;return ak(n)}function ck(e,t,n){if(e instanceof vm||e instanceof Gp)return e;n={slice:!0,parseOptions:{},...n};const r="string"===typeof e;if("object"===typeof e&&null!==e)try{if(Array.isArray(e)&&e.length>0)return Gp.fromArray(e.map(e=>t.nodeFromJSON(e)));const r=t.nodeFromJSON(e);return n.errorOnInvalidContent&&r.check(),r}catch(i){if(n.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",e,"Error:",i),ck("",t,n)}if(r){if(n.errorOnInvalidContent){let r=!1,i="";const s=new Fm({topNode:t.spec.topNode,marks:t.spec.marks,nodes:t.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:e=>(r=!0,i="string"===typeof e?e:e.outerHTML,null)}]}})});if(n.slice?Vm.fromSchema(s).parseSlice(lk(e),n.parseOptions):Vm.fromSchema(s).parse(lk(e),n.parseOptions),n.errorOnInvalidContent&&r)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${i}`)})}const r=Vm.fromSchema(t);return n.slice?r.parseSlice(lk(e),n.parseOptions).content:r.parse(lk(e),n.parseOptions)}return ck("",t,n)}function uk(){return"undefined"!==typeof navigator&&/Mac/.test(navigator.platform)}function hk(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{from:r,to:i,empty:s}=e.selection,o=t?xS(t,e.schema):null,a=[];e.doc.nodesBetween(r,i,(e,t)=>{if(e.isText)return;const n=Math.max(r,t),s=Math.min(i,t+e.nodeSize);a.push({node:e,from:n,to:s})});const l=i-r,c=a.filter(e=>!o||o.name===e.node.type.name).filter(e=>XS(e.node.attrs,n,{strict:!1}));if(s)return!!c.length;const u=c.reduce((e,t)=>e+t.to-t.from,0);return u>=l}function dk(e,t){return t.nodes[e]?"node":t.marks[e]?"mark":null}function fk(e,t){const n="string"===typeof t?[t]:t;return Object.keys(e).reduce((t,r)=>(n.includes(r)||(t[r]=e[r]),t),{})}function pk(e,t){return ck(e,t,{slice:!1,parseOptions:arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},errorOnInvalidContent:(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).errorOnInvalidContent})}function mk(e,t){const n=tk(t,e.schema),{from:r,to:i,empty:s}=e.selection,o=[];s?(e.storedMarks&&o.push(...e.storedMarks),o.push(...e.selection.$head.marks())):e.doc.nodesBetween(r,i,e=>{o.push(...e.marks)});const a=o.find(e=>e.type.name===n.name);return a?{...a.attrs}:{}}function gk(e){return t=>function(e,t){for(let n=e.depth;n>0;n-=1){const r=e.node(n);if(t(r))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:r}}}(t.$from,e)}function yk(e,t){return GS(e,{from:0,to:e.content.size},t)}function vk(e,t){const n=dk("string"===typeof t?t:t.name,e.schema);return"node"===n?function(e,t){const n=xS(t,e.schema),{from:r,to:i}=e.selection,s=[];e.doc.nodesBetween(r,i,e=>{s.push(e)});const o=s.reverse().find(e=>e.type.name===n.name);return o?{...o.attrs}:{}}(e,t):"mark"===n?mk(e,t):{}}function wk(e,t,n){const r=[];return e===t?n.resolve(e).marks().forEach(t=>{const i=ek(n.resolve(e),t.type);i&&r.push({mark:t,...i})}):n.nodesBetween(e,t,(e,t)=>{e&&void 0!==(null===e||void 0===e?void 0:e.nodeSize)&&r.push(...e.marks.map(n=>({from:t,to:t+e.nodeSize,mark:n})))}),r}function bk(e,t,n){return Object.fromEntries(Object.entries(n).filter(n=>{let[r]=n;const i=e.find(e=>e.type===t&&e.name===r);return!!i&&i.attribute.keepOnSplit}))}function Sk(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{empty:r,ranges:i}=e.selection,s=t?tk(t,e.schema):null;if(r)return!!(e.storedMarks||e.selection.$from.marks()).filter(e=>!s||s.name===e.type.name).find(e=>XS(e.attrs,n,{strict:!1}));let o=0;const a=[];if(i.forEach(t=>{let{$from:n,$to:r}=t;const i=n.pos,s=r.pos;e.doc.nodesBetween(i,s,(e,t)=>{if(!e.isText&&!e.marks.length)return;const n=Math.max(i,t),r=Math.min(s,t+e.nodeSize);o+=r-n,a.push(...e.marks.map(e=>({mark:e,from:n,to:r})))})}),0===o)return!1;const l=a.filter(e=>!s||s.name===e.mark.type.name).filter(e=>XS(e.mark.attrs,n,{strict:!1})).reduce((e,t)=>e+t.to-t.from,0),c=a.filter(e=>!s||e.mark.type!==s&&e.mark.type.excludes(s)).reduce((e,t)=>e+t.to-t.from,0);return(l>0?l+c:l)>=o}function kk(e,t){const{nodeExtensions:n}=kS(t),r=n.find(t=>t.name===e);if(!r)return!1;const i=IS(SS(r,"group",{name:r.name,options:r.options,storage:r.storage}));return"string"===typeof i&&i.split(" ").includes("list")}function Ek(e){let{checkChildren:t=!0,ignoreWhitespace:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var r;if(n){if("hardBreak"===e.type.name)return!0;if(e.isText)return/^\s*$/m.test(null!==(r=e.text)&&void 0!==r?r:"")}if(e.isText)return!e.text;if(e.isAtom||e.isLeaf)return!1;if(0===e.content.childCount)return!0;if(t){let r=!0;return e.content.forEach(e=>{!1!==r&&(Ek(e,{ignoreWhitespace:n,checkChildren:t})||(r=!1))}),r}return!1}function xk(e,t){const n=e.storedMarks||e.selection.$to.parentOffset&&e.selection.$from.marks();if(n){const r=n.filter(e=>null===t||void 0===t?void 0:t.includes(e.type.name));e.tr.ensureMarks(r)}}const Ck=(e,t)=>{const n=gk(e=>e.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===r)return!0;const i=e.doc.nodeAt(r);return n.node.type!==(null===i||void 0===i?void 0:i.type)||!Tg(e.doc,n.pos)||(e.join(n.pos),!0)},Tk=(e,t)=>{const n=gk(e=>e.type===t)(e.selection);if(!n)return!0;const r=e.doc.resolve(n.start).after(n.depth);if(void 0===r)return!0;const i=e.doc.nodeAt(r);return n.node.type!==(null===i||void 0===i?void 0:i.type)||!Tg(e.doc,r)||(e.join(r),!0)};var _k=Object.freeze({__proto__:null,blur:()=>e=>{let{editor:t,view:n}=e;return requestAnimationFrame(()=>{var e;t.isDestroyed||(n.dom.blur(),null===(e=null===window||void 0===window?void 0:window.getSelection())||void 0===e||e.removeAllRanges())}),!0},clearContent:function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return t=>{let{commands:n}=t;return n.setContent("",e)}},clearNodes:()=>e=>{let{state:t,tr:n,dispatch:r}=e;const{selection:i}=n,{ranges:s}=i;return!r||(s.forEach(e=>{let{$from:r,$to:i}=e;t.doc.nodesBetween(r.pos,i.pos,(e,t)=>{if(e.type.isText)return;const{doc:r,mapping:i}=n,s=r.resolve(i.map(t)),o=r.resolve(i.map(t+e.nodeSize)),a=s.blockRange(o);if(!a)return;const l=bg(a);if(e.type.isTextblock){const{defaultType:e}=s.parent.contentMatchAt(s.index());n.setNodeMarkup(a.start,e)}(l||0===l)&&n.lift(a,l)})}),!0)},command:e=>t=>e(t),createParagraphNear:()=>e=>{let{state:t,dispatch:n}=e;return nS(t,n)},cut:(e,t)=>n=>{let{editor:r,tr:i}=n;const{state:s}=r,o=s.doc.slice(e.from,e.to);i.deleteRange(e.from,e.to);const a=i.mapping.map(t);return i.insert(a,o.content),i.setSelection(new Qg(i.doc.resolve(Math.max(a-1,0)))),!0},deleteCurrentNode:()=>e=>{let{tr:t,dispatch:n}=e;const{selection:r}=t,i=r.$anchor.node();if(i.content.size>0)return!1;const s=t.selection.$anchor;for(let o=s.depth;o>0;o-=1){if(s.node(o).type===i.type){if(n){const e=s.before(o),n=s.after(o);t.delete(e,n).scrollIntoView()}return!0}}return!1},deleteNode:e=>t=>{let{tr:n,state:r,dispatch:i}=t;const s=xS(e,r.schema),o=n.selection.$anchor;for(let e=o.depth;e>0;e-=1){if(o.node(e).type===s){if(i){const t=o.before(e),r=o.after(e);n.delete(t,r).scrollIntoView()}return!0}}return!1},deleteRange:e=>t=>{let{tr:n,dispatch:r}=t;const{from:i,to:s}=e;return r&&n.delete(i,s),!0},deleteSelection:()=>e=>{let{state:t,dispatch:n}=e;return Bb(t,n)},enter:()=>e=>{let{commands:t}=e;return t.keyboardShortcut("Enter")},exitCode:()=>e=>{let{state:t,dispatch:n}=e;return tS(t,n)},extendMarkRange:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:i,dispatch:s}=n;const o=tk(e,i.schema),{doc:a,selection:l}=r,{$from:c,from:u,to:h}=l;if(s){const e=ek(c,o,t);if(e&&e.from<=u&&e.to>=h){const t=Qg.create(a,e.from,e.to);r.setSelection(t)}}return!0}},first:e=>t=>{const n="function"===typeof e?e(t):e;for(let e=0;e<n.length;e+=1)if(n[e](t))return!0;return!1},focus:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{editor:r,view:i,tr:s,dispatch:o}=n;t={scrollIntoView:!0,...t};const a=()=>{(ok()||sk())&&i.dom.focus(),requestAnimationFrame(()=>{r.isDestroyed||(i.focus(),(null===t||void 0===t?void 0:t.scrollIntoView)&&r.commands.scrollIntoView())})};if(i.hasFocus()&&null===e||!1===e)return!0;if(o&&null===e&&!nk(r.state.selection))return a(),!0;const l=ik(s.doc,e)||r.state.selection,c=r.state.selection.eq(l);return o&&(c||s.setSelection(l),c&&s.storedMarks&&s.setStoredMarks(s.storedMarks),a()),!0}},forEach:(e,t)=>n=>e.every((e,r)=>t(e,{...n,index:r})),insertContent:(e,t)=>n=>{let{tr:r,commands:i}=n;return i.insertContentAt({from:r.selection.from,to:r.selection.to},e,t)},insertContentAt:(e,t,n)=>r=>{let{tr:i,dispatch:s,editor:o}=r;var a;if(s){let r;const s=e=>{o.emit("contentError",{editor:o,error:e,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...(n={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...n}).parseOptions};if(!n.errorOnInvalidContent&&!o.options.enableContentCheck&&o.options.emitContentError)try{ck(t,o.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(l){s(l)}try{r=ck(t,o.schema,{parseOptions:c,errorOnInvalidContent:null!==(a=n.errorOnInvalidContent)&&void 0!==a?a:o.options.enableContentCheck})}catch(l){return s(l),!1}let{from:u,to:h}="number"===typeof e?{from:e,to:e}:{from:e.from,to:e.to},d=!0,f=!0;if(("type"in r?[r]:r).forEach(e=>{e.check(),d=!!d&&(e.isText&&0===e.marks.length),f=!!f&&e.isBlock}),u===h&&f){const{parent:e}=i.doc.resolve(u);e.isTextblock&&!e.type.spec.code&&!e.childCount&&(u-=1,h+=1)}let p;if(d){if(Array.isArray(t))p=t.map(e=>e.text||"").join("");else if(t instanceof Gp){let e="";t.forEach(t=>{t.text&&(e+=t.text)}),p=e}else p="object"===typeof t&&t&&t.text?t.text:t;i.insertText(p,u,h)}else p=r,i.replaceWith(u,h,p);n.updateSelection&&function(e,t,n){const r=e.steps.length-1;if(r<t)return;const i=e.steps[r];if(!(i instanceof mg||i instanceof gg))return;const s=e.mapping.maps[r];let o=0;s.forEach((e,t,n,r)=>{0===o&&(o=r)}),e.setSelection(Wg.near(e.doc.resolve(o),n))}(i,i.steps.length-1,-1),n.applyInputRules&&i.setMeta("applyInputRules",{from:u,text:p}),n.applyPasteRules&&i.setMeta("applyPasteRules",{from:u,text:p})}return!0},joinBackward:()=>e=>{let{state:t,dispatch:n}=e;return qb(t,n)},joinDown:()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,r=e.selection;if(r instanceof Yg){if(r.node.isTextblock||!Tg(e.doc,r.to))return!1;n=r.to}else if(n=Ig(e.doc,r.to,1),null==n)return!1;return t&&t(e.tr.join(n).scrollIntoView()),!0})(t,n)},joinForward:()=>e=>{let{state:t,dispatch:n}=e;return Qb(t,n)},joinItemBackward:()=>e=>{let{state:t,dispatch:n,tr:r}=e;try{const e=Ig(t.doc,t.selection.$from.pos,-1);return null!==e&&void 0!==e&&(r.join(e,2),n&&n(r),!0)}catch{return!1}},joinItemForward:()=>e=>{let{state:t,dispatch:n,tr:r}=e;try{const e=Ig(t.doc,t.selection.$from.pos,1);return null!==e&&void 0!==e&&(r.join(e,2),n&&n(r),!0)}catch{return!1}},joinTextblockBackward:()=>e=>{let{state:t,dispatch:n}=e;return((e,t,n)=>{let r=$b(e,n);if(!r)return!1;let i=Gb(r);return!!i&&Hb(e,i,t)})(t,n)},joinTextblockForward:()=>e=>{let{state:t,dispatch:n}=e;return((e,t,n)=>{let r=Jb(e,n);if(!r)return!1;let i=Yb(r);return!!i&&Hb(e,i,t)})(t,n)},joinUp:()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,r=e.selection,i=r instanceof Yg;if(i){if(r.node.isTextblock||!Tg(e.doc,r.from))return!1;n=r.from}else if(n=Ig(e.doc,r.from,-1),null==n)return!1;if(t){let r=e.tr.join(n);i&&r.setSelection(Yg.create(r.doc,n-e.doc.resolve(n).nodeBefore.nodeSize)),t(r.scrollIntoView())}return!0})(t,n)},keyboardShortcut:e=>t=>{let{editor:n,view:r,tr:i,dispatch:s}=t;const o=function(e){const t=e.split(/-(?!$)/);let n,r,i,s,o=t[t.length-1];"Space"===o&&(o=" ");for(let a=0;a<t.length-1;a+=1){const e=t[a];if(/^(cmd|meta|m)$/i.test(e))s=!0;else if(/^a(lt)?$/i.test(e))n=!0;else if(/^(c|ctrl|control)$/i.test(e))r=!0;else if(/^s(hift)?$/i.test(e))i=!0;else{if(!/^mod$/i.test(e))throw new Error(`Unrecognized modifier name: ${e}`);ok()||uk()?s=!0:r=!0}}return n&&(o=`Alt-${o}`),r&&(o=`Ctrl-${o}`),s&&(o=`Meta-${o}`),i&&(o=`Shift-${o}`),o}(e).split(/-(?!$)/),a=o.find(e=>!["Alt","Ctrl","Meta","Shift"].includes(e)),l=new KeyboardEvent("keydown",{key:"Space"===a?" ":a,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),c=n.captureTransaction(()=>{r.someProp("handleKeyDown",e=>e(r,l))});return null===c||void 0===c||c.steps.forEach(e=>{const t=e.map(i.mapping);t&&s&&i.maybeStep(t)}),!0},lift:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:i}=n;return!!hk(r,xS(e,r.schema),t)&&((e,t)=>{let{$from:n,$to:r}=e.selection,i=n.blockRange(r),s=i&&bg(i);return null!=s&&(t&&t(e.tr.lift(i,s).scrollIntoView()),!0)})(r,i)}},liftEmptyBlock:()=>e=>{let{state:t,dispatch:n}=e;return rS(t,n)},liftListItem:e=>t=>{let{state:n,dispatch:r}=t;return yS(xS(e,n.schema))(n,r)},newlineInCode:()=>e=>{let{state:t,dispatch:n}=e;return Zb(t,n)},resetAttributes:(e,t)=>n=>{let{tr:r,state:i,dispatch:s}=n,o=null,a=null;const l=dk("string"===typeof e?e:e.name,i.schema);return!!l&&("node"===l&&(o=xS(e,i.schema)),"mark"===l&&(a=tk(e,i.schema)),s&&r.selection.ranges.forEach(e=>{i.doc.nodesBetween(e.$from.pos,e.$to.pos,(e,n)=>{o&&o===e.type&&r.setNodeMarkup(n,void 0,fk(e.attrs,t)),a&&e.marks.length&&e.marks.forEach(i=>{a===i.type&&r.addMark(n,n+e.nodeSize,a.create(fk(i.attrs,t)))})})}),!0)},scrollIntoView:()=>e=>{let{tr:t,dispatch:n}=e;return n&&t.scrollIntoView(),!0},selectAll:()=>e=>{let{tr:t,dispatch:n}=e;if(n){const e=new ey(t.doc);t.setSelection(e)}return!0},selectNodeBackward:()=>e=>{let{state:t,dispatch:n}=e;return Kb(t,n)},selectNodeForward:()=>e=>{let{state:t,dispatch:n}=e;return Xb(t,n)},selectParentNode:()=>e=>{let{state:t,dispatch:n}=e;return((e,t)=>{let n,{$from:r,to:i}=e.selection,s=r.sharedDepth(i);return 0!=s&&(n=r.before(s),t&&t(e.tr.setSelection(Yg.create(e.doc,n))),!0)})(t,n)},selectTextblockEnd:()=>e=>{let{state:t,dispatch:n}=e;return cS(t,n)},selectTextblockStart:()=>e=>{let{state:t,dispatch:n}=e;return lS(t,n)},setContent:function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i=>{let{editor:s,tr:o,dispatch:a,commands:l}=i;var c,u;const{doc:h}=o;if("full"!==n.preserveWhitespace){const i=pk(e,s.schema,n,{errorOnInvalidContent:null!==(c=r.errorOnInvalidContent)&&void 0!==c?c:s.options.enableContentCheck});return a&&o.replaceWith(0,h.content.size,i).setMeta("preventUpdate",!t),!0}return a&&o.setMeta("preventUpdate",!t),l.insertContentAt({from:0,to:h.content.size},e,{parseOptions:n,errorOnInvalidContent:null!==(u=r.errorOnInvalidContent)&&void 0!==u?u:s.options.enableContentCheck})}},setMark:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:i,dispatch:s}=n;const{selection:o}=r,{empty:a,ranges:l}=o,c=tk(e,i.schema);if(s)if(a){const e=mk(i,c);r.addStoredMark(c.create({...e,...t}))}else l.forEach(e=>{const n=e.$from.pos,s=e.$to.pos;i.doc.nodesBetween(n,s,(e,i)=>{const o=Math.max(i,n),a=Math.min(i+e.nodeSize,s);e.marks.find(e=>e.type===c)?e.marks.forEach(e=>{c===e.type&&r.addMark(o,a,c.create({...e.attrs,...t}))}):r.addMark(o,a,c.create(t))})});return function(e,t,n){var r;const{selection:i}=t;let s=null;if(nk(i)&&(s=i.$cursor),s){const t=null!==(r=e.storedMarks)&&void 0!==r?r:s.marks();return!!n.isInSet(t)||!t.some(e=>e.type.excludes(n))}const{ranges:o}=i;return o.some(t=>{let{$from:r,$to:i}=t,s=0===r.depth&&e.doc.inlineContent&&e.doc.type.allowsMarkType(n);return e.doc.nodesBetween(r.pos,i.pos,(e,t,r)=>{if(s)return!1;if(e.isInline){const t=!r||r.type.allowsMarkType(n),i=!!n.isInSet(e.marks)||!e.marks.some(e=>e.type.excludes(n));s=t&&i}return!s}),s})}(i,r,c)}},setMeta:(e,t)=>n=>{let{tr:r}=n;return r.setMeta(e,t),!0},setNode:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:i,chain:s}=n;const o=xS(e,r.schema);let a;return r.selection.$anchor.sameParent(r.selection.$head)&&(a=r.selection.$anchor.parent.attrs),o.isTextblock?s().command(e=>{let{commands:n}=e;return!!uS(o,{...a,...t})(r)||n.clearNodes()}).command(e=>{let{state:n}=e;return uS(o,{...a,...t})(n,i)}).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)}},setNodeSelection:e=>t=>{let{tr:n,dispatch:r}=t;if(r){const{doc:t}=n,r=rk(e,0,t.content.size),i=Yg.create(t,r);n.setSelection(i)}return!0},setTextSelection:e=>t=>{let{tr:n,dispatch:r}=t;if(r){const{doc:t}=n,{from:r,to:i}="number"===typeof e?{from:e,to:e}:e,s=Qg.atStart(t).from,o=Qg.atEnd(t).to,a=rk(r,s,o),l=rk(i,s,o),c=Qg.create(t,a,l);n.setSelection(c)}return!0},sinkListItem:e=>t=>{let{state:n,dispatch:r}=t;const i=xS(e,n.schema);return(s=i,function(e,t){let{$from:n,$to:r}=e.selection,i=n.blockRange(r,e=>e.childCount>0&&e.firstChild.type==s);if(!i)return!1;let o=i.startIndex;if(0==o)return!1;let a=i.parent,l=a.child(o-1);if(l.type!=s)return!1;if(t){let n=l.lastChild&&l.lastChild.type==a.type,r=Gp.from(n?s.create():null),o=new em(Gp.from(s.create(null,Gp.from(a.type.create(null,r)))),n?3:1,0),c=i.start,u=i.end;t(e.tr.step(new gg(c-(n?3:1),u,c,u,o,1,!0)).scrollIntoView())}return!0})(n,r);var s},splitBlock:function(){let{keepMarks:e=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t=>{let{tr:n,state:r,dispatch:i,editor:s}=t;const{selection:o,doc:a}=n,{$from:l,$to:c}=o,u=bk(s.extensionManager.attributes,l.node().type.name,l.node().attrs);if(o instanceof Yg&&o.node.isBlock)return!(!l.parentOffset||!Cg(a,l.pos))&&(i&&(e&&xk(r,s.extensionManager.splittableMarks),n.split(l.pos).scrollIntoView()),!0);if(!l.parent.isBlock)return!1;const h=c.parentOffset===c.parent.content.size,d=0===l.depth?void 0:function(e){for(let t=0;t<e.edgeCount;t+=1){const{type:n}=e.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(l.node(-1).contentMatchAt(l.indexAfter(-1)));let f=h&&d?[{type:d,attrs:u}]:void 0,p=Cg(n.doc,n.mapping.map(l.pos),1,f);if(f||p||!Cg(n.doc,n.mapping.map(l.pos),1,d?[{type:d}]:void 0)||(p=!0,f=d?[{type:d,attrs:u}]:void 0),i){if(p&&(o instanceof Qg&&n.deleteSelection(),n.split(n.mapping.map(l.pos),1,f),d&&!h&&!l.parentOffset&&l.parent.type!==d)){const e=n.mapping.map(l.before()),t=n.doc.resolve(e);l.node(-1).canReplaceWith(t.index(),t.index()+1,d)&&n.setNodeMarkup(n.mapping.map(l.before()),d)}e&&xk(r,s.extensionManager.splittableMarks),n.scrollIntoView()}return p}},splitListItem:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:i,dispatch:s,editor:o}=n;var a;const l=xS(e,i.schema),{$from:c,$to:u}=i.selection,h=i.selection.node;if(h&&h.isBlock||c.depth<2||!c.sameParent(u))return!1;const d=c.node(-1);if(d.type!==l)return!1;const f=o.extensionManager.attributes;if(0===c.parent.content.size&&c.node(-1).childCount===c.indexAfter(-1)){if(2===c.depth||c.node(-3).type!==l||c.index(-2)!==c.node(-2).childCount-1)return!1;if(s){let e=Gp.empty;const n=c.index(-1)?1:c.index(-2)?2:3;for(let t=c.depth-n;t>=c.depth-3;t-=1)e=Gp.from(c.node(t).copy(e));const i=c.indexAfter(-1)<c.node(-2).childCount?1:c.indexAfter(-2)<c.node(-3).childCount?2:3,s={...bk(f,c.node().type.name,c.node().attrs),...t},o=(null===(a=l.contentMatch.defaultType)||void 0===a?void 0:a.createAndFill(s))||void 0;e=e.append(Gp.from(l.createAndFill(null,o)||void 0));const u=c.before(c.depth-(n-1));r.replace(u,c.after(-i),new em(e,4-n,0));let h=-1;r.doc.nodesBetween(u,r.doc.content.size,(e,t)=>{if(h>-1)return!1;e.isTextblock&&0===e.content.size&&(h=t+1)}),h>-1&&r.setSelection(Qg.near(r.doc.resolve(h))),r.scrollIntoView()}return!0}const p=u.pos===c.end()?d.contentMatchAt(0).defaultType:null,m={...bk(f,d.type.name,d.attrs),...t},g={...bk(f,c.node().type.name,c.node().attrs),...t};r.delete(c.pos,u.pos);const y=p?[{type:l,attrs:m},{type:p,attrs:g}]:[{type:l,attrs:m}];if(!Cg(r.doc,c.pos,2))return!1;if(s){const{selection:e,storedMarks:t}=i,{splittableMarks:n}=o.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();if(r.split(c.pos,2,y).scrollIntoView(),!a||!s)return!0;const l=a.filter(e=>n.includes(e.type.name));r.ensureMarks(l)}return!0}},toggleList:function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return i=>{let{editor:s,tr:o,state:a,dispatch:l,chain:c,commands:u,can:h}=i;const{extensions:d,splittableMarks:f}=s.extensionManager,p=xS(e,a.schema),m=xS(t,a.schema),{selection:g,storedMarks:y}=a,{$from:v,$to:w}=g,b=v.blockRange(w),S=y||g.$to.parentOffset&&g.$from.marks();if(!b)return!1;const k=gk(e=>kk(e.type.name,d))(g);if(b.depth>=1&&k&&b.depth-k.depth<=1){if(k.node.type===p)return u.liftListItem(m);if(kk(k.node.type.name,d)&&p.validContent(k.node.content)&&l)return c().command(()=>(o.setNodeMarkup(k.pos,p),!0)).command(()=>Ck(o,p)).command(()=>Tk(o,p)).run()}return n&&S&&l?c().command(()=>{const e=h().wrapInList(p,r),t=S.filter(e=>f.includes(e.type.name));return o.ensureMarks(t),!!e||u.clearNodes()}).wrapInList(p,r).command(()=>Ck(o,p)).command(()=>Tk(o,p)).run():c().command(()=>!!h().wrapInList(p,r)||u.clearNodes()).wrapInList(p,r).command(()=>Ck(o,p)).command(()=>Tk(o,p)).run()}},toggleMark:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=>{let{state:i,commands:s}=r;const{extendEmptyMarkRange:o=!1}=n,a=tk(e,i.schema);return Sk(i,a,t)?s.unsetMark(a,{extendEmptyMarkRange:o}):s.setMark(a,t)}},toggleNode:function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r=>{let{state:i,commands:s}=r;const o=xS(e,i.schema),a=xS(t,i.schema),l=hk(i,o,n);let c;return i.selection.$anchor.sameParent(i.selection.$head)&&(c=i.selection.$anchor.parent.attrs),l?s.setNode(a,c):s.setNode(o,{...c,...n})}},toggleWrap:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,commands:i}=n;const s=xS(e,r.schema);return hk(r,s,t)?i.lift(s):i.wrapIn(s,t)}},undoInputRule:()=>e=>{let{state:t,dispatch:n}=e;const r=t.plugins;for(let i=0;i<r.length;i+=1){const e=r[i];let s;if(e.spec.isInputRules&&(s=e.getState(t))){if(n){const e=t.tr,n=s.transform;for(let t=n.steps.length-1;t>=0;t-=1)e.step(n.steps[t].invert(n.docs[t]));if(s.text){const n=e.doc.resolve(s.from).marks();e.replaceWith(s.from,s.to,t.schema.text(s.text,n))}else e.delete(s.from,s.to)}return!0}}return!1},unsetAllMarks:()=>e=>{let{tr:t,dispatch:n}=e;const{selection:r}=t,{empty:i,ranges:s}=r;return i||n&&s.forEach(e=>{t.removeMark(e.$from.pos,e.$to.pos)}),!0},unsetMark:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:i,dispatch:s}=n;var o;const{extendEmptyMarkRange:a=!1}=t,{selection:l}=r,c=tk(e,i.schema),{$from:u,empty:h,ranges:d}=l;if(!s)return!0;if(h&&a){let{from:e,to:t}=l;const n=null===(o=u.marks().find(e=>e.type===c))||void 0===o?void 0:o.attrs,i=ek(u,c,n);i&&(e=i.from,t=i.to),r.removeMark(e,t,c)}else d.forEach(e=>{r.removeMark(e.$from.pos,e.$to.pos,c)});return r.removeStoredMark(c),!0}},updateAttributes:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{tr:r,state:i,dispatch:s}=n,o=null,a=null;const l=dk("string"===typeof e?e:e.name,i.schema);return!!l&&("node"===l&&(o=xS(e,i.schema)),"mark"===l&&(a=tk(e,i.schema)),s&&r.selection.ranges.forEach(e=>{const n=e.$from.pos,s=e.$to.pos;let l,c,u,h;r.selection.empty?i.doc.nodesBetween(n,s,(e,t)=>{o&&o===e.type&&(u=Math.max(t,n),h=Math.min(t+e.nodeSize,s),l=t,c=e)}):i.doc.nodesBetween(n,s,(e,i)=>{i<n&&o&&o===e.type&&(u=Math.max(i,n),h=Math.min(i+e.nodeSize,s),l=i,c=e),i>=n&&i<=s&&(o&&o===e.type&&r.setNodeMarkup(i,void 0,{...e.attrs,...t}),a&&e.marks.length&&e.marks.forEach(o=>{if(a===o.type){const l=Math.max(i,n),c=Math.min(i+e.nodeSize,s);r.addMark(l,c,a.create({...o.attrs,...t}))}}))}),c&&(void 0!==l&&r.setNodeMarkup(l,void 0,{...c.attrs,...t}),a&&c.marks.length&&c.marks.forEach(e=>{a===e.type&&r.addMark(u,h,a.create({...e.attrs,...t}))}))}),!0)}},wrapIn:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:i}=n;return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(n,r){let{$from:i,$to:s}=n.selection,o=i.blockRange(s),a=o&&Sg(o,e,t);return!!a&&(r&&r(n.tr.wrap(o,a).scrollIntoView()),!0)}}(xS(e,r.schema),t)(r,i)}},wrapInList:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n=>{let{state:r,dispatch:i}=n;return gS(xS(e,r.schema),t)(r,i)}}});const Ik=KS.create({name:"commands",addCommands:()=>({..._k})}),Ak=KS.create({name:"drop",addProseMirrorPlugins(){return[new hy({key:new py("tiptapDrop"),props:{handleDrop:(e,t,n,r)=>{this.editor.emit("drop",{editor:this.editor,event:t,slice:n,moved:r})}}})]}}),Nk=KS.create({name:"editable",addProseMirrorPlugins(){return[new hy({key:new py("editable"),props:{editable:()=>this.editor.options.editable}})]}}),Ok=new py("focusEvents"),Mk=KS.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:e}=this;return[new hy({key:Ok,props:{handleDOMEvents:{focus:(t,n)=>{e.isFocused=!0;const r=e.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1},blur:(t,n)=>{e.isFocused=!1;const r=e.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(r),!1}}}})]}}),Rk=KS.create({name:"keymap",addKeyboardShortcuts(){const e=()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.undoInputRule(),()=>t.command(e=>{let{tr:n}=e;const{selection:r,doc:i}=n,{empty:s,$anchor:o}=r,{pos:a,parent:l}=o,c=o.parent.isTextblock&&a>0?n.doc.resolve(a-1):o,u=c.parent.type.spec.isolating,h=o.pos-o.parentOffset,d=u&&1===c.parent.childCount?h===o.pos:Wg.atStart(i).from===a;return!(!s||!l.type.isTextblock||l.textContent.length||!d||d&&"paragraph"===o.parent.type.name)&&t.clearNodes()}),()=>t.deleteSelection(),()=>t.joinBackward(),()=>t.selectNodeBackward()]}),t=()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.deleteSelection(),()=>t.deleteCurrentNode(),()=>t.joinForward(),()=>t.selectNodeForward()]}),n={Enter:()=>this.editor.commands.first(e=>{let{commands:t}=e;return[()=>t.newlineInCode(),()=>t.createParagraphNear(),()=>t.liftEmptyBlock(),()=>t.splitBlock()]}),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:e,"Mod-Backspace":e,"Shift-Backspace":e,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},r={...n},i={...n,"Ctrl-h":e,"Alt-Backspace":e,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return ok()||uk()?i:r},addProseMirrorPlugins(){return[new hy({key:new py("clearDocument"),appendTransaction:(e,t,n)=>{if(e.some(e=>e.getMeta("composition")))return;const r=e.some(e=>e.docChanged)&&!t.doc.eq(n.doc),i=e.some(e=>e.getMeta("preventClearDocument"));if(!r||i)return;const{empty:s,from:o,to:a}=t.selection,l=Wg.atStart(t.doc).from,c=Wg.atEnd(t.doc).to;if(s||!(o===l&&a===c))return;if(!Ek(n.doc))return;const u=n.tr,h=vS({state:n,transaction:u}),{commands:d}=new wS({editor:this.editor,state:h});return d.clearNodes(),u.steps.length?u:void 0}})]}}),Dk=KS.create({name:"paste",addProseMirrorPlugins(){return[new hy({key:new py("tiptapPaste"),props:{handlePaste:(e,t,n)=>{this.editor.emit("paste",{editor:this.editor,event:t,slice:n})}}})]}}),Pk=KS.create({name:"tabindex",addProseMirrorPlugins(){return[new hy({key:new py("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Lk{get name(){return this.node.type.name}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.currentNode=null,this.actualDepth=null,this.isBlock=n,this.resolvedPos=e,this.editor=t,this.currentNode=r}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return null!==(e=this.actualDepth)&&void 0!==e?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,n=this.to;if(this.isBlock){if(0===this.content.size)return void console.error(`You can\u2019t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);t=this.from+1,n=this.to-1}this.editor.commands.insertContentAt({from:t,to:n},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(0===this.depth)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Lk(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Lk(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Lk(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,n)=>{const r=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,s=this.pos+n+(i?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const o=this.resolvedPos.doc.resolve(s);if(!r&&o.depth<=this.depth)return;const a=new Lk(o,this.editor,r,r?t:null);r&&(a.actualDepth=this.depth+1),e.push(new Lk(o,this.editor,r,r?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=null,r=this.parent;for(;r&&!n;){if(r.node.type.name===e)if(Object.keys(t).length>0){const e=r.node.attrs,n=Object.keys(t);for(let r=0;r<n.length;r+=1){const i=n[r];if(e[i]!==t[i])break}}else n=r;r=r.parent}return n}querySelector(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=[];if(!this.children||0===this.children.length)return r;const i=Object.keys(t);return this.children.forEach(s=>{if(!(n&&r.length>0)){if(s.node.type.name===e){i.every(e=>t[e]===s.node.attrs[e])&&r.push(s)}n&&r.length>0||(r=r.concat(s.querySelectorAll(e,t,n)))}}),r}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}class Fk extends bS{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:e=>{let{error:t}=e;throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",e=>{let{event:t,slice:n,moved:r}=e;return this.options.onDrop(t,n,r)}),this.on("paste",e=>{let{event:t,slice:n}=e;return this.options.onPaste(t,n)}),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function(e,t,n){const r=document.querySelector(`style[data-tiptap-style${n?`-${n}`:""}]`);if(null!==r)return r;const i=document.createElement("style");return t&&i.setAttribute("nonce",t),i.setAttribute("data-tiptap-style"+(n?`-${n}`:""),""),i.innerHTML=e,document.getElementsByTagName("head")[0].appendChild(i),i}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 0 !important;\n  height: 0 !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.options={...this.options,...e},this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const n=_S(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let n=t;if([].concat(e).forEach(e=>{const t="string"===typeof e?`${e}$`:e.key;n=n.filter(e=>!e.key.startsWith(t))}),t.length===n.length)return;const r=this.state.reconfigure({plugins:n});return this.view.updateState(r),r}createExtensionManager(){var e,t;const n=[...this.options.enableCoreExtensions?[Nk,QS.configure({blockSeparator:null===(t=null===(e=this.options.coreExtensionOptions)||void 0===e?void 0:e.clipboardTextSerializer)||void 0===t?void 0:t.blockSeparator}),Ik,Mk,Rk,Pk,Ak,Dk].filter(e=>"object"!==typeof this.options.enableCoreExtensions||!1!==this.options.enableCoreExtensions[e.name]):[],...this.options.extensions].filter(e=>["extension","node","mark"].includes(null===e||void 0===e?void 0:e.type));this.extensionManager=new WS(n,this)}createCommandManager(){this.commandManager=new wS({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=pk(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(i){if(!(i instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(i.message))throw i;this.emit("contentError",{editor:this,error:i,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(e=>"collaboration"!==e.name),this.createExtensionManager()}}),t=pk(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const n=ik(t,this.options.autofocus);this.view=new Cb(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...null===(e=this.options.editorProps)||void 0===e?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:cy.create({doc:t,selection:n||void 0})});const r=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(r),this.createNodeViews(),this.prependClass();this.view.dom.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction)return this.capturedTransaction?void e.steps.forEach(e=>{var t;return null===(t=this.capturedTransaction)||void 0===t?void 0:t.step(e)}):void(this.capturedTransaction=e);const t=this.state.apply(e),n=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),n&&this.emit("selectionUpdate",{editor:this,transaction:e});const r=e.getMeta("focus"),i=e.getMeta("blur");r&&this.emit("focus",{editor:this,event:r.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),e.docChanged&&!e.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return vk(this.state,e)}isActive(e,t){const n="string"===typeof e?e:null,r="string"===typeof e?t:e;return function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!t)return hk(e,null,n)||Sk(e,null,n);const r=dk(t,e.schema);return"node"===r?hk(e,t,n):"mark"===r&&Sk(e,t,n)}(this.state,n,r)}getJSON(){return this.state.doc.toJSON()}getHTML(){return DS(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t="\n\n",textSerializers:n={}}=e||{};return yk(this.state.doc,{blockSeparator:t,textSerializers:{...JS(this.schema),...n}})}get isEmpty(){return Ek(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(null===(e=this.view)||void 0===e?void 0:e.docView)}$node(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelector(e,t))||null}$nodes(e,t){var n;return(null===(n=this.$doc)||void 0===n?void 0:n.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new Lk(t,this)}get $doc(){return this.$pos(0)}}function jk(e){return new LS({find:e.find,handler:t=>{let{state:n,range:r,match:i}=t;const s=IS(e.getAttributes,void 0,i);if(!1===s||null===s)return null;const{tr:o}=n,a=i[i.length-1],l=i[0];if(a){const t=l.search(/\S/),i=r.from+l.indexOf(a),c=i+a.length;if(wk(r.from,r.to,n.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>i).length)return null;c<r.to&&o.delete(c,r.to),i>r.from&&o.delete(r.from+t,i);const u=r.from+t+a.length;o.addMark(r.from+t,u,e.type.create(s||{})),o.removeStoredMark(e.type)}}})}function Vk(e){return new LS({find:e.find,handler:t=>{let{state:n,range:r,match:i}=t;const s=n.doc.resolve(r.from),o=IS(e.getAttributes,void 0,i)||{};if(!s.node(-1).canReplaceWith(s.index(-1),s.indexAfter(-1),e.type))return null;n.tr.delete(r.from,r.to).setBlockType(r.from,r.from,e.type,o)}})}function zk(e){return new LS({find:e.find,handler:t=>{let{state:n,range:r,match:i,chain:s}=t;const o=IS(e.getAttributes,void 0,i)||{},a=n.tr.delete(r.from,r.to),l=a.doc.resolve(r.from).blockRange(),c=l&&Sg(l,e.type,o);if(!c)return null;if(a.wrap(l,c),e.keepMarks&&e.editor){const{selection:t,storedMarks:r}=n,{splittableMarks:i}=e.editor.extensionManager,s=r||t.$to.parentOffset&&t.$from.marks();if(s){const e=s.filter(e=>i.includes(e.type.name));a.ensureMarks(e)}}if(e.keepAttributes){const t="bulletList"===e.type.name||"orderedList"===e.type.name?"listItem":"taskList";s().updateAttributes(t,o).run()}const u=a.doc.resolve(r.from-1).nodeBefore;u&&u.type===e.type&&Tg(a.doc,r.from-1)&&(!e.joinPredicate||e.joinPredicate(i,u))&&a.join(r.from-1)}})}class Uk{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=IS(SS(this,"addOptions",{name:this.name}))),this.storage=IS(SS(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(){return new Uk(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}configure(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=this.extend({...this.config,addOptions:()=>zS(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=new Uk(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=IS(SS(t,"addOptions",{name:t.name})),t.storage=IS(SS(t,"addStorage",{name:t.name,options:t.options})),t}}function Bk(e){return new BS({find:e.find,handler:t=>{let{state:n,range:r,match:i,pasteEvent:s}=t;const o=IS(e.getAttributes,void 0,i,s);if(!1===o||null===o)return null;const{tr:a}=n,l=i[i.length-1],c=i[0];let u=r.to;if(l){const t=c.search(/\S/),i=r.from+c.indexOf(l),s=i+l.length;if(wk(r.from,r.to,n.doc).filter(t=>t.mark.type.excluded.find(n=>n===e.type&&n!==t.mark.type)).filter(e=>e.to>i).length)return null;s<r.to&&a.delete(s,r.to),i>r.from&&a.delete(r.from+t,i),u=r.from+t+l.length,a.addMark(r.from+t,u,e.type.create(o||{})),a.removeStoredMark(e.type)}}})}function $k(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var qk,Hk={exports:{}},Wk={};Hk.exports=function(){if(qk)return Wk;qk=1;var e=i,t="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},n=e.useState,r=e.useEffect,s=e.useLayoutEffect,o=e.useDebugValue;function a(e){var n=e.getSnapshot;e=e.value;try{var r=n();return!t(e,r)}catch(i){return!0}}var l="undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement?function(e,t){return t()}:function(e,t){var i=t(),l=n({inst:{value:i,getSnapshot:t}}),c=l[0].inst,u=l[1];return s(function(){c.value=i,c.getSnapshot=t,a(c)&&u({inst:c})},[e,i,t]),r(function(){return a(c)&&u({inst:c}),e(function(){a(c)&&u({inst:c})})},[e]),o(i),i};return Wk.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:l,Wk}();var Kk=Hk.exports;const Gk=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):t&&(t.current=e)})}},Jk=e=>{let{contentComponent:t}=e;const n=Kk.useSyncExternalStore(t.subscribe,t.getSnapshot,t.getServerSnapshot);return i.createElement(i.Fragment,null,Object.values(n))};class Qk extends i.Component{constructor(e){var t;super(e),this.editorContentRef=i.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:Boolean(null===(t=e.editor)||void 0===t?void 0:t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=function(){const e=new Set;let t={};return{subscribe:t=>(e.add(t),()=>{e.delete(t)}),getSnapshot:()=>t,getServerSnapshot:()=>t,setRenderer(n,r){t={...t,[n]:$p.createPortal(r.reactElement,r.element,n)},e.forEach(e=>e())},removeRenderer(n){const r={...t};delete r[n],t=r,e.forEach(e=>e())}}}(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(e=>e.hasContentComponentInitialized?e:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e)return;if(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild)return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:t,...n}=this.props;return i.createElement(i.Fragment,null,i.createElement("div",{ref:Gk(t,this.editorContentRef),...n}),(null===e||void 0===e?void 0:e.contentComponent)&&i.createElement(Jk,{contentComponent:e.contentComponent}))}}const Xk=(0,i.forwardRef)((e,t)=>{const n=i.useMemo(()=>Math.floor(4294967295*Math.random()).toString(),[e.editor]);return i.createElement(Qk,{key:n,innerRef:t,...e})}),Yk=i.memo(Xk);var Zk,eE=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,i,s;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(i=r;0!==i--;)if(!e(t[i],n[i]))return!1;return!0}if(t instanceof Map&&n instanceof Map){if(t.size!==n.size)return!1;for(i of t.entries())if(!n.has(i[0]))return!1;for(i of t.entries())if(!e(i[1],n.get(i[0])))return!1;return!0}if(t instanceof Set&&n instanceof Set){if(t.size!==n.size)return!1;for(i of t.entries())if(!n.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(n)){if((r=t.length)!=n.length)return!1;for(i=r;0!==i--;)if(t[i]!==n[i])return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(s=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(i=r;0!==i--;)if(!Object.prototype.hasOwnProperty.call(n,s[i]))return!1;for(i=r;0!==i--;){var o=s[i];if(("_owner"!==o||!t.$$typeof)&&!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n},tE=$k(eE),nE={exports:{}},rE={};nE.exports=function(){if(Zk)return rE;Zk=1;var e=i,t=Kk,n="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},r=t.useSyncExternalStore,s=e.useRef,o=e.useEffect,a=e.useMemo,l=e.useDebugValue;return rE.useSyncExternalStoreWithSelector=function(e,t,i,c,u){var h=s(null);if(null===h.current){var d={hasValue:!1,value:null};h.current=d}else d=h.current;h=a(function(){function e(e){if(!o){if(o=!0,r=e,e=c(e),void 0!==u&&d.hasValue){var t=d.value;if(u(t,e))return s=t}return s=e}if(t=s,n(r,e))return t;var i=c(e);return void 0!==u&&u(t,i)?t:(r=e,s=i)}var r,s,o=!1,a=void 0===i?null:i;return[function(){return e(t())},null===a?void 0:function(){return e(a())}]},[t,i,c,u]);var f=r(e,h[0],h[1]);return o(function(){d.hasValue=!0,d.value=f},[f]),l(f),f},rE}();var iE=nE.exports;const sE="undefined"!==typeof window?i.useLayoutEffect:i.useEffect;class oE{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber||(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber}),this.lastSnapshot}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const e=()=>{this.transactionNumber+=1,this.subscribers.forEach(e=>e())},t=this.editor;return t.on("transaction",e),()=>{t.off("transaction",e)}}}}const aE="undefined"===typeof window,lE=aE||Boolean("undefined"!==typeof window&&window.next);class cE{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(e=>e())}getInitialEditor(){return void 0===this.options.current.immediatelyRender?aE||lE?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){var e=this;const t={...this.options.current,onBeforeCreate:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onBeforeCreate)||void 0===n?void 0:n.call(t,...i)},onBlur:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onBlur)||void 0===n?void 0:n.call(t,...i)},onCreate:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onCreate)||void 0===n?void 0:n.call(t,...i)},onDestroy:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onDestroy)||void 0===n?void 0:n.call(t,...i)},onFocus:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onFocus)||void 0===n?void 0:n.call(t,...i)},onSelectionUpdate:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onSelectionUpdate)||void 0===n?void 0:n.call(t,...i)},onTransaction:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onTransaction)||void 0===n?void 0:n.call(t,...i)},onUpdate:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onUpdate)||void 0===n?void 0:n.call(t,...i)},onContentError:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onContentError)||void 0===n?void 0:n.call(t,...i)},onDrop:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onDrop)||void 0===n?void 0:n.call(t,...i)},onPaste:function(){for(var t,n,r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return null===(n=(t=e.options.current).onPaste)||void 0===n?void 0:n.call(t,...i)}};return new Fk(t)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(n=>!!["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(n)||("extensions"===n&&e.extensions&&t.extensions?e.extensions.length===t.extensions.length&&e.extensions.every((e,n)=>{var r;return e===(null===(r=t.extensions)||void 0===r?void 0:r[n])}):e[n]===t[n]))}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&0===e.length?cE.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(null===this.previousDeps)return void(this.previousDeps=e);const t=this.previousDeps.length===e.length&&this.previousDeps.every((t,n)=>t===e[n]);if(t)return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{this.isComponentMounted&&this.instanceId===e?t&&t.setOptions(this.options.current):t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function uE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n=(0,i.useRef)(e);n.current=e;const[r]=(0,i.useState)(()=>new cE(n)),s=Kk.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return(0,i.useDebugValue)(s),(0,i.useEffect)(r.onRender(t)),function(e){var t;const[n]=(0,i.useState)(()=>new oE(e.editor)),r=iE.useSyncExternalStoreWithSelector(n.subscribe,n.getSnapshot,n.getServerSnapshot,e.selector,null!==(t=e.equalityFn)&&void 0!==t?t:tE);sE(()=>n.watch(e.editor),[e.editor,n]),(0,i.useDebugValue)(r)}({editor:s,selector:t=>{let{transactionNumber:n}=t;return!1===e.shouldRerenderOnTransaction?null:e.immediatelyRender&&0===n?0:n+1}}),s}const hE=(0,i.createContext)({editor:null});hE.Consumer;const dE=(0,i.createContext)({onDragStart:void 0}),fE=()=>(0,i.useContext)(dE);i.forwardRef((e,t)=>{const{onDragStart:n}=fE(),r=e.as||"div";return i.createElement(r,{...e,ref:t,"data-node-view-wrapper":"",onDragStart:n,style:{whiteSpace:"normal",...e.style}})});function pE(e){return!("function"!==typeof e||!e.prototype||!e.prototype.isReactComponent)}function mE(e){return!("object"!==typeof e||!e.$$typeof||"Symbol(react.forward_ref)"!==e.$$typeof.toString()&&"react.forward_ref"!==e.$$typeof.description)}class gE{constructor(e,t){let{editor:n,props:r={},as:i="div",className:s=""}=t;this.ref=null,this.id=Math.floor(4294967295*Math.random()).toString(),this.component=e,this.editor=n,this.props=r,this.element=document.createElement(i),this.element.classList.add("react-renderer"),s&&this.element.classList.add(...s.split(" ")),this.editor.isInitialized?(0,$p.flushSync)(()=>{this.render()}):queueMicrotask(()=>{this.render()})}render(){var e;const t=this.component,n=this.props,r=this.editor,s=function(){try{if(i.version)return parseInt(i.version.split(".")[0],10)>=19}catch{}return!1}(),o=function(e){if(pE(e))return!0;if(mE(e))return!0;if(function(e){return!("object"!==typeof e||!e.$$typeof||"Symbol(react.memo)"!==e.$$typeof.toString()&&"react.memo"!==e.$$typeof.description)}(e)){const t=e.type;if(t)return pE(t)||mE(t)}return!1}(t),a={...n};!a.ref||s||o||delete a.ref,a.ref||!s&&!o||(a.ref=e=>{this.ref=e}),this.reactElement=i.createElement(t,{...a}),null===(e=null===r||void 0===r?void 0:r.contentComponent)||void 0===e||e.setRenderer(this.id,this)}updateProps(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.props={...this.props,...e},this.render()}destroy(){var e;const t=this.editor;null===(e=null===t||void 0===t?void 0:t.contentComponent)||void 0===e||e.removeRenderer(this.id)}updateAttributes(e){Object.keys(e).forEach(t=>{this.element.setAttribute(t,e[t])})}}const yE=/^\s*>\s$/,vE=Uk.create({name:"blockquote",addOptions:()=>({HTMLAttributes:{}}),content:"block+",group:"block",defining:!0,parseHTML:()=>[{tag:"blockquote"}],renderHTML(e){let{HTMLAttributes:t}=e;return["blockquote",CS(this.options.HTMLAttributes,t),0]},addCommands(){return{setBlockquote:()=>e=>{let{commands:t}=e;return t.wrapIn(this.name)},toggleBlockquote:()=>e=>{let{commands:t}=e;return t.toggleWrap(this.name)},unsetBlockquote:()=>e=>{let{commands:t}=e;return t.lift(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[zk({find:yE,type:this.type})]}}),wE=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,bE=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,SE=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,kE=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,EE=US.create({name:"bold",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!==e.style.fontWeight&&null},{style:"font-weight=400",clearMark:e=>e.type.name===this.name},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML(e){let{HTMLAttributes:t}=e;return["strong",CS(this.options.HTMLAttributes,t),0]},addCommands(){return{setBold:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleBold:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetBold:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[jk({find:wE,type:this.type}),jk({find:SE,type:this.type})]},addPasteRules(){return[Bk({find:bE,type:this.type}),Bk({find:kE,type:this.type})]}}),xE="textStyle",CE=/^\s*([-+*])\s$/,TE=Uk.create({name:"bulletList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML:()=>[{tag:"ul"}],renderHTML(e){let{HTMLAttributes:t}=e;return["ul",CS(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleBulletList:()=>e=>{let{commands:t,chain:n}=e;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(xE)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=zk({find:CE,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=zk({find:CE,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(xE),editor:this.editor})),[e]}}),_E=/(^|[^`])`([^`]+)`(?!`)/,IE=/(^|[^`])`([^`]+)`(?!`)/g,AE=US.create({name:"code",addOptions:()=>({HTMLAttributes:{}}),excludes:"_",code:!0,exitable:!0,parseHTML:()=>[{tag:"code"}],renderHTML(e){let{HTMLAttributes:t}=e;return["code",CS(this.options.HTMLAttributes,t),0]},addCommands(){return{setCode:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleCode:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetCode:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[jk({find:_E,type:this.type})]},addPasteRules(){return[Bk({find:IE,type:this.type})]}}),NE=/^```([a-z]+)?[\s\n]$/,OE=/^~~~([a-z]+)?[\s\n]$/,ME=Uk.create({name:"codeBlock",addOptions:()=>({languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}),content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:e=>{var t;const{languageClassPrefix:n}=this.options,r=[...(null===(t=e.firstElementChild)||void 0===t?void 0:t.classList)||[]].filter(e=>e.startsWith(n)).map(e=>e.replace(n,""))[0];return r||null},rendered:!1}}},parseHTML:()=>[{tag:"pre",preserveWhitespace:"full"}],renderHTML(e){let{node:t,HTMLAttributes:n}=e;return["pre",CS(this.options.HTMLAttributes,n),["code",{class:t.attrs.language?this.options.languageClassPrefix+t.attrs.language:null},0]]},addCommands(){return{setCodeBlock:e=>t=>{let{commands:n}=t;return n.setNode(this.name,e)},toggleCodeBlock:e=>t=>{let{commands:n}=t;return n.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:e,$anchor:t}=this.editor.state.selection,n=1===t.pos;return!(!e||t.parent.type.name!==this.name)&&(!(!n&&t.parent.textContent.length)&&this.editor.commands.clearNodes())},Enter:e=>{let{editor:t}=e;if(!this.options.exitOnTripleEnter)return!1;const{state:n}=t,{selection:r}=n,{$from:i,empty:s}=r;if(!s||i.parent.type!==this.type)return!1;const o=i.parentOffset===i.parent.nodeSize-2,a=i.parent.textContent.endsWith("\n\n");return!(!o||!a)&&t.chain().command(e=>{let{tr:t}=e;return t.delete(i.pos-2,i.pos),!0}).exitCode().run()},ArrowDown:e=>{let{editor:t}=e;if(!this.options.exitOnArrowDown)return!1;const{state:n}=t,{selection:r,doc:i}=n,{$from:s,empty:o}=r;if(!o||s.parent.type!==this.type)return!1;if(!(s.parentOffset===s.parent.nodeSize-2))return!1;const a=s.after();if(void 0===a)return!1;return i.nodeAt(a)?t.commands.command(e=>{let{tr:t}=e;return t.setSelection(Wg.near(i.resolve(a))),!0}):t.commands.exitCode()}}},addInputRules(){return[Vk({find:NE,type:this.type,getAttributes:e=>({language:e[1]})}),Vk({find:OE,type:this.type,getAttributes:e=>({language:e[1]})})]},addProseMirrorPlugins(){return[new hy({key:new py("codeBlockVSCodeHandler"),props:{handlePaste:(e,t)=>{if(!t.clipboardData)return!1;if(this.editor.isActive(this.type.name))return!1;const n=t.clipboardData.getData("text/plain"),r=t.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,s=null===i||void 0===i?void 0:i.mode;if(!n||!s)return!1;const{tr:o,schema:a}=e.state,l=a.text(n.replace(/\r\n?/g,"\n"));return o.replaceSelectionWith(this.type.create({language:s},l)),o.selection.$from.parent.type!==this.type&&o.setSelection(Qg.near(o.doc.resolve(Math.max(0,o.selection.from-2)))),o.setMeta("paste",!0),e.dispatch(o),!0}}})]}}),RE=Uk.create({name:"doc",topNode:!0,content:"block+"});function DE(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new hy({view:t=>new PE(t,e)})}class PE{constructor(e,t){var n;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=null!==(n=t.width)&&void 0!==n?n:1,this.color=!1===t.color?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(t=>{let n=e=>{this[t](e)};return e.dom.addEventListener(t,n),{name:t,handler:n}})}destroy(){this.handlers.forEach(e=>{let{name:t,handler:n}=e;return this.editorView.dom.removeEventListener(t,n)})}update(e,t){null!=this.cursorPos&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,null==e?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e,t=this.editorView.state.doc.resolve(this.cursorPos),n=!t.parent.inlineContent,r=this.editorView.dom,i=r.getBoundingClientRect(),s=i.width/r.offsetWidth,o=i.height/r.offsetHeight;if(n){let n=t.nodeBefore,r=t.nodeAfter;if(n||r){let t=this.editorView.nodeDOM(this.cursorPos-(n?n.nodeSize:0));if(t){let i=t.getBoundingClientRect(),s=n?i.bottom:i.top;n&&r&&(s=(s+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let a=this.width/2*o;e={left:i.left,right:i.right,top:s-a,bottom:s+a}}}}if(!e){let t=this.editorView.coordsAtPos(this.cursorPos),n=this.width/2*s;e={left:t.left-n,right:t.left+n,top:t.top,bottom:t.bottom}}let a,l,c=this.editorView.dom.offsetParent;if(this.element||(this.element=c.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",n),this.element.classList.toggle("prosemirror-dropcursor-inline",!n),!c||c==document.body&&"static"==getComputedStyle(c).position)a=-pageXOffset,l=-pageYOffset;else{let e=c.getBoundingClientRect(),t=e.width/c.offsetWidth,n=e.height/c.offsetHeight;a=e.left-c.scrollLeft*t,l=e.top-c.scrollTop*n}this.element.style.left=(e.left-a)/s+"px",this.element.style.top=(e.top-l)/o+"px",this.element.style.width=(e.right-e.left)/s+"px",this.element.style.height=(e.bottom-e.top)/o+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),n=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),r=n&&n.type.spec.disableDropCursor,i="function"==typeof r?r(this.editorView,t,e):r;if(t&&!i){let e=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let t=Ag(this.editorView.state.doc,e,this.editorView.dragging.slice);null!=t&&(e=t)}this.setCursor(e),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const LE=KS.create({name:"dropCursor",addOptions:()=>({color:"currentColor",width:1,class:void 0}),addProseMirrorPlugins(){return[DE(this.options)]}});class FE extends Wg{constructor(e){super(e,e)}map(e,t){let n=e.resolve(t.map(this.head));return FE.valid(n)?new FE(n):Wg.near(n)}content(){return em.empty}eq(e){return e instanceof FE&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if("number"!=typeof t.pos)throw new RangeError("Invalid input for GapCursor.fromJSON");return new FE(e.resolve(t.pos))}getBookmark(){return new jE(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!function(e){for(let t=e.depth;t>=0;t--){let n=e.index(t),r=e.node(t);if(0!=n)for(let e=r.child(n-1);;e=e.lastChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e)||!function(e){for(let t=e.depth;t>=0;t--){let n=e.indexAfter(t),r=e.node(t);if(n!=r.childCount)for(let e=r.child(n);;e=e.firstChild){if(0==e.childCount&&!e.inlineContent||e.isAtom||e.type.spec.isolating)return!0;if(e.inlineContent)return!1}else if(r.type.spec.isolating)return!0}return!0}(e))return!1;let n=t.type.spec.allowGapCursor;if(null!=n)return n;let r=t.contentMatchAt(e.index()).defaultType;return r&&r.isTextblock}static findGapCursorFrom(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e:for(;;){if(!n&&FE.valid(e))return e;let r=e.pos,i=null;for(let n=e.depth;;n--){let s=e.node(n);if(t>0?e.indexAfter(n)<s.childCount:e.index(n)>0){i=s.child(t>0?e.indexAfter(n):e.index(n)-1);break}if(0==n)return null;r+=t;let o=e.doc.resolve(r);if(FE.valid(o))return o}for(;;){let s=t>0?i.firstChild:i.lastChild;if(!s){if(i.isAtom&&!i.isText&&!Yg.isSelectable(i)){e=e.doc.resolve(r+i.nodeSize*t),n=!1;continue e}break}i=s,r+=t;let o=e.doc.resolve(r);if(FE.valid(o))return o}return null}}}FE.prototype.visible=!1,FE.findFrom=FE.findGapCursorFrom,Wg.jsonID("gapcursor",FE);class jE{constructor(e){this.pos=e}map(e){return new jE(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return FE.valid(t)?new FE(t):Wg.near(t)}}const VE=Ub({ArrowLeft:zE("horiz",-1),ArrowRight:zE("horiz",1),ArrowUp:zE("vert",-1),ArrowDown:zE("vert",1)});function zE(e,t){const n="vert"==e?t>0?"down":"up":t>0?"right":"left";return function(e,r,i){let s=e.selection,o=t>0?s.$to:s.$from,a=s.empty;if(s instanceof Qg){if(!i.endOfTextblock(n)||0==o.depth)return!1;a=!1,o=e.doc.resolve(t>0?o.after():o.before())}let l=FE.findGapCursorFrom(o,t,a);return!!l&&(r&&r(e.tr.setSelection(new FE(l))),!0)}}function UE(e,t,n){if(!e||!e.editable)return!1;let r=e.state.doc.resolve(t);if(!FE.valid(r))return!1;let i=e.posAtCoords({left:n.clientX,top:n.clientY});return!(i&&i.inside>-1&&Yg.isSelectable(e.state.doc.nodeAt(i.inside)))&&(e.dispatch(e.state.tr.setSelection(new FE(r))),!0)}function BE(e,t){if("insertCompositionText"!=t.inputType||!(e.state.selection instanceof FE))return!1;let{$from:n}=e.state.selection,r=n.parent.contentMatchAt(n.index()).findWrapping(e.state.schema.nodes.text);if(!r)return!1;let i=Gp.empty;for(let o=r.length-1;o>=0;o--)i=Gp.from(r[o].createAndFill(null,i));let s=e.state.tr.replace(n.pos,n.pos,new em(i,0,0));return s.setSelection(Qg.near(s.doc.resolve(n.pos+1))),e.dispatch(s),!1}function $E(e){if(!(e.selection instanceof FE))return null;let t=document.createElement("div");return t.className="ProseMirror-gapcursor",eb.create(e.doc,[Xw.widget(e.selection.head,t,{key:"gapcursor"})])}const qE=KS.create({name:"gapCursor",addProseMirrorPlugins:()=>[new hy({props:{decorations:$E,createSelectionBetween:(e,t,n)=>t.pos==n.pos&&FE.valid(n)?new FE(n):null,handleClick:UE,handleKeyDown:VE,handleDOMEvents:{beforeinput:BE}}})],extendNodeSchema(e){var t;return{allowGapCursor:null!==(t=IS(SS(e,"allowGapCursor",{name:e.name,options:e.options,storage:e.storage})))&&void 0!==t?t:null}}}),HE=Uk.create({name:"hardBreak",addOptions:()=>({keepMarks:!0,HTMLAttributes:{}}),inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML:()=>[{tag:"br"}],renderHTML(e){let{HTMLAttributes:t}=e;return["br",CS(this.options.HTMLAttributes,t)]},renderText:()=>"\n",addCommands(){return{setHardBreak:()=>e=>{let{commands:t,chain:n,state:r,editor:i}=e;return t.first([()=>t.exitCode(),()=>t.command(()=>{const{selection:e,storedMarks:t}=r;if(e.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:o}=i.extensionManager,a=t||e.$to.parentOffset&&e.$from.marks();return n().insertContent({type:this.name}).command(e=>{let{tr:t,dispatch:n}=e;if(n&&a&&s){const e=a.filter(e=>o.includes(e.type.name));t.ensureMarks(e)}return!0}).run()})])}}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),WE=Uk.create({name:"heading",addOptions:()=>({levels:[1,2,3,4,5,6],HTMLAttributes:{}}),content:"inline*",group:"block",defining:!0,addAttributes:()=>({level:{default:1,rendered:!1}}),parseHTML(){return this.options.levels.map(e=>({tag:`h${e}`,attrs:{level:e}}))},renderHTML(e){let{node:t,HTMLAttributes:n}=e;return[`h${this.options.levels.includes(t.attrs.level)?t.attrs.level:this.options.levels[0]}`,CS(this.options.HTMLAttributes,n),0]},addCommands(){return{setHeading:e=>t=>{let{commands:n}=t;return!!this.options.levels.includes(e.level)&&n.setNode(this.name,e)},toggleHeading:e=>t=>{let{commands:n}=t;return!!this.options.levels.includes(e.level)&&n.toggleNode(this.name,"paragraph",e)}}},addKeyboardShortcuts(){return this.options.levels.reduce((e,t)=>({...e,[`Mod-Alt-${t}`]:()=>this.editor.commands.toggleHeading({level:t})}),{})},addInputRules(){return this.options.levels.map(e=>Vk({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${e}})\\s$`),type:this.type,getAttributes:{level:e}}))}});var KE=200,GE=function(){};GE.prototype.append=function(e){return e.length?(e=GE.from(e),!this.length&&e||e.length<KE&&this.leafAppend(e)||this.length<KE&&e.leafPrepend(this)||this.appendInner(e)):this},GE.prototype.prepend=function(e){return e.length?GE.from(e).append(this):this},GE.prototype.appendInner=function(e){return new QE(this,e)},GE.prototype.slice=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=this.length),e>=t?GE.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))},GE.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)},GE.prototype.forEach=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length),t<=n?this.forEachInner(e,t,n,0):this.forEachInvertedInner(e,t,n,0)},GE.prototype.map=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=this.length);var r=[];return this.forEach(function(t,n){return r.push(e(t,n))},t,n),r},GE.from=function(e){return e instanceof GE?e:e&&e.length?new JE(e):GE.empty};var JE=function(e){function t(t){e.call(this),this.values=t}e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t;var n={length:{configurable:!0},depth:{configurable:!0}};return t.prototype.flatten=function(){return this.values},t.prototype.sliceInner=function(e,n){return 0==e&&n==this.length?this:new t(this.values.slice(e,n))},t.prototype.getInner=function(e){return this.values[e]},t.prototype.forEachInner=function(e,t,n,r){for(var i=t;i<n;i++)if(!1===e(this.values[i],r+i))return!1},t.prototype.forEachInvertedInner=function(e,t,n,r){for(var i=t-1;i>=n;i--)if(!1===e(this.values[i],r+i))return!1},t.prototype.leafAppend=function(e){if(this.length+e.length<=KE)return new t(this.values.concat(e.flatten()))},t.prototype.leafPrepend=function(e){if(this.length+e.length<=KE)return new t(e.flatten().concat(this.values))},n.length.get=function(){return this.values.length},n.depth.get=function(){return 0},Object.defineProperties(t.prototype,n),t}(GE);GE.empty=new JE([]);var QE=function(e){function t(t,n){e.call(this),this.left=t,this.right=n,this.length=t.length+n.length,this.depth=Math.max(t.depth,n.depth)+1}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},t.prototype.getInner=function(e){return e<this.left.length?this.left.get(e):this.right.get(e-this.left.length)},t.prototype.forEachInner=function(e,t,n,r){var i=this.left.length;return!(t<i&&!1===this.left.forEachInner(e,t,Math.min(n,i),r))&&(!(n>i&&!1===this.right.forEachInner(e,Math.max(t-i,0),Math.min(this.length,n)-i,r+i))&&void 0)},t.prototype.forEachInvertedInner=function(e,t,n,r){var i=this.left.length;return!(t>i&&!1===this.right.forEachInvertedInner(e,t-i,Math.max(n,i)-i,r+i))&&(!(n<i&&!1===this.left.forEachInvertedInner(e,Math.min(t,i),n,r))&&void 0)},t.prototype.sliceInner=function(e,t){if(0==e&&t==this.length)return this;var n=this.left.length;return t<=n?this.left.slice(e,t):e>=n?this.right.slice(e-n,t-n):this.left.slice(e,n).append(this.right.slice(0,t-n))},t.prototype.leafAppend=function(e){var n=this.right.leafAppend(e);if(n)return new t(this.left,n)},t.prototype.leafPrepend=function(e){var n=this.left.leafPrepend(e);if(n)return new t(n,this.right)},t.prototype.appendInner=function(e){return this.left.depth>=Math.max(this.right.depth,e.depth)+1?new t(this.left,new t(this.right,e)):new t(this,e)},t}(GE);const XE=GE;class YE{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(0==this.eventCount)return null;let n,r,i=this.items.length;for(;;i--){if(this.items.get(i-1).selection){--i;break}}t&&(n=this.remapping(i,this.items.length),r=n.maps.length);let s,o,a=e.tr,l=[],c=[];return this.items.forEach((e,t)=>{if(!e.step)return n||(n=this.remapping(i,t+1),r=n.maps.length),r--,void c.push(e);if(n){c.push(new ZE(e.map));let t,i=e.step.map(n.slice(r));i&&a.maybeStep(i).doc&&(t=a.mapping.maps[a.mapping.maps.length-1],l.push(new ZE(t,void 0,void 0,l.length+c.length))),r--,t&&n.appendMap(t,r)}else a.maybeStep(e.step);return e.selection?(s=n?e.selection.map(n.slice(r)):e.selection,o=new YE(this.items.slice(0,i).append(c.reverse().concat(l)),this.eventCount-1),!1):void 0},this.items.length,0),{remaining:o,transform:a,selection:s}}addTransform(e,t,n,r){let i=[],s=this.eventCount,o=this.items,a=!r&&o.length?o.get(o.length-1):null;for(let c=0;c<e.steps.length;c++){let n,l=e.steps[c].invert(e.docs[c]),u=new ZE(e.mapping.maps[c],l,t);(n=a&&a.merge(u))&&(u=n,c?i.pop():o=o.slice(0,o.length-1)),i.push(u),t&&(s++,t=void 0),r||(a=u)}let l=s-n.depth;return l>tx&&(o=function(e,t){let n;return e.forEach((e,r)=>{if(e.selection&&0==t--)return n=r,!1}),e.slice(n)}(o,l),s-=l),new YE(o.append(i),s)}remapping(e,t){let n=new og;return this.items.forEach((t,r)=>{let i=null!=t.mirrorOffset&&r-t.mirrorOffset>=e?n.maps.length-t.mirrorOffset:void 0;n.appendMap(t.map,i)},e,t),n}addMaps(e){return 0==this.eventCount?this:new YE(this.items.append(e.map(e=>new ZE(e))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let n=[],r=Math.max(0,this.items.length-t),i=e.mapping,s=e.steps.length,o=this.eventCount;this.items.forEach(e=>{e.selection&&o--},r);let a=t;this.items.forEach(t=>{let r=i.getMirror(--a);if(null==r)return;s=Math.min(s,r);let l=i.maps[r];if(t.step){let s=e.steps[r].invert(e.docs[r]),c=t.selection&&t.selection.map(i.slice(a+1,r));c&&o++,n.push(new ZE(l,s,c))}else n.push(new ZE(l))},r);let l=[];for(let h=t;h<s;h++)l.push(new ZE(i.maps[h]));let c=this.items.slice(0,r).append(l).append(n),u=new YE(c,o);return u.emptyItemCount()>500&&(u=u.compress(this.items.length-n.length)),u}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,t=this.remapping(0,e),n=t.maps.length,r=[],i=0;return this.items.forEach((s,o)=>{if(o>=e)r.push(s),s.selection&&i++;else if(s.step){let e=s.step.map(t.slice(n)),o=e&&e.getMap();if(n--,o&&t.appendMap(o,n),e){let a=s.selection&&s.selection.map(t.slice(n));a&&i++;let l,c=new ZE(o.invert(),e,a),u=r.length-1;(l=r.length&&r[u].merge(c))?r[u]=l:r.push(c)}}else s.map&&n--},this.items.length,0),new YE(XE.from(r.reverse()),i)}}YE.empty=new YE(XE.empty,0);class ZE{constructor(e,t,n,r){this.map=e,this.step=t,this.selection=n,this.mirrorOffset=r}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new ZE(t.getMap().invert(),t,this.selection)}}}class ex{constructor(e,t,n,r,i){this.done=e,this.undone=t,this.prevRanges=n,this.prevTime=r,this.prevComposition=i}}const tx=20;function nx(e){let t=[];for(let n=e.length-1;n>=0&&0==t.length;n--)e[n].forEach((e,n,r,i)=>t.push(r,i));return t}function rx(e,t){if(!e)return null;let n=[];for(let r=0;r<e.length;r+=2){let i=t.map(e[r],1),s=t.map(e[r+1],-1);i<=s&&n.push(i,s)}return n}let ix=!1,sx=null;function ox(e){let t=e.plugins;if(sx!=t){ix=!1,sx=t;for(let e=0;e<t.length;e++)if(t[e].spec.historyPreserveItems){ix=!0;break}}return ix}const ax=new py("history"),lx=new py("closeHistory");function cx(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e={depth:e.depth||100,newGroupDelay:e.newGroupDelay||500},new hy({key:ax,state:{init:()=>new ex(YE.empty,YE.empty,null,0,-1),apply:(t,n,r)=>function(e,t,n,r){let i,s=n.getMeta(ax);if(s)return s.historyState;n.getMeta(lx)&&(e=new ex(e.done,e.undone,null,0,-1));let o=n.getMeta("appendedTransaction");if(0==n.steps.length)return e;if(o&&o.getMeta(ax))return o.getMeta(ax).redo?new ex(e.done.addTransform(n,void 0,r,ox(t)),e.undone,nx(n.mapping.maps),e.prevTime,e.prevComposition):new ex(e.done,e.undone.addTransform(n,void 0,r,ox(t)),null,e.prevTime,e.prevComposition);if(!1===n.getMeta("addToHistory")||o&&!1===o.getMeta("addToHistory"))return(i=n.getMeta("rebased"))?new ex(e.done.rebased(n,i),e.undone.rebased(n,i),rx(e.prevRanges,n.mapping),e.prevTime,e.prevComposition):new ex(e.done.addMaps(n.mapping.maps),e.undone.addMaps(n.mapping.maps),rx(e.prevRanges,n.mapping),e.prevTime,e.prevComposition);{let i=n.getMeta("composition"),s=0==e.prevTime||!o&&e.prevComposition!=i&&(e.prevTime<(n.time||0)-r.newGroupDelay||!function(e,t){if(!t)return!1;if(!e.docChanged)return!0;let n=!1;return e.mapping.maps[0].forEach((e,r)=>{for(let i=0;i<t.length;i+=2)e<=t[i+1]&&r>=t[i]&&(n=!0)}),n}(n,e.prevRanges)),a=o?rx(e.prevRanges,n.mapping):nx(n.mapping.maps);return new ex(e.done.addTransform(n,s?t.selection.getBookmark():void 0,r,ox(t)),YE.empty,a,n.time,null==i?e.prevComposition:i)}}(n,r,t,e)},config:e,props:{handleDOMEvents:{beforeinput(e,t){let n=t.inputType,r="historyUndo"==n?hx:"historyRedo"==n?dx:null;return!!r&&(t.preventDefault(),r(e.state,e.dispatch))}}}})}function ux(e,t){return(n,r)=>{let i=ax.getState(n);if(!i||0==(e?i.undone:i.done).eventCount)return!1;if(r){let s=function(e,t,n){let r=ox(t),i=ax.get(t).spec.config,s=(n?e.undone:e.done).popEvent(t,r);if(!s)return null;let o=s.selection.resolve(s.transform.doc),a=(n?e.done:e.undone).addTransform(s.transform,t.selection.getBookmark(),i,r),l=new ex(n?a:s.remaining,n?s.remaining:a,null,0,-1);return s.transform.setSelection(o).setMeta(ax,{redo:n,historyState:l})}(i,n,e);s&&r(t?s.scrollIntoView():s)}return!0}}const hx=ux(!1,!0),dx=ux(!0,!0);ux(!1,!1),ux(!0,!1);const fx=KS.create({name:"history",addOptions:()=>({depth:100,newGroupDelay:500}),addCommands:()=>({undo:()=>e=>{let{state:t,dispatch:n}=e;return hx(t,n)},redo:()=>e=>{let{state:t,dispatch:n}=e;return dx(t,n)}}),addProseMirrorPlugins(){return[cx(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-\u044f":()=>this.editor.commands.undo(),"Shift-Mod-\u044f":()=>this.editor.commands.redo()}}}),px=Uk.create({name:"horizontalRule",addOptions:()=>({HTMLAttributes:{}}),group:"block",parseHTML:()=>[{tag:"hr"}],renderHTML(e){let{HTMLAttributes:t}=e;return["hr",CS(this.options.HTMLAttributes,t)]},addCommands(){return{setHorizontalRule:()=>e=>{let{chain:t,state:n}=e;if(!function(e,t){const{selection:n}=e,{$from:r}=n;if(n instanceof Yg){const e=r.index();return r.parent.canReplaceWith(e,e+1,t)}let i=r.depth;for(;i>=0;){const e=r.index(i);if(r.node(i).contentMatchAt(e).matchType(t))return!0;i-=1}return!1}(n,n.schema.nodes[this.name]))return!1;const{selection:r}=n,{$from:i,$to:s}=r,o=t();return 0===i.parentOffset?o.insertContentAt({from:Math.max(i.pos-1,0),to:s.pos},{type:this.name}):r instanceof Yg?o.insertContentAt(s.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(e=>{let{tr:t,dispatch:n}=e;var r;if(n){const{$to:e}=t.selection,n=e.end();if(e.nodeAfter)e.nodeAfter.isTextblock?t.setSelection(Qg.create(t.doc,e.pos+1)):e.nodeAfter.isBlock?t.setSelection(Yg.create(t.doc,e.pos)):t.setSelection(Qg.create(t.doc,e.pos));else{const i=null===(r=e.parent.type.contentMatch.defaultType)||void 0===r?void 0:r.create();i&&(t.insert(n,i),t.setSelection(Qg.create(t.doc,n+1)))}t.scrollIntoView()}return!0}).run()}}},addInputRules(){return[(e={find:/^(?:---|\u2014-|___\s|\*\*\*\s)$/,type:this.type},new LS({find:e.find,handler:t=>{let{state:n,range:r,match:i}=t;const s=IS(e.getAttributes,void 0,i)||{},{tr:o}=n,a=r.from;let l=r.to;const c=e.type.create(s);if(i[1]){let e=a+i[0].lastIndexOf(i[1]);e>l?e=l:l=e+i[1].length;const t=i[0][i[0].length-1];o.insertText(t,a+i[0].length-1),o.replaceWith(e,l,c)}else if(i[0]){const t=e.type.isInline?a:a-1;o.insert(t,e.type.create(s)).delete(o.mapping.map(a),o.mapping.map(l))}o.scrollIntoView()}}))];var e}}),mx=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,gx=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,yx=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,vx=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,wx=US.create({name:"italic",addOptions:()=>({HTMLAttributes:{}}),parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>"normal"!==e.style.fontStyle&&null},{style:"font-style=normal",clearMark:e=>e.type.name===this.name},{style:"font-style=italic"}]},renderHTML(e){let{HTMLAttributes:t}=e;return["em",CS(this.options.HTMLAttributes,t),0]},addCommands(){return{setItalic:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleItalic:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetItalic:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[jk({find:mx,type:this.type}),jk({find:yx,type:this.type})]},addPasteRules(){return[Bk({find:gx,type:this.type}),Bk({find:vx,type:this.type})]}}),bx=Uk.create({name:"listItem",addOptions:()=>({HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}),content:"paragraph block*",defining:!0,parseHTML:()=>[{tag:"li"}],renderHTML(e){let{HTMLAttributes:t}=e;return["li",CS(this.options.HTMLAttributes,t),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Sx="textStyle",kx=/^(\d+)\.\s$/,Ex=Uk.create({name:"orderedList",addOptions:()=>({itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}),group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes:()=>({start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1},type:{default:null,parseHTML:e=>e.getAttribute("type")}}),parseHTML:()=>[{tag:"ol"}],renderHTML(e){let{HTMLAttributes:t}=e;const{start:n,...r}=t;return 1===n?["ol",CS(this.options.HTMLAttributes,r),0]:["ol",CS(this.options.HTMLAttributes,t),0]},addCommands(){return{toggleOrderedList:()=>e=>{let{commands:t,chain:n}=e;return this.options.keepAttributes?n().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes("listItem",this.editor.getAttributes(Sx)).run():t.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=zk({find:kx,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=zk({find:kx,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(Sx)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[e]}}),xx=Uk.create({name:"paragraph",priority:1e3,addOptions:()=>({HTMLAttributes:{}}),group:"block",content:"inline*",parseHTML:()=>[{tag:"p"}],renderHTML(e){let{HTMLAttributes:t}=e;return["p",CS(this.options.HTMLAttributes,t),0]},addCommands(){return{setParagraph:()=>e=>{let{commands:t}=e;return t.setNode(this.name)}}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),Cx=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,Tx=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,_x=US.create({name:"strike",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("line-through")&&{}}],renderHTML(e){let{HTMLAttributes:t}=e;return["s",CS(this.options.HTMLAttributes,t),0]},addCommands(){return{setStrike:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleStrike:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetStrike:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[jk({find:Cx,type:this.type})]},addPasteRules(){return[Bk({find:Tx,type:this.type})]}}),Ix=Uk.create({name:"text",group:"inline"}),Ax=KS.create({name:"starterKit",addExtensions(){const e=[];return!1!==this.options.bold&&e.push(EE.configure(this.options.bold)),!1!==this.options.blockquote&&e.push(vE.configure(this.options.blockquote)),!1!==this.options.bulletList&&e.push(TE.configure(this.options.bulletList)),!1!==this.options.code&&e.push(AE.configure(this.options.code)),!1!==this.options.codeBlock&&e.push(ME.configure(this.options.codeBlock)),!1!==this.options.document&&e.push(RE.configure(this.options.document)),!1!==this.options.dropcursor&&e.push(LE.configure(this.options.dropcursor)),!1!==this.options.gapcursor&&e.push(qE.configure(this.options.gapcursor)),!1!==this.options.hardBreak&&e.push(HE.configure(this.options.hardBreak)),!1!==this.options.heading&&e.push(WE.configure(this.options.heading)),!1!==this.options.history&&e.push(fx.configure(this.options.history)),!1!==this.options.horizontalRule&&e.push(px.configure(this.options.horizontalRule)),!1!==this.options.italic&&e.push(wx.configure(this.options.italic)),!1!==this.options.listItem&&e.push(bx.configure(this.options.listItem)),!1!==this.options.orderedList&&e.push(Ex.configure(this.options.orderedList)),!1!==this.options.paragraph&&e.push(xx.configure(this.options.paragraph)),!1!==this.options.strike&&e.push(_x.configure(this.options.strike)),!1!==this.options.text&&e.push(Ix.configure(this.options.text)),e}}),Nx=US.create({name:"underline",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>!!e.includes("underline")&&{}}],renderHTML(e){let{HTMLAttributes:t}=e;return["u",CS(this.options.HTMLAttributes,t),0]},addCommands(){return{setUnderline:()=>e=>{let{commands:t}=e;return t.setMark(this.name)},toggleUnderline:()=>e=>{let{commands:t}=e;return t.toggleMark(this.name)},unsetUnderline:()=>e=>{let{commands:t}=e;return t.unsetMark(this.name)}}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}});var Ox={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};var Mx=(e,t)=>{const n=(0,i.forwardRef)((n,r)=>{let{color:s="currentColor",size:o=24,strokeWidth:a=2,absoluteStrokeWidth:l,children:c,...u}=n;return(0,i.createElement)("svg",{ref:r,...Ox,width:o,height:o,stroke:s,strokeWidth:l?24*Number(a)/Number(o):a,className:`lucide lucide-${h=e,h.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,...u},[...t.map(e=>{let[t,n]=e;return(0,i.createElement)(t,n)}),...(Array.isArray(c)?c:[c])||[]]);var h});return n.displayName=`${e}`,n};const Rx=Mx("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]),Dx=Mx("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]),Px=Mx("Underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]),Lx=Mx("Strikethrough",[["path",{d:"M16 4H9a3 3 0 0 0-2.83 4",key:"43sutm"}],["path",{d:"M14 12a4 4 0 0 1 0 8H6",key:"nlfj13"}],["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}]]),Fx=Mx("Heading1",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"m17 12 3-2v8",key:"1hhhft"}]]),jx=Mx("Heading2",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M21 18h-4c0-4 4-3 4-6 0-1.5-2-2.5-4-1",key:"9jr5yi"}]]),Vx=Mx("Heading3",[["path",{d:"M4 12h8",key:"17cfdx"}],["path",{d:"M4 18V6",key:"1rz3zl"}],["path",{d:"M12 18V6",key:"zqpxq5"}],["path",{d:"M17.5 10.5c1.7-1 3.5 0 3.5 1.5a2 2 0 0 1-2 2",key:"68ncm8"}],["path",{d:"M17 17.5c2 1.5 4 .3 4-1.5a2 2 0 0 0-2-2",key:"1ejuhz"}]]),zx=Mx("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]),Ux=Mx("AlignCenter",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"17",x2:"7",y1:"12",y2:"12",key:"rsh8ii"}],["line",{x1:"19",x2:"5",y1:"18",y2:"18",key:"1t0tuv"}]]),Bx=Mx("AlignRight",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}],["line",{x1:"21",x2:"7",y1:"18",y2:"18",key:"1g9eri"}]]),$x=Mx("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]),qx=Mx("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]),Hx=Mx("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),Wx=Mx("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]),Kx=Mx("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]),Gx=Mx("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]),Jx=[{name:"Arial",displayName:"Arial"},{name:"Calibri",displayName:"Calibri"},{name:"Helvetica",displayName:"Helvetica"},{name:"Lato",displayName:"Lato"},{name:"PT Sans",displayName:"PT Sans"},{name:"PT Serif",displayName:"PT Serif"},{name:"Baskerville",displayName:"Baskerville"}],Qx=[{name:"SimSun",displayName:"\u5b8b\u4f53"},{name:"Songti SC",displayName:"\u5b8b\u4f53-\u7b80"},{name:"STHeiti",displayName:"\u534e\u6587\u9ed1\u4f53"}];function Xx(){return`#set text(font: ((name: "${arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Arial"}", covers: "latin-in-cjk"), "${arguments.length>1&&void 0!==arguments[1]?arguments[1]:"SimSun"}"))`}const Yx=e=>{let{content:t,onFontChange:n}=e;const[r,s]=(0,i.useState)(!1),[o,a]=(0,i.useState)({latinFont:"Arial",cjkFont:"Source Han Serif SC"}),l=Jx,c=Qx;(0,i.useEffect)(()=>{const e=function(e){const t=e.match(/#set\s+text\s*\(\s*font:\s*\(\s*\(\s*name:\s*"([^"]+)"\s*,\s*covers:\s*"[^"]*"\s*\)\s*,\s*"([^"]+)"\s*\)\s*\)/);return t?{latinFont:t[1],cjkFont:t[2]}:{latinFont:"Arial",cjkFont:"SimSun"}}(t);a(e)},[t]);return(0,Fp.jsxs)("div",{className:"font-selector",children:[(0,Fp.jsx)("button",{onClick:()=>{s(!r)},className:"toolbar-button "+(r?"is-active":""),title:"\u5b57\u4f53\u9009\u62e9\u5668",children:(0,Fp.jsx)(Gx,{size:16})}),r&&(0,Fp.jsxs)("div",{className:"font-selector-dropdown",children:[(0,Fp.jsxs)("div",{className:"font-selector-section",children:[(0,Fp.jsx)("label",{className:"font-selector-label",children:"\u897f\u6587\u5b57\u4f53:"}),(0,Fp.jsx)("select",{value:o.latinFont,onChange:e=>(e=>{const t={...o,latinFont:e};a(t),n(t.latinFont,t.cjkFont)})(e.target.value),className:"font-selector-select",children:l.map(e=>(0,Fp.jsx)("option",{value:e.name,children:e.displayName},e.name))})]}),(0,Fp.jsxs)("div",{className:"font-selector-section",children:[(0,Fp.jsx)("label",{className:"font-selector-label",children:"\u4e2d\u6587\u5b57\u4f53:"}),(0,Fp.jsx)("select",{value:o.cjkFont,onChange:e=>(e=>{const t={...o,cjkFont:e};a(t),n(t.latinFont,t.cjkFont)})(e.target.value),className:"font-selector-select",children:c.map(e=>(0,Fp.jsx)("option",{value:e.name,children:e.displayName},e.name))})]}),(0,Fp.jsxs)("div",{className:"font-selector-preview",children:[(0,Fp.jsx)("div",{className:"font-preview-text",style:{fontFamily:o.latinFont},children:"ABC 123 Hello"}),(0,Fp.jsx)("div",{className:"font-preview-text",style:{fontFamily:o.cjkFont},children:"\u4f60\u597d\u4e16\u754c \u6d4b\u8bd5\u6587\u5b57"})]})]}),r&&(0,Fp.jsx)("div",{className:"font-selector-overlay",onClick:()=>s(!1)})]})},Zx=e=>{let{editor:t,content:n,onFontChange:r}=e;if(!t)return null;const i=e=>{let{onClick:t,isActive:n,children:r,title:i}=e;return(0,Fp.jsx)("button",{onClick:t,className:"toolbar-button "+(n?"is-active":""),title:i,children:r})},s=()=>(0,Fp.jsx)("div",{className:"toolbar-separator"});return(0,Fp.jsxs)("div",{className:"editor-toolbar",children:[(0,Fp.jsx)(Yx,{content:n,onFontChange:r}),(0,Fp.jsx)(s,{}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().toggleBold().run(),isActive:t.isActive("bold"),title:"\u7c97\u4f53 (Ctrl+B)",children:(0,Fp.jsx)(Rx,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().toggleItalic().run(),isActive:t.isActive("italic"),title:"\u659c\u4f53 (Ctrl+I)",children:(0,Fp.jsx)(Dx,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().toggleUnderline().run(),isActive:t.isActive("underline"),title:"\u4e0b\u5212\u7ebf (Ctrl+U)",children:(0,Fp.jsx)(Px,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().toggleStrike().run(),isActive:t.isActive("strike"),title:"\u5220\u9664\u7ebf",children:(0,Fp.jsx)(Lx,{size:16})}),(0,Fp.jsx)(s,{}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().toggleHeading({level:1}).run(),isActive:t.isActive("heading",{level:1}),title:"\u4e00\u7ea7\u6807\u9898",children:(0,Fp.jsx)(Fx,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().toggleHeading({level:2}).run(),isActive:t.isActive("heading",{level:2}),title:"\u4e8c\u7ea7\u6807\u9898",children:(0,Fp.jsx)(jx,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().toggleHeading({level:3}).run(),isActive:t.isActive("heading",{level:3}),title:"\u4e09\u7ea7\u6807\u9898",children:(0,Fp.jsx)(Vx,{size:16})}),(0,Fp.jsx)(s,{}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().setTextAlign("left").run(),isActive:t.isActive({textAlign:"left"})||!t.isActive({textAlign:"center"})&&!t.isActive({textAlign:"right"}),title:"\u5de6\u5bf9\u9f50 (Ctrl+Shift+L)",children:(0,Fp.jsx)(zx,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().setTextAlign("center").run(),isActive:t.isActive({textAlign:"center"}),title:"\u5c45\u4e2d\u5bf9\u9f50 (Ctrl+Shift+E)",children:(0,Fp.jsx)(Ux,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().setTextAlign("right").run(),isActive:t.isActive({textAlign:"right"}),title:"\u53f3\u5bf9\u9f50 (Ctrl+Shift+R)",children:(0,Fp.jsx)(Bx,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().insertFlexSpace().run(),isActive:!1,title:"\u5f39\u6027\u7a7a\u95f4 #h(1fr) (Ctrl+Shift+Space)",children:(0,Fp.jsx)($x,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>{const e=prompt("\u8bf7\u8f93\u5165\u5782\u76f4\u7a7a\u95f4\u5927\u5c0f\uff0c\u4f8b\u5982\uff1a1em, 2pt, 1fr","1em");if(e&&e.trim()){const n=e.trim();if(!/^-?\d+(\.\d+)?(em|pt|fr)$/.test(n))return void alert("\u8bf7\u8f93\u5165\u6709\u6548\u683c\u5f0f\uff0c\u4f8b\u5982\uff1a1em, -2pt, 1fr");t.chain().focus().insertVerticalSpace({spacing:n}).run()}},isActive:!1,title:"\u5782\u76f4\u7a7a\u95f4 #v() (Ctrl+Shift+Enter)",children:(0,Fp.jsx)(qx,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().insertLine().run(),isActive:!1,title:"\u5206\u9694\u7ebf #line(length: 100%) (Ctrl+Shift+-)",children:(0,Fp.jsx)(Hx,{size:16})}),(0,Fp.jsx)(s,{}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().toggleBulletList().run(),isActive:t.isActive("bulletList"),title:"\u65e0\u5e8f\u5217\u8868",children:(0,Fp.jsx)(Wx,{size:16})}),(0,Fp.jsx)(i,{onClick:()=>t.chain().focus().toggleOrderedList().run(),isActive:t.isActive("orderedList"),title:"\u6709\u5e8f\u5217\u8868",children:(0,Fp.jsx)(Kx,{size:16})})]})},eC=KS.create({name:"textAlign",addOptions:()=>({types:["heading","paragraph"],alignments:["left","center","right"],defaultAlignment:"left"}),addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>{const t=e.style.textAlign||this.options.defaultAlignment;return this.options.alignments.includes(t)?t:this.options.defaultAlignment},renderHTML:e=>e.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${e.textAlign}`}}}}]},addCommands(){return{setTextAlign:e=>t=>{let{commands:n}=t;return!!this.options.alignments.includes(e)&&this.options.types.every(t=>n.updateAttributes(t,{textAlign:e}))},unsetTextAlign:()=>e=>{let{commands:t}=e;return this.options.types.every(e=>t.resetAttributes(e,"textAlign"))}}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right")}}}),tC=eC,nC=Uk.create({name:"flexSpace",group:"inline",inline:!0,atom:!0,addAttributes:()=>({"data-typst":{default:"#h(1fr)"}}),parseHTML:()=>[{tag:'span[class="typst-flex-space"]'}],renderHTML(e){let{HTMLAttributes:t}=e;return["span",{class:"typst-flex-space","data-typst":"#h(1fr)",...t},"\u2194"]},addCommands(){return{insertFlexSpace:()=>e=>{let{commands:t}=e;return t.insertContent({type:this.name,attrs:{"data-typst":"#h(1fr)"}})}}},addKeyboardShortcuts(){return{"Mod-Shift-Space":()=>this.editor.commands.insertFlexSpace()}}}),rC=nC,iC=Uk.create({name:"line",group:"block",atom:!0,addAttributes:()=>({"data-typst":{default:"#line(length: 100%)"}}),parseHTML:()=>[{tag:'hr[class="typst-line"]'}],renderHTML(e){let{HTMLAttributes:t}=e;return["hr",{class:"typst-line","data-typst":"#line(length: 100%)",...t}]},addCommands(){return{insertLine:()=>e=>{let{commands:t}=e;return t.insertContent({type:this.name})}}},addKeyboardShortcuts(){return{"Mod-Shift-Minus":()=>this.editor.commands.insertLine()}}}),sC=iC,oC=Uk.create({name:"verticalSpace",group:"block",atom:!0,addAttributes:()=>({"data-typst":{default:"#v(1em)"},spacing:{default:"1em"}}),parseHTML:()=>[{tag:'div[class="typst-vertical-space"]'}],renderHTML(e){let{HTMLAttributes:t}=e;const n=t.spacing||"1em";return["div",{class:"typst-vertical-space","data-typst":`#v(${n})`,style:`height: ${n.includes("fr")?"20px":n}; display: block; border-top: 1px dashed #ccc; position: relative;`,...t},["span",{style:"position: absolute; left: 50%; top: -10px; transform: translateX(-50%); background: white; padding: 0 5px; color: #888; font-size: 12px;"},`\u2195 ${n}`]]},addCommands(){var e=this;return{insertVerticalSpace:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n=>{let{commands:r}=n;const{spacing:i="1em"}=t;return r.insertContent({type:e.name,attrs:{"data-typst":`#v(${i})`,spacing:i}})}}}},addKeyboardShortcuts(){return{"Mod-Shift-Enter":()=>{const e=prompt("\u8bf7\u8f93\u5165\u5782\u76f4\u7a7a\u95f4\u5927\u5c0f\uff0c\u4f8b\u5982\uff1a1em, 2pt, 1fr","1em");if(e&&e.trim()){const t=e.trim();return/^-?\d+(\.\d+)?(em|pt|fr)$/.test(t)?this.editor.commands.insertVerticalSpace({spacing:t}):(alert("\u8bf7\u8f93\u5165\u6709\u6548\u683c\u5f0f\uff0c\u4f8b\u5982\uff1a1em, -2pt, 1fr"),!1)}return!1}}}}),aC=oC;function lC(e){var t;const{char:n,allowSpaces:r,allowToIncludeChar:i,allowedPrefixes:s,startOfLine:o,$position:a}=e,l=r&&!i,c=n.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&");const u=new RegExp(`\\s${c}$`),h=o?"^":"",d=i?"":c,f=l?new RegExp(`${h}${c}.*?(?=\\s${d}|$)`,"gm"):new RegExp(`${h}(?:^)?${c}[^\\s${d}]*`,"gm"),p=(null===(t=a.nodeBefore)||void 0===t?void 0:t.isText)&&a.nodeBefore.text;if(!p)return null;const m=a.pos-p.length,g=Array.from(p.matchAll(f)).pop();if(!g||void 0===g.input||void 0===g.index)return null;const y=g.input.slice(Math.max(0,g.index-1),g.index),v=new RegExp(`^[${null===s||void 0===s?void 0:s.join("")}\0]?$`).test(y);if(null!==s&&!v)return null;const w=m+g.index;let b=w+g[0].length;return l&&u.test(p.slice(b-1,b+1))&&(g[0]+=" ",b+=1),w<a.pos&&b>=a.pos?{range:{from:w,to:b},query:g[0].slice(n.length),text:g[0]}:null}const cC=new py("suggestion");function uC(e){let t,{pluginKey:n=cC,editor:r,char:i="@",allowSpaces:s=!1,allowToIncludeChar:o=!1,allowedPrefixes:a=[" "],startOfLine:l=!1,decorationTag:c="span",decorationClass:u="suggestion",decorationContent:h="",decorationEmptyClass:d="is-empty",command:f=()=>null,items:p=()=>[],render:m=()=>({}),allow:g=()=>!0,findSuggestionMatch:y=lC}=e;const v=null===m||void 0===m?void 0:m(),w=new hy({key:n,view(){return{update:async(e,n)=>{var i,s,o,a,l,c,u;const h=null===(i=this.key)||void 0===i?void 0:i.getState(n),d=null===(s=this.key)||void 0===s?void 0:s.getState(e.state),m=h.active&&d.active&&h.range.from!==d.range.from,g=!h.active&&d.active,y=h.active&&!d.active,w=!g&&!y&&h.query!==d.query,b=g||m&&w,S=w||m,k=y||m&&w;if(!b&&!S&&!k)return;const E=k&&!b?h:d,x=e.dom.querySelector(`[data-decoration-id="${E.decorationId}"]`);t={editor:r,range:E.range,query:E.query,text:E.text,items:[],command:e=>f({editor:r,range:E.range,props:e}),decorationNode:x,clientRect:x?()=>{var t;const{decorationId:n}=null===(t=this.key)||void 0===t?void 0:t.getState(r.state),i=e.dom.querySelector(`[data-decoration-id="${n}"]`);return(null===i||void 0===i?void 0:i.getBoundingClientRect())||null}:null},b&&(null===(o=null===v||void 0===v?void 0:v.onBeforeStart)||void 0===o||o.call(v,t)),S&&(null===(a=null===v||void 0===v?void 0:v.onBeforeUpdate)||void 0===a||a.call(v,t)),(S||b)&&(t.items=await p({editor:r,query:E.query})),k&&(null===(l=null===v||void 0===v?void 0:v.onExit)||void 0===l||l.call(v,t)),S&&(null===(c=null===v||void 0===v?void 0:v.onUpdate)||void 0===c||c.call(v,t)),b&&(null===(u=null===v||void 0===v?void 0:v.onStart)||void 0===u||u.call(v,t))},destroy:()=>{var e;t&&(null===(e=null===v||void 0===v?void 0:v.onExit)||void 0===e||e.call(v,t))}}},state:{init:()=>({active:!1,range:{from:0,to:0},query:null,text:null,composing:!1}),apply(e,t,n,c){const{isEditable:u}=r,{composing:h}=r.view,{selection:d}=e,{empty:f,from:p}=d,m={...t};if(m.composing=h,u&&(f||r.view.composing)){!(p<t.range.from||p>t.range.to)||h||t.composing||(m.active=!1);const e=y({char:i,allowSpaces:s,allowToIncludeChar:o,allowedPrefixes:a,startOfLine:l,$position:d.$from}),n=`id_${Math.floor(4294967295*Math.random())}`;e&&g({editor:r,state:c,range:e.range,isActive:t.active})?(m.active=!0,m.decorationId=t.decorationId?t.decorationId:n,m.range=e.range,m.query=e.query,m.text=e.text):m.active=!1}else m.active=!1;return m.active||(m.decorationId=null,m.range={from:0,to:0},m.query=null,m.text=null),m}},props:{handleKeyDown(e,t){var n;const{active:r,range:i}=w.getState(e.state);return r&&(null===(n=null===v||void 0===v?void 0:v.onKeyDown)||void 0===n?void 0:n.call(v,{view:e,event:t,range:i}))||!1},decorations(e){const{active:t,range:n,decorationId:r,query:i}=w.getState(e);if(!t)return null;const s=!(null===i||void 0===i?void 0:i.length),o=[u];return s&&o.push(d),eb.create(e.doc,[Xw.inline(n.from,n.to,{nodeName:c,class:o.join(" "),"data-decoration-id":r,"data-decoration-content":h})])}}});return w}function hC(e){if(null==e)return window;if("[object Window]"!==e.toString()){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function dC(e){return e instanceof hC(e).Element||e instanceof Element}function fC(e){return e instanceof hC(e).HTMLElement||e instanceof HTMLElement}function pC(e){return"undefined"!==typeof ShadowRoot&&(e instanceof hC(e).ShadowRoot||e instanceof ShadowRoot)}var mC=Math.max,gC=Math.min,yC=Math.round;function vC(){var e=navigator.userAgentData;return null!=e&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function wC(){return!/^((?!chrome|android).)*safari/i.test(vC())}function bC(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var r=e.getBoundingClientRect(),i=1,s=1;t&&fC(e)&&(i=e.offsetWidth>0&&yC(r.width)/e.offsetWidth||1,s=e.offsetHeight>0&&yC(r.height)/e.offsetHeight||1);var o=(dC(e)?hC(e):window).visualViewport,a=!wC()&&n,l=(r.left+(a&&o?o.offsetLeft:0))/i,c=(r.top+(a&&o?o.offsetTop:0))/s,u=r.width/i,h=r.height/s;return{width:u,height:h,top:c,right:l+u,bottom:c+h,left:l,x:l,y:c}}function SC(e){var t=hC(e);return{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function kC(e){return e?(e.nodeName||"").toLowerCase():null}function EC(e){return((dC(e)?e.ownerDocument:e.document)||window.document).documentElement}function xC(e){return bC(EC(e)).left+SC(e).scrollLeft}function CC(e){return hC(e).getComputedStyle(e)}function TC(e){var t=CC(e),n=t.overflow,r=t.overflowX,i=t.overflowY;return/auto|scroll|overlay|hidden/.test(n+i+r)}function _C(e,t,n){void 0===n&&(n=!1);var r=fC(t),i=fC(t)&&function(e){var t=e.getBoundingClientRect(),n=yC(t.width)/e.offsetWidth||1,r=yC(t.height)/e.offsetHeight||1;return 1!==n||1!==r}(t),s=EC(t),o=bC(e,i,n),a={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(r||!r&&!n)&&(("body"!==kC(t)||TC(s))&&(a=function(e){return e!==hC(e)&&fC(e)?{scrollLeft:(t=e).scrollLeft,scrollTop:t.scrollTop}:SC(e);var t}(t)),fC(t)?((l=bC(t,!0)).x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=xC(s))),{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}function IC(e){var t=bC(e),n=e.offsetWidth,r=e.offsetHeight;return Math.abs(t.width-n)<=1&&(n=t.width),Math.abs(t.height-r)<=1&&(r=t.height),{x:e.offsetLeft,y:e.offsetTop,width:n,height:r}}function AC(e){return"html"===kC(e)?e:e.assignedSlot||e.parentNode||(pC(e)?e.host:null)||EC(e)}function NC(e){return["html","body","#document"].indexOf(kC(e))>=0?e.ownerDocument.body:fC(e)&&TC(e)?e:NC(AC(e))}function OC(e,t){var n;void 0===t&&(t=[]);var r=NC(e),i=r===(null==(n=e.ownerDocument)?void 0:n.body),s=hC(r),o=i?[s].concat(s.visualViewport||[],TC(r)?r:[]):r,a=t.concat(o);return i?a:a.concat(OC(AC(o)))}function MC(e){return["table","td","th"].indexOf(kC(e))>=0}function RC(e){return fC(e)&&"fixed"!==CC(e).position?e.offsetParent:null}function DC(e){for(var t=hC(e),n=RC(e);n&&MC(n)&&"static"===CC(n).position;)n=RC(n);return n&&("html"===kC(n)||"body"===kC(n)&&"static"===CC(n).position)?t:n||function(e){var t=/firefox/i.test(vC());if(/Trident/i.test(vC())&&fC(e)&&"fixed"===CC(e).position)return null;var n=AC(e);for(pC(n)&&(n=n.host);fC(n)&&["html","body"].indexOf(kC(n))<0;){var r=CC(n);if("none"!==r.transform||"none"!==r.perspective||"paint"===r.contain||-1!==["transform","perspective"].indexOf(r.willChange)||t&&"filter"===r.willChange||t&&r.filter&&"none"!==r.filter)return n;n=n.parentNode}return null}(e)||t}var PC="top",LC="bottom",FC="right",jC="left",VC="auto",zC=[PC,LC,FC,jC],UC="start",BC="end",$C="viewport",qC="popper",HC=zC.reduce(function(e,t){return e.concat([t+"-"+UC,t+"-"+BC])},[]),WC=[].concat(zC,[VC]).reduce(function(e,t){return e.concat([t,t+"-"+UC,t+"-"+BC])},[]),KC=["beforeRead","read","afterRead","beforeMain","main","afterMain","beforeWrite","write","afterWrite"];function GC(e){var t=new Map,n=new Set,r=[];function i(e){n.add(e.name),[].concat(e.requires||[],e.requiresIfExists||[]).forEach(function(e){if(!n.has(e)){var r=t.get(e);r&&i(r)}}),r.push(e)}return e.forEach(function(e){t.set(e.name,e)}),e.forEach(function(e){n.has(e.name)||i(e)}),r}function JC(e){var t;return function(){return t||(t=new Promise(function(n){Promise.resolve().then(function(){t=void 0,n(e())})})),t}}var QC={placement:"bottom",modifiers:[],strategy:"absolute"};function XC(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return!t.some(function(e){return!(e&&"function"===typeof e.getBoundingClientRect)})}function YC(e){void 0===e&&(e={});var t=e,n=t.defaultModifiers,r=void 0===n?[]:n,i=t.defaultOptions,s=void 0===i?QC:i;return function(e,t,n){void 0===n&&(n=s);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},QC,s),modifiersData:{},elements:{reference:e,popper:t},attributes:{},styles:{}},o=[],a=!1,l={state:i,setOptions:function(n){var a="function"===typeof n?n(i.options):n;c(),i.options=Object.assign({},s,i.options,a),i.scrollParents={reference:dC(e)?OC(e):e.contextElement?OC(e.contextElement):[],popper:OC(t)};var u=function(e){var t=GC(e);return KC.reduce(function(e,n){return e.concat(t.filter(function(e){return e.phase===n}))},[])}(function(e){var t=e.reduce(function(e,t){var n=e[t.name];return e[t.name]=n?Object.assign({},n,t,{options:Object.assign({},n.options,t.options),data:Object.assign({},n.data,t.data)}):t,e},{});return Object.keys(t).map(function(e){return t[e]})}([].concat(r,i.options.modifiers)));return i.orderedModifiers=u.filter(function(e){return e.enabled}),i.orderedModifiers.forEach(function(e){var t=e.name,n=e.options,r=void 0===n?{}:n,s=e.effect;if("function"===typeof s){var a=s({state:i,name:t,instance:l,options:r}),c=function(){};o.push(a||c)}}),l.update()},forceUpdate:function(){if(!a){var e=i.elements,t=e.reference,n=e.popper;if(XC(t,n)){i.rects={reference:_C(t,DC(n),"fixed"===i.options.strategy),popper:IC(n)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach(function(e){return i.modifiersData[e.name]=Object.assign({},e.data)});for(var r=0;r<i.orderedModifiers.length;r++)if(!0!==i.reset){var s=i.orderedModifiers[r],o=s.fn,c=s.options,u=void 0===c?{}:c,h=s.name;"function"===typeof o&&(i=o({state:i,options:u,name:h,instance:l})||i)}else i.reset=!1,r=-1}}},update:JC(function(){return new Promise(function(e){l.forceUpdate(),e(i)})}),destroy:function(){c(),a=!0}};if(!XC(e,t))return l;function c(){o.forEach(function(e){return e()}),o=[]}return l.setOptions(n).then(function(e){!a&&n.onFirstUpdate&&n.onFirstUpdate(e)}),l}}var ZC={passive:!0};function eT(e){return e.split("-")[0]}function tT(e){return e.split("-")[1]}function nT(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function rT(e){var t,n=e.reference,r=e.element,i=e.placement,s=i?eT(i):null,o=i?tT(i):null,a=n.x+n.width/2-r.width/2,l=n.y+n.height/2-r.height/2;switch(s){case PC:t={x:a,y:n.y-r.height};break;case LC:t={x:a,y:n.y+n.height};break;case FC:t={x:n.x+n.width,y:l};break;case jC:t={x:n.x-r.width,y:l};break;default:t={x:n.x,y:n.y}}var c=s?nT(s):null;if(null!=c){var u="y"===c?"height":"width";switch(o){case UC:t[c]=t[c]-(n[u]/2-r[u]/2);break;case BC:t[c]=t[c]+(n[u]/2-r[u]/2)}}return t}var iT={top:"auto",right:"auto",bottom:"auto",left:"auto"};function sT(e){var t,n=e.popper,r=e.popperRect,i=e.placement,s=e.variation,o=e.offsets,a=e.position,l=e.gpuAcceleration,c=e.adaptive,u=e.roundOffsets,h=e.isFixed,d=o.x,f=void 0===d?0:d,p=o.y,m=void 0===p?0:p,g="function"===typeof u?u({x:f,y:m}):{x:f,y:m};f=g.x,m=g.y;var y=o.hasOwnProperty("x"),v=o.hasOwnProperty("y"),w=jC,b=PC,S=window;if(c){var k=DC(n),E="clientHeight",x="clientWidth";if(k===hC(n)&&"static"!==CC(k=EC(n)).position&&"absolute"===a&&(E="scrollHeight",x="scrollWidth"),i===PC||(i===jC||i===FC)&&s===BC)b=LC,m-=(h&&k===S&&S.visualViewport?S.visualViewport.height:k[E])-r.height,m*=l?1:-1;if(i===jC||(i===PC||i===LC)&&s===BC)w=FC,f-=(h&&k===S&&S.visualViewport?S.visualViewport.width:k[x])-r.width,f*=l?1:-1}var C,T=Object.assign({position:a},c&&iT),_=!0===u?function(e,t){var n=e.x,r=e.y,i=t.devicePixelRatio||1;return{x:yC(n*i)/i||0,y:yC(r*i)/i||0}}({x:f,y:m},hC(n)):{x:f,y:m};return f=_.x,m=_.y,l?Object.assign({},T,((C={})[b]=v?"0":"",C[w]=y?"0":"",C.transform=(S.devicePixelRatio||1)<=1?"translate("+f+"px, "+m+"px)":"translate3d("+f+"px, "+m+"px, 0)",C)):Object.assign({},T,((t={})[b]=v?m+"px":"",t[w]=y?f+"px":"",t.transform="",t))}const oT={name:"applyStyles",enabled:!0,phase:"write",fn:function(e){var t=e.state;Object.keys(t.elements).forEach(function(e){var n=t.styles[e]||{},r=t.attributes[e]||{},i=t.elements[e];fC(i)&&kC(i)&&(Object.assign(i.style,n),Object.keys(r).forEach(function(e){var t=r[e];!1===t?i.removeAttribute(e):i.setAttribute(e,!0===t?"":t)}))})},effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow),function(){Object.keys(t.elements).forEach(function(e){var r=t.elements[e],i=t.attributes[e]||{},s=Object.keys(t.styles.hasOwnProperty(e)?t.styles[e]:n[e]).reduce(function(e,t){return e[t]="",e},{});fC(r)&&kC(r)&&(Object.assign(r.style,s),Object.keys(i).forEach(function(e){r.removeAttribute(e)}))})}},requires:["computeStyles"]};const aT={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.offset,s=void 0===i?[0,0]:i,o=WC.reduce(function(e,n){return e[n]=function(e,t,n){var r=eT(e),i=[jC,PC].indexOf(r)>=0?-1:1,s="function"===typeof n?n(Object.assign({},t,{placement:e})):n,o=s[0],a=s[1];return o=o||0,a=(a||0)*i,[jC,FC].indexOf(r)>=0?{x:a,y:o}:{x:o,y:a}}(n,t.rects,s),e},{}),a=o[t.placement],l=a.x,c=a.y;null!=t.modifiersData.popperOffsets&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[r]=o}};var lT={left:"right",right:"left",bottom:"top",top:"bottom"};function cT(e){return e.replace(/left|right|bottom|top/g,function(e){return lT[e]})}var uT={start:"end",end:"start"};function hT(e){return e.replace(/start|end/g,function(e){return uT[e]})}function dT(e,t){var n=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(n&&pC(n)){var r=t;do{if(r&&e.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function fT(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function pT(e,t,n){return t===$C?fT(function(e,t){var n=hC(e),r=EC(e),i=n.visualViewport,s=r.clientWidth,o=r.clientHeight,a=0,l=0;if(i){s=i.width,o=i.height;var c=wC();(c||!c&&"fixed"===t)&&(a=i.offsetLeft,l=i.offsetTop)}return{width:s,height:o,x:a+xC(e),y:l}}(e,n)):dC(t)?function(e,t){var n=bC(e,!1,"fixed"===t);return n.top=n.top+e.clientTop,n.left=n.left+e.clientLeft,n.bottom=n.top+e.clientHeight,n.right=n.left+e.clientWidth,n.width=e.clientWidth,n.height=e.clientHeight,n.x=n.left,n.y=n.top,n}(t,n):fT(function(e){var t,n=EC(e),r=SC(e),i=null==(t=e.ownerDocument)?void 0:t.body,s=mC(n.scrollWidth,n.clientWidth,i?i.scrollWidth:0,i?i.clientWidth:0),o=mC(n.scrollHeight,n.clientHeight,i?i.scrollHeight:0,i?i.clientHeight:0),a=-r.scrollLeft+xC(e),l=-r.scrollTop;return"rtl"===CC(i||n).direction&&(a+=mC(n.clientWidth,i?i.clientWidth:0)-s),{width:s,height:o,x:a,y:l}}(EC(e)))}function mT(e,t,n,r){var i="clippingParents"===t?function(e){var t=OC(AC(e)),n=["absolute","fixed"].indexOf(CC(e).position)>=0&&fC(e)?DC(e):e;return dC(n)?t.filter(function(e){return dC(e)&&dT(e,n)&&"body"!==kC(e)}):[]}(e):[].concat(t),s=[].concat(i,[n]),o=s[0],a=s.reduce(function(t,n){var i=pT(e,n,r);return t.top=mC(i.top,t.top),t.right=gC(i.right,t.right),t.bottom=gC(i.bottom,t.bottom),t.left=mC(i.left,t.left),t},pT(e,o,r));return a.width=a.right-a.left,a.height=a.bottom-a.top,a.x=a.left,a.y=a.top,a}function gT(e){return Object.assign({},{top:0,right:0,bottom:0,left:0},e)}function yT(e,t){return t.reduce(function(t,n){return t[n]=e,t},{})}function vT(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=void 0===r?e.placement:r,s=n.strategy,o=void 0===s?e.strategy:s,a=n.boundary,l=void 0===a?"clippingParents":a,c=n.rootBoundary,u=void 0===c?$C:c,h=n.elementContext,d=void 0===h?qC:h,f=n.altBoundary,p=void 0!==f&&f,m=n.padding,g=void 0===m?0:m,y=gT("number"!==typeof g?g:yT(g,zC)),v=d===qC?"reference":qC,w=e.rects.popper,b=e.elements[p?v:d],S=mT(dC(b)?b:b.contextElement||EC(e.elements.popper),l,u,o),k=bC(e.elements.reference),E=rT({reference:k,element:w,strategy:"absolute",placement:i}),x=fT(Object.assign({},w,E)),C=d===qC?x:k,T={top:S.top-C.top+y.top,bottom:C.bottom-S.bottom+y.bottom,left:S.left-C.left+y.left,right:C.right-S.right+y.right},_=e.modifiersData.offset;if(d===qC&&_){var I=_[i];Object.keys(T).forEach(function(e){var t=[FC,LC].indexOf(e)>=0?1:-1,n=[PC,LC].indexOf(e)>=0?"y":"x";T[e]+=I[n]*t})}return T}const wT={name:"flip",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name;if(!t.modifiersData[r]._skip){for(var i=n.mainAxis,s=void 0===i||i,o=n.altAxis,a=void 0===o||o,l=n.fallbackPlacements,c=n.padding,u=n.boundary,h=n.rootBoundary,d=n.altBoundary,f=n.flipVariations,p=void 0===f||f,m=n.allowedAutoPlacements,g=t.options.placement,y=eT(g),v=l||(y===g||!p?[cT(g)]:function(e){if(eT(e)===VC)return[];var t=cT(e);return[hT(e),t,hT(t)]}(g)),w=[g].concat(v).reduce(function(e,n){return e.concat(eT(n)===VC?function(e,t){void 0===t&&(t={});var n=t,r=n.placement,i=n.boundary,s=n.rootBoundary,o=n.padding,a=n.flipVariations,l=n.allowedAutoPlacements,c=void 0===l?WC:l,u=tT(r),h=u?a?HC:HC.filter(function(e){return tT(e)===u}):zC,d=h.filter(function(e){return c.indexOf(e)>=0});0===d.length&&(d=h);var f=d.reduce(function(t,n){return t[n]=vT(e,{placement:n,boundary:i,rootBoundary:s,padding:o})[eT(n)],t},{});return Object.keys(f).sort(function(e,t){return f[e]-f[t]})}(t,{placement:n,boundary:u,rootBoundary:h,padding:c,flipVariations:p,allowedAutoPlacements:m}):n)},[]),b=t.rects.reference,S=t.rects.popper,k=new Map,E=!0,x=w[0],C=0;C<w.length;C++){var T=w[C],_=eT(T),I=tT(T)===UC,A=[PC,LC].indexOf(_)>=0,N=A?"width":"height",O=vT(t,{placement:T,boundary:u,rootBoundary:h,altBoundary:d,padding:c}),M=A?I?FC:jC:I?LC:PC;b[N]>S[N]&&(M=cT(M));var R=cT(M),D=[];if(s&&D.push(O[_]<=0),a&&D.push(O[M]<=0,O[R]<=0),D.every(function(e){return e})){x=T,E=!1;break}k.set(T,D)}if(E)for(var P=function(e){var t=w.find(function(t){var n=k.get(t);if(n)return n.slice(0,e).every(function(e){return e})});if(t)return x=t,"break"},L=p?3:1;L>0;L--){if("break"===P(L))break}t.placement!==x&&(t.modifiersData[r]._skip=!0,t.placement=x,t.reset=!0)}},requiresIfExists:["offset"],data:{_skip:!1}};function bT(e,t,n){return mC(e,gC(t,n))}const ST={name:"preventOverflow",enabled:!0,phase:"main",fn:function(e){var t=e.state,n=e.options,r=e.name,i=n.mainAxis,s=void 0===i||i,o=n.altAxis,a=void 0!==o&&o,l=n.boundary,c=n.rootBoundary,u=n.altBoundary,h=n.padding,d=n.tether,f=void 0===d||d,p=n.tetherOffset,m=void 0===p?0:p,g=vT(t,{boundary:l,rootBoundary:c,padding:h,altBoundary:u}),y=eT(t.placement),v=tT(t.placement),w=!v,b=nT(y),S="x"===b?"y":"x",k=t.modifiersData.popperOffsets,E=t.rects.reference,x=t.rects.popper,C="function"===typeof m?m(Object.assign({},t.rects,{placement:t.placement})):m,T="number"===typeof C?{mainAxis:C,altAxis:C}:Object.assign({mainAxis:0,altAxis:0},C),_=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,I={x:0,y:0};if(k){if(s){var A,N="y"===b?PC:jC,O="y"===b?LC:FC,M="y"===b?"height":"width",R=k[b],D=R+g[N],P=R-g[O],L=f?-x[M]/2:0,F=v===UC?E[M]:x[M],j=v===UC?-x[M]:-E[M],V=t.elements.arrow,z=f&&V?IC(V):{width:0,height:0},U=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:{top:0,right:0,bottom:0,left:0},B=U[N],$=U[O],q=bT(0,E[M],z[M]),H=w?E[M]/2-L-q-B-T.mainAxis:F-q-B-T.mainAxis,W=w?-E[M]/2+L+q+$+T.mainAxis:j+q+$+T.mainAxis,K=t.elements.arrow&&DC(t.elements.arrow),G=K?"y"===b?K.clientTop||0:K.clientLeft||0:0,J=null!=(A=null==_?void 0:_[b])?A:0,Q=R+W-J,X=bT(f?gC(D,R+H-J-G):D,R,f?mC(P,Q):P);k[b]=X,I[b]=X-R}if(a){var Y,Z="x"===b?PC:jC,ee="x"===b?LC:FC,te=k[S],ne="y"===S?"height":"width",re=te+g[Z],ie=te-g[ee],se=-1!==[PC,jC].indexOf(y),oe=null!=(Y=null==_?void 0:_[S])?Y:0,ae=se?re:te-E[ne]-x[ne]-oe+T.altAxis,le=se?te+E[ne]+x[ne]-oe-T.altAxis:ie,ce=f&&se?function(e,t,n){var r=bT(e,t,n);return r>n?n:r}(ae,te,le):bT(f?ae:re,te,f?le:ie);k[S]=ce,I[S]=ce-te}t.modifiersData[r]=I}},requiresIfExists:["offset"]};const kT={name:"arrow",enabled:!0,phase:"main",fn:function(e){var t,n=e.state,r=e.name,i=e.options,s=n.elements.arrow,o=n.modifiersData.popperOffsets,a=eT(n.placement),l=nT(a),c=[jC,FC].indexOf(a)>=0?"height":"width";if(s&&o){var u=function(e,t){return gT("number"!==typeof(e="function"===typeof e?e(Object.assign({},t.rects,{placement:t.placement})):e)?e:yT(e,zC))}(i.padding,n),h=IC(s),d="y"===l?PC:jC,f="y"===l?LC:FC,p=n.rects.reference[c]+n.rects.reference[l]-o[l]-n.rects.popper[c],m=o[l]-n.rects.reference[l],g=DC(s),y=g?"y"===l?g.clientHeight||0:g.clientWidth||0:0,v=p/2-m/2,w=u[d],b=y-h[c]-u[f],S=y/2-h[c]/2+v,k=bT(w,S,b),E=l;n.modifiersData[r]=((t={})[E]=k,t.centerOffset=k-S,t)}},effect:function(e){var t=e.state,n=e.options.element,r=void 0===n?"[data-popper-arrow]":n;null!=r&&("string"!==typeof r||(r=t.elements.popper.querySelector(r)))&&dT(t.elements.popper,r)&&(t.elements.arrow=r)},requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function ET(e,t,n){return void 0===n&&(n={x:0,y:0}),{top:e.top-t.height-n.y,right:e.right-t.width+n.x,bottom:e.bottom-t.height+n.y,left:e.left-t.width-n.x}}function xT(e){return[PC,FC,LC,jC].some(function(t){return e[t]>=0})}var CT=YC({defaultModifiers:[{name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:function(e){var t=e.state,n=e.instance,r=e.options,i=r.scroll,s=void 0===i||i,o=r.resize,a=void 0===o||o,l=hC(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach(function(e){e.addEventListener("scroll",n.update,ZC)}),a&&l.addEventListener("resize",n.update,ZC),function(){s&&c.forEach(function(e){e.removeEventListener("scroll",n.update,ZC)}),a&&l.removeEventListener("resize",n.update,ZC)}},data:{}},{name:"popperOffsets",enabled:!0,phase:"read",fn:function(e){var t=e.state,n=e.name;t.modifiersData[n]=rT({reference:t.rects.reference,element:t.rects.popper,strategy:"absolute",placement:t.placement})},data:{}},{name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:function(e){var t=e.state,n=e.options,r=n.gpuAcceleration,i=void 0===r||r,s=n.adaptive,o=void 0===s||s,a=n.roundOffsets,l=void 0===a||a,c={placement:eT(t.placement),variation:tT(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:i,isFixed:"fixed"===t.options.strategy};null!=t.modifiersData.popperOffsets&&(t.styles.popper=Object.assign({},t.styles.popper,sT(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:o,roundOffsets:l})))),null!=t.modifiersData.arrow&&(t.styles.arrow=Object.assign({},t.styles.arrow,sT(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})},data:{}},oT,aT,wT,ST,kT,{name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:function(e){var t=e.state,n=e.name,r=t.rects.reference,i=t.rects.popper,s=t.modifiersData.preventOverflow,o=vT(t,{elementContext:"reference"}),a=vT(t,{altBoundary:!0}),l=ET(o,r),c=ET(a,i,s),u=xT(l),h=xT(c);t.modifiersData[n]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:u,hasPopperEscaped:h},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":u,"data-popper-escaped":h})}}]}),TT="tippy-content",_T="tippy-backdrop",IT="tippy-arrow",AT="tippy-svg-arrow",NT={passive:!0,capture:!0},OT=function(){return document.body};function MT(e,t,n){if(Array.isArray(e)){var r=e[t];return null==r?Array.isArray(n)?n[t]:n:r}return e}function RT(e,t){var n={}.toString.call(e);return 0===n.indexOf("[object")&&n.indexOf(t+"]")>-1}function DT(e,t){return"function"===typeof e?e.apply(void 0,t):e}function PT(e,t){return 0===t?e:function(r){clearTimeout(n),n=setTimeout(function(){e(r)},t)};var n}function LT(e){return[].concat(e)}function FT(e,t){-1===e.indexOf(t)&&e.push(t)}function jT(e){return e.split("-")[0]}function VT(e){return[].slice.call(e)}function zT(e){return Object.keys(e).reduce(function(t,n){return void 0!==e[n]&&(t[n]=e[n]),t},{})}function UT(){return document.createElement("div")}function BT(e){return["Element","Fragment"].some(function(t){return RT(e,t)})}function $T(e){return RT(e,"MouseEvent")}function qT(e){return!(!e||!e._tippy||e._tippy.reference!==e)}function HT(e){return BT(e)?[e]:function(e){return RT(e,"NodeList")}(e)?VT(e):Array.isArray(e)?e:VT(document.querySelectorAll(e))}function WT(e,t){e.forEach(function(e){e&&(e.style.transitionDuration=t+"ms")})}function KT(e,t){e.forEach(function(e){e&&e.setAttribute("data-state",t)})}function GT(e){var t,n=LT(e)[0];return null!=n&&null!=(t=n.ownerDocument)&&t.body?n.ownerDocument:document}function JT(e,t,n){var r=t+"EventListener";["transitionend","webkitTransitionEnd"].forEach(function(t){e[r](t,n)})}function QT(e,t){for(var n=t;n;){var r;if(e.contains(n))return!0;n=null==n.getRootNode||null==(r=n.getRootNode())?void 0:r.host}return!1}var XT={isTouch:!1},YT=0;function ZT(){XT.isTouch||(XT.isTouch=!0,window.performance&&document.addEventListener("mousemove",e_))}function e_(){var e=performance.now();e-YT<20&&(XT.isTouch=!1,document.removeEventListener("mousemove",e_)),YT=e}function t_(){var e=document.activeElement;if(qT(e)){var t=e._tippy;e.blur&&!t.state.isVisible&&e.blur()}}var n_=!!("undefined"!==typeof window&&"undefined"!==typeof document)&&!!window.msCrypto;var r_={animateFill:!1,followCursor:!1,inlinePositioning:!1,sticky:!1},i_=Object.assign({appendTo:OT,aria:{content:"auto",expanded:"auto"},delay:0,duration:[300,250],getReferenceClientRect:null,hideOnClick:!0,ignoreAttributes:!1,interactive:!1,interactiveBorder:2,interactiveDebounce:0,moveTransition:"",offset:[0,10],onAfterUpdate:function(){},onBeforeUpdate:function(){},onCreate:function(){},onDestroy:function(){},onHidden:function(){},onHide:function(){},onMount:function(){},onShow:function(){},onShown:function(){},onTrigger:function(){},onUntrigger:function(){},onClickOutside:function(){},placement:"top",plugins:[],popperOptions:{},render:null,showOnCreate:!1,touch:!0,trigger:"mouseenter focus",triggerTarget:null},r_,{allowHTML:!1,animation:"fade",arrow:!0,content:"",inertia:!1,maxWidth:350,role:"tooltip",theme:"",zIndex:9999}),s_=Object.keys(i_);function o_(e){var t=(e.plugins||[]).reduce(function(t,n){var r,i=n.name,s=n.defaultValue;i&&(t[i]=void 0!==e[i]?e[i]:null!=(r=i_[i])?r:s);return t},{});return Object.assign({},e,t)}function a_(e,t){var n=Object.assign({},t,{content:DT(t.content,[e])},t.ignoreAttributes?{}:function(e,t){return(t?Object.keys(o_(Object.assign({},i_,{plugins:t}))):s_).reduce(function(t,n){var r=(e.getAttribute("data-tippy-"+n)||"").trim();if(!r)return t;if("content"===n)t[n]=r;else try{t[n]=JSON.parse(r)}catch(i){t[n]=r}return t},{})}(e,t.plugins));return n.aria=Object.assign({},i_.aria,n.aria),n.aria={expanded:"auto"===n.aria.expanded?t.interactive:n.aria.expanded,content:"auto"===n.aria.content?t.interactive?null:"describedby":n.aria.content},n}function l_(e,t){e.innerHTML=t}function c_(e){var t=UT();return!0===e?t.className=IT:(t.className=AT,BT(e)?t.appendChild(e):l_(t,e)),t}function u_(e,t){BT(t.content)?(l_(e,""),e.appendChild(t.content)):"function"!==typeof t.content&&(t.allowHTML?l_(e,t.content):e.textContent=t.content)}function h_(e){var t=e.firstElementChild,n=VT(t.children);return{box:t,content:n.find(function(e){return e.classList.contains(TT)}),arrow:n.find(function(e){return e.classList.contains(IT)||e.classList.contains(AT)}),backdrop:n.find(function(e){return e.classList.contains(_T)})}}function d_(e){var t=UT(),n=UT();n.className="tippy-box",n.setAttribute("data-state","hidden"),n.setAttribute("tabindex","-1");var r=UT();function i(n,r){var i=h_(t),s=i.box,o=i.content,a=i.arrow;r.theme?s.setAttribute("data-theme",r.theme):s.removeAttribute("data-theme"),"string"===typeof r.animation?s.setAttribute("data-animation",r.animation):s.removeAttribute("data-animation"),r.inertia?s.setAttribute("data-inertia",""):s.removeAttribute("data-inertia"),s.style.maxWidth="number"===typeof r.maxWidth?r.maxWidth+"px":r.maxWidth,r.role?s.setAttribute("role",r.role):s.removeAttribute("role"),n.content===r.content&&n.allowHTML===r.allowHTML||u_(o,e.props),r.arrow?a?n.arrow!==r.arrow&&(s.removeChild(a),s.appendChild(c_(r.arrow))):s.appendChild(c_(r.arrow)):a&&s.removeChild(a)}return r.className=TT,r.setAttribute("data-state","hidden"),u_(r,e.props),t.appendChild(n),n.appendChild(r),i(e.props,e.props),{popper:t,onUpdate:i}}d_.$$tippy=!0;var f_=1,p_=[],m_=[];function g_(e,t){var n,r,i,s,o,a,l,c,u=a_(e,Object.assign({},i_,o_(zT(t)))),h=!1,d=!1,f=!1,p=!1,m=[],g=PT(K,u.interactiveDebounce),y=f_++,v=(c=u.plugins).filter(function(e,t){return c.indexOf(e)===t}),w={id:y,reference:e,popper:UT(),popperInstance:null,props:u,state:{isEnabled:!0,isVisible:!1,isDestroyed:!1,isMounted:!1,isShown:!1},plugins:v,clearDelayTimeouts:function(){clearTimeout(n),clearTimeout(r),cancelAnimationFrame(i)},setProps:function(t){0;if(w.state.isDestroyed)return;R("onBeforeUpdate",[w,t]),H();var n=w.props,r=a_(e,Object.assign({},n,zT(t),{ignoreAttributes:!0}));w.props=r,q(),n.interactiveDebounce!==r.interactiveDebounce&&(L(),g=PT(K,r.interactiveDebounce));n.triggerTarget&&!r.triggerTarget?LT(n.triggerTarget).forEach(function(e){e.removeAttribute("aria-expanded")}):r.triggerTarget&&e.removeAttribute("aria-expanded");P(),M(),k&&k(n,r);w.popperInstance&&(X(),Z().forEach(function(e){requestAnimationFrame(e._tippy.popperInstance.forceUpdate)}));R("onAfterUpdate",[w,t])},setContent:function(e){w.setProps({content:e})},show:function(){0;var e=w.state.isVisible,t=w.state.isDestroyed,n=!w.state.isEnabled,r=XT.isTouch&&!w.props.touch,i=MT(w.props.duration,0,i_.duration);if(e||t||n||r)return;if(I().hasAttribute("disabled"))return;if(R("onShow",[w],!1),!1===w.props.onShow(w))return;w.state.isVisible=!0,_()&&(S.style.visibility="visible");M(),z(),w.state.isMounted||(S.style.transition="none");if(_()){var s=N();WT([s.box,s.content],0)}a=function(){var e;if(w.state.isVisible&&!p){if(p=!0,S.offsetHeight,S.style.transition=w.props.moveTransition,_()&&w.props.animation){var t=N(),n=t.box,r=t.content;WT([n,r],i),KT([n,r],"visible")}D(),P(),FT(m_,w),null==(e=w.popperInstance)||e.forceUpdate(),R("onMount",[w]),w.props.animation&&_()&&function(e,t){B(e,t)}(i,function(){w.state.isShown=!0,R("onShown",[w])})}},function(){var e,t=w.props.appendTo,n=I();e=w.props.interactive&&t===OT||"parent"===t?n.parentNode:DT(t,[n]);e.contains(S)||e.appendChild(S);w.state.isMounted=!0,X(),!1}()},hide:function(){0;var e=!w.state.isVisible,t=w.state.isDestroyed,n=!w.state.isEnabled,r=MT(w.props.duration,1,i_.duration);if(e||t||n)return;if(R("onHide",[w],!1),!1===w.props.onHide(w))return;w.state.isVisible=!1,w.state.isShown=!1,p=!1,h=!1,_()&&(S.style.visibility="hidden");if(L(),U(),M(!0),_()){var i=N(),s=i.box,o=i.content;w.props.animation&&(WT([s,o],r),KT([s,o],"hidden"))}D(),P(),w.props.animation?_()&&function(e,t){B(e,function(){!w.state.isVisible&&S.parentNode&&S.parentNode.contains(S)&&t()})}(r,w.unmount):w.unmount()},hideWithInteractivity:function(e){0;A().addEventListener("mousemove",g),FT(p_,g),g(e)},enable:function(){w.state.isEnabled=!0},disable:function(){w.hide(),w.state.isEnabled=!1},unmount:function(){0;w.state.isVisible&&w.hide();if(!w.state.isMounted)return;Y(),Z().forEach(function(e){e._tippy.unmount()}),S.parentNode&&S.parentNode.removeChild(S);m_=m_.filter(function(e){return e!==w}),w.state.isMounted=!1,R("onHidden",[w])},destroy:function(){0;if(w.state.isDestroyed)return;w.clearDelayTimeouts(),w.unmount(),H(),delete e._tippy,w.state.isDestroyed=!0,R("onDestroy",[w])}};if(!u.render)return w;var b=u.render(w),S=b.popper,k=b.onUpdate;S.setAttribute("data-tippy-root",""),S.id="tippy-"+w.id,w.popper=S,e._tippy=w,S._tippy=w;var E=v.map(function(e){return e.fn(w)}),x=e.hasAttribute("aria-expanded");return q(),P(),M(),R("onCreate",[w]),u.showOnCreate&&ee(),S.addEventListener("mouseenter",function(){w.props.interactive&&w.state.isVisible&&w.clearDelayTimeouts()}),S.addEventListener("mouseleave",function(){w.props.interactive&&w.props.trigger.indexOf("mouseenter")>=0&&A().addEventListener("mousemove",g)}),w;function C(){var e=w.props.touch;return Array.isArray(e)?e:[e,0]}function T(){return"hold"===C()[0]}function _(){var e;return!(null==(e=w.props.render)||!e.$$tippy)}function I(){return l||e}function A(){var e=I().parentNode;return e?GT(e):document}function N(){return h_(S)}function O(e){return w.state.isMounted&&!w.state.isVisible||XT.isTouch||s&&"focus"===s.type?0:MT(w.props.delay,e?0:1,i_.delay)}function M(e){void 0===e&&(e=!1),S.style.pointerEvents=w.props.interactive&&!e?"":"none",S.style.zIndex=""+w.props.zIndex}function R(e,t,n){var r;(void 0===n&&(n=!0),E.forEach(function(n){n[e]&&n[e].apply(n,t)}),n)&&(r=w.props)[e].apply(r,t)}function D(){var t=w.props.aria;if(t.content){var n="aria-"+t.content,r=S.id;LT(w.props.triggerTarget||e).forEach(function(e){var t=e.getAttribute(n);if(w.state.isVisible)e.setAttribute(n,t?t+" "+r:r);else{var i=t&&t.replace(r,"").trim();i?e.setAttribute(n,i):e.removeAttribute(n)}})}}function P(){!x&&w.props.aria.expanded&&LT(w.props.triggerTarget||e).forEach(function(e){w.props.interactive?e.setAttribute("aria-expanded",w.state.isVisible&&e===I()?"true":"false"):e.removeAttribute("aria-expanded")})}function L(){A().removeEventListener("mousemove",g),p_=p_.filter(function(e){return e!==g})}function F(t){if(!XT.isTouch||!f&&"mousedown"!==t.type){var n=t.composedPath&&t.composedPath()[0]||t.target;if(!w.props.interactive||!QT(S,n)){if(LT(w.props.triggerTarget||e).some(function(e){return QT(e,n)})){if(XT.isTouch)return;if(w.state.isVisible&&w.props.trigger.indexOf("click")>=0)return}else R("onClickOutside",[w,t]);!0===w.props.hideOnClick&&(w.clearDelayTimeouts(),w.hide(),d=!0,setTimeout(function(){d=!1}),w.state.isMounted||U())}}}function j(){f=!0}function V(){f=!1}function z(){var e=A();e.addEventListener("mousedown",F,!0),e.addEventListener("touchend",F,NT),e.addEventListener("touchstart",V,NT),e.addEventListener("touchmove",j,NT)}function U(){var e=A();e.removeEventListener("mousedown",F,!0),e.removeEventListener("touchend",F,NT),e.removeEventListener("touchstart",V,NT),e.removeEventListener("touchmove",j,NT)}function B(e,t){var n=N().box;function r(e){e.target===n&&(JT(n,"remove",r),t())}if(0===e)return t();JT(n,"remove",o),JT(n,"add",r),o=r}function $(t,n,r){void 0===r&&(r=!1),LT(w.props.triggerTarget||e).forEach(function(e){e.addEventListener(t,n,r),m.push({node:e,eventType:t,handler:n,options:r})})}function q(){var e;T()&&($("touchstart",W,{passive:!0}),$("touchend",G,{passive:!0})),(e=w.props.trigger,e.split(/\s+/).filter(Boolean)).forEach(function(e){if("manual"!==e)switch($(e,W),e){case"mouseenter":$("mouseleave",G);break;case"focus":$(n_?"focusout":"blur",J);break;case"focusin":$("focusout",J)}})}function H(){m.forEach(function(e){var t=e.node,n=e.eventType,r=e.handler,i=e.options;t.removeEventListener(n,r,i)}),m=[]}function W(e){var t,n=!1;if(w.state.isEnabled&&!Q(e)&&!d){var r="focus"===(null==(t=s)?void 0:t.type);s=e,l=e.currentTarget,P(),!w.state.isVisible&&$T(e)&&p_.forEach(function(t){return t(e)}),"click"===e.type&&(w.props.trigger.indexOf("mouseenter")<0||h)&&!1!==w.props.hideOnClick&&w.state.isVisible?n=!0:ee(e),"click"===e.type&&(h=!n),n&&!r&&te(e)}}function K(e){var t=e.target,n=I().contains(t)||S.contains(t);if("mousemove"!==e.type||!n){var r=Z().concat(S).map(function(e){var t,n=null==(t=e._tippy.popperInstance)?void 0:t.state;return n?{popperRect:e.getBoundingClientRect(),popperState:n,props:u}:null}).filter(Boolean);(function(e,t){var n=t.clientX,r=t.clientY;return e.every(function(e){var t=e.popperRect,i=e.popperState,s=e.props.interactiveBorder,o=jT(i.placement),a=i.modifiersData.offset;if(!a)return!0;var l="bottom"===o?a.top.y:0,c="top"===o?a.bottom.y:0,u="right"===o?a.left.x:0,h="left"===o?a.right.x:0,d=t.top-r+l>s,f=r-t.bottom-c>s,p=t.left-n+u>s,m=n-t.right-h>s;return d||f||p||m})})(r,e)&&(L(),te(e))}}function G(e){Q(e)||w.props.trigger.indexOf("click")>=0&&h||(w.props.interactive?w.hideWithInteractivity(e):te(e))}function J(e){w.props.trigger.indexOf("focusin")<0&&e.target!==I()||w.props.interactive&&e.relatedTarget&&S.contains(e.relatedTarget)||te(e)}function Q(e){return!!XT.isTouch&&T()!==e.type.indexOf("touch")>=0}function X(){Y();var t=w.props,n=t.popperOptions,r=t.placement,i=t.offset,s=t.getReferenceClientRect,o=t.moveTransition,l=_()?h_(S).arrow:null,c=s?{getBoundingClientRect:s,contextElement:s.contextElement||I()}:e,u={name:"$$tippy",enabled:!0,phase:"beforeWrite",requires:["computeStyles"],fn:function(e){var t=e.state;if(_()){var n=N().box;["placement","reference-hidden","escaped"].forEach(function(e){"placement"===e?n.setAttribute("data-placement",t.placement):t.attributes.popper["data-popper-"+e]?n.setAttribute("data-"+e,""):n.removeAttribute("data-"+e)}),t.attributes.popper={}}}},h=[{name:"offset",options:{offset:i}},{name:"preventOverflow",options:{padding:{top:2,bottom:2,left:5,right:5}}},{name:"flip",options:{padding:5}},{name:"computeStyles",options:{adaptive:!o}},u];_()&&l&&h.push({name:"arrow",options:{element:l,padding:3}}),h.push.apply(h,(null==n?void 0:n.modifiers)||[]),w.popperInstance=CT(c,S,Object.assign({},n,{placement:r,onFirstUpdate:a,modifiers:h}))}function Y(){w.popperInstance&&(w.popperInstance.destroy(),w.popperInstance=null)}function Z(){return VT(S.querySelectorAll("[data-tippy-root]"))}function ee(e){w.clearDelayTimeouts(),e&&R("onTrigger",[w,e]),z();var t=O(!0),r=C(),i=r[0],s=r[1];XT.isTouch&&"hold"===i&&s&&(t=s),t?n=setTimeout(function(){w.show()},t):w.show()}function te(e){if(w.clearDelayTimeouts(),R("onUntrigger",[w,e]),w.state.isVisible){if(!(w.props.trigger.indexOf("mouseenter")>=0&&w.props.trigger.indexOf("click")>=0&&["mouseleave","mousemove"].indexOf(e.type)>=0&&h)){var t=O(!1);t?r=setTimeout(function(){w.state.isVisible&&w.hide()},t):i=requestAnimationFrame(function(){w.hide()})}}else U()}}function y_(e,t){void 0===t&&(t={});var n=i_.plugins.concat(t.plugins||[]);document.addEventListener("touchstart",ZT,NT),window.addEventListener("blur",t_);var r=Object.assign({},t,{plugins:n}),i=HT(e).reduce(function(e,t){var n=t&&g_(t,r);return n&&e.push(n),e},[]);return BT(e)?i[0]:i}y_.defaultProps=i_,y_.setDefaultProps=function(e){Object.keys(e).forEach(function(t){i_[t]=e[t]})},y_.currentInput=XT;Object.assign({},oT,{effect:function(e){var t=e.state,n={popper:{position:t.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};Object.assign(t.elements.popper.style,n.popper),t.styles=n,t.elements.arrow&&Object.assign(t.elements.arrow.style,n.arrow)}});y_.setDefaultProps({render:d_});const v_=y_,w_=(0,i.forwardRef)((e,t)=>{const[n,r]=(0,i.useState)(0),s=(0,i.useRef)(null),o=(0,i.useRef)(null),a=[{title:"\u7c97\u4f53",description:"\u52a0\u7c97\u9009\u4e2d\u7684\u6587\u672c",icon:(0,Fp.jsx)(Rx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).toggleBold().run()}},{title:"\u659c\u4f53",description:"\u503e\u659c\u9009\u4e2d\u7684\u6587\u672c",icon:(0,Fp.jsx)(Dx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).toggleItalic().run()}},{title:"\u4e0b\u5212\u7ebf",description:"\u4e3a\u6587\u672c\u6dfb\u52a0\u4e0b\u5212\u7ebf",icon:(0,Fp.jsx)(Px,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).toggleUnderline().run()}},{title:"\u5220\u9664\u7ebf",description:"\u4e3a\u6587\u672c\u6dfb\u52a0\u5220\u9664\u7ebf",icon:(0,Fp.jsx)(Lx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).toggleStrike().run()}},{title:"\u4e00\u7ea7\u6807\u9898",description:"\u5927\u53f7\u6807\u9898",icon:(0,Fp.jsx)(Fx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).setNode("heading",{level:1}).run()}},{title:"\u4e8c\u7ea7\u6807\u9898",description:"\u4e2d\u53f7\u6807\u9898",icon:(0,Fp.jsx)(jx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).setNode("heading",{level:2}).run()}},{title:"\u4e09\u7ea7\u6807\u9898",description:"\u5c0f\u53f7\u6807\u9898",icon:(0,Fp.jsx)(Vx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).setNode("heading",{level:3}).run()}},{title:"\u65e0\u5e8f\u5217\u8868",description:"\u521b\u5efa\u7b80\u5355\u7684\u65e0\u5e8f\u5217\u8868",icon:(0,Fp.jsx)(Wx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).toggleBulletList().run()}},{title:"\u6709\u5e8f\u5217\u8868",description:"\u521b\u5efa\u5e26\u7f16\u53f7\u7684\u5217\u8868",icon:(0,Fp.jsx)(Kx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).toggleOrderedList().run()}},{title:"\u5de6\u5bf9\u9f50",description:"\u5c06\u6587\u672c\u5de6\u5bf9\u9f50",icon:(0,Fp.jsx)(zx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).setTextAlign("left").run()}},{title:"\u5c45\u4e2d\u5bf9\u9f50",description:"\u5c06\u6587\u672c\u5c45\u4e2d\u5bf9\u9f50",icon:(0,Fp.jsx)(Ux,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).setTextAlign("center").run()}},{title:"\u53f3\u5bf9\u9f50",description:"\u5c06\u6587\u672c\u53f3\u5bf9\u9f50",icon:(0,Fp.jsx)(Bx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).setTextAlign("right").run()}},{title:"\u5f39\u6027\u7a7a\u95f4",description:"\u63d2\u5165\u5f39\u6027\u6c34\u5e73\u7a7a\u95f4 #h(1fr)",icon:(0,Fp.jsx)($x,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).insertFlexSpace().run()}},{title:"\u5782\u76f4\u7a7a\u95f4",description:"\u63d2\u5165\u5782\u76f4\u7a7a\u95f4 #v()",icon:(0,Fp.jsx)(qx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;const r=prompt("\u8bf7\u8f93\u5165\u5782\u76f4\u7a7a\u95f4\u5927\u5c0f\uff0c\u4f8b\u5982\uff1a1em, 2pt, 1fr","1em");if(r&&r.trim()){const e=r.trim();if(!/^-?\d+(\.\d+)?(em|pt|fr)$/.test(e))return void alert("\u8bf7\u8f93\u5165\u6709\u6548\u683c\u5f0f\uff0c\u4f8b\u5982\uff1a1em, -2pt, 1fr");t.chain().focus().deleteRange(n).insertVerticalSpace({spacing:e}).run()}}},{title:"\u5206\u9694\u7ebf",description:"\u63d2\u5165\u6c34\u5e73\u5206\u9694\u7ebf #line(length: 100%)",icon:(0,Fp.jsx)(Hx,{className:"slash-command-icon"}),command:e=>{let{editor:t,range:n}=e;t.chain().focus().deleteRange(n).insertLine().run()}}].filter(t=>t.title.toLowerCase().includes(e.query.toLowerCase()));(0,i.useEffect)(()=>{r(0)},[e.query]),(0,i.useEffect)(()=>{if(o.current&&s.current){const e=s.current,t=o.current,n=(e.getBoundingClientRect(),t.getBoundingClientRect(),e.scrollTop),r=e.clientHeight,i=t.offsetTop,a=t.offsetHeight;i<n?e.scrollTop=i:i+a>n+r&&(e.scrollTop=i+a-r)}},[n,a.length]);const l=t=>{const n=a[t];n&&n.command(e)};return(0,i.useImperativeHandle)(t,()=>({onKeyDown:e=>{let{event:t}=e;return"ArrowUp"===t.key?(r((n+a.length-1)%a.length),!0):"ArrowDown"===t.key?(r((n+1)%a.length),!0):"Enter"===t.key&&(l(n),!0)}})),(0,Fp.jsx)("div",{className:"slash-command",ref:s,children:a.length?a.map((e,t)=>(0,Fp.jsxs)("div",{ref:t===n?o:null,className:"slash-command-item "+(t===n?"is-selected":""),onClick:()=>l(t),children:[e.icon,(0,Fp.jsxs)("div",{className:"slash-command-content",children:[(0,Fp.jsx)("div",{className:"slash-command-title",children:e.title}),(0,Fp.jsx)("div",{className:"slash-command-description",children:e.description})]})]},t)):(0,Fp.jsx)("div",{className:"slash-command-item",children:(0,Fp.jsxs)("div",{className:"slash-command-content",children:[(0,Fp.jsx)("div",{className:"slash-command-title",children:"\u6ca1\u6709\u627e\u5230\u7ed3\u679c"}),(0,Fp.jsx)("div",{className:"slash-command-description",children:"\u5c1d\u8bd5\u5176\u4ed6\u5173\u952e\u8bcd"})]})})})}),b_=KS.create({name:"slashCommands",addOptions:()=>({suggestion:{char:"/",command:e=>{let{editor:t,range:n,props:r}=e;r.command({editor:t,range:n})}}}),addProseMirrorPlugins(){return[uC({editor:this.editor,...this.options.suggestion,items:e=>{let{query:t}=e;return["bold","italic","underline","strike","heading1","heading2","heading3","bulletList","orderedList","left","center","right","flexSpace","verticalSpace","line"].filter(e=>e.toLowerCase().startsWith(t.toLowerCase()))},render:()=>{let e,t;return{onStart:n=>{e=new gE(w_,{props:n,editor:n.editor}),n.clientRect&&(t=v_("body",{getReferenceClientRect:n.clientRect,appendTo:()=>document.body,content:e.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"}))},onUpdate(n){e.updateProps(n),n.clientRect&&t[0].setProps({getReferenceClientRect:n.clientRect})},onKeyDown(n){var r;return"Escape"===n.event.key?(t[0].hide(),!0):null===(r=e.ref)||void 0===r?void 0:r.onKeyDown(n)},onExit(){t[0].destroy(),e.destroy()}}}})]}}),S_=b_,k_=e=>{if(!e)return"";let t=e;return t=(e=>e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/#align\(center\)\[= (.+)\]/g,'<h1 style="text-align: center">$1</h1>')).replace(/#align\(right\)\[= (.+)\]/g,'<h1 style="text-align: right">$1</h1>')).replace(/#align\(left\)\[= (.+)\]/g,'<h1 style="text-align: left">$1</h1>')).replace(/#align\(center\)\[== (.+)\]/g,'<h2 style="text-align: center">$1</h2>')).replace(/#align\(right\)\[== (.+)\]/g,'<h2 style="text-align: right">$1</h2>')).replace(/#align\(left\)\[== (.+)\]/g,'<h2 style="text-align: left">$1</h2>')).replace(/#align\(center\)\[=== (.+)\]/g,'<h3 style="text-align: center">$1</h3>')).replace(/#align\(right\)\[=== (.+)\]/g,'<h3 style="text-align: right">$1</h3>')).replace(/#align\(left\)\[=== (.+)\]/g,'<h3 style="text-align: left">$1</h3>'))(t),t=t.replace(/^= (.+)$/gm,"<h1>$1</h1>"),t=t.replace(/^== (.+)$/gm,"<h2>$1</h2>"),t=t.replace(/^=== (.+)$/gm,"<h3>$1</h3>"),t=t.replace(/#align\(center\)\[([^\]]+)\]/g,'<p style="text-align: center">$1</p>'),t=t.replace(/#align\(right\)\[([^\]]+)\]/g,'<p style="text-align: right">$1</p>'),t=t.replace(/#align\(left\)\[([^\]]+)\]/g,'<p style="text-align: left">$1</p>'),t=t.replace(/#h\(1fr\)/g,'<span class="typst-flex-space" data-typst="#h(1fr)">\u2194</span>'),t=t.replace(/#v\(([^)]+)\)/g,(e,t)=>`<div class="typst-vertical-space" data-typst="#v(${t})" spacing="${t}" style="height: ${t.includes("fr")?"20px":t}; display: block; border-top: 1px dashed #ccc; position: relative;"><span style="position: absolute; left: 50%; top: -10px; transform: translateX(-50%); background: white; padding: 0 5px; color: #888; font-size: 12px;">\u2195 ${t}</span></div>`),t=t.replace(/#line\(length:\s*100%\)/g,'<hr class="typst-line" data-typst="#line(length: 100%)" />'),t=t.replace(/\*([^*]+)\*/g,"<strong>$1</strong>"),t=t.replace(/_([^_]+)_/g,"<em>$1</em>"),t=t.replace(/^- (.+)$/gm,"<li>$1</li>"),t=t.replace(/^(\d+)\. (.+)$/gm,"<li>$2</li>"),t=t.replace(/(<li>.*<\/li>)/gs,e=>{const t=e.split("</li>").filter(e=>e.trim());if(t.length>0){return`<ul>${t.map(e=>e+"</li>").join("")}</ul>`}return e}),t=t.replace(/\n\n/g,"</p><p>"),t="<p>"+t+"</p>",t=t.replace(/<p><\/p>/g,""),t=t.replace(/<p>\s*<h/g,"<h"),t=t.replace(/<\/h(\d)>\s*<\/p>/g,"</h$1>"),t=t.replace(/<p>\s*<ul>/g,"<ul>"),t=t.replace(/<\/ul>\s*<\/p>/g,"</ul>"),t=t.replace(/<p>\s*<pre>/g,"<pre>"),t=t.replace(/<\/pre>\s*<\/p>/g,"</pre>"),t},E_=e=>{let{content:t,onChange:n}=e;const r=uE({extensions:[Ax.configure({code:!1}),EE,wx,Nx,_x,WE.configure({levels:[1,2,3]}),TE,Ex,bx,tC,rC,sC,aC,S_],content:k_(t),onUpdate:e=>{let{editor:t}=e;const r=(e=>{if(!e)return"";const t=document.createElement("div");t.innerHTML=e;const n=(e,t)=>{const n=Array.from(e.childNodes).map(r).join(""),i=e.getAttribute("style")||"",s="=".repeat(t);return i.includes("text-align: center")?`\n#align(center)[${s} ${n}]\n`:i.includes("text-align: right")?`\n#align(right)[${s} ${n}]\n`:i.includes("text-align: left")?`\n#align(left)[${s} ${n}]\n`:`\n${s} ${n}\n`},r=e=>{if(e.nodeType===Node.TEXT_NODE)return e.textContent;if(e.nodeType===Node.ELEMENT_NODE){const t=e.tagName.toLowerCase(),i=Array.from(e.childNodes).map(r).join("");switch(t){case"h1":return n(e,1);case"h2":return n(e,2);case"h3":return n(e,3);case"strong":case"b":return`*${i}*`;case"em":case"i":return`_${i}_`;case"u":return`#underline[${i}]`;case"s":return`#strike[${i}]`;case"li":return`- ${i}`;case"ul":return`${Array.from(e.children).filter(e=>"li"===e.tagName.toLowerCase()).map(e=>{let t=r(e).replace(/^- /,"");return t=t.replace(/\n\n$/,""),`- ${t}`}).join("\n")}\n\n`;case"ol":{const t=Array.from(e.children).filter(e=>"li"===e.tagName.toLowerCase()).map((e,t)=>`${t+1}. ${r(e).replace(/^- /,"")}`).join("\n");return`${t}`}case"p":const t=e.getAttribute("style")||"";return t.includes("text-align: center")?`#align(center)[${i}]\n\n`:t.includes("text-align: right")?`#align(right)[${i}]\n\n`:t.includes("text-align: left")?`#align(left)[${i}]\n\n`:`${i}\n\n`;case"br":return"\n";case"span":return e.classList.contains("typst-flex-space")?"#h(1fr)":i;case"div":return e.classList.contains("typst-vertical-space")?`#v(${e.getAttribute("spacing")||"1em"})\n\n`:i;case"hr":return e.classList.contains("typst-line")?"#line(length: 100%)\n\n":i;default:return i}}return""};let i=r(t);return i=i.replace(/\n{3,}/g,"\n\n").replace(/^\n+/,"").replace(/\n+$/,"").trim(),i=i.replace(/\n\n- /g,"\n- "),i})(t.getHTML());n(r)},editorProps:{attributes:{class:"prose prose-sm sm:prose lg:prose-lg xl:prose-2xl mx-auto focus:outline-none"}}});return(0,Fp.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[(0,Fp.jsx)(Zx,{editor:r,content:t,onFontChange:(e,r)=>{const i=function(e,t,n){const r=Xx(t,n),i=/#set\s+text\s*\(\s*font:\s*\(\s*\(\s*name:\s*"[^"]+"\s*,\s*covers:\s*"[^"]*"\s*\)\s*,\s*"[^"]+"\s*\)\s*\)/;return i.test(e)?e.replace(i,r):r+"\n"+e}(t,e,r);n(i)}}),(0,Fp.jsx)("div",{style:{flex:1,overflow:"auto",border:"none",background:"white"},children:(0,Fp.jsx)(Yk,{editor:r})})]})},x_=Mx("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),C_=Mx("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),T_=Mx("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),__=Mx("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),I_=Mx("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),A_=Mx("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),N_=Mx("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),O_=Mx("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);function M_(e,t){return function(){return e.apply(t,arguments)}}const{toString:R_}=Object.prototype,{getPrototypeOf:D_}=Object,{iterator:P_,toStringTag:L_}=Symbol,F_=(j_=Object.create(null),e=>{const t=R_.call(e);return j_[t]||(j_[t]=t.slice(8,-1).toLowerCase())});var j_;const V_=e=>(e=e.toLowerCase(),t=>F_(t)===e),z_=e=>t=>typeof t===e,{isArray:U_}=Array,B_=z_("undefined");const $_=V_("ArrayBuffer");const q_=z_("string"),H_=z_("function"),W_=z_("number"),K_=e=>null!==e&&"object"===typeof e,G_=e=>{if("object"!==F_(e))return!1;const t=D_(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(L_ in e)&&!(P_ in e)},J_=V_("Date"),Q_=V_("File"),X_=V_("Blob"),Y_=V_("FileList"),Z_=V_("URLSearchParams"),[eI,tI,nI,rI]=["ReadableStream","Request","Response","Headers"].map(V_);function iI(e,t){let n,r,{allOwnKeys:i=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),U_(e))for(n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else{const r=i?Object.getOwnPropertyNames(e):Object.keys(e),s=r.length;let o;for(n=0;n<s;n++)o=r[n],t.call(null,e[o],o,e)}}function sI(e,t){t=t.toLowerCase();const n=Object.keys(e);let r,i=n.length;for(;i-- >0;)if(r=n[i],t===r.toLowerCase())return r;return null}const oI="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,aI=e=>!B_(e)&&e!==oI;const lI=(cI="undefined"!==typeof Uint8Array&&D_(Uint8Array),e=>cI&&e instanceof cI);var cI;const uI=V_("HTMLFormElement"),hI=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),dI=V_("RegExp"),fI=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};iI(n,(n,i)=>{let s;!1!==(s=t(n,i,e))&&(r[i]=s||n)}),Object.defineProperties(e,r)};const pI=V_("AsyncFunction"),mI=((e,t)=>{return e?setImmediate:t?(n=`axios@${Math.random()}`,r=[],oI.addEventListener("message",e=>{let{source:t,data:i}=e;t===oI&&i===n&&r.length&&r.shift()()},!1),e=>{r.push(e),oI.postMessage(n,"*")}):e=>setTimeout(e);var n,r})("function"===typeof setImmediate,H_(oI.postMessage)),gI="undefined"!==typeof queueMicrotask?queueMicrotask.bind(oI):"undefined"!==typeof process&&process.nextTick||mI,yI={isArray:U_,isArrayBuffer:$_,isBuffer:function(e){return null!==e&&!B_(e)&&null!==e.constructor&&!B_(e.constructor)&&H_(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||H_(e.append)&&("formdata"===(t=F_(e))||"object"===t&&H_(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&$_(e.buffer),t},isString:q_,isNumber:W_,isBoolean:e=>!0===e||!1===e,isObject:K_,isPlainObject:G_,isReadableStream:eI,isRequest:tI,isResponse:nI,isHeaders:rI,isUndefined:B_,isDate:J_,isFile:Q_,isBlob:X_,isRegExp:dI,isFunction:H_,isStream:e=>K_(e)&&H_(e.pipe),isURLSearchParams:Z_,isTypedArray:lI,isFileList:Y_,forEach:iI,merge:function e(){const{caseless:t}=aI(this)&&this||{},n={},r=(r,i)=>{const s=t&&sI(n,i)||i;G_(n[s])&&G_(r)?n[s]=e(n[s],r):G_(r)?n[s]=e({},r):U_(r)?n[s]=r.slice():n[s]=r};for(let i=0,s=arguments.length;i<s;i++)arguments[i]&&iI(arguments[i],r);return n},extend:function(e,t,n){let{allOwnKeys:r}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return iI(t,(t,r)=>{n&&H_(t)?e[r]=M_(t,n):e[r]=t},{allOwnKeys:r}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,r)=>{let i,s,o;const a={};if(t=t||{},null==e)return t;do{for(i=Object.getOwnPropertyNames(e),s=i.length;s-- >0;)o=i[s],r&&!r(o,e,t)||a[o]||(t[o]=e[o],a[o]=!0);e=!1!==n&&D_(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:F_,kindOfTest:V_,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return-1!==r&&r===n},toArray:e=>{if(!e)return null;if(U_(e))return e;let t=e.length;if(!W_(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[P_]).call(e);let r;for(;(r=n.next())&&!r.done;){const n=r.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const r=[];for(;null!==(n=e.exec(t));)r.push(n);return r},isHTMLForm:uI,hasOwnProperty:hI,hasOwnProp:hI,reduceDescriptors:fI,freezeMethods:e=>{fI(e,(t,n)=>{if(H_(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const r=e[n];H_(r)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},r=e=>{e.forEach(e=>{n[e]=!0})};return U_(e)?r(e):r(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:sI,global:oI,isContextDefined:aI,isSpecCompliantForm:function(e){return!!(e&&H_(e.append)&&"FormData"===e[L_]&&e[P_])},toJSONObject:e=>{const t=new Array(10),n=(e,r)=>{if(K_(e)){if(t.indexOf(e)>=0)return;if(!("toJSON"in e)){t[r]=e;const i=U_(e)?[]:{};return iI(e,(e,t)=>{const s=n(e,r+1);!B_(s)&&(i[t]=s)}),t[r]=void 0,i}}return e};return n(e,0)},isAsyncFn:pI,isThenable:e=>e&&(K_(e)||H_(e))&&H_(e.then)&&H_(e.catch),setImmediate:mI,asap:gI,isIterable:e=>null!=e&&H_(e[P_])};function vI(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}yI.inherits(vI,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:yI.toJSONObject(this.config),code:this.code,status:this.status}}});const wI=vI.prototype,bI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{bI[e]={value:e}}),Object.defineProperties(vI,bI),Object.defineProperty(wI,"isAxiosError",{value:!0}),vI.from=(e,t,n,r,i,s)=>{const o=Object.create(wI);return yI.toFlatObject(e,o,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),vI.call(o,e.message,t,n,r,i),o.cause=e,o.name=e.name,s&&Object.assign(o,s),o};const SI=vI;function kI(e){return yI.isPlainObject(e)||yI.isArray(e)}function EI(e){return yI.endsWith(e,"[]")?e.slice(0,-2):e}function xI(e,t,n){return e?e.concat(t).map(function(e,t){return e=EI(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const CI=yI.toFlatObject(yI,{},null,function(e){return/^is[A-Z]/.test(e)});const TI=function(e,t,n){if(!yI.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const r=(n=yI.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!yI.isUndefined(t[e])})).metaTokens,i=n.visitor||c,s=n.dots,o=n.indexes,a=(n.Blob||"undefined"!==typeof Blob&&Blob)&&yI.isSpecCompliantForm(t);if(!yI.isFunction(i))throw new TypeError("visitor must be a function");function l(e){if(null===e)return"";if(yI.isDate(e))return e.toISOString();if(yI.isBoolean(e))return e.toString();if(!a&&yI.isBlob(e))throw new SI("Blob is not supported. Use a Buffer instead.");return yI.isArrayBuffer(e)||yI.isTypedArray(e)?a&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,n,i){let a=e;if(e&&!i&&"object"===typeof e)if(yI.endsWith(n,"{}"))n=r?n:n.slice(0,-2),e=JSON.stringify(e);else if(yI.isArray(e)&&function(e){return yI.isArray(e)&&!e.some(kI)}(e)||(yI.isFileList(e)||yI.endsWith(n,"[]"))&&(a=yI.toArray(e)))return n=EI(n),a.forEach(function(e,r){!yI.isUndefined(e)&&null!==e&&t.append(!0===o?xI([n],r,s):null===o?n:n+"[]",l(e))}),!1;return!!kI(e)||(t.append(xI(i,n,s),l(e)),!1)}const u=[],h=Object.assign(CI,{defaultVisitor:c,convertValue:l,isVisitable:kI});if(!yI.isObject(e))throw new TypeError("data must be an object");return function e(n,r){if(!yI.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+r.join("."));u.push(n),yI.forEach(n,function(n,s){!0===(!(yI.isUndefined(n)||null===n)&&i.call(t,n,yI.isString(s)?s.trim():s,r,h))&&e(n,r?r.concat(s):[s])}),u.pop()}}(e),t};function _I(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function II(e,t){this._pairs=[],e&&TI(e,this,t)}const AI=II.prototype;AI.append=function(e,t){this._pairs.push([e,t])},AI.toString=function(e){const t=e?function(t){return e.call(this,t,_I)}:_I;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const NI=II;function OI(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function MI(e,t,n){if(!t)return e;const r=n&&n.encode||OI;yI.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let s;if(s=i?i(t,n):yI.isURLSearchParams(t)?t.toString():new NI(t,n).toString(r),s){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}const RI=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){yI.forEach(this.handlers,function(t){null!==t&&e(t)})}},DI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},PI={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:NI,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},LI="undefined"!==typeof window&&"undefined"!==typeof document,FI="object"===typeof navigator&&navigator||void 0,jI=LI&&(!FI||["ReactNative","NativeScript","NS"].indexOf(FI.product)<0),VI="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,zI=LI&&window.location.href||"http://localhost",UI={...r,...PI};const BI=function(e){function t(e,n,r,i){let s=e[i++];if("__proto__"===s)return!0;const o=Number.isFinite(+s),a=i>=e.length;if(s=!s&&yI.isArray(r)?r.length:s,a)return yI.hasOwnProp(r,s)?r[s]=[r[s],n]:r[s]=n,!o;r[s]&&yI.isObject(r[s])||(r[s]=[]);return t(e,n,r[s],i)&&yI.isArray(r[s])&&(r[s]=function(e){const t={},n=Object.keys(e);let r;const i=n.length;let s;for(r=0;r<i;r++)s=n[r],t[s]=e[s];return t}(r[s])),!o}if(yI.isFormData(e)&&yI.isFunction(e.entries)){const n={};return yI.forEachEntry(e,(e,r)=>{t(function(e){return yI.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),r,n,0)}),n}return null};const $I={transitional:DI,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",r=n.indexOf("application/json")>-1,i=yI.isObject(e);i&&yI.isHTMLForm(e)&&(e=new FormData(e));if(yI.isFormData(e))return r?JSON.stringify(BI(e)):e;if(yI.isArrayBuffer(e)||yI.isBuffer(e)||yI.isStream(e)||yI.isFile(e)||yI.isBlob(e)||yI.isReadableStream(e))return e;if(yI.isArrayBufferView(e))return e.buffer;if(yI.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let s;if(i){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return TI(e,new UI.classes.URLSearchParams,Object.assign({visitor:function(e,t,n,r){return UI.isNode&&yI.isBuffer(e)?(this.append(t,e.toString("base64")),!1):r.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((s=yI.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return TI(s?{"files[]":e}:e,t&&new t,this.formSerializer)}}return i||r?(t.setContentType("application/json",!1),function(e,t,n){if(yI.isString(e))try{return(t||JSON.parse)(e),yI.trim(e)}catch(r){if("SyntaxError"!==r.name)throw r}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||$I.transitional,n=t&&t.forcedJSONParsing,r="json"===this.responseType;if(yI.isResponse(e)||yI.isReadableStream(e))return e;if(e&&yI.isString(e)&&(n&&!this.responseType||r)){const n=!(t&&t.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(i){if(n){if("SyntaxError"===i.name)throw SI.from(i,SI.ERR_BAD_RESPONSE,this,null,this.response);throw i}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:UI.classes.FormData,Blob:UI.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};yI.forEach(["delete","get","head","post","put","patch"],e=>{$I.headers[e]={}});const qI=$I,HI=yI.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),WI=Symbol("internals");function KI(e){return e&&String(e).trim().toLowerCase()}function GI(e){return!1===e||null==e?e:yI.isArray(e)?e.map(GI):String(e)}function JI(e,t,n,r,i){return yI.isFunction(r)?r.call(this,t,n):(i&&(t=n),yI.isString(t)?yI.isString(r)?-1!==t.indexOf(r):yI.isRegExp(r)?r.test(t):void 0:void 0)}class QI{constructor(e){e&&this.set(e)}set(e,t,n){const r=this;function i(e,t,n){const i=KI(t);if(!i)throw new Error("header name must be a non-empty string");const s=yI.findKey(r,i);(!s||void 0===r[s]||!0===n||void 0===n&&!1!==r[s])&&(r[s||t]=GI(e))}const s=(e,t)=>yI.forEach(e,(e,n)=>i(e,n,t));if(yI.isPlainObject(e)||e instanceof this.constructor)s(e,t);else if(yI.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))s((e=>{const t={};let n,r,i;return e&&e.split("\n").forEach(function(e){i=e.indexOf(":"),n=e.substring(0,i).trim().toLowerCase(),r=e.substring(i+1).trim(),!n||t[n]&&HI[n]||("set-cookie"===n?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t})(e),t);else if(yI.isObject(e)&&yI.isIterable(e)){let n,r,i={};for(const t of e){if(!yI.isArray(t))throw TypeError("Object iterator must return a key-value pair");i[r=t[0]]=(n=i[r])?yI.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}s(i,t)}else null!=e&&i(t,e,n);return this}get(e,t){if(e=KI(e)){const n=yI.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}(e);if(yI.isFunction(t))return t.call(this,e,n);if(yI.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=KI(e)){const n=yI.findKey(this,e);return!(!n||void 0===this[n]||t&&!JI(0,this[n],n,t))}return!1}delete(e,t){const n=this;let r=!1;function i(e){if(e=KI(e)){const i=yI.findKey(n,e);!i||t&&!JI(0,n[i],i,t)||(delete n[i],r=!0)}}return yI.isArray(e)?e.forEach(i):i(e),r}clear(e){const t=Object.keys(this);let n=t.length,r=!1;for(;n--;){const i=t[n];e&&!JI(0,this[i],i,e,!0)||(delete this[i],r=!0)}return r}normalize(e){const t=this,n={};return yI.forEach(this,(r,i)=>{const s=yI.findKey(n,i);if(s)return t[s]=GI(r),void delete t[i];const o=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(i):String(i).trim();o!==i&&delete t[i],t[o]=GI(r),n[o]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return yI.forEach(this,(n,r)=>{null!=n&&!1!==n&&(t[r]=e&&yI.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[WI]=this[WI]={accessors:{}}).accessors,n=this.prototype;function r(e){const r=KI(e);t[r]||(!function(e,t){const n=yI.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(e,n,i){return this[r].call(this,t,e,n,i)},configurable:!0})})}(n,e),t[r]=!0)}return yI.isArray(e)?e.forEach(r):r(e),this}}QI.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),yI.reduceDescriptors(QI.prototype,(e,t)=>{let{value:n}=e,r=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[r]=e}}}),yI.freezeMethods(QI);const XI=QI;function YI(e,t){const n=this||qI,r=t||n,i=XI.from(r.headers);let s=r.data;return yI.forEach(e,function(e){s=e.call(n,s,i.normalize(),t?t.status:void 0)}),i.normalize(),s}function ZI(e){return!(!e||!e.__CANCEL__)}function eA(e,t,n){SI.call(this,null==e?"canceled":e,SI.ERR_CANCELED,t,n),this.name="CanceledError"}yI.inherits(eA,SI,{__CANCEL__:!0});const tA=eA;function nA(e,t,n){const r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(new SI("Request failed with status code "+n.status,[SI.ERR_BAD_REQUEST,SI.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const rA=function(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i,s=0,o=0;return t=void 0!==t?t:1e3,function(a){const l=Date.now(),c=r[o];i||(i=l),n[s]=a,r[s]=l;let u=o,h=0;for(;u!==s;)h+=n[u++],u%=e;if(s=(s+1)%e,s===o&&(o=(o+1)%e),l-i<t)return;const d=c&&l-c;return d?Math.round(1e3*h/d):void 0}};const iA=function(e,t){let n,r,i=0,s=1e3/t;const o=function(t){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();i=s,n=null,r&&(clearTimeout(r),r=null),e.apply(null,t)};return[function(){const e=Date.now(),t=e-i;for(var a=arguments.length,l=new Array(a),c=0;c<a;c++)l[c]=arguments[c];t>=s?o(l,e):(n=l,r||(r=setTimeout(()=>{r=null,o(n)},s-t)))},()=>n&&o(n)]},sA=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=0;const i=rA(50,250);return iA(n=>{const s=n.loaded,o=n.lengthComputable?n.total:void 0,a=s-r,l=i(a);r=s;e({loaded:s,total:o,progress:o?s/o:void 0,bytes:a,rate:l||void 0,estimated:l&&o&&s<=o?(o-s)/l:void 0,event:n,lengthComputable:null!=o,[t?"download":"upload"]:!0})},n)},oA=(e,t)=>{const n=null!=e;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},aA=e=>function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return yI.asap(()=>e(...n))},lA=UI.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,UI.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(UI.origin),UI.navigator&&/(msie|trident)/i.test(UI.navigator.userAgent)):()=>!0,cA=UI.hasStandardBrowserEnv?{write(e,t,n,r,i,s){const o=[e+"="+encodeURIComponent(t)];yI.isNumber(n)&&o.push("expires="+new Date(n).toGMTString()),yI.isString(r)&&o.push("path="+r),yI.isString(i)&&o.push("domain="+i),!0===s&&o.push("secure"),document.cookie=o.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function uA(e,t,n){let r=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(r||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const hA=e=>e instanceof XI?{...e}:e;function dA(e,t){t=t||{};const n={};function r(e,t,n,r){return yI.isPlainObject(e)&&yI.isPlainObject(t)?yI.merge.call({caseless:r},e,t):yI.isPlainObject(t)?yI.merge({},t):yI.isArray(t)?t.slice():t}function i(e,t,n,i){return yI.isUndefined(t)?yI.isUndefined(e)?void 0:r(void 0,e,0,i):r(e,t,0,i)}function s(e,t){if(!yI.isUndefined(t))return r(void 0,t)}function o(e,t){return yI.isUndefined(t)?yI.isUndefined(e)?void 0:r(void 0,e):r(void 0,t)}function a(n,i,s){return s in t?r(n,i):s in e?r(void 0,n):void 0}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(e,t,n)=>i(hA(e),hA(t),0,!0)};return yI.forEach(Object.keys(Object.assign({},e,t)),function(r){const s=l[r]||i,o=s(e[r],t[r],r);yI.isUndefined(o)&&s!==a||(n[r]=o)}),n}const fA=e=>{const t=dA({},e);let n,{data:r,withXSRFToken:i,xsrfHeaderName:s,xsrfCookieName:o,headers:a,auth:l}=t;if(t.headers=a=XI.from(a),t.url=MI(uA(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),l&&a.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),yI.isFormData(r))if(UI.hasStandardBrowserEnv||UI.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(!1!==(n=a.getContentType())){const[e,...t]=n?n.split(";").map(e=>e.trim()).filter(Boolean):[];a.setContentType([e||"multipart/form-data",...t].join("; "))}if(UI.hasStandardBrowserEnv&&(i&&yI.isFunction(i)&&(i=i(t)),i||!1!==i&&lA(t.url))){const e=s&&o&&cA.read(o);e&&a.set(s,e)}return t},pA="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const r=fA(e);let i=r.data;const s=XI.from(r.headers).normalize();let o,a,l,c,u,{responseType:h,onUploadProgress:d,onDownloadProgress:f}=r;function p(){c&&c(),u&&u(),r.cancelToken&&r.cancelToken.unsubscribe(o),r.signal&&r.signal.removeEventListener("abort",o)}let m=new XMLHttpRequest;function g(){if(!m)return;const r=XI.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());nA(function(e){t(e),p()},function(e){n(e),p()},{data:h&&"text"!==h&&"json"!==h?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:r,config:e,request:m}),m=null}m.open(r.method.toUpperCase(),r.url,!0),m.timeout=r.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new SI("Request aborted",SI.ECONNABORTED,e,m)),m=null)},m.onerror=function(){n(new SI("Network Error",SI.ERR_NETWORK,e,m)),m=null},m.ontimeout=function(){let t=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const i=r.transitional||DI;r.timeoutErrorMessage&&(t=r.timeoutErrorMessage),n(new SI(t,i.clarifyTimeoutError?SI.ETIMEDOUT:SI.ECONNABORTED,e,m)),m=null},void 0===i&&s.setContentType(null),"setRequestHeader"in m&&yI.forEach(s.toJSON(),function(e,t){m.setRequestHeader(t,e)}),yI.isUndefined(r.withCredentials)||(m.withCredentials=!!r.withCredentials),h&&"json"!==h&&(m.responseType=r.responseType),f&&([l,u]=sA(f,!0),m.addEventListener("progress",l)),d&&m.upload&&([a,c]=sA(d),m.upload.addEventListener("progress",a),m.upload.addEventListener("loadend",c)),(r.cancelToken||r.signal)&&(o=t=>{m&&(n(!t||t.type?new tA(null,e,m):t),m.abort(),m=null)},r.cancelToken&&r.cancelToken.subscribe(o),r.signal&&(r.signal.aborted?o():r.signal.addEventListener("abort",o)));const y=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(r.url);y&&-1===UI.protocols.indexOf(y)?n(new SI("Unsupported protocol "+y+":",SI.ERR_BAD_REQUEST,e)):m.send(i||null)})},mA=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,r=new AbortController;const i=function(e){if(!n){n=!0,o();const t=e instanceof Error?e:this.reason;r.abort(t instanceof SI?t:new tA(t instanceof Error?t.message:t))}};let s=t&&setTimeout(()=>{s=null,i(new SI(`timeout ${t} of ms exceeded`,SI.ETIMEDOUT))},t);const o=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(i):e.removeEventListener("abort",i)}),e=null)};e.forEach(e=>e.addEventListener("abort",i));const{signal:a}=r;return a.unsubscribe=()=>yI.asap(o),a}},gA=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let r,i=0;for(;i<n;)r=i+t,yield e.slice(i,r),i=r},yA=async function*(e){if(e[Symbol.asyncIterator])return void(yield*e);const t=e.getReader();try{for(;;){const{done:e,value:n}=await t.read();if(e)break;yield n}}finally{await t.cancel()}},vA=(e,t,n,r)=>{const i=async function*(e,t){for await(const n of yA(e))yield*gA(n,t)}(e,t);let s,o=0,a=e=>{s||(s=!0,r&&r(e))};return new ReadableStream({async pull(e){try{const{done:t,value:r}=await i.next();if(t)return a(),void e.close();let s=r.byteLength;if(n){let e=o+=s;n(e)}e.enqueue(new Uint8Array(r))}catch(t){throw a(t),t}},cancel:e=>(a(e),i.return())},{highWaterMark:2})},wA="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,bA=wA&&"function"===typeof ReadableStream,SA=wA&&("function"===typeof TextEncoder?(kA=new TextEncoder,e=>kA.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var kA;const EA=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return!!e(...n)}catch(i){return!1}},xA=bA&&EA(()=>{let e=!1;const t=new Request(UI.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),CA=bA&&EA(()=>yI.isReadableStream(new Response("").body)),TA={stream:CA&&(e=>e.body)};var _A;wA&&(_A=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!TA[e]&&(TA[e]=yI.isFunction(_A[e])?t=>t[e]():(t,n)=>{throw new SI(`Response type '${e}' is not supported`,SI.ERR_NOT_SUPPORT,n)})}));const IA=async(e,t)=>{const n=yI.toFiniteNumber(e.getContentLength());return null==n?(async e=>{if(null==e)return 0;if(yI.isBlob(e))return e.size;if(yI.isSpecCompliantForm(e)){const t=new Request(UI.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return yI.isArrayBufferView(e)||yI.isArrayBuffer(e)?e.byteLength:(yI.isURLSearchParams(e)&&(e+=""),yI.isString(e)?(await SA(e)).byteLength:void 0)})(t):n},AA={http:null,xhr:pA,fetch:wA&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:h="same-origin",fetchOptions:d}=fA(e);c=c?(c+"").toLowerCase():"text";let f,p=mA([i,s&&s.toAbortSignal()],o);const m=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let g;try{if(l&&xA&&"get"!==n&&"head"!==n&&0!==(g=await IA(u,r))){let e,n=new Request(t,{method:"POST",body:r,duplex:"half"});if(yI.isFormData(r)&&(e=n.headers.get("content-type"))&&u.setContentType(e),n.body){const[e,t]=oA(g,sA(aA(l)));r=vA(n.body,65536,e,t)}}yI.isString(h)||(h=h?"include":"omit");const i="credentials"in Request.prototype;f=new Request(t,{...d,signal:p,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:i?h:void 0});let s=await fetch(f,d);const o=CA&&("stream"===c||"response"===c);if(CA&&(a||o&&m)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=s[t]});const t=yI.toFiniteNumber(s.headers.get("content-length")),[n,r]=a&&oA(t,sA(aA(a),!0))||[];s=new Response(vA(s.body,65536,n,()=>{r&&r(),m&&m()}),e)}c=c||"text";let y=await TA[yI.findKey(TA,c)||"text"](s,e);return!o&&m&&m(),await new Promise((t,n)=>{nA(t,n,{data:y,headers:XI.from(s.headers),status:s.status,statusText:s.statusText,config:e,request:f})})}catch(y){if(m&&m(),y&&"TypeError"===y.name&&/Load failed|fetch/i.test(y.message))throw Object.assign(new SI("Network Error",SI.ERR_NETWORK,e,f),{cause:y.cause||y});throw SI.from(y,y&&y.code,e,f)}})};yI.forEach(AA,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(n){}Object.defineProperty(e,"adapterName",{value:t})}});const NA=e=>`- ${e}`,OA=e=>yI.isFunction(e)||null===e||!1===e,MA=e=>{e=yI.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let s=0;s<t;s++){let t;if(n=e[s],r=n,!OA(n)&&(r=AA[(t=String(n)).toLowerCase()],void 0===r))throw new SI(`Unknown adapter '${t}'`);if(r)break;i[t||"#"+s]=r}if(!r){const e=Object.entries(i).map(e=>{let[t,n]=e;return`adapter ${t} `+(!1===n?"is not supported by the environment":"is not available in the build")});let n=t?e.length>1?"since :\n"+e.map(NA).join("\n"):" "+NA(e[0]):"as no adapter specified";throw new SI("There is no suitable adapter to dispatch the request "+n,"ERR_NOT_SUPPORT")}return r};function RA(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new tA(null,e)}function DA(e){RA(e),e.headers=XI.from(e.headers),e.data=YI.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return MA(e.adapter||qI.adapter)(e).then(function(t){return RA(e),t.data=YI.call(e,e.transformResponse,t),t.headers=XI.from(t.headers),t},function(t){return ZI(t)||(RA(e),t&&t.response&&(t.response.data=YI.call(e,e.transformResponse,t.response),t.response.headers=XI.from(t.response.headers))),Promise.reject(t)})}const PA="1.10.0",LA={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{LA[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const FA={};LA.transitional=function(e,t,n){function r(e,t){return"[Axios v"+PA+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,i,s)=>{if(!1===e)throw new SI(r(i," has been removed"+(t?" in "+t:"")),SI.ERR_DEPRECATED);return t&&!FA[i]&&(FA[i]=!0,console.warn(r(i," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,i,s)}},LA.spelling=function(e){return(t,n)=>(console.warn(`${n} is likely a misspelling of ${e}`),!0)};const jA={assertOptions:function(e,t,n){if("object"!==typeof e)throw new SI("options must be an object",SI.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const s=r[i],o=t[s];if(o){const t=e[s],n=void 0===t||o(t,s,e);if(!0!==n)throw new SI("option "+s+" must be "+n,SI.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new SI("Unknown option "+s,SI.ERR_BAD_OPTION)}},validators:LA},VA=jA.validators;class zA{constructor(e){this.defaults=e||{},this.interceptors={request:new RI,response:new RI}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(r){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=dA(this.defaults,t);const{transitional:n,paramsSerializer:r,headers:i}=t;void 0!==n&&jA.assertOptions(n,{silentJSONParsing:VA.transitional(VA.boolean),forcedJSONParsing:VA.transitional(VA.boolean),clarifyTimeoutError:VA.transitional(VA.boolean)},!1),null!=r&&(yI.isFunction(r)?t.paramsSerializer={serialize:r}:jA.assertOptions(r,{encode:VA.function,serialize:VA.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),jA.assertOptions(t,{baseUrl:VA.spelling("baseURL"),withXsrfToken:VA.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let s=i&&yI.merge(i.common,i[t.method]);i&&yI.forEach(["delete","get","head","post","put","patch","common"],e=>{delete i[e]}),t.headers=XI.concat(s,i);const o=[];let a=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(a=a&&e.synchronous,o.unshift(e.fulfilled,e.rejected))});const l=[];let c;this.interceptors.response.forEach(function(e){l.push(e.fulfilled,e.rejected)});let u,h=0;if(!a){const e=[DA.bind(this),void 0];for(e.unshift.apply(e,o),e.push.apply(e,l),u=e.length,c=Promise.resolve(t);h<u;)c=c.then(e[h++],e[h++]);return c}u=o.length;let d=t;for(h=0;h<u;){const e=o[h++],t=o[h++];try{d=e(d)}catch(f){t.call(this,f);break}}try{c=DA.call(this,d)}catch(f){return Promise.reject(f)}for(h=0,u=l.length;h<u;)c=c.then(l[h++],l[h++]);return c}getUri(e){return MI(uA((e=dA(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}yI.forEach(["delete","get","head","options"],function(e){zA.prototype[e]=function(t,n){return this.request(dA(n||{},{method:e,url:t,data:(n||{}).data}))}}),yI.forEach(["post","put","patch"],function(e){function t(t){return function(n,r,i){return this.request(dA(i||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:r}))}}zA.prototype[e]=t(),zA.prototype[e+"Form"]=t(!0)});const UA=zA;class BA{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const r=new Promise(e=>{n.subscribe(e),t=e}).then(e);return r.cancel=function(){n.unsubscribe(t)},r},e(function(e,r,i){n.reason||(n.reason=new tA(e,r,i),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new BA(function(t){e=t}),cancel:e}}}const $A=BA;const qA={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(qA).forEach(e=>{let[t,n]=e;qA[n]=t});const HA=qA;const WA=function e(t){const n=new UA(t),r=M_(UA.prototype.request,n);return yI.extend(r,UA.prototype,n,{allOwnKeys:!0}),yI.extend(r,n,null,{allOwnKeys:!0}),r.create=function(n){return e(dA(t,n))},r}(qI);WA.Axios=UA,WA.CanceledError=tA,WA.CancelToken=$A,WA.isCancel=ZI,WA.VERSION=PA,WA.toFormData=TI,WA.AxiosError=SI,WA.Cancel=WA.CanceledError,WA.all=function(e){return Promise.all(e)},WA.spread=function(e){return function(t){return e.apply(null,t)}},WA.isAxiosError=function(e){return yI.isObject(e)&&!0===e.isAxiosError},WA.mergeConfig=dA,WA.AxiosHeaders=XI,WA.formToJSON=e=>BI(yI.isHTMLForm(e)?new FormData(e):e),WA.getAdapter=MA,WA.HttpStatusCode=HA,WA.default=WA;const KA=WA;const GA=new class{constructor(){this.baseURL="",this.api=KA.create({baseURL:this.baseURL,timeout:3e4})}async compile(e){try{const t=await this.api.post("/compile",{source:e,format:"png"},{responseType:"json",headers:{"Content-Type":"application/json"}});return 200===t.status&&t.data.success?{success:!0,data:t.data}:{success:!1,error:t.data.error||"\u7f16\u8bd1\u5931\u8d25"}}catch(n){var t;return console.error("Typst\u7f16\u8bd1\u9519\u8bef:",n),n.response?{success:!1,error:(null===(t=n.response.data)||void 0===t?void 0:t.message)||`\u670d\u52a1\u5668\u9519\u8bef: ${n.response.status}`}:n.request?{success:!1,error:"\u65e0\u6cd5\u8fde\u63a5\u5230Typst\u670d\u52a1\u5668\uff0c\u8bf7\u68c0\u67e5\u670d\u52a1\u5668\u662f\u5426\u8fd0\u884c"}:{success:!1,error:n.message||"\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u53d1\u751f\u672a\u77e5\u9519\u8bef"}}}async checkHealth(){try{return 200===(await this.api.get("/health")).status}catch(e){return console.error("\u5065\u5eb7\u68c0\u67e5\u5931\u8d25:",e),!1}}async downloadPDF(e){try{const t=await this.api.post("/download-pdf",{source:e},{responseType:"blob",headers:{"Content-Type":"application/json"}});if(200===t.status){const e=new Blob([t.data],{type:"application/pdf"}),n=window.URL.createObjectURL(e),r=document.createElement("a");return r.href=n,r.download="typst-document.pdf",document.body.appendChild(r),r.click(),document.body.removeChild(r),window.URL.revokeObjectURL(n),{success:!0}}return{success:!1,error:"PDF\u4e0b\u8f7d\u5931\u8d25"}}catch(n){var t;return console.error("PDF\u4e0b\u8f7d\u9519\u8bef:",n),n.response?{success:!1,error:(null===(t=n.response.data)||void 0===t?void 0:t.error)||`\u4e0b\u8f7d\u5931\u8d25: ${n.response.status}`}:n.request?{success:!1,error:"\u65e0\u6cd5\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u8fde\u63a5"}:{success:!1,error:n.message||"\u4e0b\u8f7d\u8fc7\u7a0b\u4e2d\u53d1\u751f\u672a\u77e5\u9519\u8bef"}}}async getSupportedFeatures(){try{return(await this.api.get("/features")).data.features||[]}catch(e){return console.error("\u83b7\u53d6\u529f\u80fd\u5217\u8868\u5931\u8d25:",e),[]}}},JA=document.createElement("style");JA.textContent="\n  @keyframes spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n  }\n\n  /* \u4f18\u5316SVG\u663e\u793a */\n  .svg-container svg {\n    max-width: 100%;\n    height: auto;\n    display: block;\n    margin: 0 auto;\n  }\n\n  /* \u9002\u5e94\u5bbd\u5ea6\u65f6\u7684SVG\u6837\u5f0f */\n  .svg-container svg.fit-width {\n    width: 100%;\n    height: auto;\n  }\n\n  /* \u5e73\u6ed1\u6eda\u52a8\u6761\u6837\u5f0f */\n  *::-webkit-scrollbar {\n    width: 8px;\n    height: 8px;\n  }\n\n  *::-webkit-scrollbar-track {\n    background: #f1f5f9;\n    border-radius: 4px;\n  }\n\n  *::-webkit-scrollbar-thumb {\n    background: #cbd5e1;\n    border-radius: 4px;\n    transition: background 0.2s ease;\n  }\n\n  *::-webkit-scrollbar-thumb:hover {\n    background: #94a3b8;\n  }\n\n  /* \u54cd\u5e94\u5f0f\u7f29\u653e\u6309\u94ae */\n  @media (max-width: 640px) {\n    .zoom-controls {\n      flex-wrap: wrap;\n      gap: 0.125rem;\n    }\n\n    .zoom-controls button {\n      width: 24px;\n      height: 24px;\n    }\n\n    .zoom-controls span {\n      font-size: 0.625rem;\n      min-width: 40px;\n    }\n  }\n",document.head.appendChild(JA);const QA=e=>{let{pngPages:t,isCompiling:n,error:r,sourceCode:s}=e;const o=t,[a,l]=(0,i.useState)(1),[c,u]=(0,i.useState)(!0),[h,d]=(0,i.useState)(!1),f=(0,i.useCallback)(()=>{l(e=>Math.min(1.2*e,3)),u(!1)},[]),p=(0,i.useCallback)(()=>{l(e=>Math.max(e/1.2,.3)),u(!1)},[]),m=(0,i.useCallback)(()=>{l(1),u(!0)},[]),g=(0,i.useCallback)(()=>{u(!c),c||l(1)},[c]),y=(0,i.useCallback)(async()=>{if(s&&!h){d(!0);try{const e=await GA.downloadPDF(s);e.success||alert(`\u4e0b\u8f7d\u5931\u8d25: ${e.error}`)}catch(r){console.error("\u4e0b\u8f7dPDF\u5931\u8d25:",r),alert("\u4e0b\u8f7d\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}finally{d(!1)}}},[s,h]);return(0,Fp.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column",backgroundColor:"#f8f9fa"},children:[(0,Fp.jsxs)("div",{style:{padding:"0.75rem 1rem",borderBottom:"1px solid #e1e5e9",backgroundColor:"white",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:"0.5rem"},children:[(0,Fp.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,Fp.jsx)(x_,{size:16}),(0,Fp.jsxs)("span",{style:{fontWeight:"500"},children:["SVG\u9884\u89c8",o&&o.totalPages&&` (${o.totalPages}\u9875)`]}),n&&(0,Fp.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,Fp.jsx)(C_,{size:14,style:{animation:"spin 1s linear infinite"}}),(0,Fp.jsx)("span",{style:{fontSize:"0.875rem",color:"#6b7280"},children:"\u7f16\u8bd1\u4e2d..."})]}),o&&o.pages&&s&&(0,Fp.jsx)("button",{onClick:y,disabled:h||n,style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"0.375rem",padding:"0.375rem 0.75rem",border:"none",backgroundColor:h||n?"#e5e7eb":"#3b82f6",borderRadius:"0.375rem",cursor:h||n?"not-allowed":"pointer",color:h||n?"#9ca3af":"white",fontSize:"0.75rem",fontWeight:"500",transition:"all 0.15s"},title:"\u4e0b\u8f7dPDF",children:h?(0,Fp.jsxs)(Fp.Fragment,{children:[(0,Fp.jsx)(C_,{size:12,style:{animation:"spin 1s linear infinite"}}),"\u4e0b\u8f7d\u4e2d..."]}):(0,Fp.jsxs)(Fp.Fragment,{children:[(0,Fp.jsx)(T_,{size:12}),"\u4e0b\u8f7dPDF"]})})]}),o&&o.pages&&(0,Fp.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem",backgroundColor:"#f3f4f6",borderRadius:"0.375rem",padding:"0.25rem"},children:[(0,Fp.jsx)("button",{onClick:p,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",border:"none",backgroundColor:a<=.3?"#e5e7eb":"white",borderRadius:"0.25rem",cursor:a<=.3?"not-allowed":"pointer",color:a<=.3?"#9ca3af":"#374151",transition:"all 0.15s"},disabled:a<=.3,title:"\u7f29\u5c0f",children:(0,Fp.jsx)(__,{size:14})}),(0,Fp.jsx)("span",{style:{fontSize:"0.75rem",color:"#6b7280",minWidth:"50px",textAlign:"center"},children:c?"\u9002\u5e94":`${Math.round(100*a)}%`}),(0,Fp.jsx)("button",{onClick:f,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",border:"none",backgroundColor:a>=3?"#e5e7eb":"white",borderRadius:"0.25rem",cursor:a>=3?"not-allowed":"pointer",color:a>=3?"#9ca3af":"#374151",transition:"all 0.15s"},disabled:a>=3,title:"\u653e\u5927",children:(0,Fp.jsx)(I_,{size:14})}),(0,Fp.jsx)("button",{onClick:g,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",border:"none",backgroundColor:c?"#3b82f6":"white",borderRadius:"0.25rem",cursor:"pointer",color:c?"white":"#374151",transition:"all 0.15s"},title:"\u9002\u5e94\u5bbd\u5ea6",children:(0,Fp.jsx)(A_,{size:14})}),(0,Fp.jsx)("button",{onClick:m,style:{display:"flex",alignItems:"center",justifyContent:"center",width:"28px",height:"28px",border:"none",backgroundColor:"white",borderRadius:"0.25rem",cursor:"pointer",color:"#374151",transition:"all 0.15s"},title:"\u91cd\u7f6e\u7f29\u653e",children:(0,Fp.jsx)(N_,{size:14})})]})]}),(0,Fp.jsx)("div",{style:{flex:1,display:"flex",flexDirection:"column",overflow:"hidden",backgroundColor:"#f3f4f6"},children:r?(0,Fp.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"1rem",color:"#dc2626",textAlign:"center",padding:"1rem"},children:[(0,Fp.jsx)(O_,{size:48}),(0,Fp.jsxs)("div",{children:[(0,Fp.jsx)("h3",{style:{marginBottom:"0.5rem"},children:"\u7f16\u8bd1\u9519\u8bef"}),(0,Fp.jsx)("p",{style:{fontSize:"0.875rem"},children:r})]})]}):o&&o.pages?(0,Fp.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"2rem",overflowY:"auto",overflowX:c?"hidden":"auto",height:"100%",padding:"1rem",alignItems:"center"},children:o.pages.map((e,t)=>(0,Fp.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.75rem",width:"100%",maxWidth:c?"100%":"none"},children:[(0,Fp.jsx)("div",{style:{backgroundColor:"white",borderRadius:"8px",boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)",border:"1px solid #e5e7eb",overflow:c?"hidden":"visible",maxWidth:c?"100%":"none",position:"relative",display:"flex",alignItems:"center",justifyContent:"center",padding:c?"1rem":"0.5rem",minHeight:"200px"},children:(0,Fp.jsx)("div",{className:"svg-container",style:{transform:c?"none":`scale(${a})`,transformOrigin:"center center",transition:"transform 0.2s ease-in-out",lineHeight:0,width:c?"100%":"auto",height:"auto",display:"flex",alignItems:"center",justifyContent:"center"},dangerouslySetInnerHTML:{__html:e.data}})}),(0,Fp.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6b7280",fontWeight:"500",backgroundColor:"white",padding:"0.375rem 0.75rem",borderRadius:"0.375rem",border:"1px solid #e5e7eb",boxShadow:"0 1px 2px rgba(0, 0, 0, 0.05)"},children:["\u7b2c ",e.pageNumber," \u9875"]})]},e.pageNumber))}):(0,Fp.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",gap:"1rem",color:"#6b7280",textAlign:"center",padding:"1rem"},children:[(0,Fp.jsx)(x_,{size:48}),(0,Fp.jsxs)("div",{children:[(0,Fp.jsx)("h3",{style:{marginBottom:"0.5rem"},children:"\u5f00\u59cb\u7f16\u5199\u4f60\u7684\u6587\u6863"}),(0,Fp.jsx)("p",{style:{fontSize:"0.875rem"},children:"\u5728\u5de6\u4fa7\u7f16\u8f91\u5668\u4e2d\u8f93\u5165\u5185\u5bb9\uff0cSVG\u9884\u89c8\u5c06\u81ea\u52a8\u663e\u793a\u5728\u8fd9\u91cc"})]})]})})]})},XA="documents";async function YA(e,t,n){try{const r=await function(e,t){const n=Us(e.firestore,Pf),r=Of(e),i=xp(e.converter,t);return Op(n,[Qf(Jf(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,rc.exists(!1))]).then(()=>r)}(Nf(Lp,XA),{userId:e,title:t||"\u65e0\u6807\u9898\u6587\u6863",content:n||"",createdAt:Rp(),updatedAt:Rp()});return{id:r.id,success:!0}}catch(r){throw console.error("Error creating document:",r),r}}async function ZA(e){try{const t=function(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof mp&&n.push(t),n=n.concat(i),function(e){const t=e.filter(e=>e instanceof vp).length,n=e.filter(e=>e instanceof yp).length;if(t>1||t>0&&n>0)throw new ds(hs.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}(Nf(Lp,XA),function(e,t,n){const r=t,i=fp("where",e);return yp._create(i,r,n)}("userId","==",e),function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=fp("orderBy",e);return wp._create(n,t)}("updatedAt","desc")),n=await function(e){e=Us(e,_f);const t=Us(e.firestore,Pf),n=Lf(t),r=new Np(t);return pp(e._query),wf(n,e._query).then(n=>new Ip(t,r,e,n))}(t),r=[];return n.forEach(e=>{r.push({id:e.id,...e.data()})}),r}catch(t){throw console.error("Error getting documents:",t),t}}async function eN(e){try{const t=Of(Lp,XA,e),n=await function(e){e=Us(e,If);const t=Us(e.firestore,Pf);return vf(Lf(t),e._key).then(n=>Mp(t,e,n))}(t);if(n.exists())return{id:n.id,...n.data()};throw new Error("Document not found")}catch(t){throw console.error("Error getting document:",t),t}}async function tN(e,t,n){try{const r=Of(Lp,XA,e);return await function(e,t,n){e=Us(e,If);const r=Us(e.firestore,Pf),i=Jf(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=L(t))||t instanceof Vf?ep(i,"updateDoc",e._key,t,n,a):Zf(i,"updateDoc",e._key,t),Op(r,[s.toMutation(e._key,rc.exists(!0))])}(r,{title:t,content:n,updatedAt:Rp()}),{success:!0}}catch(r){throw console.error("Error updating document:",r),r}}async function nN(e){try{const n=Of(Lp,XA,e);return await(t=n,Op(Us(t.firestore,Pf),[new gc(t._key,rc.none())])),{success:!0}}catch(n){throw console.error("Error deleting document:",n),n}var t}function rN(e){let{onSelectDocument:t,onNewDocument:n}=e;const[r,s]=(0,i.useState)([]),[o,a]=(0,i.useState)(!0),[l,c]=(0,i.useState)(""),{currentUser:u}=Vp();async function h(){try{a(!0),c("");const e=await ZA(u.uid);s(e)}catch(e){c("\u52a0\u8f7d\u6587\u6863\u5931\u8d25: "+e.message)}finally{a(!1)}}async function d(){try{c("");const e=await YA(u.uid,"\u65b0\u6587\u6863 "+(new Date).toLocaleDateString(),"");await h(),n(e.id)}catch(e){c("\u521b\u5efa\u6587\u6863\u5931\u8d25: "+e.message)}}function f(e){if(!e)return"";const t=e.toDate?e.toDate():new Date(e);return t.toLocaleDateString("zh-CN")+" "+t.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit"})}return(0,i.useEffect)(()=>{h()},[u]),o?(0,Fp.jsx)("div",{className:"document-manager-loading",children:"\u52a0\u8f7d\u4e2d..."}):(0,Fp.jsxs)("div",{className:"document-manager",children:[(0,Fp.jsxs)("div",{className:"document-manager-header",children:[(0,Fp.jsx)("h3",{children:"\u6211\u7684\u6587\u6863"}),(0,Fp.jsx)("button",{onClick:d,className:"btn-new-doc",children:"+ \u65b0\u5efa\u6587\u6863"})]}),l&&(0,Fp.jsx)("div",{className:"document-error",children:l}),(0,Fp.jsx)("div",{className:"document-list",children:0===r.length?(0,Fp.jsxs)("div",{className:"no-documents",children:[(0,Fp.jsx)("p",{children:"\u8fd8\u6ca1\u6709\u6587\u6863"}),(0,Fp.jsx)("button",{onClick:d,className:"btn-create-first",children:"\u521b\u5efa\u7b2c\u4e00\u4e2a\u6587\u6863"})]}):r.map(e=>(0,Fp.jsxs)("div",{className:"document-item",onClick:()=>t(e.id),children:[(0,Fp.jsxs)("div",{className:"document-info",children:[(0,Fp.jsx)("h4",{children:e.title}),(0,Fp.jsx)("p",{className:"document-date",children:f(e.updatedAt)})]}),(0,Fp.jsx)("button",{onClick:t=>async function(e,t){if(t.stopPropagation(),window.confirm("\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u4e2a\u6587\u6863\u5417\uff1f"))try{c(""),await nN(e),await h()}catch(n){c("\u5220\u9664\u6587\u6863\u5931\u8d25: "+n.message)}}(e.id,t),className:"btn-delete",title:"\u5220\u9664",children:"\u2715"})]},e.id))})]})}const iN=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[n,r]=(0,i.useState)(null),[s,o]=(0,i.useState)(!1),[a,l]=(0,i.useState)(null),[c,u]=(0,i.useState)(!1),h=t.debounceDelay||500,d=(0,i.useRef)(null),f=(0,i.useRef)([]);(0,i.useEffect)(()=>{const e=async()=>{const e=await GA.checkHealth();u(e),e||l("Typst\u670d\u52a1\u5668\u672a\u54cd\u5e94\uff0c\u8bf7\u786e\u4fdd\u670d\u52a1\u5668\u6b63\u5728\u8fd0\u884c")};e();const t=setInterval(e,3e4);return()=>clearInterval(t)},[]);const p=(0,i.useCallback)(async e=>{if(!e.trim())return r(null),void l(null);if(!c)return void l("Typst\u670d\u52a1\u5668\u4e0d\u53ef\u7528");o(!0),l(null);let t=e;if(!(e=>/#set\s+text\s*\(\s*font:\s*\(/.test(e))(e)){t=Xx()+"\n"+e}try{const e=await GA.compile(t);e.success&&e.data?(f.current.forEach(e=>{e.startsWith("blob:")&&URL.revokeObjectURL(e)}),r({totalPages:e.data.totalPages,pages:e.data.pages}),f.current=e.data.pages.map(e=>e.data),l(null)):(r(null),l(e.error||"\u7f16\u8bd1\u5931\u8d25"))}catch(n){console.error("\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u51fa\u9519:",n),r(null),l("\u7f16\u8bd1\u8fc7\u7a0b\u4e2d\u53d1\u751f\u9519\u8bef: "+n.message)}finally{o(!1)}},[c]),m=(0,i.useCallback)(e=>{d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{p(e)},h)},[p,h]);(0,i.useEffect)(()=>(e&&c&&m(e),()=>{d.current&&clearTimeout(d.current)}),[e,m,c]),(0,i.useEffect)(()=>()=>{f.current.forEach(e=>{e.startsWith("blob:")&&URL.revokeObjectURL(e)}),d.current&&clearTimeout(d.current)},[]);const g=(0,i.useCallback)(()=>{d.current&&clearTimeout(d.current),p(e)},[p,e]);return{pngPages:n,isCompiling:s,error:a,isServerHealthy:c,manualCompile:g}},sN=()=>{const{currentUser:e,logout:t}=Vp(),[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)(null),[a,l]=(0,i.useState)("\u65e0\u6807\u9898\u6587\u6863"),[c,u]=(0,i.useState)(!0),[h,d]=(0,i.useState)(""),{pngPages:f,isCompiling:p,error:m}=iN(n,{debounceDelay:300});(0,i.useEffect)(()=>{if(!s||!n)return;const e=setTimeout(async()=>{try{d("saving"),await tN(s,a,n),d("saved"),setTimeout(()=>d(""),2e3)}catch(e){d("error"),console.error("Auto-save failed:",e)}},2e3);return()=>clearTimeout(e)},[n,s,a]);const g=(0,i.useCallback)(e=>{r(e)},[]);return(0,Fp.jsxs)("div",{className:"split-layout-container",children:[(0,Fp.jsxs)("div",{className:"top-toolbar",children:[(0,Fp.jsx)("button",{onClick:()=>u(!c),className:"btn-toggle-docs",children:c?"\u9690\u85cf\u6587\u6863\u5217\u8868":"\u663e\u793a\u6587\u6863\u5217\u8868"}),s&&(0,Fp.jsx)("input",{type:"text",value:a,onChange:e=>{l(e.target.value)},className:"document-title-input",placeholder:"\u6587\u6863\u6807\u9898"}),(0,Fp.jsxs)("div",{className:"toolbar-right",children:["saving"===h&&(0,Fp.jsx)("span",{className:"save-status saving",children:"\u4fdd\u5b58\u4e2d..."}),"saved"===h&&(0,Fp.jsx)("span",{className:"save-status saved",children:"\u5df2\u4fdd\u5b58 \u2713"}),"error"===h&&(0,Fp.jsx)("span",{className:"save-status error",children:"\u4fdd\u5b58\u5931\u8d25"}),(0,Fp.jsx)("span",{className:"user-email",children:null===e||void 0===e?void 0:e.email}),(0,Fp.jsx)("button",{onClick:t,className:"btn-logout",children:"\u9000\u51fa"})]})]}),(0,Fp.jsxs)("div",{className:"main-content",children:[c&&(0,Fp.jsx)("div",{className:"document-sidebar",children:(0,Fp.jsx)(rN,{onSelectDocument:async e=>{try{const t=await eN(e);o(t.id),r(t.content||""),l(t.title||"\u65e0\u6807\u9898\u6587\u6863"),u(!1)}catch(t){console.error("Failed to load document:",t)}},onNewDocument:async e=>{try{const t=await eN(e);o(t.id),r(""),l(t.title||"\u65b0\u6587\u6863"),u(!1)}catch(t){console.error("Failed to create document:",t)}}})}),(0,Fp.jsxs)("div",{className:"editor-preview-container",children:[(0,Fp.jsx)("div",{className:"editor-pane",children:s?(0,Fp.jsx)(E_,{content:n,onChange:g}):(0,Fp.jsx)("div",{className:"no-document-selected",children:(0,Fp.jsx)("p",{children:"\u8bf7\u9009\u62e9\u6216\u521b\u5efa\u4e00\u4e2a\u6587\u6863\u5f00\u59cb\u7f16\u8f91"})})}),(0,Fp.jsx)("div",{className:"preview-pane",children:(0,Fp.jsx)(QA,{pngPages:f,isCompiling:p,error:m,sourceCode:n})})]})]})]})};function oN(){return(0,Fp.jsxs)("div",{className:"App",children:[(0,Fp.jsx)("header",{className:"app-header",children:(0,Fp.jsx)("h1",{children:"Typst \u6240\u89c1\u5373\u6240\u5f97\u7f16\u8f91\u5668"})}),(0,Fp.jsx)(sN,{})]})}function aN(){const[e,t]=(0,i.useState)(!0);return e?(0,Fp.jsx)(Up,{onSwitchToSignup:()=>t(!1)}):(0,Fp.jsx)(Bp,{onSwitchToLogin:()=>t(!0)})}function lN(){const{currentUser:e}=Vp();return e?(0,Fp.jsx)(oN,{}):(0,Fp.jsx)(aN,{})}const cN=function(){return(0,Fp.jsx)(zp,{children:(0,Fp.jsx)(lN,{})})};s.createRoot(document.getElementById("root")).render((0,Fp.jsx)(i.StrictMode,{children:(0,Fp.jsx)(cN,{})}))})();
//# sourceMappingURL=main.080bc246.js.map